/*
    ChickenPaint Be
    https://github.com/satopian/ChickenPaint_Be
    by satopian
    Customized from ChickenPaint by Nicholas Sherlock.
    GNU GENERAL PUBLIC LICENSE
    Version 3, 29 June 2007
    <http://www.gnu.org/licenses/>
*/
/*
    ChickenPaint

    ChickenPaint is a translation of ChibiPaint from Java to JavaScript
    by Nicholas Sherlock / Chicken Smoothie.

    ChibiPaint is Copyright (c) 2006-2008 Marc Schefer

    ChickenPaint is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    ChickenPaint is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with ChickenPaint. If not, see <http://www.gnu.org/licenses/>.
*/
/*
    jQuery JavaScript Library
    (c) OpenJS Foundation and other contributors | https://jquery.com/license/

    Bootstrap (https://getbootstrap.com/)
    Copyright The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)

    EventEmitter v5.2.9 - git.io/ee
    Unlicense - http://unlicense.org/
    Oliver Caldwell - https://oli.me.uk/
*/
!function(){function ma(a){return a&&a.__esModule?a.default:a}function od(a,c,d,b){Object.defineProperty(a,c,{get:d,set:b,enumerable:!0,configurable:!0})}function Ca(a){for(var c in Ca.DEFAULTS)Ca.DEFAULTS.hasOwnProperty(c)&&(this[c]=Ca.DEFAULTS[c]);for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c])}function Ha(a,c,d,b){this.left=a;this.top=c;this.right=d;this.bottom=b}function Dd(a,c){this.width=0|a;this.height=0|c}function Yc(a,c){var d=document.createElement("canvas");return d.width=a,d.height=c,d}
function of(a,c){return document.createElement("canvas").getContext("2d").createImageData(a,c)}function H(a,c){"number"==typeof a?(Dd.call(this,a,c),this.imageData=of(this.width,this.height)):(Dd.call(this,a.width,a.height),this.imageData=a);this.data=this.imageData.data}function ig(a,c,d,b){var g,p=0,f=[0,0,0,0];var e=0;for(g=0;g<b&&g<d;g++){for(var m=0;m<H.BYTES_PER_PIXEL;m++)f[m]+=a[e++];p++}g=0;for(m=0;m<d;m++){if(m+b<d){e=(m+b)*H.BYTES_PER_PIXEL;for(var l=0;l<H.BYTES_PER_PIXEL;l++)f[l]+=a[e++];
p++}for(e=0;e<H.BYTES_PER_PIXEL;e++)c[g++]=Math.round(f[e]/p);if(0<=m-b){e=(m-b)*H.BYTES_PER_PIXEL;for(l=0;l<H.BYTES_PER_PIXEL;l++)f[l]-=a[e++];p--}}}function jg(a,c){if(0==(c%=4))return a;let d=Yc(0,0),b=d.getContext("2d");switch(0==c%2?(d.width=a.width,d.height=a.height):(d.width=a.height,d.height=a.width),c){case 1:b.rotate(Math.PI/2);b.drawImage(a,0,-a.height);break;case 2:b.rotate(Math.PI);b.drawImage(a,-a.width,-a.height);break;case 3:b.rotate(-Math.PI/2);b.drawImage(a,-a.width,0);break;default:return a}return d}
function nb(a,c){rb.call(this,a);this.layers=[];this.expanded=!0;this.blendMode=c}function sh(a,c){return a+c}function Xa(a,c,d){Dd.call(this,a,c);this.createBitmap(a,c,d)}function kg(a,c,d,b){var g,p=0,f=0;for(g=0;g<b&&g<d;g++)f+=a[g],p++;g=0;for(let e=0;e<d;e++)e+b<d&&(f+=a[e+b],p++),c[g++]=Math.round(f/p),0<=e-b&&(f-=a[e-b],p--)}function V(){}function rb(a){this.name=a||"";this.parent=null;this.lockAlpha=!1;this.alpha=100;this.visible=!0;this.blendMode=V.LM_NORMAL;this.mask=null;this.maskVisible=
this.maskLinked=!0;this.maskThumbnail=null;this.useLegacyMultiply=!1}function Ma(a,c,d){rb.call(this,d);0<a&&0<c?this.image=new H(a,c):this.image=null;this.clip=!1;this.imageThumbnail=null}function ge(a,c,d){d?(this.isGroup=d instanceof nb,this.image=d.image,this.mask=d.getEffectiveMask(),this.layer=d,this.blendMode=d.blendMode,this.alpha=d.alpha,this.visible=d.visible):(this.isGroup=!0,this.image=null,this.mask=null,this.layer=null,this.blendMode=V.LM_PASSTHROUGH,this.alpha=100,this.visible=!0);
this.dirtyRect=new Ha(0,0,a,c);this.layers=[];this.parent=null;this.clip=!1}function pf(a,c,d,b){function g(){return 0<l.length?l.pop():new H(c,d)}function p(n){if(0==n.layers.length)return null;if(1==n.layers.length&&(null==n.mask||null==n.layers[0].mask)){let r=n.layers[0];return r.alpha=Math.round(n.alpha*r.alpha/100),n.blendMode!=V.LM_PASSTHROUGH&&(r.blendMode=n.blendMode),r.mask=n.mask||r.mask,n.layer&&h.set(n.layer,r),r}return n.blendMode==V.LM_PASSTHROUGH&&100==n.alpha&&null==n.mask?n.layers:
(n.image=g(),n)}function f(n){let r=new ge(c,d,n);return h.set(n,r),r}function e(n,r){n&&(n.dirtyRect.union(r),e(n.parent,r))}let m,l=[],h=new Map;this.invalidateLayerRect=function(n,r){e(h.get(n),r)};this.buildTree=function(){if(!m){if(m=function t(r){if(0==r.getEffectiveAlpha())return null;let v=f(r);for(var x=0;x<r.layers.length;x++){let G=r.layers[x];var D=r.layers[x+1];if(G instanceof Ma&&D&&D.clip){D=new ge(c,d,null);D.blendMode=G.blendMode;D.alpha=100;D.clip=!0;D.addChildren(f(G));for(x+=1;x<
r.layers.length;x++)if(r.layers[x].clip)0<r.layers[x].getEffectiveAlpha()&&D.addChildren(f(r.layers[x]));else break;0<G.getEffectiveAlpha()&&v.addChildren(p(D));--x}else G instanceof nb?v.addChildren(t(G)):0<G.getEffectiveAlpha()&&v.addChildren(f(G))}return p(v)}(a)){if(Array.isArray(m)||b&&(100>m.alpha||m.mask)){let r=m;(m=new ge(c,d)).blendMode=Array.isArray(r)?V.LM_NORMAL:r.blendMode;m.alpha=100;m.image=g();m.addChildren(r)}}else(m=new ge(c,d,{image:g(),blendMode:V.LM_NORMAL,alpha:100,getEffectiveMask:()=>
null,visible:!0})).image.clearAll(0);l=[]}};this.resetTree=function(){m&&(!function t(r){if(r.isGroup)for(let v of(r.image&&l.push(r.image),r.layers))t(v)}(m),m=null,h.clear())};this.layerPropertyChanged=function(n,r){let t=h.get(n);t&&t.visible==n.visible&&t.alpha==n.alpha&&null==t.mask==(null==n.getEffectiveMask())&&t.blendMode==V.LM_PASSTHROUGH==(n.blendMode==V.LM_PASSTHROUGH)&&"clip"!==r?(t.blendMode=n.blendMode,e(t,new Ha(0,0,c,d))):this.resetTree()};this.blendTree=function(){return function t(r){if(!r||
!r.isGroup)return r;let v=r.dirtyRect;var x=!0,D=!0;if(r.blendMode==V.LM_PASSTHROUGH&&r.parent&&v.union(r.parent.dirtyRect),v.isEmpty())return r;if(r.blendMode==V.LM_PASSTHROUGH&&r.parent){x=!1;var G=r.image;var N=r.parent.image;v.getWidth()==G.width&&v.getHeight()==G.height?G.copyPixelsFrom(N):V.replaceOntoFusionWithOpaqueLayer(G,N,100,v)}for(G=0;G<r.layers.length;G++){var K=t(r.layers[G]);if(x){x=r.image;N=K.image;var P=K.alpha,L=v;K=K.mask;if(100!=P||K||L.getWidth()!=x.width||L.getHeight()!=x.height){let ba=
"replaceOntoFusionWith";100==P?ba+="OpaqueLayer":ba+="TransparentLayer";K&&(ba+="Masked");V[ba](x,N,P,L,K)}else x.copyPixelsFrom(N);!0;x=!1}else D=D&&r.image.hasAlphaInRect(v),V.fuseImageOntoImage(r.image,D,K.image,K.alpha,K.blendMode,v,K.mask)}r.clip&&(D=r.layers[0],100>D.alpha?D.mask?V.replaceAlphaOntoFusionWithTransparentLayerMasked(r.image,D.image,D.alpha,v,D.mask):V.replaceAlphaOntoFusionWithTransparentLayer(r.image,D.image,D.alpha,v):D.mask?V.replaceAlphaOntoFusionWithOpaqueLayerMasked(r.image,
D.image,100,v,D.mask):V.replaceAlphaOntoFusionWithOpaqueLayer(r.image,D.image,100,v));return r.dirtyRect.makeEmpty(),r}(m)}}function th(){function a(h){if(null!=g&&h.curSize==p&&h.curSqueeze==f&&h.curAngle==e&&h.tip==m)return g;switch(h.tip){case Ca.TIP_ROUND_AIRBRUSH:!function(n,r){let t=Math.ceil(r.curSize),v=t/2,x=r.curSize/2*(r.curSize/2),D=1+10*r.curSqueeze,G=Math.cos(r.curAngle);r=Math.sin(r.curAngle);let N=0;for(let L=0;L<t;L++)for(let ba=0;ba<t;ba++){var K=ba+.5-v;let X=L+.5-v;var P=(K*G-
X*r)*D;K=X*G+K*r;P=P*P+K*K;P<=x?n[N++]=~~(255*(1-P/x)):n[N++]=0}}(c,h);break;case Ca.TIP_ROUND_AA:!function(n,r){let t=Math.ceil(r.curSize),v=t/2,x=r.curSize/2*(r.curSize/2),D=(r.curSize-2)/2*((r.curSize-2)/2),G=(r.curSize+2)/2*((r.curSize+2)/2),N=1+10*r.curSqueeze,K=Math.cos(r.curAngle);r=Math.sin(r.curAngle);let P=0;for(let ba=0;ba<t;ba++)for(let X=0;X<t;X++){let Y=X+.5-v,ka=ba+.5-v,Aa=(Y*K-ka*r)*N,Ga=ka*K+Y*r;var L=Aa*Aa+Ga*Ga;if(L<=D)n[P++]=255;else if(L>G)n[P++]=0;else{L=0;for(let U=0;4>U;U++)for(let ya=
0;4>ya;ya++)(Aa=((Y=X+.25*ya-v)*K-(ka=ba+.25*U-v)*r)*N)*Aa+(Ga=ka*K+Y*r)*Ga<=x&&(L+=1);n[P++]=Math.min(16*L,255)}}}(c,h);break;case Ca.TIP_ROUND_PIXEL:!function(n,r){let t=Math.ceil(r.curSize),v=t/2,x=r.curSize/2*(r.curSize/2),D=1+10*r.curSqueeze,G=Math.cos(r.curAngle);r=Math.sin(r.curAngle);let N=0;for(let P=0;P<t;P++)for(let L=0;L<t;L++){var K=L+.5-v;let ba=P+.5-v,X=(K*G-ba*r)*D;K=ba*G+K*r;X*X+K*K<=x?n[N++]=255:n[N++]=0}}(c,h);break;case Ca.TIP_SQUARE_AA:!function(n,r){let t=Math.ceil(r.curSize),
v=t/2;var x=r.curSize*Math.sin(Math.PI/4);let D=x/2/(1+10*r.curSqueeze);x/=2;let G=D-1,N=x-1,K=D+1,P=x+1,L=Math.cos(r.curAngle);r=Math.sin(r.curAngle);let ba=0;for(let Y=0;Y<t;Y++)for(let ka=0;ka<t;ka++){var X=ka+.5-v;let Aa=Y+.5-v,Ga=Math.abs(X*L-Aa*r);X=Math.abs(Aa*L+X*r);if(Ga<=G&&X<=N)n[ba++]=255;else if(Ga>K||X>P)n[ba++]=0;else{let U=0;for(let ya=0;4>ya;ya++)for(let pa=0;4>pa;pa++)Ga=Math.abs((X=ka+.25*pa-v)*L-(Aa=Y+.25*ya-v)*r),X=Math.abs(Aa*L+X*r),Ga<=D&&X<=x&&U++;n[ba++]=Math.min(16*U,255)}}}(c,
h);break;case Ca.TIP_SQUARE_PIXEL:!function(n,r){let t=Math.ceil(r.curSize),v=t/2;var x=r.curSize*Math.sin(Math.PI/4);let D=x/2/(1+10*r.curSqueeze);x/=2;let G=Math.cos(r.curAngle);r=Math.sin(r.curAngle);let N=0;for(let K=0;K<t;K++)for(let P=0;P<t;P++){let L=P+.5-v,ba=K+.5-v,X=Math.abs(ba*G+L*r);Math.abs(L*G-ba*r)<=D&&X<=x?n[N++]=255:n[N++]=0}}(c,h)}return g=c,p=h.curSize,m=h.tip,f=h.curSqueeze,e=h.curAngle,c}let c=new Uint8Array(160801),d=new Uint8Array(161604),b=[new Float32Array(402),new Float32Array(402)],
g=null,p,f,e,m,l=this;this.getDab=function(h,n,r){let t={alpha:r.curAlpha,width:Math.ceil(r.curSize),height:Math.ceil(r.curSize)},v=r.isAA&&r.tip!=Ca.TIP_ROUND_PIXEL;v&&(t.width++,t.height++);h=h-t.width/2+.5;n=n-t.height/2+.5;let x=Math.floor(h),D=Math.floor(n);return v?t.brush=function(G,N,K){var P=a(G);let L=Math.ceil(G.curSize);G=Math.ceil(G.curSize)+1;let ba=(1-N)*(1-K),X=N*(1-K),Y=N*K,ka=(1-N)*K,Aa=0;N=0;K=b[0];let Ga=b[1];K.fill(0);for(let ya=0;ya<L;ya++){var U=0;for(Ga[0]=0;U<L;U++,Aa++,N++){let pa=
P[Aa];d[N]=K[U]+pa*ba+.5|0;K[U+1]+=pa*X;Ga[U]+=pa*ka;Ga[U+1]=pa*Y}d[N++]=K[U]+.5|0;U=K;K=Ga;Ga=U}for(P=0;P<G;P++,N++)d[N]=K[P]+.5|0;return d}(r,h-x,n-D):t.brush=a(r),t.x=x,t.y=D,0<r.texture&&null!=this.texture&&(t.brush==c&&(d.set(c),t.brush=d),!function(G,N){N=Math.floor(255*N);let K=l.texture,P=G.x%K.width,L=G.y%K.height,ba=0,X,Y;0>P&&(P+=K.width);0>L&&(L+=K.height);for(let ka=0;ka<G.height;ka++){X=L*K.width+P;Y=L*K.width+K.width;for(let Aa=0;Aa<G.width;Aa++)G.brush[ba]=~~(G.brush[ba]*(K.data[X]*
N/255^255)/255),ba++,++X==Y&&(X-=K.width);++L==K.height&&(L=0)}}(t,r.texture)),t};this.setTexture=function(h){this.texture=h}}function qf(a,c,d){this.bmp=a;this.x=c;this.y=d}function De(a){if(0==a.saturation)return a.value<<16|a.value<<8|a.value;var c=a.hue/60;c-=Math.floor(c);var d=a.saturation/255,b=~~(a.value*(1-d)),g=~~(a.value*(1-d*c));c=~~(a.value*(1-d*(1-c)));switch(~~(a.hue/60)){case 0:return a.value<<16|c<<8|b;case 1:return g<<16|a.value<<8|b;case 2:return b<<16|a.value<<8|c;case 3:return b<<
16|g<<8|a.value;case 4:return c<<16|b<<8|a.value;case 5:return a.value<<16|b<<8|g;default:return 0}}function Ab(a){this.value=this.saturation=this.hue=this.rgb=0;this.setRgb(a||0)}function uh(){var a,c=!1;this.nextGaussian=function(){if(c)return c=!1,a;do var d=(b=2*Math.random()-1)*b+(g=2*Math.random()-1)*g;while(1<=d||0==d);var b,g;d=Math.sqrt(-2*Math.log(d)/d);return a=g*d,c=!0,b*d}}function Jb(){this.setToIdentity()}function rf(a){for(var c=["imageSmoothingEnabled","mozImageSmoothingEnabled",
"webkitImageSmoothingEnabled","msImageSmoothingEnabled"],d=0;d<c.length;d++)if(c[d]in a)return c[d];return null}function sf(a,c){var d=rf(a);d&&(a[d]=c)}function cd(a,c,d){this.r=a;this.g=c;this.b=d}function lg(a){let c=0;for(let d=0;d<a.length;d++)c+=a[d];return c/a.length}function mg(a){let c=new cd(0,0,0);for(let d=0;d<a.length;d++){let b=a[d];c.r+=b.r;c.g+=b.g;c.b+=b.b}return c.r/=a.length,c.g/=a.length,c.b/=a.length,c}function ng(a,c){let d=a.data;if(0<c.left)for(var b=c.top;b<c.bottom;b++){var g=
b*a.width,p=g;g=d[g+c.left];for(var f=0;f<c.left;f++,p++)d[p]=g}if(c.right<a.width)for(b=c.top;b<c.bottom;b++)for(p=b*a.width+c.right,g=d[p-1],f=c.right;f<a.width;f++,p++)d[p]=g;b=0;for(p=0;p<c.top;p++)for(g=c.top*a.width,f=0;f<a.width;f++,g++,b++)d[b]=d[g];b=c.bottom*a.width;for(p=c.bottom;p<a.width;p++)for(g=(c.bottom-1)*a.width,f=0;f<a.width;f++,g++,b++)d[b]=d[g]}function Ee(a,c){return a+c}function og(a){return a?a.width*a.height*4:0}function Ec(a,c){function d(C){vc=!1;(0<Tb.size||0<cc.size)&&
(C?e():cb||setTimeout(e,1E3))}function b(){fa.emitEvent("changeSelection",[])}function g(C){fa.emitEvent("updateRegion",[C])}function p(){fa.emitEvent("changeStructure");$a.resetTree();x();g(fa.getBounds())}function f(C,R,da){fa.emitEvent("changeLayer",[C]);da||($a.layerPropertyChanged(C,R),g(fa.getBounds()))}function e(){for(let C of Tb)C.rebuildImageThumbnail(),fa.emitEvent("changeLayerImageThumb",[C]);for(let C of cc)C.rebuildMaskThumbnail(),fa.emitEvent("changeLayerMaskThumb",[C]);Tb.clear();
cb&&(clearTimeout(cb),cb=null)}function m(C,R,da,ea){Array.isArray(C)||(C=[C]);C.forEach(O=>$a.invalidateLayerRect(O,R));let E=!1;if(da)for(let O of(Fb.union(R),C))O instanceof Ma&&(Tb.add(O),E=!0);ea&&(Na.union(R),C.forEach(O=>{cc.add(O);Ia&&Ia.layer==O&&Ia.invalidateRect(R)}),E=!0);E&&(cb&&(clearTimeout(cb),cb=null),vc||(cb=setTimeout(e,1E3)));g(R)}function l(C,R){m(C,R,!Ra,Ra)}function h(){return Ra?qa.mask:qa.image}function n(){if(!Fa.isEmpty()){if(Ra){var C=qa.mask;ib.brushMode==Ca.BRUSH_MODE_ERASE?
La[Ca.BRUSH_MODE_PAINT].mergeOntoMask(C,Ka,4278190080):La[ib.brushMode].mergeOntoMask(C,Ka,255&db)}else{C=qa.image;let R=qa.getLockAlpha();ib.brushMode==Ca.BRUSH_MODE_ERASE&&R?La[Ca.BRUSH_MODE_PAINT].mergeOntoImage(C,Gb,16777215):La[ib.brushMode].mergeOntoImage(C,Gb,db);R&&C.copyAlphaFrom(Gb,Fa)}Fa.makeEmpty()}}function r(){qa instanceof Ma&&!Fb.isEmpty()&&(Gb.copyBitmapRect(qa.image,Fb.left,Fb.top,Fb),Fb.makeEmpty())}function t(){qa.mask&&!Na.isEmpty()&&(Ka.copyBitmapRect(qa.mask,Na.left,Na.top,
Na),Na.makeEmpty())}function v(){Ra?t():r()}function x(){let C=fa.getBounds();Fb.set(C);Na.set(C)}function D(C){fa.setHasUnsavedChanges(!0);0<fb.length&&(fb=[]);0!==xb.length&&xb[xb.length-1].merge(C)?xb[xb.length-1].noChange()&&xb.pop():(30<=xb.length&&xb.shift(),fa.compactUndo(),xb.push(C))}function G(C,R){C||R||(C=!Ra,R=Ra);let da=hb.clone(),ea=C?Gb.copyRectXOR(qa.image,da):null,E=R?Ka.copyRectXOR(qa.mask,da):null;this.layer=qa;hb.makeEmpty();this.redo=this.undo=function(){ea&&this.layer.image.setRectXOR(ea,
da);E&&this.layer.mask.setRectXOR(E,da);m(this.layer,da,null!=ea,null!=E)};this.getMemoryUsed=function(O,Z){return(ea?ea.length:0)+(E?E.length:0)}}function N(C){let R=C.maskLinked,da=C.maskVisible;this.undo=function(){C.setMask(null);C.maskLinked=R;C.maskVisible=da;p();fa.setActiveLayer(C,!1)};this.redo=function(){let ea=new Xa(fa.width,fa.height,8);ea.clearAll(255);C.maskLinked=!0;C.maskVisible=!0;C.setMask(ea);p();fa.setActiveLayer(C,!0)};this.redo()}function K(C,R){let da=C.mask,ea,E=!1;ea=R&&
C instanceof Ma?C.image.clone():null;E=qa==C&&Ra;this.undo=function(){C.setMask(da);ea&&(C.image.copyPixelsFrom(ea),m(C,C.image.getBounds(),!0,!1));E&&fa.setActiveLayer(C,!0);p()};this.redo=function(){ea&&(V.multiplyAlphaByMask(C.image,100,C.mask),m(C,fa.getBounds(),!0,!1));E&&fa.setActiveLayer(C,!1);C.setMask(null);p()};this.redo()}function P(C,R,da){let ea=da instanceof Ma&&da.clip,E=C.layers[R],O=E instanceof Ma&&E.clip,Z=Ra;this.undo=function(){C.removeLayer(da);let la=C.layers[R-1]||C.layers[0]||
C;E instanceof Ma&&(E.clip=O);da instanceof Ma&&(da.clip=ea);p();fa.setActiveLayer(la,Z)};this.redo=function(){C.insertLayer(R,da);O&&(da instanceof Ma?da.clip=!0:E.clip=!1);p();fa.setActiveLayer(da,!1)};this.redo()}function L(C){let R=C.clone(),da=Ra;this.undo=function(){R.parent.removeLayer(R);p();fa.setActiveLayer(C,da)};this.redo=function(){let ea=C.name;ea.endsWith(" Copy")||(ea+=" Copy");R.name=ea;C.parent.insertLayer(C.parent.indexOf(C)+1,R);p();fa.setActiveLayer(R,!1)};this.redo()}function ba(C){let R=
C.parent,da=R.indexOf(C),ea=Ra,E=0;if(C instanceof Ma&&!C.clip)for(let O=da+1;O<R.layers.length;O++)if(R.layers[O]instanceof Ma&&R.layers[O].clip)E++;else break;this.undo=function(){R.insertLayer(da,C);for(let O=0;O<E;O++)R.layers[O+da+1].clip=!0;p();fa.setActiveLayer(C,ea)};this.redo=function(){var O;for(O=0;O<E;O++)R.layers[O+da+1].clip=!1;R.removeLayerAtIndex(da);O=0==R.layers.length?C.parent:R.layers[Math.max(da-1,0)];p();fa.setActiveLayer(O,!1)};this.getMemoryUsed=function(O,Z){return O?0:C.getMemoryUsed()};
this.redo()}function X(C){let R=C.parent.indexOf(C),da=Ra,ea=new Ma(fa.width,fa.height,"");this.undo=function(){C.parent.setLayerAtIndex(R,C);p();fa.setActiveLayer(C,da)};this.redo=function(){C.parent.setLayerAtIndex(R,ea);p();fa.setActiveLayer(ea,!1)};this.getMemoryUsed=function(O,Z){return O?0:C.getMemoryUsed()};var E=new pf(C,fa.width,fa.height,!1);E.buildTree();E=E.blendTree();ea.name=C.name;ea.alpha=E.alpha;ea.image=E.image;ea.blendMode=E.blendMode;ea.mask=E.mask;ea.blendMode==V.LM_PASSTHROUGH&&
(ea.blendMode=V.LM_NORMAL);this.redo()}function Y(C){let R=C.parent,da=R.layers[R.indexOf(C)-1],ea=new Ma(fa.width,fa.height,""),E=Ra;this.undo=function(){let O=R.indexOf(ea);R.removeLayerAtIndex(O);R.insertLayer(O,C);R.insertLayer(O,da);p();fa.setActiveLayer(C,E)};this.redo=function(){if(da.clip||!C.clip)ea.copyFrom(da),0<C.getEffectiveAlpha()&&(ea.mask?V.multiplyAlphaByMask(ea.image,ea.alpha,ea.mask):V.multiplyAlphaBy(ea.image,ea.alpha),V.fuseImageOntoImage(ea.image,!0,C.image,C.alpha,C.blendMode,
C.getBounds(),C.mask));else{var O=new nb;O.layers=[da,C];O.parent=null;O.name="Temporary Group";O=new pf(O,fa.width,fa.height,!1);O.buildTree();ea.image=O.blendTree().image}ea.name=da.name;ea.alpha=100;ea.blendMode=da.blendMode;ea.mask=null;O=R.indexOf(da);R.removeLayerAtIndex(O);R.removeLayerAtIndex(O);R.insertLayer(O,ea);p();fa.setActiveLayer(ea,!1)};this.getMemoryUsed=function(O,Z){return O?0:C.getMemoryUsed()+ea.getMemoryUsed()};this.redo()}function ka(){let C=fa.getActiveLayer(),R=qb.layers.slice(0),
da=new Ma(fa.width,fa.height,"");this.undo=function(){qb.layers=R.slice(0);p();fa.setActiveLayer(C,!1)};this.redo=function(){let ea=fa.fusionLayers();da.copyImageFrom(ea);qb.clearLayers();da.setName(fa.getDefaultLayerName(!1));qb.addLayer(da);p();fa.setActiveLayer(da,!1)};this.getMemoryUsed=function(ea,E){return R.map(O=>O.getMemoryUsed()).reduce(Ee,0)};this.redo()}function Aa(C,R,da){let ea=C.parent,E=C.parent.indexOf(C),O=Ra,Z=ea.layers[ea.indexOf(C)+1],la=R.layers[da],za=C instanceof Ma&&C.clip,
ua=!!za&&C.getClippingBase(),ab=0,gb=0;if(C instanceof Ma&&!C.clip)for(var sb=E+1;sb<ea.layers.length;sb++)if(ea.layers[sb]instanceof Ma&&ea.layers[sb].clip)ab++;else break;else if(C instanceof nb)for(sb=da;sb<R.layers.length;sb++)if(R.layers[sb]instanceof Ma&&R.layers[sb].clip)gb++;else break;this.undo=function(){C.parent.removeLayer(C);var Da=Z?ea.indexOf(Z):ea.layers.length;ea.insertLayer(Da,C);C instanceof Ma&&(C.clip=za);for(Da=0;Da<ab;Da++)ea.layers[Da+E+1].clip=!0;for(Da=0;Da<gb;Da++)R.layers[Da+
da].clip=!0;p();fa.setActiveLayer(C,O)};this.redo=function(){for(var Da=0;Da<ab;Da++)ea.layers[Da+E+1].clip=!1;C.parent.removeLayer(C);Da=la?R.indexOf(la):R.layers.length;R.insertLayer(Da,C);for(var Bb=0;Bb<gb;Bb++)R.layers[Bb+Da+1].clip=!1;C instanceof Ma&&(C.clip&&C.getClippingBase()!=ua&&(C.clip=!1),la instanceof Ma&&la.clip&&(C.clip=!0));for(Bb=0;Bb<gb;Bb++)R.layers[Bb+Da+1].clip=!1;p();fa.setActiveLayer(C,!1)};this.redo()}function Ga(C,R){let da=C.substring(0,1).toUpperCase()+C.substring(1),
ea=function(E,O){Array.isArray(E)||(E=[E]);this.layers=E;this.from=this.layers.map(Z=>Z["get"+da]());this.to=O;this.redo()};return ea.prototype=Object.create(Bc.prototype),ea.prototype.constructor=ea,ea.prototype.undo=function(){this.layers.forEach((E,O)=>E["set"+da](this.from[O]));this.layers.forEach(E=>f(E,C,!R))},ea.prototype.redo=function(){this.layers.forEach(E=>E["set"+da](this.to));this.layers.forEach(E=>f(E,C,!R))},ea.prototype.merge=function(E){var O;if(O=E instanceof ea)a:{O=this.layers;
var Z=E.layers;if(O.length!=Z.length)O=!1;else{for(let la=0;la<O.length;la++)if(O[la]!=Z[la]){O=!1;break a}O=!0}}return!!O&&(this.to=E.to,!0)},ea.prototype.noChange=function(){for(let E=0;E<this.from.length;E++)if(this.from[E]!=this.to)return!1;return!0},ea}function U(C,R){C=C.clone();R=R.clone();this.undo=function(){fa.setSelection(C);g(fa.getBounds())};this.redo=function(){fa.setSelection(R);g(fa.getBounds())};this.noChange=function(){return C.equals(R)}}function ya(C,R,da){let ea=R?C.mask:C.image,
E=ea.cloneRect(da);da=da.clone();this.undo=function(){ea.copyBitmapRect(E,da.left,da.top,E.getBounds());fa.setActiveLayer(C,R);fa.setSelection(da);m(C,da,!R,R)};this.redo=function(){R?ea.clearRect(da,0):ea.clearRect(da,16777215);yb=new qf(E,da.left,da.top);fa.setActiveLayer(C,R);fa.emptySelection();m(C,da,!R,R)};this.getMemoryUsed=function(O,Z){return E==Z?0:E.getMemorySize()};this.redo()}function pa(C){let R=fa.getSelection(),da=Ra,ea=new Ma(fa.width,fa.height,fa.getDefaultLayerName(!1)),E=qa,O=
E.parent;this.undo=function(){O.removeLayer(ea);fa.setSelection(R);p();fa.setActiveLayer(E,da)};this.redo=function(){var Z=O.indexOf(E);let la=C.bmp.getBounds(),za,ua;(O.insertLayer(Z+1,ea),la.isInside(fa.getBounds())?(za=C.x,ua=C.y):(za=(fa.width-C.bmp.width)/2|0,ua=(fa.height-C.bmp.height)/2|0),C.bmp instanceof Xa)?(Z=new H(C.bmp.width,C.bmp.height),Z.copyPixelsFromGreyscale(C.bmp),ea.image.copyBitmapRect(Z,za,ua,la)):ea.image.copyBitmapRect(C.bmp,za,ua,la);fa.emptySelection();p();fa.setActiveLayer(ea,
!1)};this.getMemoryUsed=function(Z,la){return C.bmp==la?0:C.bmp.getMemorySize()};this.redo()}a|=0;c|=0;let qb=new nb("Root",V.LM_NORMAL),$a=new pf(qb,a,c,!0),Gb=new H(a,c),Fb=new Ha(0,0,a,c),Ka=new Xa(a,c,8),Na=new Ha(0,0,a,c),ja=new Xa(a,c,32),Fa=new Ha(0,0,0,0),sa=new th,fa=this,La=[],qa=qb,Ra=!1,Ia=null,hb=new Ha(0,0,0,0),Yb=!1,ic=new Ha(0,0,0,0),Qb=null,Cb=new uh,Kb=null,yb=null,xb=[],fb=[],ib=null,dc=0,mb=0,Nb=0,Ob=!1,vc=!1,cc=new Set,Tb=new Set,cb=null,db=0,nc="smooth";this.getLayersRoot=function(){return qb};
this.getSelectionAutoSelect=function(){return ic.isEmpty()?this.getBounds():this.getSelection()};this.getSelection=function(){return ic.clone()};this.setHasUnsavedChanges=function(C){C!=Yb&&(Yb=C,this.emitEvent("unsavedChanges",[C]))};this.getHasUnsavedChanges=function(){return Yb};this.isAddLayerMaskAllowed=function(){return!qa.mask};this.addLayerMask=function(){this.isAddLayerMaskAllowed()&&D(new N(qa))};this.isRemoveLayerMaskAllowed=function(){return null!==qa.mask};this.removeLayerMask=function(){this.isRemoveLayerMaskAllowed()&&
D(new K(qa,!1))};this.isApplyLayerMaskAllowed=function(){return null!==qa.mask&&qa instanceof Ma};this.applyLayerMask=function(C){this.isApplyLayerMaskAllowed()&&D(new K(qa,!0))};this.addLayer=function(C){let R,da;if(qa instanceof nb&&qa.expanded?(R=qa,da=qa.layers.length):da=(R=qa.parent).layers.indexOf(qa)+1,"group"===C){for(;R.layers[da]instanceof Ma&&R.layers[da].clip;)da++;C=new nb(this.getDefaultLayerName(!0),V.LM_PASSTHROUGH)}else(C=new Ma(this.width,this.height,this.getDefaultLayerName(!1))).image.clearAll(16777215);
return D(new P(R,da,C)),C};this.addLayerObject=function(C,R){C.addLayer(R);C==qb&&1==qb.layers.length&&(qa=R);p()};this.addLayerGroupObject=function(C,R,da){let ea=[];for(let E=0;E<da;E++)ea.unshift(C.layers.pop());ea.forEach(E=>R.addLayer(E));this.addLayerObject(C,R)};this.isRemoveLayerAllowed=function(){return qa instanceof Ma?qb.getLinearizedLayerList(!1).some(C=>C instanceof Ma&&C!=qa):qa instanceof nb&&qb.getLinearizedLayerList(!1).some(C=>C instanceof Ma&&!C.hasAncestor(qa))};this.removeLayer=
function(){return!!this.isRemoveLayerAllowed()&&(D(new ba(qa)),!0)};this.duplicateLayer=function(){D(new L(qa))};this.isMergeDownAllowed=function(){let C=qa.parent.indexOf(qa);return 0<C&&qa instanceof Ma&&qa.parent.layers[C-1]instanceof Ma};this.mergeDown=function(){this.isMergeDownAllowed()&&D(new Y(qa))};this.isMergeGroupAllowed=function(){return qa instanceof nb&&0<qa.getEffectiveAlpha()};this.mergeGroup=function(){this.isMergeGroupAllowed()&&D(new X(qa))};this.isMergeAllLayersAllowed=function(){return 1<
qb.getLinearizedLayerList(!1).length};this.mergeAllLayers=function(){this.isMergeAllLayersAllowed()&&D(new ka)};this.relocateLayer=function(C,R,da){C&&R&&C!=R&&!R.hasAncestor(C)&&D(new Aa(C,R,da))};this.setLayerVisibility=function(C,R){let da=[];if(C.ancestorsAreVisible())C.visible!=R&&D(new dd(C,R));else{for(;null!=C;C=C.parent)C.visible||da.push(C);D(new dd(da,!0))}};this.expandLayerGroup=function(C,R){C.expanded!=R&&(C.expanded=R,!R&&qa.hasAncestor(C)&&this.setActiveLayer(C,!1),f(C,"expanded",
!0))};this.setLayerAlpha=function(C){qa.getAlpha()!=C&&D(new Wa(qa,C))};this.setLayerMaskLinked=function(C){qa.maskLinked!=C&&D(new Fc(qa,C))};this.setLayerMaskVisible=function(C,R){C.maskVisible!=R&&D(new wc(C,R))};this.setLayerBlendMode=function(C){qa.getBlendMode()!=C&&(C!=V.LM_PASSTHROUGH||qa instanceof nb)&&D(new Rc(qa,C))};this.setLayerName=function(C,R){C.getName()!=R&&D(new Mc(C,R))};this.paintDab=function(C,R,da){ib.applyPressure(da);0<ib.scattering&&(C+=Cb.nextGaussian()*ib.curScattering/
4,R+=Cb.nextGaussian()*ib.curScattering/4);da=La[ib.brushMode];C=sa.getDab(C,R,ib);R=new Ha(0,0,C.width,C.height);let ea=new Ha(0,0,C.width,C.height);if(ea.translate(C.x,C.y),fa.getBounds().clipSourceDest(R,ea),!ea.isEmpty()){hb.union(ea);var E=Ra?qa.mask:qa.image;da.paintDab(E,ea,Ob&&!Ra?Qb:E,ib,R,C,db);!Ra&&da.noMergePhase&&qa.getLockAlpha()&&E.copyAlphaFrom(Gb,ea);da.wantsOutputAsInput&&(n(),Ob&&!Ra&&fa.fusionLayers());l(qa,ea)}};this.getDefaultLayerName=function(C){let R=C?"Group ":"Layer ";C=
C?/^Group [0-9]+$/:/^Layer [0-9]+$/;let da=0,ea=qb.getLinearizedLayerList(!1);for(let E=0;E<ea.length;E++){let O=ea[E];C.test(O.name)&&(da=Math.max(da,parseInt(O.name.substring(R.length),10)))}return R+(da+1)};this.addBackgroundLayer=function(){let C=new Ma(fa.width,fa.height,this.getDefaultLayerName(!1));C.image.clearAll(4294967295);this.addLayerObject(this.getLayersRoot(),C)};this.addDefaultLayer=function(){let C=new Ma(fa.width,fa.height,this.getDefaultLayerName(!1));C.image.clearAll(16777215);
this.addLayerObject(this.getLayersRoot(),C);this.setActiveLayer(C,!1)};this.fusionLayers=function(){n();$a.buildTree();return Qb=$a.blendTree().image};this.upgradeMultiplyLayers=function(C){let R=this.getLayersRoot().getLinearizedLayerList(!1,[]),da=-1;for(var ea=0;ea<R.length;ea++){var E=R[ea];if(!(E instanceof Ma)||E.mask||E.blendMode>V.LM_LAST_CHIBIPAINT)throw Error("Bad layer type during multiply upgrade");E.blendMode===V.LM_MULTIPLY&&(da=ea)}if(-1!==da){ea=new H(this.width,this.height);let O=
E=!0,Z=this.getBounds();ea.clearAll(Z,16777215);for(let la=0;la<=da;la++){let za=R[la];O||(E=E&&ea.hasAlphaInRect(Z));za.blendMode===V.LM_MULTIPLY&&("bake"===C?!E&&0<za.getEffectiveAlpha()&&(100===za.alpha?V.upgradeMultiplyOfOpaqueLayer(ea,za.image,100,Z):V.upgradeMultiplyOfTransparentLayer(ea,za.image,za.alpha,Z),za.setBlendMode(V.LM_MULTIPLY2)):E&&za.setBlendMode(V.LM_MULTIPLY2));0<za.getEffectiveAlpha()&&(O=!1,V.fuseImageOntoImage(ea,E,za.image,za.alpha,za.blendMode,Z,null))}}};this.isCreateClippingMaskAllowed=
function(){var C=qa.parent.indexOf(qa);C=qa.parent.layers[C-1];return qa instanceof Ma&&!qa.clip&&C instanceof Ma};this.createClippingMask=function(){this.isCreateClippingMaskAllowed()&&D(new y(qa,!0))};this.isReleaseClippingMaskAllowed=function(){return qa instanceof Ma&&qa.clip};this.releaseClippingMask=function(){this.isReleaseClippingMaskAllowed()&&D(new y(qa,!1))};this.setActiveLayer=function(C,R){if(C){let da=(R=C.mask&&R)!=Ra;if(qa!=C||da){let ea=qa;qa=C;Ra=R;x();this.emitEvent("changeActiveLayer",
[ea,C,Ra]);da&&this.emitEvent("editModeChanged",[Ra?Ec.EDITING_MODE_MASK:Ec.EDITING_MODE_IMAGE]);Ia&&Ia.layer==ea&&(R?Ia.setLayer(C):this.closeMaskView())}}};this.closeMaskView=function(){Ia.close();Ia=null};this.toggleMaskView=function(){return null!=Ia&&Ia.isOpen()?this.closeMaskView():Ia=qa.mask?new vh(qa,n):null,Ia};this.selectTopmostVisibleLayer=function(){let C=qb.getLinearizedLayerList(!1);for(var R=C.length-1;0<=R;R--)if(C[R]instanceof Ma&&0<C[R].getEffectiveAlpha()){this.setActiveLayer(C[R],
!1);return}for(R=C.length-1;0<=R;R--)if(C[R]instanceof Ma){this.setActiveLayer(C[R],!1);return}this.setActiveLayer(C[C.length-1],!1)};this.getActiveLayer=function(){return qa};this.isEditingMask=function(){return Ra};this.isActiveLayerDrawable=function(){return Ra&&qa.mask||!Ra&&qa instanceof Ma};this.getUndoMemoryUsed=function(){let C=0;for(let R of fb)C+=R.getMemoryUsed(!0,null);for(let R of xb)C+=R.getMemoryUsed(!1,null);return C};this.isUndoAllowed=function(){return 0<xb.length};this.isRedoAllowed=
function(){return 0<fb.length};this.undo=function(){if(this.isUndoAllowed()){this.setHasUnsavedChanges(!0);var C=xb.pop();C.undo();fb.push(C)}};this.redo=function(){if(this.isRedoAllowed()){this.setHasUnsavedChanges(!0);var C=fb.pop();C.redo();xb.push(C)}};this.performIdleTasks=function(){v();n();$a.buildTree()};this.compactUndo=function(){0<xb.length&&xb[xb.length-1].compact()};this.clearHistory=function(){xb=[];fb=[]};this.colorPicker=function(C,R){return Ra&&qa.mask?Ab.greyToRGB(qa.mask.getPixel(~~C,
~~R)):16777215&Qb.getPixel(~~C,~~R)};this.setSelection=function(C){ic.set(C);ic.roundNearest();ic.clipTo(this.getBounds())};this.emptySelection=function(){ic.makeEmpty()};this.floodFill=function(C,R){let da=h();da&&(v(),hb=this.getBounds(),da.floodFill(~~C,~~R,4278190080|db),D(new G),l(qa,this.getBounds()))};this.gradientFill=function(C,R,da,ea,E){let O=this.getSelectionAutoSelect(),Z=h();Z&&(v(),hb=O.clone(),Z.gradient(O,C,R,da,ea,E,!1),this.getLayerLockAlpha()&&Z instanceof H&&Z.copyAlphaFrom(Gb,
O),D(new G),l(qa,O))};this.fill=function(C){let R=this.getSelectionAutoSelect(),da=h();da&&(v(),hb=R.clone(),da.clearRect(R,C),D(new G),l(qa,R))};this.clear=function(){Ra?this.fill(0):this.fill(16777215)};this.flip=function(C){let R=this.getSelection(),da=R.isEmpty();var ea=da&&qa instanceof Ma&&qa.mask&&qa.maskLinked;let E=(!Ra||ea)&&qa instanceof Ma;ea=(Ra||ea)&&qa.mask;C=C?"copyRegionHFlip":"copyRegionVFlip";(E||ea)&&(da&&(R=this.getBounds()),hb=R.clone(),E&&(r(),qa.image[C](R,Gb)),ea&&(t(),qa.mask[C](R,
Ka)),D(new G(E,ea)),m(qa,R,E,ea))};this.hFlip=function(){this.flip(!0)};this.vFlip=function(){this.flip(!1)};this.monochromaticNoise=function(){let C=this.getSelectionAutoSelect(),R=h();R&&(v(),hb=C.clone(),R.fillWithNoise(C),D(new G),l(qa,C))};this.isColorNoiseAllowed=function(){return!this.isEditingMask()&&this.isActiveLayerDrawable()};this.colorNoise=function(){if(this.isColorNoiseAllowed()){let C=this.getSelectionAutoSelect();v();hb=C.clone();qa.image.fillWithColorNoise(C);D(new G(!0,!1));m(qa,
C,!0,!1)}};this.invert=function(){let C=this.getSelectionAutoSelect(),R=h();R&&(v(),hb=C.clone(),R.invert(C),D(new G),l(qa,C))};this.brightnessToOpacity=function(){let C=this.getSelectionAutoSelect(),R=h();R&&(v(),hb=C.clone(),R.brightnessToOpacity(C),D(new G),l(qa,C))};this.boxBlur=function(C,R,da){let ea=this.getSelectionAutoSelect(),E=h();if(E){v();hb=ea.clone();for(let O=0;O<da;O++)E.boxBlur(ea,C,R);D(new G);l(qa,ea)}};this.rectangleSelection=function(C){C=C.clone();C.clipTo(this.getBounds());
D(new U(this.getSelection(),C));this.setSelection(C)};this.move=function(C,R,da){if(R|=0,0!=(C|=0)||0!=R){var ea=0<xb.length?xb[xb.length-1]:null;!da&&ea instanceof xc&&ea.layer==this.getActiveLayer()?(ea.amend(C,R),fb=[],this.setHasUnsavedChanges(!0)):(C=new xc(C,R,da),D(C),C.redo())}};this.setTransformInterpolation=function(C){nc=C;Kb instanceof Vb&&Kb.setInterpolation(C)};this.transformAffineAbort=function(){Kb instanceof Vb&&(Kb.undo(),Kb=null,d(!0))};this.transformAffineBegin=function(){if(Kb instanceof
Vb)return{transform:Kb.getTransform(),rect:Kb.getInitialTransformRect(),selection:Kb.getInitialSelectionRect()};let C=new Jb,R;return(R=new Vb(C,nc)).getInitialTransformRect().isEmpty()?null:(Kb=R,vc=!0,{transform:C,rect:R.getInitialTransformRect(),selection:R.getInitialSelectionRect()})};this.transformAffineFinish=function(){Kb instanceof Vb&&(D(Kb),Kb=null,d(!0))};this.transformAffineAmend=function(C){Kb instanceof Vb&&Kb.amend(C)};this.isCopySelectionAllowed=this.isCutSelectionAllowed=function(){return!this.getSelection().isEmpty()&&
null!==h()};this.cutSelection=function(){this.isCutSelectionAllowed()&&D(new ya(qa,Ra,this.getSelection()))};this.copySelection=function(){if(this.isCopySelectionAllowed()){let C=fa.getSelection();yb=new qf(h().cloneRect(C),C.left,C.top)}};this.isCopySelectionMergedAllowed=function(){return!this.getSelection().isEmpty()};this.copySelectionMerged=function(){if(this.isCopySelectionMergedAllowed()){let C=fa.getSelection();yb=new qf(this.fusionLayers().cloneRect(C),C.left,C.top)}};this.isPasteClipboardAllowed=
function(){return!this.isClipboardEmpty()};this.pasteClipboard=function(){this.isPasteClipboardAllowed()&&D(new pa(yb))};this.getClipboard=function(){return yb};this.setClipboard=function(C){yb=C};this.isClipboardEmpty=function(){return null==yb};this.setSampleAllLayers=function(C){Ob=C};this.getLayerLockAlpha=function(){return this.getActiveLayer().getLockAlpha()};this.setLayerLockAlpha=function(C){qa.getLockAlpha()!=C&&D(new jc(qa,C))};this.setForegroundColor=function(C){db=C};this.setBrush=function(C){ib=
C};this.setBrushTexture=function(C){sa.setTexture(C)};this.beginStroke=function(C,R,da){return null!==ib&&!!this.isActiveLayerDrawable()&&(v(),hb.makeEmpty(),ja.clearAll(0),Fa.makeEmpty(),dc=C,mb=R,Nb=da,vc=!0,La[ib.brushMode].beginStroke(),this.paintDab(C,R,da),!0)};this.continueStroke=function(C,R,da){if(null!=ib){var ea=Math.sqrt((dc-C)*(dc-C)+(mb-R)*(mb-R)),E=Math.max(ib.minSpacing,ib.curSize*ib.spacing);if(ea>E){let O=dc,Z=mb,la=Nb;ea=(E-.001)/ea;for(E=ea;1>=E;E+=ea)O=E*C+(1-E)*dc,Z=E*R+(1-E)*
mb,la=E*da+(1-E)*Nb,this.paintDab(O,Z,la);dc=O;mb=Z;Nb=la}}};this.endStroke=function(){null!=ib&&(n(),La[ib.brushMode].endStroke(),hb.clipTo(this.getBounds()),hb.isEmpty()||(D(new G),v()),d(!1))};this.hasAlpha=function(){return Qb.hasAlpha()};this.getFlatPNG=function(C){return this.fusionLayers(),Qb.getAsPNG(C)};this.getFlatPNGBuffer=function(C){return this.fusionLayers(),Qb.getAsPNGBuffer(C)};this.isSimpleDrawing=function(){return 1==qb.layers.length&&qb.layers[0]instanceof Ma&&!qb.layers[0].mask&&
100==qb.layers[0].getEffectiveAlpha()};G.prototype=Object.create(Bc.prototype);G.prototype.constructor=G;N.prototype=Object.create(Bc.prototype);N.prototype.constructor=N;K.prototype=Object.create(Bc.prototype);K.prototype.constructor=K;P.prototype=Object.create(Bc.prototype);P.prototype.constructor=P;L.prototype=Object.create(Bc.prototype);L.prototype.constructor=L;ba.prototype=Object.create(Bc.prototype);ba.prototype.constructor=ba;X.prototype=Object.create(Bc.prototype);X.prototype.constructor=
X;Y.prototype=Object.create(Bc.prototype);Y.prototype.constructor=Y;ka.prototype=Object.create(Bc.prototype);ka.prototype.constructor=ka;Aa.prototype=Object.create(Bc.prototype);Aa.prototype.constructor=Aa;let Wa=Ga("alpha",!0),Rc=Ga("blendMode",!0),dd=Ga("visible",!0),y=Ga("clip",!0),wc=Ga("maskVisible",!0),Mc=Ga("name",!1),jc=Ga("lockAlpha",!1),Fc=Ga("maskLinked",!1);U.prototype=Object.create(Bc.prototype);U.prototype.constructor=U;class xa extends Bc{undo(){let C=[];this.dstRect.isEmpty()||C.push(this.dstRect);
this.erasesSourceRect&&(C.push(this.srcRect),C=Ha.union(C));this.movingLayers.forEach(R=>{this.hasFullUndo?C.forEach(da=>{R.moveImage&&R.layer.image.copyBitmapRect(R.imageUndo,da.left,da.top,da);R.moveMask&&R.layer.mask.copyBitmapRect(R.maskUndo,da.left,da.top,da)}):(R.moveImage&&R.imageRect.forEach((da,ea)=>{R.layer.image.copyBitmapRect(da,ea.left,ea.top,da.getBounds())}),R.moveMask&&R.maskRect.forEach((da,ea)=>{R.layer.mask.copyBitmapRect(da,ea.left,ea.top,da.getBounds())}))});m(this.movingLayers.map(R=>
R.layer),C.reduce((R,da)=>R.getUnion(da),new Ha(0,0,0,0)),!0,!0);this.dstRect.makeEmpty();fa.setSelection(this.fromSelection);fa.setActiveLayer(this.layer,this.fromMaskMode);b()}getMemoryUsed(C,R){return this.movingLayers.map(function(da){return[da.imageUndo,da.maskUndo,da.imageRect,da.maskRect].map(ea=>ea?ea.getMemorySize():0).reduce(Ee,0)}).reduce(Ee,0)}buildFullUndo(){this.hasFullUndo||(this.movingLayers.forEach(function(C){C.moveImage&&(C.imageUndo=C.layer.image.clone());C.moveMask&&(C.maskUndo=
C.layer.mask.clone());C.imageRect.clear();C.maskRect.clear()}),this.hasFullUndo=!0)}compact(){if(this.hasFullUndo){let C=[];this.dstRect.isEmpty()||C.push(this.dstRect);this.erasesSourceRect&&(C.push(this.srcRect),C=Ha.union(C));this.movingLayers.forEach(R=>{R.imageRect.clear();R.maskRect.clear();C.forEach(da=>{R.moveImage&&R.imageRect.set(da,R.imageUndo.cloneRect(da));R.moveMask&&R.maskRect.set(da,R.maskUndo.cloneRect(da))});R.imageUndo=null;R.maskUndo=null});this.hasFullUndo=!1}}constructor(){super();
this.layer=qa;this.fromSelection=fa.getSelection();this.fromMaskMode=Ra;this.movingWholeLayer=this.fromSelection.isEmpty();this.movingImage=!Ra||this.movingWholeLayer&&this.layer.maskLinked;this.movingMask=Ra||this.movingWholeLayer&&this.layer.maskLinked;this.erasesSourceRect=this.hasFullUndo=!1;this.dstRect=new Ha(0,0,0,0);this.movingLayers=[{layer:this.layer,moveImage:this.layer instanceof Ma&&this.movingImage,moveMask:null!==this.layer.mask&&this.movingMask,imageRect:new Map,maskRect:new Map}];
this.layer instanceof nb&&this.movingImage&&this.movingWholeLayer&&(this.movingLayers=this.movingLayers.concat(this.layer.getLinearizedLayerList(!1).map(ea=>({layer:ea,moveImage:ea instanceof Ma,moveMask:null!==ea.mask&&ea.maskLinked,imageRect:new Map,maskRect:new Map}))));let C=new Ha(0,0,0,0);if(this.movingWholeLayer){this.srcRect=fa.getBounds();for(var R=0;R<this.movingLayers.length&&!C.equals(this.srcRect);R++){var da=this.movingLayers[R];da.moveMask&&C.union(da.layer.mask.getValueBounds(this.srcRect,
255));da.moveImage&&C.union(da.layer.image.getNonTransparentBounds(this.srcRect))}}else for(this.srcRect=this.fromSelection.clone(),R=0;R<this.movingLayers.length&&!C.equals(this.srcRect);R++)da=this.movingLayers[R],da.moveMask&&C.union(da.layer.mask.getValueBounds(this.srcRect,0)),da.moveImage&&C.union(da.layer.image.getNonTransparentBounds(this.srcRect));this.srcRect=C}}class Vb extends xa{buildFullUndo(){this.hasFullUndo||(super.buildFullUndo(),this.movingLayers.forEach(C=>{if(C.moveImage){var R=
Yc(this.srcRect.getWidth(),this.srcRect.getHeight());R.getContext("2d").putImageData(C.layer.image.getImageData(),-this.srcRect.left,-this.srcRect.top,this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),this.srcRect.getHeight());C.imageSourceCanvas=R}C.moveMask&&(R=Yc(this.srcRect.getWidth(),this.srcRect.getHeight()),R.getContext("2d").putImageData(C.layer.mask.getImageData(this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),this.srcRect.getHeight()),0,0),C.maskSourceCanvas=R)}),this.composeCanvas=
Yc(fa.width,fa.height),this.composeCanvasContext=this.composeCanvas.getContext("2d",{willReadFrequently:!0}),sf(this.composeCanvasContext,"smooth"==this.interpolation),this.junk=this.composeCanvasContext.getImageData(0,0,1,1))}redo(){this.buildFullUndo();var C=this.dstRect.clone();let R=this.srcRect.toPoints();this.affineTransform.transformPoints(R);this.dstRect.set(Ha.createBoundingBox(R).roundContain().clipTo(fa.getBounds()));let da=Ha.subtract(this.dstRect,this.srcRect),ea=Ha.subtract(C.isEmpty()?
this.srcRect:this.srcRect.getIntersection(C),this.dstRect),E=this.srcRect.getIntersection(this.dstRect),O=Ha.subtract(C,[this.dstRect,this.srcRect]);C=this.srcRect.getUnion(this.dstRect).getUnion(C);(this.movingLayers.forEach(Z=>{if(ea.forEach(la=>{Z.moveImage&&Z.layer.image.clearRect(la,16777215);Z.moveMask&&(this.movingWholeLayer?Z.layer.mask.clearRect(la,255):Z.layer.mask.clearRect(la,0))}),!this.dstRect.isEmpty()){if(Z.moveImage){let la=Z.imageUndo.getImageData();da.forEach(za=>{this.composeCanvasContext.putImageData(la,
0,0,za.left,za.top,za.getWidth(),za.getHeight())});this.composeCanvasContext.clearRect(E.left,E.top,E.getWidth(),E.getHeight());this.composeCanvasContext.save();this.composeCanvasContext.setTransform(this.affineTransform.m[0],this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]);this.composeCanvasContext.drawImage(Z.imageSourceCanvas,this.srcRect.left,this.srcRect.top);this.composeCanvasContext.restore();Z.layer.image.copyBitmapRect(new H(this.composeCanvasContext.getImageData(this.dstRect.left,
this.dstRect.top,this.dstRect.getWidth(),this.dstRect.getHeight())),this.dstRect.left,this.dstRect.top,new Ha(0,0,this.dstRect.getWidth(),this.dstRect.getHeight()))}Z.moveMask&&(da.forEach(la=>{this.composeCanvasContext.putImageData(Z.layer.mask.getImageData(la.left,la.top,la.getWidth(),la.getHeight()),la.left,la.top)}),this.movingWholeLayer?this.composeCanvasContext.fillStyle="#FFF":this.composeCanvasContext.fillStyle="#000",this.composeCanvasContext.fillRect(E.left,E.top,E.getWidth(),E.getHeight()),
this.composeCanvasContext.save(),this.composeCanvasContext.setTransform(this.affineTransform.m[0],this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]),this.composeCanvasContext.drawImage(Z.maskSourceCanvas,this.srcRect.left,this.srcRect.top),this.composeCanvasContext.restore(),Z.layer.mask.pasteImageData(this.composeCanvasContext.getImageData(this.dstRect.left,this.dstRect.top,this.dstRect.getWidth(),this.dstRect.getHeight()),
this.dstRect.left,this.dstRect.top))}O.forEach(la=>{Z.moveImage&&Z.layer.image.copyBitmapRect(Z.imageUndo,la.left,la.top,la);Z.moveMask&&Z.layer.mask.copyBitmapRect(Z.maskUndo,la.left,la.top,la)})}),m(this.movingLayers.map(Z=>Z.layer),C,!0,!0),this.fromSelection.isEmpty())||(C=this.fromSelection.toPoints(),this.affineTransform.transformPoints(C),(C=Ha.createBoundingBox(C)).roundNearest(),fa.setSelection(C),b());fa.setActiveLayer(this.layer,this.fromMaskMode)}amend(C){this.hasFullUndo||this.undo();
this.affineTransform=C.clone();this.redo()}setInterpolation(C){C!=this.interpolation&&(this.interpolation=C,this.composeCanvasContext&&sf(this.composeCanvasContext,"smooth"==this.interpolation),this.undo(),this.redo())}compact(){super.compact();this.composeCanvasContext=this.composeCanvas=null;this.movingLayers.forEach(C=>C.imageSourceCanvas=null)}getMemoryUsed(C,R){C=super.getMemoryUsed(C,R);return C+=og(this.composeCanvas),C+=this.movingLayers.map(da=>og(da.imageSourceCanvas)).reduce(Ee,0)}getTransform(){return this.affineTransform.clone()}getInitialTransformRect(){return this.srcRect.clone()}getInitialSelectionRect(){return this.fromSelection.clone()}constructor(C,
R){super();this.erasesSourceRect=!0;this.affineTransform=C.clone();this.interpolation=R||"smooth";this.composeCanvasContext=this.composeCanvas=null}}class xc extends xa{redo(){var C=this.dstRect.clone();let R,da,ea=C.clone(),E=null;(this.buildFullUndo(),this.dstRect.set(this.srcRect),this.dstRect.translate(this.offsetX,this.offsetY),R=this.dstRect.clone(),this.dstRect.clipTo(fa.getBounds()),this.erasesSourceRect?(E=C.isEmpty()?this.srcRect:this.srcRect.getIntersection(C),ea.union(E),da=C.subtract(this.srcRect)):
da=[C],this.movingLayers.forEach(O=>{E&&(O.moveImage&&O.layer.image.clearRect(E,16777215),O.moveMask&&O.layer.mask.clearRect(E,255*!!this.movingWholeLayer));da.forEach(function(Z){O.moveImage&&O.layer.image.copyBitmapRect(O.imageUndo,Z.left,Z.top,Z);O.moveMask&&O.layer.mask.copyBitmapRect(O.maskUndo,Z.left,Z.top,Z)});O.moveImage&&V.normalFuseImageOntoImageAtPosition(O.layer.image,O.imageUndo,R.left,R.top,this.srcRect);O.moveMask&&O.layer.mask.copyBitmapRect(O.maskUndo,R.left,R.top,this.srcRect)}),
ea.union(this.dstRect),m(this.movingLayers.map(O=>O.layer),ea,!0,!0),this.fromSelection.isEmpty())||(C=this.fromSelection.clone(),C.translate(this.offsetX,this.offsetY),fa.setSelection(C),b())}amend(C,R){this.hasFullUndo||this.undo();this.offsetX+=C;this.offsetY+=R;this.redo()}constructor(C,R,da){super();this.offsetX=C;this.offsetY=R;this.erasesSourceRect=!da}}ya.prototype=Object.create(Bc.prototype);ya.prototype.constructor=ya;pa.prototype=Object.create(Bc.prototype);pa.prototype.constructor=pa;
La=[Qd,wh,xh,yh,he,zh,Ah,Bh].map(C=>new C(ja,Fa));this.width=a;this.height=c}function ub(a,c,d){this.data=a;this.eof=!1;this.start=void 0===c?0:c;this.end=void 0===d?a.length:d;this.pos=this.start}function Rd(a){for(var c=a.length;0<=--c;)a[c]=0}function tf(a,c,d,b,g){this.static_tree=a;this.extra_bits=c;this.extra_base=d;this.elems=b;this.max_length=g;this.has_stree=a&&a.length}function uf(a,c){this.dyn_tree=a;this.max_code=0;this.stat_desc=c}function pg(a){return 256>a?ie[a]:ie[256+(a>>>7)]}function je(a,
c){a.pending_buf[a.pending++]=255&c;a.pending_buf[a.pending++]=c>>>8&255}function Gc(a,c,d){a.bi_valid>16-d?(a.bi_buf|=c<<a.bi_valid&65535,je(a,a.bi_buf),a.bi_buf=c>>16-a.bi_valid,a.bi_valid+=d-16):(a.bi_buf|=c<<a.bi_valid&65535,a.bi_valid+=d)}function Zc(a,c,d){Gc(a,d[2*c],d[2*c+1])}function qg(a,c){var d=0;do d|=1&a,a>>>=1,d<<=1;while(0<--c);return d>>>1}function rg(a,c,d){var b,g=Array(16),p=0;for(b=1;15>=b;b++)g[b]=p=p+d[b-1]<<1;for(d=0;d<=c;d++)b=a[2*d+1],0!==b&&(a[2*d]=qg(g[b]++,b))}function sg(a){var c;
for(c=0;286>c;c++)a.dyn_ltree[2*c]=0;for(c=0;30>c;c++)a.dyn_dtree[2*c]=0;for(c=0;19>c;c++)a.bl_tree[2*c]=0;a.dyn_ltree[512]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function tg(a){8<a.bi_valid?je(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf);a.bi_buf=0;a.bi_valid=0}function ug(a,c,d,b){var g=2*c,p=2*d;return a[g]<a[p]||a[g]===a[p]&&b[c]<=b[d]}function vf(a,c,d){for(var b=a.heap[d],g=d<<1;g<=a.heap_len&&(g<a.heap_len&&ug(c,a.heap[g+1],a.heap[g],a.depth)&&g++,!ug(c,b,a.heap[g],
a.depth));)a.heap[d]=a.heap[g],d=g,g<<=1;a.heap[d]=b}function vg(a,c,d){var b,g,p=0;if(0!==a.last_lit){do{var f=a.pending_buf[a.d_buf+2*p]<<8|a.pending_buf[a.d_buf+2*p+1];var e=a.pending_buf[a.l_buf+p];p++;0===f?Zc(a,e,c):(Zc(a,(b=ke[e])+256+1,c),0!==(g=wf[b])&&Gc(a,e-xf[b],g),Zc(a,b=pg(--f),d),0!==(g=Fe[b])&&Gc(a,f-Ge[b],g))}while(p<a.last_lit)}Zc(a,256,c)}function yf(a,c){var d,b=c.dyn_tree;var g=c.stat_desc.static_tree;var p=c.stat_desc.has_stree,f=c.stat_desc.elems,e=-1;var m=0;a.heap_len=0;for(a.heap_max=
573;m<f;m++)0!==b[2*m]?(a.heap[++a.heap_len]=e=m,a.depth[m]=0):b[2*m+1]=0;for(;2>a.heap_len;)b[2*(d=a.heap[++a.heap_len]=2>e?++e:0)]=1,a.depth[d]=0,a.opt_len--,p&&(a.static_len-=g[2*d+1]);c.max_code=e;for(m=a.heap_len>>1;1<=m;m--)vf(a,b,m);d=f;do m=a.heap[1],a.heap[1]=a.heap[a.heap_len--],vf(a,b,1),g=a.heap[1],a.heap[--a.heap_max]=m,a.heap[--a.heap_max]=g,b[2*d]=b[2*m]+b[2*g],a.depth[d]=(a.depth[m]>=a.depth[g]?a.depth[m]:a.depth[g])+1,b[2*m+1]=b[2*g+1]=d,a.heap[1]=d++,vf(a,b,1);while(2<=a.heap_len);
a.heap[--a.heap_max]=a.heap[1];var l,h,n,r,t;m=c.dyn_tree;d=c.max_code;g=c.stat_desc.static_tree;p=c.stat_desc.has_stree;f=c.stat_desc.extra_bits;var v=c.stat_desc.extra_base,x=c.stat_desc.max_length,D=0;for(n=0;15>=n;n++)a.bl_count[n]=0;m[2*a.heap[a.heap_max]+1]=0;for(c=a.heap_max+1;573>c;c++)(n=m[2*m[2*(l=a.heap[c])+1]+1]+1)>x&&(n=x,D++),m[2*l+1]=n,l>d||(a.bl_count[n]++,r=0,l>=v&&(r=f[l-v]),t=m[2*l],a.opt_len+=t*(n+r),!p||(a.static_len+=t*(g[2*l+1]+r)));if(0!==D){do{for(n=x-1;0===a.bl_count[n];)n--;
a.bl_count[n]--;a.bl_count[n+1]+=2;a.bl_count[x]--;D-=2}while(0<D);for(n=x;0!==n;n--)for(l=a.bl_count[n];0!==l;)(h=a.heap[--c])>d||(m[2*h+1]!==n&&(a.opt_len+=(n-m[2*h+1])*m[2*h],m[2*h+1]=n),l--)}rg(b,e,a.bl_count)}function wg(a,c,d){var b,g=-1,p=c[1],f=0,e=7,m=4;0===p&&(e=138,m=3);c[2*(d+1)+1]=65535;for(b=0;b<=d;b++){var l=p;p=c[2*(b+1)+1];++f<e&&l===p||(f<m?a.bl_tree[2*l]+=f:0!==l?(l!==g&&a.bl_tree[2*l]++,a.bl_tree[32]++):10>=f?a.bl_tree[34]++:a.bl_tree[36]++,f=0,g=l,0===p?(e=138,m=3):l===p?(e=6,
m=3):(e=7,m=4))}}function xg(a,c,d){var b,g,p=-1,f=c[1],e=0,m=7,l=4;0===f&&(m=138,l=3);for(b=0;b<=d;b++)if(g=f,f=c[2*(b+1)+1],!(++e<m)||g!==f){if(e<l){do Zc(a,g,a.bl_tree);while(0!=--e)}else 0!==g?(g!==p&&(Zc(a,g,a.bl_tree),e--),Zc(a,16,a.bl_tree),Gc(a,e-3,2)):10>=e?(Zc(a,17,a.bl_tree),Gc(a,e-3,3)):(Zc(a,18,a.bl_tree),Gc(a,e-11,7));e=0;p=g;0===f?(m=138,l=3):g===f?(m=6,l=3):(m=7,l=4)}}function yg(a,c,d,b){Gc(a,+!!b,3);tg(a);je(a,d);je(a,~d);Ya.arraySet(a.pending_buf,a.window,c,d,a.pending);a.pending+=
d}function pd(a,c){return a.msg=Ed[c],c}function qd(a){for(var c=a.length;0<=--c;)a[c]=0}function rd(a){var c=a.state,d=c.pending;d>a.avail_out&&(d=a.avail_out);0!==d&&(Ya.arraySet(a.output,c.pending_buf,c.pending_out,d,a.next_out),a.next_out+=d,c.pending_out+=d,a.total_out+=d,a.avail_out-=d,c.pending-=d,0===c.pending&&(c.pending_out=0))}function oc(a,c){Ch(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,c);a.block_start=a.strstart;rd(a.strm)}function Eb(a,c){a.pending_buf[a.pending++]=
c}function le(a,c){a.pending_buf[a.pending++]=c>>>8&255;a.pending_buf[a.pending++]=255&c}function zg(a,c){var d,b,g=a.max_chain_length,p=a.strstart,f=a.prev_length,e=a.nice_match,m=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,l=a.window,h=a.w_mask,n=a.prev,r=a.strstart+258,t=l[p+f-1],v=l[p+f];a.prev_length>=a.good_match&&(g>>=2);e>a.lookahead&&(e=a.lookahead);do if(l[(d=c)+f]===v&&l[d+f-1]===t&&l[d]===l[p]&&l[++d]===l[p+1]){p+=2;for(d++;l[++p]===l[++d]&&l[++p]===l[++d]&&l[++p]===l[++d]&&l[++p]===
l[++d]&&l[++p]===l[++d]&&l[++p]===l[++d]&&l[++p]===l[++d]&&l[++p]===l[++d]&&p<r;);if(b=258-(r-p),p=r-258,b>f){if(a.match_start=c,f=b,b>=e)break;t=l[p+f-1];v=l[p+f]}}while((c=n[c&h])>m&&0!=--g);return f<=a.lookahead?f:a.lookahead}function Fd(a){var c,d,b=a.w_size;do{if(d=a.window_size-a.lookahead-a.strstart,a.strstart>=b+(b-262)){Ya.arraySet(a.window,a.window,b,b,0);a.match_start-=b;a.strstart-=b;a.block_start-=b;var g=c=a.hash_size;do{var p=a.head[--g];a.head[g]=p>=b?p-b:0}while(--c);g=c=b;do p=a.prev[--g],
a.prev[g]=p>=b?p-b:0;while(--c);d+=b}if(0===a.strm.avail_in)break;g=a.strm;p=a.window;var f=a.strstart+a.lookahead,e=g.avail_in;if(c=(e>d&&(e=d),0===e)?0:(g.avail_in-=e,Ya.arraySet(p,g.input,g.next_in,e,f),1===g.state.wrap?g.adler=Sd(g.adler,p,e,f):2===g.state.wrap&&(g.adler=fc(g.adler,p,e,f)),g.next_in+=e,g.total_in+=e,e),a.lookahead+=c,3<=a.lookahead+a.insert)for(d=a.strstart-a.insert,a.ins_h=a.window[d],a.ins_h=(a.ins_h<<a.hash_shift^a.window[d+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^
a.window[d+3-1])&a.hash_mask,a.prev[d&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=d,d++,a.insert--,!(3>a.lookahead+a.insert)););}while(262>a.lookahead&&0!==a.strm.avail_in)}function zf(a,c){for(var d,b;;){if(262>a.lookahead){if(Fd(a),262>a.lookahead&&0===c)return 1;if(0===a.lookahead)break}if(d=0,3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==d&&a.strstart-d<=a.w_size-262&&(a.match_length=
zg(a,d)),3<=a.match_length)if(b=sd(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&3<=a.lookahead){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!=--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+
1])&a.hash_mask;else b=sd(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(b&&(oc(a,!1),0===a.strm.avail_out))return 1}return(a.insert=2>a.strstart?a.strstart:2,4===c)?(oc(a,!0),0===a.strm.avail_out)?3:4:a.last_lit&&(oc(a,!1),0===a.strm.avail_out)?1:2}function Td(a,c){for(var d,b,g;;){if(262>a.lookahead){if(Fd(a),262>a.lookahead&&0===c)return 1;if(0===a.lookahead)break}if(d=0,3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=
a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=2,0!==d&&a.prev_length<a.max_lazy_match&&a.strstart-d<=a.w_size-262&&(a.match_length=zg(a,d),5>=a.match_length&&(1===a.strategy||3===a.match_length&&4096<a.strstart-a.match_start)&&(a.match_length=2)),3<=a.prev_length&&a.match_length<=a.prev_length){g=a.strstart+a.lookahead-3;b=sd(a,a.strstart-1-a.prev_match,a.prev_length-3);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=
g&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!=--a.prev_length);if(a.match_available=0,a.match_length=2,a.strstart++,b&&(oc(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if(sd(a,0,a.window[a.strstart-1])&&oc(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=1,a.strstart++,a.lookahead--}return(a.match_available&&(sd(a,0,a.window[a.strstart-
1]),a.match_available=0),a.insert=2>a.strstart?a.strstart:2,4===c)?(oc(a,!0),0===a.strm.avail_out)?3:4:a.last_lit&&(oc(a,!1),0===a.strm.avail_out)?1:2}function $c(a,c,d,b,g){this.good_length=a;this.max_lazy=c;this.nice_length=d;this.max_chain=b;this.func=g}function Dh(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=
null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new Ya.Buf16(1146);this.dyn_dtree=new Ya.Buf16(122);this.bl_tree=new Ya.Buf16(78);qd(this.dyn_ltree);qd(this.dyn_dtree);qd(this.bl_tree);
this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new Ya.Buf16(16);this.heap=new Ya.Buf16(573);qd(this.heap);this.heap_max=this.heap_len=0;this.depth=new Ya.Buf16(573);qd(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function Ag(a,c){if(65534>c&&(a.subarray&&Bg||!a.subarray&&Cg))return String.fromCharCode.apply(null,Ya.shrinkBuf(a,c));for(var d="",b=0;b<c;b++)d+=String.fromCharCode(a[b]);return d}
function Gd(a){if(!(this instanceof Gd))return new Gd(a);this.options=Ya.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},a||{});var c,d,b;a=this.options;a.raw&&0<a.windowBits?a.windowBits=-a.windowBits:a.gzip&&0<a.windowBits&&16>a.windowBits&&(a.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new Af;this.strm.avail_out=0;var g=this.strm;var p=a.level;var f=a.method,e=a.windowBits,m=a.memLevel,l=a.strategy;if(g){var h,n,r,t=1;if(-1===
p&&(p=6),0>e?(t=0,e=-e):15<e&&(t=2,e-=16),1>m||9<m||8!==f||8>e||15<e||0>p||9<p||0>l||4<l)p=pd(g,-2);else{8===e&&(e=9);var v=new Dh;p=(g.state=v,v.strm=g,v.wrap=t,v.gzhead=null,v.w_bits=e,v.w_size=1<<v.w_bits,v.w_mask=v.w_size-1,v.hash_bits=m+7,v.hash_size=1<<v.hash_bits,v.hash_mask=v.hash_size-1,v.hash_shift=~~((v.hash_bits+3-1)/3),v.window=new Ya.Buf8(2*v.w_size),v.head=new Ya.Buf16(v.hash_size),v.prev=new Ya.Buf16(v.w_size),v.lit_bufsize=1<<m+6,v.pending_buf_size=4*v.lit_bufsize,v.pending_buf=new Ya.Buf8(v.pending_buf_size),
v.d_buf=+v.lit_bufsize,v.l_buf=3*v.lit_bufsize,v.level=p,v.strategy=l,v.method=f,0===(r=g&&g.state?(g.total_in=g.total_out=0,g.data_type=2,(h=g.state).pending=0,h.pending_out=0,0>h.wrap&&(h.wrap=-h.wrap),h.status=h.wrap?42:113,g.adler=+(2!==h.wrap),h.last_flush=0,Eh(h),0):pd(g,-2))&&((n=g.state).window_size=2*n.w_size,qd(n.head),n.max_lazy_match=me[n.level].max_lazy,n.good_match=me[n.level].good_length,n.nice_match=me[n.level].nice_length,n.max_chain_length=me[n.level].max_chain,n.strstart=0,n.block_start=
0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),r)}}else p=-2;if(0!==p)throw Error(Ed[p]);if(a.header&&(c=this.strm,d=a.header,c&&c.state&&2===c.state.wrap&&(c.state.gzhead=d)),a.dictionary){if(b="string"==typeof a.dictionary?Bf(a.dictionary):"[object ArrayBuffer]"===Dg.call(a.dictionary)?new Uint8Array(a.dictionary):a.dictionary,0!==(p=Fh(this.strm,b)))throw Error(Ed[p]);this._dict_set=!0}}function Cf(a,c){c=new Gd(c);if(c.push(a,!0),c.err)throw c.msg||Ed[c.err];
return c.result}function Eg(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function Gh(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new Ya.Buf16(320);this.work=new Ya.Buf16(288);
this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function Fg(a,c,d,b){var g;a=a.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Ya.Buf8(a.wsize)),b>=a.wsize?(Ya.arraySet(a.window,c,d-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((g=a.wsize-a.wnext)>b&&(g=b),Ya.arraySet(a.window,c,d-b,g,a.wnext),(b-=g)?(Ya.arraySet(a.window,c,d-b,b,0),a.wnext=b,a.whave=a.wsize):(a.wnext+=g,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=g))),0}function Hd(a){if(!(this instanceof
Hd))return new Hd(a);this.options=Ya.assign({chunkSize:16384,windowBits:0,to:""},a||{});var c,d,b,g,p,f,e,m,l,h=this.options;h.raw&&0<=h.windowBits&&16>h.windowBits&&(h.windowBits=-h.windowBits,0===h.windowBits&&(h.windowBits=-15));0<=h.windowBits&&16>h.windowBits&&(!a||!a.windowBits)&&(h.windowBits+=32);15<h.windowBits&&48>h.windowBits&&0==(15&h.windowBits)&&(h.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new Af;this.strm.avail_out=0;a=(c=this.strm,d=h.windowBits,
c?(c.state=g=new Gh,g.window=null,0!==(p=d,b=c&&c.state?(e=c.state,0>p?(f=0,p=-p):(f=(p>>4)+1,48>p&&(p&=15)),p&&(8>p||15<p))?-2:(null!==e.window&&e.wbits!==p&&(e.window=null),e.wrap=f,e.wbits=p,c&&c.state?((m=c.state).wsize=0,m.whave=0,m.wnext=0,c&&c.state?(l=c.state,c.total_in=c.total_out=l.total=0,c.msg="",l.wrap&&(c.adler=1&l.wrap),l.mode=1,l.last=0,l.havedict=0,l.dmax=32768,l.head=null,l.hold=0,l.bits=0,l.lencode=l.lendyn=new Ya.Buf32(852),l.distcode=l.distdyn=new Ya.Buf32(592),l.sane=1,l.back=
-1,0):-2):-2):-2)&&(c.state=null),b):-2);if(a!==Wb.Z_OK||(this.header=new Gg,Hh(this.strm,this.header),h.dictionary&&("string"==typeof h.dictionary?h.dictionary=Bf(h.dictionary):"[object ArrayBuffer]"===Hg.call(h.dictionary)&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(a=Ig(this.strm,h.dictionary))!==Wb.Z_OK)))throw Error(Ed[a]);}function Df(a,c){c=new Hd(c);if(c.push(a,!0),c.err)throw c.msg||Ed[c.err];return c.result}function Ef(a){this.version=a.readU32BE();this.width=a.readU32BE();this.height=
a.readU32BE();this.layersNb=a.readU32BE()}function He(a){let c=[,,,,];for(let d=0;d<c.length;d++)c[d]=String.fromCharCode(a.readByte());if(this.chunkType=c.join(""),this.chunkSize=a.readU32BE(),a.eof)throw"Truncated chunk";}function Jg(a){return{major:a>>16&65535,minor:65535&a}}function Ff(a,c){let d=new ub(new Uint8Array(He.HEADER_LENGTH+c));return d.writeString(a),d.writeU32BE(c),d}function Ud(){}function Ie(a){function c(p,f){null===f?g.emitEvent("loadingProgress",[1,"Loading your "+p.friendly+
"..."]):g.emitEvent("loadingProgress",[f,"Loading your "+p.friendly+" ("+Math.round(100*f)+"%)..."])}var d=[],b={},g=this;a.loadChibiFileUrl&&0<(""+a.loadChibiFileUrl).length?d.push({url:a.loadChibiFileUrl,friendly:"drawing layers",name:"layers",required:!0}):a.loadImageUrl&&0<(""+a.loadImageUrl).length&&d.push({url:a.loadImageUrl,friendly:"drawing",name:"flat",required:!0});a.loadSwatchesUrl&&d.push({url:a.loadSwatchesUrl,friendly:"color swatches",name:"swatches",required:!1,noProgress:!0});this.load=
function(){function p(){f.required?g.emitEvent("loadingFailure",["Failed to load your "+f.friendly+", please try again later."]):g.load()}if(0==d.length)g.emitEvent("loadingComplete",[b]);else{var f=d.shift(),e=new XMLHttpRequest;e.addEventListener("progress",function(m){c(f,m.lengthComputable&&!f.noProgress?m.loaded/m.total:null)},!1);e.addEventListener("load",function(m){if(200==this.status){let l=this.response;g.emitEvent("loadingProgress",[1,"Starting ChickenPaint..."]);setTimeout(function(){(function(h,
n){switch(h.name){case "flat":return new Promise(function(r,t){let v=new Blob([n],{type:"image/png"}),x=window.URL.createObjectURL(v);if(x){let D=new Image;D.onload=function(){let G=new Ec(this.width,this.height),N=new Ma(0,0,"Layer 1");N.image=H.createFromImage(D);G.addLayerObject(G.getLayersRoot(),N);D=null;window.URL.revokeObjectURL(x);r(G)};D.src=x}else t(null)});case "swatches":return(h=(new Ud).read(n))?Promise.resolve(h):Promise.reject(null);case "layers":return function(r,t){function v(Y){let ka;
var Aa=X;if(null!==Aa&&0!==Aa.length)if(null===Y||0===Y.length)Y=Aa;else{var Ga=new Uint8Array(Aa.length+Y.length);Y=(Ga.set(Aa,0),Ga.set(Y,Aa.length),Ga)}for(X=Y;X;){if(P<X.length)X=X.subarray(P),P=0;else{P-=X.length;X=null;break}switch(D){case 0:if(X.length<He.HEADER_LENGTH)break;if(ba=new He(ka=new ub(X)),X=X.subarray(ka.pos),L)if("ZEND"==ba.chunkType)D=45;else{"LAYR"==ba.chunkType?(D=2,K=new Ih(ba,L.width,L.height)):"GRUP"==ba.chunkType?(D=3,K=new Jh(ba,L.width,L.height)):(console.log("Unknown chunk type '"+
ba.chunkType+"', attempting to skip..."),P=ba.chunkSize);continue}else if("HEAD"==ba.chunkType){D=1;continue}else D=5;break;case 1:if(X.length<ba.chunkSize)break;if(0<Jg((L=new Ef(ka=new ub(X))).version).major){D=5;break}N=(G=new Ec(L.width,L.height)).getLayersRoot();P=ba.chunkSize;D=0;continue;case 2:if(X=K.decode(X),K.done){G.addLayerObject(N,K.layer);D=0;continue}break;case 3:if(X=K.decode(X),K.done){G.addLayerGroupObject(N,K.layer,K.childLayers);D=0;continue}}break}}t=t||{};let x=new (ma(Gf).Inflate)({}),
D=0,G=null,N=null,K,P=0,L=null,ba=null,X=null;return(new Promise(function(Y){if(r instanceof ArrayBuffer)Y(r);else{let ka=new FileReader;ka.onload=function(){Y(this.result)};ka.readAsArrayBuffer(r)}})).then(Y=>new Promise(function(ka,Aa){let Ga=new Uint8Array(Y);(function(U){for(let ya=0;8>ya;ya++)if(U[ya]!="CHIBIOEK".charCodeAt(ya))return!1;return!0})(Ga)?(Ga=Ga.subarray(8),x.onData=v,x.onEnd=function(U){0===U&&45==D?(!1!==t.upgradeMultiplyLayers&&10>L.version&&G.upgradeMultiplyLayers(t.upgradeMultiplyLayers),
G.selectTopmostVisibleLayer(),ka(G)):Aa("Fatal error decoding ChibiFile: "+U)},x.push(Ga,!0)):Aa("This doesn't appear to be a ChibiPaint layers file, is it damaged?")}))}(n);default:return Promise.reject("Unexpected resource type '"+h.name+"'")}})(f,l).then(function(h){b[f.name]=h;g.load()},function(){g.emitEvent("loadingFailure",["Failed to read your "+f.friendly])})},0)}else p()},!1);e.addEventListener("error",p);c(f,f.noProgress?null:0);e.open("GET",f.url,!0);e.responseType="arraybuffer";e.send()}}}
function Hf(a){(a=a.split(/[-_]/,1)[0].toLowerCase())in If?(Je=If[a],Jf=a):(Je=Ke,Jf="en")}function ia(a){return a in Je?Je[a]:a}function ne(a){function c(e){null===e?p.emitEvent("savingProgress",[1,ia("Saving drawing...")]):p.emitEvent("savingProgress",[e,ia("Saving drawing...")+" ("+Math.round(100*e)+"%)"])}function d(e){p.emitEvent("savingFailure",[e])}async function b(e){try{let m=await g(e),l=`${(m/1024/1024).toFixed(3)}MB`,h=`${a.post_max_size}MB`;if(console.log("Total size of FormData:",l),
console.log("post_max_size:",h),a&&a.post_max_size&&m&&!isNaN(m)&&m>1048576*a.post_max_size){d(`${ia("The file size exceeds the server limit.")}
${ia("Limit size")}:${h}
${ia("Current size")}:${l}`);return}console.log(ia("The total size of FormData is within the acceptable range."))}catch(m){console.error("Error details:",m);d("An error occurred in the getFormDataSize function.");return}c(.5);fetch(a.url,{method:"POST",mode:"same-origin",headers:{"X-Requested-With":"chickenpaint"},body:e}).then(m=>{if(!m.ok){let l;switch(m.status){case 400:l="Bad Request";break;case 401:l="Unauthorized";break;case 403:l="Forbidden";break;case 404:l="Not Found";break;case 500:l="Internal Server Error";
break;case 502:l="Bad Gateway";break;case 503:l="Service Unavailable";break;default:l="Unknown Error"}throw Error(`${ia("Network response was not OK")} ( ${ia("HTTP status code")} ${m.status} : ${l} )`);}return m.text()}).then(m=>{/^CHIBIOK/.test(m)?(c(1),p.emitEvent("savingComplete")):d(m)}).catch(m=>{d(m.message)})}async function g(e){if(a.post_max_size)return e=Array.from(e.entries()).map(([m,l])=>"string"==typeof l?new Blob([`${m}=${l}`]):l),(new Blob(e)).size}var p=this,f=!1;a.rotation=a.rotation||
0;this.save=function(){var e,m,l,h,n;(e=new Blob([function(r){for(var t=new Uint8Array(r.length),v=0;v<r.length;v++)t[v]=r.charCodeAt(v);return t}(a.artwork.getFlatPNG(a.rotation))],{type:"image/png"}),a.artwork.isSimpleDrawing())?l=Promise.resolve(null):(h=a.artwork,n=n||{},l=Promise.resolve().then(()=>{var r,t;let v,x=new (ma(Gf).Deflate)({level:7}),D=[],G=new Uint8Array(8),N=h.getLayersRoot().getLinearizedLayerList(!1),K=n.forceOldVersion?0:function(L){for(let ba of L.getLayersRoot().getLinearizedLayerList(!1))if(ba instanceof
nb||ba.mask||ba.clip||ba.blendMode>V.LM_LAST_CHIBIPAINT||ba.blendMode===V.LM_MULTIPLY)return 10;return 0}(h),P=0===(t=Jg(K)).major&&0===t.minor?"ChibiPaint v0.0":"ChickenPaint v"+t.major+"."+t.minor;t=Promise.resolve();x.onData=function(L){D.push(L)};for(let L=0;8>L;L++)G[L]="CHIBIOEK".charCodeAt(L);for(let L of(D.push(G),x.push((r=N.length,(v=Ff("HEAD",Ef.FIXED_HEADER_LENGTH)).writeU32BE(K),v.writeU32BE(h.width),v.writeU32BE(h.height),v.writeU32BE(r),v.getAsDataArray()),!1),N))t=t.then(()=>new Promise(function(ba){var X=
x.push,Y=L,ka=Y instanceof Ma,Aa=4*(ka?5:6),Ga=Y.name.length;var U=Ff(ka?"LAYR":"GRUP",Aa+Ga+((ka?Y.image.data.length:0)+(Y.mask?Y.mask.data.length:0)));var ya=0;let pa;Y.visible&&(ya|=1);ka&&Y.clip&&(ya|=2);Y.mask&&(ya|=4);Y.maskLinked&&(ya|=8);Y.maskVisible&&(ya|=16);Y.lockAlpha&&(ya|=64);!ka&&Y.expanded&&(ya|=32);Y.blendMode===V.LM_MULTIPLY2?(pa=V.LM_MULTIPLY,ya|=128):pa=Y.blendMode;U.writeU32BE(Aa+Ga);U.writeU32BE(pa);U.writeU32BE(Y.alpha);U.writeU32BE(ya);U.writeU32BE(Y.name.length);ka||U.writeU32BE(Y.layers.length);
U.writeString(Y.name);if(ka){ka=U.pos;Aa=U.data;Ga=Y.image.data;for(ya=0;ya<Ga.length;ya+=H.BYTES_PER_PIXEL)Aa[ka++]=Ga[ya+H.ALPHA_BYTE_OFFSET],Aa[ka++]=Ga[ya+H.RED_BYTE_OFFSET],Aa[ka++]=Ga[ya+H.GREEN_BYTE_OFFSET],Aa[ka++]=Ga[ya+H.BLUE_BYTE_OFFSET];U.pos=ka;!0}Y.mask&&(Y=Y.mask,U.data.set(Y.data,U.pos),U.pos+=Y.data.length);U=U.getAsDataArray();X.call(x,U,!1);setTimeout(ba,10)}));return t.then(()=>new Promise((L,ba)=>{x.onEnd=function(X){if(0===X)if("undefined"!=typeof Blob)L({bytes:new Blob(D,{type:"application/octet-stream"}),
version:P});else{X=new Uint8Array(D.map(ka=>ka.byteLength).reduce((ka,Aa)=>ka+Aa,0));let Y=0;for(let ka of D)X.set(ka,Y),Y+=ka.byteLength;L({bytes:X,version:P})}else ba(X)};x.push(Ff("ZEND",0).getAsDataArray(),!0)}))}));l.then(function(r){if(f)p.emitEvent("savingFailure");else if(m=a.swatches?new Blob([(new Ud).write(a.swatches)],{type:"application/octet-stream"}):null,a.url){var t=new FormData;t.append("beginMarker","This marker ensures the upload wasn't truncated");t.append("painter","ChickenPaint v2.0");
t.append("picture",e);e=null;r?(t.append("chibifileFormat",r.version),t.append("chibifile",r.bytes),t.append("rotation",""+a.rotation)):t.append("rotation","0");m&&(t.append("swatches",m),m=null);t.append("endMarker","This marker ensures the upload wasn't truncated");b(t)}else t="oekaki_"+(new Date).toISOString().split(".")[0].replace(/[^0-9]/g,"_"),ma(oe).saveAs(e,t+".png"),r&&ma(oe).saveAs(r.bytes,t+".chi"),m&&ma(oe).saveAs(m,t+".aco")}).catch(function(r){p.emitEvent("savingFailure")})};this.cancel=
function(){f=!0}}function Kh(a,c,d){function b(){var X=l.width/2,Y=l.height/2;if(h.fillStyle="white",h.fillRect(0,0,l.width,l.height),K==N.length){var ka=v.width,Aa=v.height,Ga=Math.round(X-ka/2),U=Math.round(Y-Aa/2);h.drawImage(v,Ga,U);var ya=P;p||((p=document.createElement("canvas")).width=ka,p.height=Aa,e=p.getContext("2d"));e.globalCompositeOperation="copy";e.drawImage(n,0,0);f||((f=document.createElement("canvas")).width=ka,f.height=Aa,m=f.getContext("2d"));m.globalCompositeOperation="copy";
m.drawImage(G,0,0);m.globalCompositeOperation="source-in";m.drawImage(G,0,Math.round(170*ya));e.globalCompositeOperation="source-over";e.drawImage(f,0,0);e.drawImage(r,0,0);e.globalCompositeOperation="screen";e.drawImage(D,0,0);e.globalCompositeOperation="multiply";e.drawImage(x,0,0);h.globalAlpha=.88;h.drawImage(p,Ga,U);h.globalAlpha=1;h.drawImage(t,Ga,U);Y=Math.round(Y+Aa/2+2)}if(""!=L)for(h.fillStyle="black",ya=L.split("\n"),ka=0;ka<ya.length;ka++)Aa=ya[ka],Ga=h.measureText(Aa).width,Y+=28,h.fillText(Aa,
X-Ga/2,Y)}function g(){l.width=l.clientWidth;l.height=l.clientHeight;h.font="14pt sans-serif";b()}var p,f,e,m,l=document.createElement("canvas"),h=l.getContext("2d"),n=new Image,r=new Image,t=new Image,v=new Image,x=new Image,D=new Image,G=new Image,N=[n,r,t,v,x,D,G],K=0,P=0,L="";d+="splash/";for(var ba=0;ba<N.length;ba++)N[ba].onload=function(){++K==N.length&&b()};n.src=d+"cup.png";D.src=d+"highlights.png";r.src=d+"lid.png";t.src=d+"lines.png";x.src=d+"shading.png";G.src=d+"smoothie.png";v.src=d+
"text.png";c.on("loadingProgress",function(X,Y){P=X;L=Y;b()});c.on("loadingFailure",function(X){P=0;L=X;b()});c.on("loadingComplete",function(){window.removeEventListener("resize",g);a.removeChild(l)});window.addEventListener("resize",g);l.className="chickenpaint-splash-screen";a.appendChild(l);g()}function Kg(a){for(var c={DELETE:46,BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27," ":32,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40,SHIFT:16,"[":219,"]":221,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,
0:48,"-":189,"=":187,"+":187,";":187,META:91,LEFTMETA:91,RIGHTMETA:91,ALT:18,ALTGRAPH:18,OPTION:18,CONTROL:17},d=65;90>=d;d++)c[String.fromCharCode(d)]=d;if((a=a.toUpperCase())in c)return c[a]}function ed(){var a,c=null,d=this;this.isPen=function(){var b;return!!c&&(1==(b=c.pointerType)||3==b)};this.getPressure=function(){return c?c.pressure:1};this.pluginLoaded=function(){console.log("Wacom tablet support loaded!");c=a.penAPI};this.isTabletPresent=function(){return!!c};this.detectTablet=function(){if(/Chrome/i.test(navigator.userAgent)&&
!/OPR/.test(navigator.userAgent))console.log("Not attempting to load Wacom tablet plugin, since this is Chrome");else{if(console.log("Attempting to load Wacom tablet support..."),"classid"in(a=document.createElement("object")))a.classid="CLSID:092dfa86-5807-5a94-bf3b-5a53ba9e5308";else{var b=document.createElement("param");b.name="onload";b.value="onWacomPluginLoaded";a.appendChild(b);a.type="application/x-wacomtabletplugin"}a.style.position="absolute";a.style.visibility="hidden";a.onload="onWacomPluginLoaded";
document.body.appendChild(a);setTimeout(function(){d.isTabletPresent()||console.log("Looks like the Wacom plugin isn't installed, or failed to load.")},5E3)}}}function Lg(){let a,c,d,b,g,p,f,e;this.x0=this.y0=this.x1=this.y1=this.x2=this.y2=this.x3=this.y3=0;let m=l=>{let h=3*l,n=h*l;l*=l*l;let r=2*n,t=6*l,v=this.x0-2*this.x1+this.x2,x=this.y0-2*this.y1+this.y2,D=3*(this.x1-this.x2)-this.x0+this.x3,G=3*(this.y1-this.y2)-this.y0+this.y3;a=this.x0;g=this.y0;c=(this.x1-this.x0)*h+v*n+D*l;p=(this.y1-
this.y0)*h+x*n+G*l;d=v*r+D*t;f=x*r+G*t;b=D*t;e=G*t};this.compute=(l,h,n)=>{m(1/n);l[0]=a;h[0]=g;for(let r=1;r<n;r++)a+=c,g+=p,c+=d,p+=f,d+=b,f+=e,l[r]=a,h[r]=g}}function Mg(a,c,d,b){var g,p=0;return"boolean"!=typeof c&&(b=d,d=c,c=void 0),function(){function f(){p=+new Date;d.apply(e,l)}var e=this,m=+new Date-p,l=arguments;b&&!g&&f();g&&clearTimeout(g);void 0===b&&m>a?f():!0!==c&&(g=setTimeout(b?function(){g=void 0}:f,void 0===b?a-m:a))}}function Id(a){this.points=a||[]}function Lb(a,c){this.x=a;this.y=
c}function Ng(a){for(var c=document.createElement("canvas"),d=c.getContext("2d"),b=d.createImageData(64,64),g=b.data,p=0,f=0;64>f;f++)for(var e=0;64>e;e++)0!=(8&e)^0!=(8&f)?(g[p++]=255,g[p++]=255,g[p++]=255):(g[p++]=204,g[p++]=204,g[p++]=204),g[p++]=255;return c.width=64,c.height=64,d.putImageData(b,0,0),a.createPattern(c,"repeat")}function Le(a,c){c+="Style";a.globalCompositeOperation="exclusion";"exclusion"==a.globalCompositeOperation?a[c]="white":(a.globalCompositeOperation="difference",a[c]="#888",
"difference"!=a.globalCompositeOperation&&(a[c]="black"))}function pe(a){function c(){var x=a?ma(Ba)(d).height():ma(Ba)(d).width();n=m/(f-p)*x;x=(e-p)/(f-p)*(x-n);g.style[a?"height":"width"]=n+"px";b.style[a?"height":"width"]=n+"px";b.style[a?"top":"left"]=x+"px"}let d=document.createElement("div"),b=document.createElement("div"),g=document.createElement("div"),p=0,f=1,e=0,m=1,l=10,h=!1,n=1,r=!1,t,v=this;this.setValues=function(x,D,G,N){e=x;m=D;p=G;f=N;c()};this.setBlockIncrement=function(x){l=x};
this.setUnitIncrement=function(x){};this.getElement=function(){return d};this.getValueIsAdjusting=function(){return h};d.className="chickenpaint-scrollbar "+(a?"chickenpaint-scrollbar-vertical":"chickenpaint-scrollbar-horizontal");b.className="chickenpaint-scrollbar-handle";b.setAttribute("touch-action","none");g.className="chickenpaint-scrollbar-handle-inner";b.appendChild(g);d.appendChild(b);b.addEventListener("pointerdown",function(x){x.stopPropagation();t=a?x.pageY-ma(Ba)(d).offset().top:x.pageX-
ma(Ba)(d).offset().left;b.setPointerCapture(x.pointerId);ma(Ba)(b).addClass("dragging");r=!0});b.addEventListener("pointermove",function(x){if(r){h=!0;let D=a?ma(Ba)(d).height():ma(Ba)(d).width();x=a?x.pageY-ma(Ba)(d).offset().top:x.pageX-ma(Ba)(d).offset().left;e+=(x-t)*(f-p)/(D-n);e=Math.min(Math.max(e,p),f);t=x;v.emitEvent("valueChanged",[e]);c();h=!1}});b.addEventListener("pointerup",function(x){if(x.stopPropagation(),r){try{b.releasePointerCapture(x.pointerId)}catch(D){}ma(Ba)(b).removeClass("dragging");
r=!1}});b.addEventListener("click",function(x){x.stopPropagation()});d.addEventListener("click",function(x){this==d&&((a?x.pageY-ma(Ba)(d).offset().top:x.pageX-ma(Ba)(d).offset().left)<parseInt(b.style[a?"top":"left"],10)?e-=l:e+=l,v.emitEvent("valueChanged",[e]),c())})}function pc(){this.modes=[]}function Me(a){function c(){}function d(){}function b(){this.shouldPaintBrushPreview=!1;this.oldPreviewRect=null}function g(){b.call(this);this.smoothMouse={x:0,y:0}}function p(){var E,O;this.mouseDown=
function(Z,la,za){if(!this.capture&&0==la&&!Z.altKey&&!ma(Ub).isPressed("space")&&G())return this.capture=!0,E=O={x:fb+.5,y:ib+.5},this.eraseBrushPreview(),!0};this.mouseDrag=function(Z){if(this.capture){var la=new Ha(Math.min(E.x,O.x)-1-1,Math.min(E.y,O.y)-1-1,Math.max(E.x,O.x)+1+1+1,Math.max(E.y,O.y)+1+1+1);if(O={x:fb+.5,y:ib+.5},Z.shiftKey){var za=Math.PI/4;Z=Math.round(Math.atan2(O.y-E.y,O.x-E.x)/za);switch(Z){case 0:case 4:O.y=E.y;break;case 2:case 6:O.x=E.x;break;default:Z*=za,za=Math.sqrt((O.y-
E.y)*(O.y-E.y)+(O.x-E.x)*(O.x-E.x)),O.x=E.x+za*Math.cos(Z),O.y=E.y+za*Math.sin(Z)}}return la.union(new Ha(Math.min(E.x,O.x)-1-1,Math.min(E.y,O.y)-1-1,Math.max(E.x,O.x)+1+1+1,Math.max(E.y,O.y)+1+1+1)),$a(la),!0}this.mouseMove.call(this,Z)};this.mouseUp=function(Z,la,za){if(this.capture&&0==la)return Z=P(E),la=P(O),this.capture=!1,this.drawLine(Z,la),$a(new Ha(Math.min(E.x,O.x)-1-1,Math.min(E.y,O.y)-1-1,Math.max(E.x,O.x)+1+1+1,Math.max(E.y,O.y)+1+1+1)),!0};this.paint=function(){this.capture?(fa.lineWidth=
1,fa.beginPath(),fa.moveTo(E.x,E.y),fa.lineTo(O.x,O.y),fa.stroke()):b.prototype.paint.call(this)};b.call(this)}function f(){let E=0,O,Z,la,za;this.mouseDown=function(ua,ab,gb){if(!this.capture&&0==ab&&!ua.altKey&&!ma(Ub).isPressed("space")&&G())return ua=P({x:fb,y:ib}),E=0,O=Z=la=za=ua,this.capture=!0,this.eraseBrushPreview(),!0};this.mouseDrag=function(ua){if(this.capture&&0===E)return la=za=P({x:fb,y:ib}),Ka.repaintAll(),!0;this.mouseMove.call(this,ua)};this.mouseUp=function(ua,ab,gb){if(this.capture&&
0==ab){switch(E){case 0:E=1;break;case 1:E=2;break;case 2:this.capture=!1;ab=O;gb=Z;let sb=la,Da=za;ua=new Lg;ua.x0=ab.x;ua.y0=ab.y;ua.x1=gb.x;ua.y1=gb.y;ua.x2=sb.x;ua.y2=sb.y;ua.x3=Da.x;ua.y3=Da.y;ab=Array(500);gb=Array(500);ua.compute(ab,gb,500);Ia.beginStroke(ab[0],gb[0],1);for(ua=1;500>ua;ua++)Ia.continueStroke(ab[ua],gb[ua],1);Ia.endStroke();Ka.repaintAll()}return!0}};this.mouseMove=function(ua,ab){if(this.capture)return ua=P({x:fb,y:ib}),1==E?Z=ua:2==E&&(la=ua),Ka.repaintAll(),!0;b.prototype.mouseMove.call(this,
ua,ab)};this.paint=function(){if(this.capture){var ua=new Lg;let ab=ba(O),gb=ba(Z),sb=ba(la),Da=ba(za);ua.x0=ab.x;ua.y0=ab.y;ua.x1=gb.x;ua.y1=gb.y;ua.x2=sb.x;ua.y2=sb.y;ua.x3=Da.x;ua.y3=Da.y;let Bb=Array(100),kc=Array(100);ua.compute(Bb,kc,100);fa.beginPath();fa.moveTo(Bb[0],kc[0]);for(ua=1;100>ua;ua++)fa.lineTo(Bb[ua],kc[ua]);fa.moveTo(~~ab.x,~~ab.y);fa.lineTo(~~gb.x,~~gb.y);fa.moveTo(~~sb.x,~~sb.y);fa.lineTo(~~Da.x,~~Da.y);fa.stroke()}else b.prototype.paint.call(this)};b.call(this)}function e(){var E;
this.mouseDown=function(O,Z,la){return!!this.capture||(ma(Ub).isPressed("space")||(0!=Z||this.transient&&!O.altKey)&&2!=Z?void(this.transient&&xa.pop()):(E=Z,this.capture=!0,x("crosshair"),this.mouseDrag(O),!0))};this.mouseDrag=function(O){if(this.capture)return O=P({x:fb,y:ib}),Ia.isPointWithin(O.x,O.y)&&a.setCurColor(new Ab(Ia.colorPicker(O.x,O.y))),!0};this.mouseUp=function(O,Z,la){if(this.capture&&Z==E)return E=-1,this.capture=!1,x("default"),this.transient&&xa.pop(),!0};this.enter=function(){c.prototype.enter.call(this);
E=-1}}function m(){var E,O,Z,la;this.keyDown=function(za){if(" "===za.key)return this.capture||x("grab"),!0};this.keyUp=function(za){if(this.transient&&1!=la&&" "===za.key)return x("default"),xa.pop(),!0};this.mouseDown=function(za,ua,ab){return!!this.capture||(1==ua||ma(Ub).isPressed("space")&&0==ua||!this.transient&&0==ua?(this.capture=!0,la=ua,E=za.pageX,O=za.pageY,Z=Ka.getOffset(),x("grabbing"),!0):void(this.transient&&xa.pop()))};this.mouseDrag=function(za){if(this.capture)return Ka.setOffset(Z.x+
za.pageX-E,Z.y+za.pageY-O),!0};this.mouseUp=function(za,ua,ab){if(this.capture&&ua==la)return la=-1,this.capture=!1,this.transient&&!ma(Ub).isPressed("space")&&(x("default"),xa.pop()),!0};this.enter=function(){x("grab")}}function l(){}function h(){var E,O=new Ha(0,0,0,0),Z=-1;this.mouseDown=function(la,za,ua){if(!this.capture&&0==za&&!la.altKey&&!ma(Ub).isPressed("space"))return la=L({x:fb,y:ib}),Z=za,O.makeEmpty(),E=la,Ka.repaintAll(),this.capture=!0,!0};this.mouseDrag=function(la){if(!this.capture)return!1;
var za=L({x:fb,y:ib});la=la.shiftKey;var ua=~~Math.max(Math.abs(za.x-E.x),Math.abs(za.y-E.y));return za.x>=E.x?(O.left=E.x,O.right=(la?E.x+ua:za.x)+1):(O.left=la?E.x-ua:za.x,O.right=E.x+1),za.y>=E.y?(O.top=E.y,O.bottom=(la?E.y+ua:za.y)+1):(O.top=la?E.y-ua:za.y,O.bottom=E.y+1),Ka.repaintAll(),!0};this.mouseUp=function(la,za,ua){if(this.capture&&za==Z)return Ia.rectangleSelection(O),O.makeEmpty(),Ka.repaintAll(),this.capture=!1,Z=-1,!0};this.paint=function(){O.isEmpty()||(fa.lineWidth=1,ka(fa,O))}}
function n(){var E,O,Z=!1;this.mouseDown=function(la,za,ua){if(!this.capture&&0==za&&!ma(Ub).isPressed("space")&&D())return E=P({x:fb,y:ib}),O=la.altKey,Z=!0,this.capture=!0,!0};this.mouseDrag=Mg(25,function(la){if(this.capture){la=P({x:fb,y:ib});var za=la.x-E.x,ua=la.y-E.y,ab=~~za,gb=~~ua;return(0!=ab||0!=gb)&&(Ia.move(ab,gb,O&&Z),Z=!1),E.x=la.x-(za-ab),E.y=la.y-(ua-gb),!0}});this.mouseUp=function(la,za,ua){if(this.capture&&0==za)return this.capture=!1,this.transient&&xa.pop(),!0}}function r(){function E(Ea,
Pa){return{x:(Ea.x+Pa.x)/2,y:(Ea.y+Pa.y)/2}}function O(Ea){return{x:Math.round(Ea.x),y:Math.round(Ea.y)}}function Z(Ea,Pa){for(var Ta=0;Ta<Ea.points.length;Ta++)if(49>=(Pa.x-Ea.points[Ta].x)*(Pa.x-Ea.points[Ta].x)+(Pa.y-Ea.points[Ta].y)*(Pa.y-Ea.points[Ta].y))return 2*Ta;for(Ta=0;Ta<Ea.points.length;Ta++){var kb=Ea.points[Ta],ob=Ea.points[(Ta+1)%Ea.points.length];ob=new Lb(ob.x-kb.x,ob.y-kb.y);kb=new Lb(Pa.x-kb.x,Pa.y-kb.y);var Zb=ob.getLength(),Nc=ob.getScaled(1/Zb);Zb=kb.getScaled(1/Zb);Nc=Nc.getDotProduct(Zb);
if(0<=Nc&&1>=Nc&&(ob.scale(Nc),49>=(ob.x-kb.x)*(ob.x-kb.x)+(ob.y-kb.y)*(ob.y-kb.y)))return 2*Ta+1}return Ea.containsPoint(Pa)?-3:-2}function la(){var Ea=gb.getTransformed(Cb),Pa=Z(Ea,{x:fb,y:ib});switch(Pa){case 0:case 2:case 4:case 6:Pa=~~(Pa/2);let Ta=Ea.points[Pa],kb=Ea.points[(Pa+1)%4];za(Lb.subtractPoints(Ea.points[(Pa+3)%4],Ta).normalize().add(Lb.subtractPoints(kb,Ta).normalize()));break;case 1:case 3:case 5:case 7:za(Lb.subtractPoints(Ea.points[(~~(Pa/2)+1)%4],Ea.points[~~(Pa/2)]).getPerpendicular());
break;case -3:x("move");break;default:x("default")}}function za(Ea){Ea=Math.floor(Math.atan2(-Ea.y,Ea.x)/(Math.PI/4)+.5);switch(0>Ea&&(Ea+=4),Ea){default:Ea="ew-resize";break;case 1:Ea="nesw-resize";break;case 2:Ea="ns-resize";break;case 3:Ea="nwse-resize"}x(Ea)}var ua,ab,gb,sb,Da,Bb,kc=-1;this.mouseDown=function(Ea,Pa,Ta){if(!this.capture&&0==Pa&&!Ea.altKey&&!ma(Ub).isPressed("space"))return kc=Z(gb.getTransformed(Cb),{x:fb,y:ib}),Da=P(sb={x:fb,y:ib}),this.capture=!0,la(),!0};this.mouseDrag=Mg(40,
function(Ea){if(this.capture){var Pa={x:fb,y:ib};switch(kc){case -3:Ea=O(P(Pa));var Ta=Lb.subtractPoints(Ea,Da);Pa=Ta.getTruncated();Ta=Ta.subtract(Pa);var kb=new Jb;kb.translate(Pa.x,Pa.y);ua.preMultiply(kb);Da=Lb.subtractPoints(Ea,Ta);break;case -2:kb=Math.PI/4;Ta=gb.getCenter();var ob=ba(Ta),Zb=Math.atan2(Pa.y-ob.y,Pa.x-ob.x)-Math.atan2(sb.y-ob.y,sb.x-ob.x);ob=new Jb;Bb+=Zb;Ea=Ea.shiftKey?-ua.decompose().rotate+Math.round(Bb/kb)*kb:Zb;ob.rotateAroundPoint(Ea,Ta.x,Ta.y);ua.preMultiply(ob);sb=Pa;
break;case 0:case 2:case 4:case 6:kb=~~(kc/2);Ta=ab.points[kb];ob=ua.getInverted().getTransformedPoint(O(P(Pa)));Pa=ab.points[(kb+2)%4];kb=(ob.x-Pa.x)/(Ta.x-Pa.x);Ta=(ob.y-Pa.y)/(Ta.y-Pa.y);if(.001>Math.abs(kb)||.001>Math.abs(Ta)||isNaN(kb)||isNaN(Ta))return!0;Ea.shiftKey&&(Ta=kb=Ea=Math.max(kb,Ta));ua.scaleAroundPoint(kb,Ta,Pa.x,Pa.y);break;case 1:case 5:case 3:case 7:Ea=~~(kc/2);ob=E(ab.points[Ea],ab.points[(Ea+1)%4]);Pa=ua.getInverted().getTransformedPoint(O(P(Pa)));Ea=E(ab.points[(Ea+2)%4],ab.points[(Ea+
3)%4]);ob=Lb.subtractPoints(ob,Ea);Pa=Lb.subtractPoints(Pa,Ea);Zb=ob.getLength();Pa=ob.getDotProduct(Pa)/Zb/Zb;if(.001>Math.abs(Pa)||isNaN(Pa))return!0;1==kc||5==kc?(Ta=1,kb=Pa):(Ta=Pa,kb=1);ua.scaleAroundPoint(Ta,kb,Ea.x,Ea.y)}return gb=ab.getTransformed(ua),Ia.transformAffineAmend(ua),Ka.repaintAll(),!0}});this.mouseUp=function(Ea,Pa,Ta){if(this.capture&&0==Pa)return this.capture=!1,kc=-1,!0};this.mouseMove=function(){this.capture||la()};this.paint=function(){var Ea=gb.getTransformed(Cb).points,
Pa=Array(2*Ea.length);for(var Ta=0;Ta<Ea.length;Ta++)Pa[Ta]=Ea[Ta];for(let ob=0;ob<Ea.length;ob++){Ta=Ea[ob];var kb=Ea[(ob+1)%Ea.length];Pa[ob+Ea.length]={x:(Ta.x+kb.x)/2,y:(Ta.y+kb.y)/2}}Le(fa,"fill");for(Ta=0;Ta<Pa.length;Ta++)fa.fillRect(Pa[Ta].x-3,Pa[Ta].y-3,7,7);Y(fa,Ea)};this.keyDown=function(Ea){return"Enter"===Ea.key?(a.actionPerformed({action:"CPTransformAccept"}),!0):"Escape"===Ea.key?(a.actionPerformed({action:"CPTransformReject"}),!0):void 0};this.enter=function(){c.prototype.enter.call(this);
var Ea,Pa=Ia.transformAffineBegin();ua=Pa.transform;Pa.rect;(Ea=Pa.selection).isEmpty()&&(Ea=Pa.rect.clone());gb=(ab=new Id(Ea.toPoints())).getTransformed(ua);kc=-1;Bb=0;Ka.repaintAll()};this.leave=function(){c.prototype.leave.call(this);Ka.repaintAll()}}function t(){var E,O,Z=0,la=!1,za=-1;this.mouseDown=function(ua,ab,gb){return!!this.capture||(!this.transient&&0==ab&&!ua.altKey&&!ma(Ub).isPressed("space")||0==ab&&!ua.altKey&&!ma(Ub).isPressed("space")&&ma(Ub).isPressed("r")?(E={x:fb,y:ib},Z=Ka.getRotation(),
O=Cb.clone(),la=!1,this.capture=!0,za=ab,!0):void(this.transient&&xa.pop()))};this.mouseDrag=function(ua){if(this.capture){var ab=sa.clientWidth/2,gb=sa.clientHeight/2;ua=sa.width/2;var sb=sa.height/2;ab=Math.atan2(ib-gb,fb-ab)-Math.atan2(E.y-gb,E.x-ab);gb=new Jb;return gb.rotateAroundPoint(ab,ua,sb),gb.multiply(O),Ka.setRotation(Z+ab),Ka.setOffset(~~gb.getTranslateX(),~~gb.getTranslateY()),la=!0,!0}};this.mouseUp=function(ua,ab,gb){if(this.capture&&ab==za){if(la){ua=Math.round(Qb/(Math.PI/2))*Math.PI/
2;if(Math.abs(Qb-ua)<5/180*Math.PI){gb=ua-Z;ua=sa.width/2;ab=sa.height/2;let sb=new Jb;sb.rotateAroundPoint(gb,ua,ab);sb.multiply(O);Ka.setRotation(Z+gb);Ka.setOffset(~~sb.getTranslateX(),~~sb.getTranslateY());Ka.repaintAll()}Ka.emitEvent("canvasRotated90",[Ka.getRotation90()])}else Ka.resetRotation();return this.capture=!1,this.transient&&!ma(Ub).isPressed("r")&&xa.pop(),!0}};this.keyUp=function(ua){if(this.transient&&1!=za&&" "===ua.key)return x("default"),xa.pop(),!0};this.keyDown=function(ua){if("r"===
ua.key.toLowerCase())return!0}}function v(){p.call(this)}function x(E){sa.getAttribute("data-cursor")!=E&&sa.setAttribute("data-cursor",E)}function D(){var E=Ia.getActiveLayer();return E.visible&&E.ancestorsAreVisible()?0!=E.alpha||(a.showLayerNotification(E,ia("Whoops! This layer's opacity is currently 0%"),"opacity"),!1):(a.showLayerNotification(E,ia("Whoops! This layer is currently hidden"),"layer"),!1)}function G(){var E=Ia.getActiveLayer();return E instanceof nb&&!Ia.isEditingMask()?(a.showLayerNotification(E,
ia("Whoops! You can't draw on a group"),"layer"),!1):D()}function N(E,O,Z,la,za){E.setValues(-za,la,O-la-za+Z/4,O+Z-za-Z/4);E.setBlockIncrement(Math.max(1,~~(.66*la)));E.setUnitIncrement(Math.max(1,~~(.05*la)))}function K(){if(Cb.setToIdentity(),Cb.translate(Yb,ic),Cb.scale(hb,hb),Cb.rotate(Qb),null!=xc&&null!=C&&!xc.getValueIsAdjusting()&&!C.getValueIsAdjusting()){var E=Aa(new Ha(0,0,La.width,La.height));N(xc,E.left,E.getWidth(),sa.clientWidth,Ka.getOffset().x);N(C,E.top,E.getHeight(),sa.clientHeight,
Ka.getOffset().y)}Ka.repaintAll()}function P(E){return Cb.getInverted().getTransformedPoint(E)}function L(E){E=P(E);return E.x=Math.floor(E.x),E.y=Math.floor(E.y),E}function ba(E){return Cb.getTransformedPoint(E)}function X(E){E=ba(E);return E.x=Math.round(E.x),E.y=Math.round(E.y),E}function Y(E,O){E.beginPath();E.moveTo(O[0].x,O[0].y);for(var Z=1;Z<O.length;Z++)E.lineTo(O[Z].x,O[Z].y);E.lineTo(O[0].x,O[0].y);E.stroke()}function ka(E,O){var Z=ba({x:(O.left+O.right)/2,y:(O.top+O.bottom)/2});O=O.toPoints();
for(var la=0;la<O.length;la++)O[la]=X(O[la]),O[la].x+=.5*Math.sign(Z.x-O[la].x),O[la].y+=.5*Math.sign(Z.y-O[la].y);Y(E,O)}function Aa(E){var O=X({x:E.left-1,y:E.top-1}),Z=X({x:E.left-1,y:E.bottom}),la=X({x:E.right,y:E.top-1});E=X({x:E.right,y:E.bottom});O=new Ha(Math.min(Math.min(O.x,Z.x),Math.min(la.x,E.x)),Math.min(Math.min(O.y,Z.y),Math.min(la.y,E.y)),Math.max(Math.max(O.x,Z.x),Math.max(la.x,E.x))+1,Math.max(Math.max(O.y,Z.y),Math.max(la.y,E.y))+1);return O.grow(2,2),O}function Ga(){var E=sa.width,
O=sa.height,Z=ba({x:Ia.width/2,y:Ia.height/2});Ka.setOffset(Math.round(Yb+E/2-Z.x),Math.round(ic+O/2-Z.y))}function U(E,O,Z){if(E=Math.max(.1,Math.min(16,E)),Ka.getZoom()!=E){var la=Ka.getOffset();Ka.setOffset(la.x+~~((O-la.x)*(1-E/Ka.getZoom())),la.y+~~((Z-la.y)*(1-E/Ka.getZoom())));Ka.setZoom(E);Ka.repaintAll()}}function ya(E){let O=sa.clientWidth,Z=sa.clientHeight,la=parseFloat(E);.01>Math.abs(la-1)?E=1:.2>Math.abs(la-2)?E=2:.08>Math.abs(la-.5)&&(E=.5);U(E,O/2,Z/2)}function pa(E){return Nb?R.getPressure():
"mouse"===E.pointerType&&0!==E.buttons&&0===E.pressure?1:"touch"===E.pointerType?(0!==E.pressure&&(vc=!0),vc)?2*E.pressure:1:2*E.pressure}function qb(){cb||(cb=!0,window.requestAnimationFrame(function(){Ka.paint()}))}function $a(E){Tb.union(E);qb()}function Gb(){cc=Ia.getBounds();Ka.repaintAll()}let Fb,Ka=this,Na=document.createElement("div"),ja=document.createElement("div"),Fa=document.createElement("div"),sa=document.createElement("canvas"),fa=sa.getContext("2d"),La=document.createElement("canvas"),
qa=La.getContext("2d"),Ra=Ng(fa),Ia=a.getArtwork(),hb=1,Yb=0,ic=0,Qb=0,Cb=new Jb,Kb=!1,yb=!1,xb=32,fb=0,ib=0,dc=!1,mb=[!1,!1,!1],Nb=!1,Ob=!1,vc=!1,cc=Ia.getBounds(),Tb=new Ha(0,0,0,0),cb=!1,db;let nc,Wa,Rc,dd,y,wc,Mc,jc,Fc=[],xa=new pc,Vb,xc=new pe(!1),C=new pe(!0),R=ed.getRef();Math.sign=Math.sign||function(E){return 0==(E*=1)||isNaN(E)?E:0<E?1:-1};c.prototype.transient=!1;c.prototype.capture=!1;c.prototype.enter=function(){x("default")};c.prototype.leave=function(){this.capture=!1};c.prototype.mouseMove=
c.prototype.paint=c.prototype.mouseDown=c.prototype.mouseDrag=c.prototype.mouseUp=c.prototype.keyDown=c.prototype.suspend=c.prototype.resume=c.prototype.keyUp=function(){};d.prototype=Object.create(c.prototype);d.prototype.constructor=d;d.prototype.mouseDown=function(E,O,Z){var la=ma(Ub).isPressed("space");!la&&(2==O||0==O&&E.altKey)?(xa.push(nc,!0),xa.peek().mouseDown(E,O,Z)):la||0!=O||E.altKey||!ma(Ub).isPressed("r")?(1==O||!E.altKey&&la&&0==O)&&(xa.push(Wa,!0),xa.peek().mouseDown(E,O,Z)):(xa.push(Rc,
!0),xa.peek().mouseDown(E,O,Z))};d.prototype.keyDown=function(E){if("r"===E.key.toLowerCase()&&" "!==E.key)xa.push(Rc,!0),xa.peek().keyDown(E);else if("r"!==E.key.toLowerCase()&&" "===E.key&&!E.altKey)return xa.push(Wa,!0),xa.peek().keyDown(E),!0};b.prototype=Object.create(c.prototype);b.prototype.constructor=b;b.prototype.getBrushPreviewOval=function(){let E=a.getBrushSize()*hb/2;return new Ha(fb-E,ib-E,fb+E,ib+E)};b.prototype.queueBrushPreview=function(){if(xa.peek()==this){this.shouldPaintBrushPreview=
!0;var E=this.getBrushPreviewOval();E.grow(2,2);null!=this.oldPreviewRect&&(E.union(this.oldPreviewRect),this.oldPreviewRect=null);$a(E)}};b.prototype.eraseBrushPreview=function(){this.shouldPaintBrushPreview=!1;null!=this.oldPreviewRect&&($a(this.oldPreviewRect),this.oldPreviewRect=null)};b.prototype.mouseMove=function(E,O){this.queueBrushPreview()};b.prototype.enter=function(){c.prototype.enter.call(this);dc&&this.queueBrushPreview()};b.prototype.leave=function(){c.prototype.leave.call(this);this.eraseBrushPreview()};
b.prototype.suspend=b.prototype.leave;b.prototype.resume=b.prototype.enter;b.prototype.paint=function(){if(this.shouldPaintBrushPreview){this.shouldPaintBrushPreview=!1;var E=this.getBrushPreviewOval();fa.beginPath();fa.arc((E.left+E.right)/2,(E.top+E.bottom)/2,E.getWidth()/2,0,2*Math.PI);fa.stroke();E.grow(2,2);null==this.oldPreviewRect?this.oldPreviewRect=E:this.oldPreviewRect.union(E)}};g.prototype=Object.create(b.prototype);g.prototype.constructor=g;g.prototype.mouseDown=function(E,O,Z){if(!this.capture&&
0==O&&!E.altKey&&!ma(Ub).isPressed("space")&&G()&&(E=P({x:fb,y:ib}),this.eraseBrushPreview(),Ia.beginStroke(E.x,E.y,Z)))return this.capture=!0,this.smoothMouse=E,!0};g.prototype.mouseDrag=function(E,O){if(("number"!=typeof navigator.maxTouchPoints||3>navigator.maxTouchPoints)&&b.prototype.mouseMove.call(this,E,O),this.capture){E=P({x:fb,y:ib});var Z=Math.min(.999,Math.pow(a.getBrushInfo().smoothing,.3));let la=1-Z;return this.smoothMouse.x=la*E.x+Z*this.smoothMouse.x,this.smoothMouse.y=la*E.y+Z*this.smoothMouse.y,
Ia.continueStroke(this.smoothMouse.x,this.smoothMouse.y,O),!0}this.mouseMove(E)};g.prototype.mouseUp=function(E,O,Z){if(this.capture)return 0==O&&(this.capture=!1,Ia.endStroke()),!0};p.prototype=Object.create(b.prototype);p.prototype.constructor=p;p.prototype.drawLine=function(E,O){Ia.beginStroke(E.x,E.y,1);Ia.continueStroke(O.x,O.y,1);Ia.endStroke()};f.prototype=Object.create(b.prototype);f.prototype.constructor=f;e.prototype=Object.create(c.prototype);e.prototype.constructor=e;m.prototype=Object.create(c.prototype);
m.prototype.constructor=m;l.prototype=Object.create(c.prototype);l.prototype.constructor=l;l.prototype.mouseDown=function(E,O,Z){if(0==O&&!E.altKey&&!ma(Ub).isPressed("space")&&G())return E=P({x:fb,y:ib}),Ia.isPointWithin(E.x,E.y)&&(Ia.floodFill(E.x,E.y),Ka.repaintAll()),!0};h.prototype=Object.create(c.prototype);h.prototype.constructor=h;n.prototype=Object.create(c.prototype);n.prototype.constructor=n;n.prototype.mouseMove=function(E){if(!ma(Ub).isPressed("r"))return x("move"),!0};n.prototype.enter=
function(){x("move")};r.prototype=Object.create(c.prototype);r.prototype.constructor=r;t.prototype=Object.create(c.prototype);t.prototype.constructor=t;v.prototype=Object.create(p.prototype);v.prototype.constructor=v;v.prototype.drawLine=function(E,O){Ia.gradientFill(Math.round(E.x),Math.round(E.y),Math.round(O.x),Math.round(O.y),a.getCurGradient())};v.prototype.queueBrushPreview=function(){};this.setZoom=function(E){hb=E;K()};this.getZoom=function(){return hb};this.setGridSize=function(E){xb=Math.max(Math.round(E),
1);this.repaintAll()};this.getGridSize=function(){return xb};this.setOffset=function(E,O){isNaN(E)||isNaN(O)?console.log("Bad offset"):(Yb=E,ic=O,K())};this.getOffset=function(){return{x:Yb,y:ic}};this.setInterpolation=function(E){Kb=E;sf(fa,E);this.repaintAll()};this.setRotation=function(E){Qb=E%(2*Math.PI);K()};this.getRotation=function(){return Qb};this.getRotation90=function(){var E=Math.round(this.getRotation()/Math.PI*2);return 0>(E%=4)&&(E+=4),E};this.zoomIn=function(){ya(1.41*this.getZoom())};
this.zoomOut=function(){ya(.7092*this.getZoom())};this.zoom100=function(){ya(1);Ga()};this.resetRotation=function(){var E=sa.width/2,O=sa.height/2,Z=new Jb;Z.rotateAroundPoint(-this.getRotation(),E,O);Z.multiply(Cb);this.setOffset(~~Z.getTranslateX(),~~Z.getTranslateY());this.setRotation(0);Ka.emitEvent("canvasRotated90",[0])};let da=!1;this.getElement=function(){return Na};this.repaintAll=function(){Tb.left=0;Tb.top=0;Tb.right=sa.width;Tb.bottom=sa.height;qb()};this.paint=function(){var E=!1;if(cb=
!1,Tb.isEmpty()||(fa.save(),fa.clipTo&&(fa.beginPath(),Tb.left|=0,Tb.top|=0,fa.rect(Tb.left,Tb.top,Math.ceil(Tb.getWidth()),Math.ceil(Tb.getHeight())),fa.clip()),E=!0),!cc.isEmpty()){var O=db&&db.isOpen()?db.getImageData():Ia.fusionLayers().getImageData();qa.putImageData(O,0,0,cc.left,cc.top,cc.getWidth(),cc.getHeight());cc.makeEmpty()}if(fa.fillStyle="#606060",fa.fillRect(0,0,sa.width,sa.height),fa.save(),fa.setTransform(Cb.m[0],Cb.m[1],Cb.m[2],Cb.m[3],Cb.m[4],Cb.m[5]),fa.fillStyle=Ra,fa.fillRect(0,
0,Ia.width,Ia.height),fa.drawImage(La,0,0,La.width,La.height),fa.restore(),Le(fa,"stroke"),fa.lineWidth=1,Ia.getSelection().isEmpty()||xa.peek()instanceof h&&xa.peek().capture||(fa.setLineDash([3,2]),ka(fa,Ia.getSelection()),fa.setLineDash([])),yb)if(O=Ia.getBounds(),2<hb*xb){fa.beginPath();for(var Z=xb-1;Z<O.right;Z+=xb){var la=ba({x:Z,y:O.top}),za=ba({x:Z,y:O.bottom});fa.moveTo(la.x+.5,la.y+.5);fa.lineTo(za.x+.5,za.y+.5)}for(Z=xb-1;Z<O.bottom;Z+=xb)la=ba({x:0,y:Z}),za=ba({x:O.right,y:Z}),fa.moveTo(la.x+
.5,la.y+.5),fa.lineTo(za.x+.5,za.y+.5);fa.stroke()}xa.paint(fa);fa.globalCompositeOperation="source-over";E&&(Tb.makeEmpty(),fa.restore())};this.showGrid=function(E){yb=E;this.repaintAll()};this.resize=function(E,O){E-=Fa.offsetHeight;sa.style.height=E+"px";sa.width=sa.clientWidth;sa.height=E;Fb=null;O||Ga();this.setInterpolation(Kb);this.repaintAll()};a.on("toolChange",function(E,O){E=Fc[O.strokeMode];for(O=0;O<xa.modes.length;O++)if(xa.modes[O]instanceof b){xa.modes[O].leave();xa.modes[O]=E;xa.modes[O].enter();
break}Vb=E});a.on("modeChange",function(E){switch(E){case na.M_DRAW:var O=Vb;break;case na.M_FLOODFILL:O=dd;break;case na.M_GRADIENTFILL:O=y;break;case na.M_RECT_SELECTION:O=wc;break;case na.M_MOVE_TOOL:O=Mc;break;case na.M_ROTATE_CANVAS:O=Rc;break;case na.M_PAN_CANVAS:O=Wa;break;case na.M_COLOR_PICKER:O=nc;break;case na.M_TRANSFORM:O=jc}xa.setUserMode(O)});a.on("maskViewOpened",function(E){db&&db.off("changeLayer",Gb);(db=E).on("changeLayer",Gb);Gb()});var ea=new d;nc=new e;Wa=new m;Rc=new t;dd=
new l;y=new v;wc=new h;Mc=new n;jc=new r;Vb=(Fc=[new g,new p,new f])[Ca.STROKE_MODE_FREEHAND];xa.setDefaultMode(ea);xa.setUserMode(Vb);La.width=Ia.width;La.height=Ia.height;sa.width=800;sa.height=900;sa.className="chickenpaint-canvas";sa.setAttribute("touch-action","none");fa.setLineDash||(fa.setLineDash=function(){});sa.addEventListener("contextmenu",function(E){E.preventDefault()});sa.addEventListener("mouseenter",function(){dc=!0});sa.addEventListener("mouseleave",function(){dc=!1;mb[0]||mb[2]||
mb[1]||Ka.repaintAll()});sa.addEventListener("pointerdown",function(E){Ob&&"touch"===E.pointerType||(sa.setPointerCapture(E.pointerId),Fb=sa.getBoundingClientRect(),fb=E.clientX-Fb.left,ib=E.clientY-Fb.top,Nb=R.isPen(),mb[0]=!1,mb[2]=!1,mb[1]=!1,mb[E.button]=!0,xa.mouseDown(E,E.button,pa(E)))});sa.addEventListener("pointermove",function(E){if(Fb||=sa.getBoundingClientRect(),!Ob||"touch"!==E.pointerType){fb=E.clientX-Fb.left;ib=E.clientY-Fb.top;var O=0!==E.buttons,Z=O?pa(E):0;if(0!=(1&E.buttons)!=
mb[0]){if(.5===E.mozPressure)return;mb[0]=!mb[0];mb[0]?xa.mouseDown(E,0,Z):xa.mouseUp(E,0,Z)}0!=(2&E.buttons)!=mb[2]&&(mb[2]=!mb[2],mb[2]?xa.mouseDown(E,2,Z):xa.mouseUp(E,2,Z));0!=(4&E.buttons)!=mb[1]&&(mb[1]=!mb[1],mb[1]?xa.mouseDown(E,1,Z):xa.mouseUp(E,1,Z));O?xa.mouseDrag(E,Z):xa.mouseMove(E,Z);Ob||"pen"!==E.pointerType||(Ob=!0)}});sa.addEventListener("pointerup",function(E){mb[0]=!1;mb[2]=!1;Nb=mb[1]=!1;xa.mouseUp(E,E.button,0);sa.releasePointerCapture(E.pointerId)});sa.addEventListener("wheel",
function(E){if(0!=E.deltaY){if(!da||20<Math.abs(E.deltaY)){var O,Z;let la;la=0<E.deltaY?1/1.15:1.15;let za=(O={x:E.pageX,y:E.pageY},Z=sa.getBoundingClientRect(),{x:O.x-Z.left-window.pageXOffset,y:O.y-Z.top-window.pageYOffset});O=P(za);Ia.isPointWithin(O.x,O.y)?U(Ka.getZoom()*la,za.x,za.y):U(Ka.getZoom()*la,Yb+~~(Ia.width*hb/2),ic+~~(Ia.height*hb/2));da=da||setTimeout(function(){da=!1},50)}E.preventDefault()}},{passive:!1});document.addEventListener("keydown",function(E){xa.keyDown(E)});document.addEventListener("keyup",
function(E){"alt"===E.key.toLowerCase()&&E.preventDefault();xa.keyUp(E)});document.addEventListener("visibilitychange",function(){let E=sa.height+Fa.offsetHeight;sa.width=1;sa.height=1;Ka.resize(E,!0)},!1);window.addEventListener("scroll",function(){Fb=null});sa.addEventListener("mousedown",function(E){1==E.button&&E.preventDefault()});Ia.on("changeSelection",function(){Ka.repaintAll()});Ia.on("updateRegion",function(E){cc.union(E);$a(Aa(cc))});xc.on("valueChanged",function(E){var O=Ka.getOffset();
Ka.setOffset(-E,O.y)});C.on("valueChanged",function(E){var O=Ka.getOffset();Ka.setOffset(O.x,-E)});this.setInterpolation(!0);ea=document.createElement("div");ea.className="chickenpaint-canvas-container-wrapper";ea.appendChild(sa);ja.className="chickenpaint-canvas-container-top";ja.appendChild(ea);ja.appendChild(C.getElement());Fa.className="chickenpaint-canvas-container-bottom";Fa.appendChild(xc.getElement());Na.appendChild(ja);Na.appendChild(Fa);a.setCanvas(this)}function lc(a,c,d,b){a.getSmallScreenMode()&&
ia(d+" (shorter)")!==d+" (shorter)"?this.title=ia(d+" (shorter)"):this.title=ia(d);b=b||{};this.name=c;this.resizeVert=b.resizeVert||!1;this.resizeHorz=b.resizeHorz||!1;let g=document.createElement("div");d=document.createElement("div");let p=document.createElement("i"),f=document.createElement("button"),e=document.createElement("div"),m=null,l=null,h,n,r,t=this;this.getElement=function(){return g};this.getBodyElement=function(){return e};this.getWidth=function(){return ma(Ba)(g).outerWidth()};this.getHeight=
function(){return ma(Ba)(g).outerHeight()};this.getX=function(){return parseInt(g.style.left,10)||0};this.getY=function(){return parseInt(g.style.top,10)||0};this.setLocation=function(x,D){g.style.left=x+"px";g.style.top=D+"px"};this.setWidth=function(x){g.style.width=x+"px"};this.setHeight=function(x){g.style.height=x+"px"};this.setSize=function(x,D){this.setWidth(x);this.setHeight(D)};this.setCollapseDownwards=function(x){b.collapseDownwards=x};this.toggleCollapse=function(x){let D=ma(Ba)(g);if(void 0===
x)x=!D.hasClass("collapsed");else if(D.hasClass("collapsed")==x)return;let G=D.parents(".chickenpaint").find(".chickenpaint-canvas").height();var N=this.getHeight();N=this.getY()+N;(D.toggleClass("collapsed",x),ma(Ba)(p).toggleClass("icon-angle-down",!x).toggleClass("icon-angle-up",x),x)?b.collapseDownwards&&this.setLocation(this.getX(),Math.min(N,G)-this.getHeight()):(x=this.getHeight(),b.collapseDownwards?this.setLocation(this.getX(),Math.max(N-x,0)):this.getY()+x>G&&this.setLocation(this.getX(),
Math.max(G-x,0)))};this.userIsDoneWithUs=function(){a.getSmallScreenMode()&&this.toggleCollapse(!0)};p.className="collapse-icon fas icon-angle-down";f.type="button";f.className="btn btn-close";f.textContent="";f.tabIndex=-1;g.className="chickenpaint-palette chickenpaint-palette-"+c;d.className="chickenpaint-palette-head";d.setAttribute("touch-action","none");c=document.createElement("div");let v=document.createElement("h5");c.className="modal-header";v.className="modal-title";v.appendChild(document.createTextNode(this.title));
v.appendChild(p);c.appendChild(v);c.appendChild(f);d.appendChild(c);e.className="chickenpaint-palette-body";g.appendChild(d);g.appendChild(e);this.resizeVert&&((m=document.createElement("div")).className="chickenpaint-resize-handle-vert",m.addEventListener("pointerdown",function(x){n="vertResize";m.setPointerCapture(x.pointerId)}),m.addEventListener("pointermove",function(x){"vertResize"==n&&t.setHeight(x.pageY-ma(Ba)(g).offset().top)}),m.addEventListener("pointerup",function(x){m.releasePointerCapture(x.pointerId);
n=!1}),g.appendChild(m));this.resizeHorz&&((l=document.createElement("div")).className="chickenpaint-resize-handle-horz",l.addEventListener("pointerdown",function(x){n="horzResize";l.setPointerCapture(x.pointerId)}),l.addEventListener("pointermove",function(x){"horzResize"==n&&t.setWidth(x.pageX-ma(Ba)(g).offset().left)}),l.addEventListener("pointerup",function(x){l.releasePointerCapture(x.pointerId);n=!1}),g.appendChild(l));d.addEventListener("pointerdown",function(x){0==x.button&&(x.stopPropagation(),
x.preventDefault(),"BUTTON"==x.target.nodeName?t.emitEvent("paletteVisChange",[t,!1]):(h={x:parseInt(g.style.left,10)||0,y:parseInt(g.style.top,10)||0},r={x:x.pageX-ma(Ba)(g).position().left,y:x.pageY-ma(Ba)(g).position().top},n=a.getSmallScreenMode()?"dragStart":"dragging",x.target.setPointerCapture(x.pointerId)))});d.addEventListener("pointermove",function(x){if(("dragStart"===n||"dragging"===n)&&0!==x.buttons){let N=x.pageX-r.x,K=x.pageY-r.y;if("dragStart"==n){x=N;var D=K;var G=h;25<(x-G.x)*(x-
G.x)+(D-G.y)*(D-G.y)&&(n="dragging")}"dragging"==n&&t.setLocation(N,K)}});d.addEventListener("pointerup",function(x){if("dragging"===n||"dragStart"===n){"dragStart"===n&&(x.stopPropagation(),x.preventDefault(),setTimeout(()=>{t.setLocation(h.x,h.y);t.toggleCollapse()},100));n=!1;try{x.target.releasePointerCapture(x.pointerId)}catch(D){console.error(D)}}})}function Ne(a){function c(f){"LI"==this.nodeName&&(f=b[parseInt(this.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:f.command}))}
lc.call(this,a,"tool","Tools");let d=this,b=[{className:"chickenpaint-tool-rect-selection",command:"CPRectSelection",toolTip:"Marquee",shortcut:"m",mode:na.M_RECT_SELECTION},{className:"chickenpaint-tool-move",command:"CPMoveTool",toolTip:"Move tool",shortcut:"v",mode:na.M_MOVE_TOOL},{className:"chickenpaint-tool-flood-fill",command:"CPFloodFill",toolTip:"Flood fill",shortcut:"f",mode:na.M_FLOODFILL},{className:"chickenpaint-tool-gradient-fill",command:"CPGradientFill",toolTip:"Gradient fill",shortcut:"g",
mode:na.M_GRADIENTFILL},{className:"chickenpaint-tool-color-picker",command:"CPColorPicker",toolTip:"Color picker",shortcut:"i",mode:na.M_COLOR_PICKER},{className:"chickenpaint-tool-blur",command:"CPBlur",toolTip:"Blur",shortcut:"u",mode:na.M_DRAW,tool:na.T_BLUR},{className:"chickenpaint-tool-pencil",command:"CPPencil",toolTip:"Pencil",shortcut:"n",mode:na.M_DRAW,tool:na.T_PENCIL},{className:"chickenpaint-tool-pen",command:"CPPen",toolTip:"Pen",selected:!0,shortcut:"b",mode:na.M_DRAW,tool:na.T_PEN},
{className:"chickenpaint-tool-airbrush",command:"CPAirbrush",toolTip:"Airbrush",shortcut:"a",mode:na.M_DRAW,tool:na.T_AIRBRUSH},{className:"chickenpaint-tool-water",command:"CPWater",toolTip:"Waterpaint",shortcut:"w",mode:na.M_DRAW,tool:na.T_WATER},{className:"chickenpaint-tool-eraser",command:"CPEraser",toolTip:"Eraser",shortcut:"e",mode:na.M_DRAW,tool:na.T_ERASER},{className:"chickenpaint-tool-soft-eraser",command:"CPSoftEraser",toolTip:"Soft eraser",shortcut:"s",mode:na.M_DRAW,tool:na.T_SOFTERASER},
{className:"chickenpaint-tool-smudge",command:"CPSmudge",toolTip:"Smudge",shortcut:"d",mode:na.M_DRAW,tool:na.T_SMUDGE},{className:"chickenpaint-tool-blender",command:"CPBlender",toolTip:"Blender",shortcut:"c",mode:na.M_DRAW,tool:na.T_BLENDER},{className:"chickenpaint-tool-dodge",command:"CPDodge",toolTip:"Dodge (tool)",shortcut:"o",mode:na.M_DRAW,tool:na.T_DODGE},{className:"chickenpaint-tool-burn",command:"CPBurn",toolTip:"Burn (tool)",shortcut:"p",mode:na.M_DRAW,tool:na.T_BURN},{className:"chickenpaint-tool-rotate-canvas",
command:"CPRotateCanvas",commandDoubleClick:"CPResetCanvasRotation",toolTip:"Rotate canvas",mode:na.M_ROTATE_CANVAS},{className:"chickenpaint-tool-pan-canvas",command:"CPPanCanvas",toolTip:"Grab canvas",mode:na.M_PAN_CANVAS}],g=document.createElement("ul");a.on("modeChange",function(f){let e=d.getBodyElement();(e.querySelectorAll("li").forEach(function(m){m.classList.remove("selected")}),f==na.M_DRAW)?(f=e.querySelector(`li[data-tool="${a.getCurTool()}"]`))&&f.classList.add("selected"):(f=e.querySelector(`li[data-mode="${f}"]`))&&
f.classList.add("selected")});a.on("toolChange",function(f){let e=d.getBodyElement();a.getCurMode()==na.M_DRAW&&(e.querySelectorAll("li").forEach(function(m){m.classList.remove("selected")}),(f=e.querySelector(`li[data-tool="${f}"]`))&&f.classList.add("selected"))});let p=d.getBodyElement();for(let f in g.className="chickenpaint-tools list-unstyled",b)!function(e){let m=b[e],l=document.createElement("li"),h=document.createElement("div");l.className="chickenpaint-toolbar-button "+m.className;l.setAttribute("data-buttonIndex",
e);l.setAttribute("data-mode",m.mode);void 0!==m.tool&&l.setAttribute("data-tool",m.tool);l.title=ia(m.toolTip);m.shortcut&&(l.title+=" ("+m.shortcut.toUpperCase()+")",ma(Ub)(m.shortcut,function(){return c.call(l),!1}));m.selected&&(l.className+=" selected");h.className="chickenpaint-toolbar-button-icon";l.appendChild(h);g.appendChild(l)}(f);g.addEventListener("click",function(f){let e=f.target.closest("li");e&&c.call(e,f)});g.addEventListener("dblclick",function(f){if(f=f.target.closest("li"))f=
b[parseInt(f.getAttribute("data-buttonIndex"),10)],f.commandDoubleClick&&a.actionPerformed({action:f.commandDoubleClick})});p.appendChild(g)}function Oe(a){lc.call(this,a,"misc","Misc");let c=this,d=[{className:"chickenpaint-tool-zoom-in",command:"CPZoomIn",toolTip:"Zoom in"},{className:"chickenpaint-tool-zoom-out",command:"CPZoomOut",toolTip:"Zoom out"},{className:"chickenpaint-tool-zoom-100",command:"CPZoom100",toolTip:"Zoom 100%"},{className:"chickenpaint-tool-flip-horizontal",command:"CPHFlip",
toolTip:"Flip horizontal"},{className:"chickenpaint-tool-undo",command:"CPUndo",toolTip:"Undo"},{className:"chickenpaint-tool-redo",command:"CPRedo",toolTip:"Redo"},{className:"chickenpaint-tool-send",command:"CPSend",toolTip:"Save Oekaki"}];!function(){let b=c.getBodyElement(),g=document.createElement("ul");for(let p in g.className="chickenpaint-misc-tools list-unstyled",d){let f=d[p],e=document.createElement("li"),m=document.createElement("div");"CPSend"!=f.command||a.isActionSupported("CPContinue")||
(f.toolTip="Post Oekaki",f.className="chickenpaint-tool-send-and-end");e.className="chickenpaint-toolbar-button "+f.className;e.setAttribute("data-buttonIndex",p);e.setAttribute("title",ia(f.toolTip));m.className="chickenpaint-toolbar-button-icon";e.appendChild(m);g.appendChild(e)}g.addEventListener("click",function(p){if(p=p.target.closest("li"))p=d[parseInt(p.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:p.command})});b.appendChild(g)}()}function Pe(a){lc.call(this,a,"stroke",
"Stroke");let c=[{className:"chickenpaint-tool-freehand",command:"CPFreeHand",toolTip:ia("Free-hand"),selected:!0},{className:"chickenpaint-tool-line",command:"CPLine",toolTip:ia("Straight line")},{className:"chickenpaint-tool-bezier",command:"CPBezier",toolTip:ia("Bezier curve")}],d=this.getBodyElement(),b=document.createElement("ul");for(let g in b.className="chickenpaint-stroke-tools list-unstyled",c){let p=c[g],f=document.createElement("li"),e=document.createElement("div");f.className="chickenpaint-toolbar-button "+
p.className;f.setAttribute("data-buttonIndex",g);f.setAttribute("title",p.toolTip);p.selected&&(f.className+=" selected");e.className="chickenpaint-toolbar-button-icon";f.appendChild(e);b.appendChild(f)}b.addEventListener("click",function(g){if(g=g.target.closest("li"))g=c[parseInt(g.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:g.command})});d.appendChild(b);a.on("toolChange",function(g,p){g=document.querySelector(".chickenpaint-tool-freehand");let f=document.querySelector(".chickenpaint-tool-line"),
e=document.querySelector(".chickenpaint-tool-bezier");g&&g.classList.toggle("selected",p.strokeMode==Ca.STROKE_MODE_FREEHAND);f&&f.classList.toggle("selected",p.strokeMode==Ca.STROKE_MODE_LINE);e&&e.classList.toggle("selected",p.strokeMode==Ca.STROKE_MODE_BEZIER)})}function Cc(a,c,d){return c in a?Object.defineProperty(a,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[c]=d,a}function Qe(a){lc.call(this,a,"color","Color (picker)");let c=new Og(a),d=new Pg(a,c);a=new Lh(a);let b=this.getBodyElement(),
g=document.createElement("div");g.className="chickenpaint-colorpicker-top";g.appendChild(c.getElement());g.appendChild(d.getElement());b.appendChild(g);b.appendChild(a.getElement())}function Lh(a){function c(p,f,e){for(;p.length<e;)p=f+p;return p}function d(){g.style.backgroundColor="#"+c(Number(b).toString(16),"0",6)}let b=0,g=document.createElement("div");this.getElement=function(){return g};a.on("colorChange",function(p){b=p.getRgb();d()});g.className="chickenpaint-colorpicker-show";g.addEventListener("click",
function(p){p.preventDefault();p="#"+c(Number(b).toString(16),"0",6);if(null!=(p=window.prompt(ia("Please enter a color in hex format"),p)))try{(p.match(/^#/)||p.match(/^$/))&&(p=p.substring(1));let f=parseInt(p,16);a.setCurColor(new Ab(f))}catch(f){}});d()}function Vd(a,c){function d(){var f=b.width;g.clearRect(0,0,f,b.height);g.beginPath();g.arc(f/2+1,f/2+1,Math.max(f/2,1)-2,0,2*Math.PI);p.state?g.fill():g.stroke()}var b=document.createElement("canvas"),g=b.getContext("2d"),p=this;this.state=a||
!1;this.setValue=function(f){this.state!=f&&(this.state=f,this.emitEvent("valueChange",[f]),d())};this.getElement=function(){return b};b.addEventListener("mousedown",function(f){p.setValue(!p.state)});b.title=c||"";b.className="chickenpaint-checkbox";b.width=20;b.height=20;b.fillStyle="black";b.strokeStyle="black";d()}function Hc(a,c,d,b,g=150){function p(){let x=m.width||g,D=m.height,G="string"==typeof v.title?ia(v.title):v.title(v.value),N=3*window.devicePixelRatio,K=.75*m.height;if(d)l.save(),
l.fillStyle="white",l.fillRect(0,0,x,D),l.fillStyle="black",l.fillText(G,N,K),l.beginPath(),v.value>=h/2?l.rect(x/2,0,(v.value-h/2)*x/h,D):l.rect(v.value*x/h,0,(h/2-v.value)*x/h,D),l.fill(),l.clip(),l.fillStyle="white";else{var P=(v.value-a)/h;b&&(P=Math.pow(P,.6666666666666666));P*=x;l.save();l.save();l.fillStyle="black";l.beginPath();l.rect(0,0,P,D);l.fill();l.clip();l.fillStyle="white";l.fillText(G,N,K);l.restore();l.fillStyle="white";l.beginPath();l.rect(P,0,x,D);l.fill();l.clip();l.fillStyle=
"black"}l.fillText(G,N,K);l.restore()}function f(x){let D=m.clientWidth,G=m.getBoundingClientRect().left+window.scrollX;x=(x.pageX-G)/D;b&&(x=Math.pow(Math.max(x,0),1.5));v.setValue(x*h+a)}function e(x){switch(n){case 1:return f(x);case 2:var D=v.title();if(!D.includes(ia("Brush size"))&&!D.includes(ia("Opacity")))return f(x);D=(x.pageX-r)/4;if(0!==D){D=v.value+D;let G=Math.floor(D);v.setValue(G);r=x.pageX-4*(D-G)}}}let m=document.createElement("canvas"),l=m.getContext("2d"),h=c-a,n=0,r,t=!1,v=this;
this.value=void 0;this.title="";d=d||!1;m.addEventListener("pointerup",x=>{if(0===n)return m.releasePointerCapture(x.pointerId),m.removeEventListener("pointermove",e);if(0!==n)switch(n){case 1:0!==x.button||x.shiftKey||(n=0);break;case 2:(2==x.button||0===x.button&&x.shiftKey)&&(n=0);break;default:return}return m.releasePointerCapture(x.pointerId),m.removeEventListener("pointermove",e)});this.setValue=function(x){x=~~Math.max(a,Math.min(c,x));this.value!=x&&(this.value=x,this.emitEvent("valueChange",
[this.value]),t?p():(t=!0,this.resize()))};this.getElement=function(){return m};this.resize=function(){m.width=m.clientWidth||g;m.height=m.clientHeight||20;1<window.devicePixelRatio&&(m.style.height=m.height+"px",m.width*=window.devicePixelRatio,m.height*=window.devicePixelRatio);l.font=.47*m.height+"pt sans-serif";p()};m.addEventListener("pointerdown",function(x){0===n&&(2===x.button||0===x.button&&x.shiftKey?(n=2,r=x.pageX):(n=1,f(x)),m.setPointerCapture(x.pointerId),m.addEventListener("pointermove",
e))});m.addEventListener("contextmenu",function(x){x.preventDefault()});m.setAttribute("touch-action","none");m.className="chickenpaint-slider";"devicePixelRatio"in window||(window.devicePixelRatio=1)}function qe(a,c,d){function b(){for(var h=e.style,n=Number(p.getRgb()).toString(16);6>n.length;)n="0"+n;h.backgroundColor="#"+n}let g=this,p=new Ab(0),f=255,e=document.createElement("div");this.getElement=function(){return e};this.setColor=function(h){p.isEqual(h)||(p.copyFrom(h),b(),this.emitEvent("colorChange",
[p]))};this.setAlpha=function(h){h!=f&&(f=h,b(),this.emitEvent("alphaChange",[f]))};this.getColorRgb=function(){return p.getRgb()};this.getAlpha=function(){return f};this.setCurColor=this.setColor;e.className="chickenpaint-color-pick-swatch";a&&p.copyFrom(a);c&&(f=c);let m=new qc.Popover(e,{html:!0,content:function(){return window.addEventListener("mousedown",l),function(){let h=document.createElement("div"),n=document.createElement("div"),r=new Og(g,p),t=new Pg(g,r,p.getHue()),v=new Hc(0,255);return h.className=
"chickenpaint-color-pick-panel",n.className="chickenpaint-colorpicker-top",n.appendChild(r.getElement()),n.appendChild(t.getElement()),h.appendChild(n),v.value=f,v.title=function(x){return ia("Opacity: ")+x},v.on("valueChange",function(x){g.setAlpha(x)}),h.appendChild(v.getElement()),setTimeout(function(){v.resize()},0),h}()},trigger:"manual",placement:"bottom",container:d||!1}),l=function(h){var n=h.target;n=n.closest(".popover-body")||n.classList.contains("chickenpaint-color-pick-panel")||n.classList.contains("chickenpaint-colorpicker-select")||
n.classList.contains("chickenpaint-colorpicker-slider");h.preventDefault();n||m.hide()};e.addEventListener("click",function(h){h.preventDefault();m.toggle()});e.addEventListener("hidden.bs.popover",function(){window.removeEventListener("mousedown",l)});b()}function Kf(a,c){let d=document.createElement("div");return d.className="chickenpaint-checkbox-slider-group",d.appendChild(a.getElement()),d.appendChild(c.getElement()),d}function Qg(a,c){for(let d in c)if(c.hasOwnProperty(d)){let b=document.createElement("option");
b.appendChild(document.createTextNode(ia(c[d])));b.value=d;a.appendChild(b)}}function Mh(a){function c(){p.gradient(p.getBounds(),0,0,p.width,0,m,!0);e.putImageData(p.imageData,0,0,0,0,150,32);b.fillRect(0,0,d.width,d.height);b.drawImage(f,0,0)}let d=document.createElement("canvas"),b=d.getContext("2d"),g=Ng(b),p=new H(150,32),f=document.createElement("canvas"),e=f.getContext("2d"),m=a.getCurGradient();this.getElement=function(){return d};a.on("gradientChange",function(l){m=l;c()});d.width=f.width=
150;d.height=f.height=32;d.className="chickenpaint-gradient-preview";b.fillStyle=g;c()}function Wd(a){lc.call(this,a,"brush","Tool options");let c=new Nh(a),d=new Oh(a),b=new Ph(a),g=this.getBodyElement();g.addEventListener("touchmove",p=>{p.preventDefault()},{passive:!1});g.appendChild(c.getElement());g.appendChild(d.getElement());g.appendChild(b.getElement());a.on("modeChange",function(p){switch(c.getElement().style.display="none",d.getElement().style.display="none",b.getElement().style.display=
"none",p){case na.M_GRADIENTFILL:d.getElement().style.display="block";break;case na.M_TRANSFORM:b.getElement().style.display="block";break;default:c.getElement().style.display="block"}})}function Nh(a){let c=[1,2,3,4,5,6,7,8,9,10,15,20,25,30,35,40,45,50,60,70,80,90,100,125,150,175,200],d=document.createElement("div"),b=document.createElement("select"),g=new Vd(!1,ia("Control brush opacity with pen pressure")),p=new Hc(1,255),f=new Vd(!0,ia("Control brush size with pen pressure")),e=new Hc(1,200,!1,
!0),m=new Vd(!1,ia("Control brush scattering with pen pressure")),l=new Hc(0,1E3,!1,!0),h=new Hc(0,100,!1,!0),n=new Hc(0,100,!1,!0),r=new Hc(0,100,!1,!0),t=new Hc(0,100,!1,!0),v=new Wd.CPBrushPreview(a);this.getElement=function(){return d};p.title=function(x){return ia("Opacity")+": "+x};p.on("valueChange",function(x){a.setAlpha(x)});e.title=function(x){return ia("Brush size")+": "+x};e.on("valueChange",function(x){a.setBrushSize(x)});h.title=function(x){return ia("Color")+": "+x+"%"};h.on("valueChange",
function(x){a.getBrushInfo().resat=x/100;a.callToolListeners()});n.title=function(x){return ia("Blend")+": "+x+"%"};n.on("valueChange",function(x){a.getBrushInfo().bleed=x/100;a.callToolListeners()});r.title=function(x){return ia("Spacing")+": "+x+"%"};r.on("valueChange",function(x){a.getBrushInfo().spacing=x/100;a.callToolListeners()});l.title=function(x){return ia("Scattering")+": "+x+"%"};l.on("valueChange",function(x){a.getBrushInfo().scattering=x/100;a.callToolListeners()});t.title=function(x){return ia("Smoothing")+
": "+x+"%"};t.on("valueChange",function(x){a.getBrushInfo().smoothing=x/100;a.callToolListeners()});m.on("valueChange",function(x){a.getBrushInfo().pressureScattering=x;a.callToolListeners()});g.on("valueChange",function(x){a.getBrushInfo().pressureAlpha=x;a.callToolListeners()});f.on("valueChange",function(x){a.getBrushInfo().pressureSize=x;a.callToolListeners()});b.addEventListener("change",function(x){a.getBrushInfo().tip=parseInt(b.value,10);b.blur()});b.className="form-control form-control-sm";
b.tabIndex=-1;Qg(b,["Round Pixelated","Round Hard Edge","Round Soft","Square Pixelated","Square Hard Edge"]);d.appendChild(b);d.appendChild(v.getElement());d.appendChild(Kf(f,e));d.appendChild(Kf(g,p));d.appendChild(h.getElement());d.appendChild(n.getElement());d.appendChild(r.getElement());d.appendChild(Kf(m,l));d.appendChild(t.getElement());g.setValue(a.getBrushInfo().pressureAlpha);p.setValue(a.getAlpha());f.setValue(a.getBrushInfo().pressureSize);e.setValue(a.getBrushSize());m.setValue(a.getBrushInfo().pressureScattering);
l.setValue(~~(100*a.getBrushInfo().scattering));b.value=a.getBrushInfo().tip;h.setValue(~~(100*a.getBrushInfo().resat));n.setValue(~~(100*a.getBrushInfo().bleed));r.setValue(~~(100*a.getBrushInfo().spacing));t.setValue(~~(100*a.getBrushInfo().smoothing));a.on("toolChange",function(x,D){p.setValue(D.alpha);e.setValue(D.size);f.setValue(D.pressureSize);g.setValue(D.pressureAlpha);b.value=D.tip;m.setValue(D.pressureScattering);~~(100*D.resat)!=h.value&&h.setValue(~~(100*D.resat));~~(100*D.bleed)!=n.value&&
n.setValue(~~(100*D.bleed));~~(100*D.spacing)!=r.value&&r.setValue(~~(100*D.spacing));~~(100*D.scattering)!=l.value&&l.setValue(~~(100*D.scattering));~~(100*D.smoothing)!=t.value&&t.setValue(~~(100*D.smoothing))});ma(Ub)("1,2,3,4,5,6,7,8,9,0",function(x,D){x=parseInt(D.shortcut,10);0==x&&(x=10);a.setAlpha(Math.round(x/10*255))});ma(Ub)("{,[",function(){let x=a.getBrushSize();for(let D=c.length-1;0<=D;D--)if(x>c[D]){a.setBrushSize(c[D]);break}});ma(Ub)("},]",function(){let x=a.getBrushSize();for(let D=
0;D<c.length;D++)if(x<c[D]){a.setBrushSize(c[D]);break}})}function Oh(a){function c(){let e=[p.getAlpha()<<24|p.getColorRgb(),f.getAlpha()<<24|f.getColorRgb()];a.setCurGradient(e)}var d;let b=document.createElement("div");var g=new Mh(a);let p=new qe(new Ab(16777215&a.getCurGradient()[0]),a.getCurGradient()[0]>>>24,b),f=new qe(new Ab(16777215&a.getCurGradient()[1]),a.getCurGradient()[1]>>>24,b);this.getElement=function(){return b};b.className="chickenpaint-gradient-panel";b.style.display="none";p.on("colorChange",
c);p.on("alphaChange",c);f.on("colorChange",c);f.on("alphaChange",c);(d=document.createElement("p")).textContent=ia("Gradient");b.appendChild(d);b.appendChild(g.getElement());(d=document.createElement("div")).className="chickenpaint-gradient-colors";(g=document.createElement("div")).className="chickenpaint-gradient-start-color";g.appendChild(p.getElement());d.appendChild(g);(g=document.createElement("div")).className="chickenpaint-gradient-end-color";g.appendChild(f.getElement());d.appendChild(g);
b.appendChild(d)}function Ph(a){var c={smooth:ia("Smooth"),sharp:ia("Sharp")};let d=document.createElement("div"),b=document.createElement("button"),g=document.createElement("button");var p=document.createElement("select");if(this.getElement=function(){return d},d.className="chickenpaint-transform-panel",d.style.display="none",b.type="button",g.type="button",b.className="btn btn-primary btn-block",g.className="btn btn-light btn-block",b.textContent=ia("Apply transform"),g.textContent=ia("Cancel"),
p.addEventListener("change",function(f){a.setTransformInterpolation(this.value)}),p.className="form-control chickenpaint-transform-interpolation",Qg(p,c),rf(Yc(0,0).getContext("2d"))){c=document.createElement("div");let f=document.createElement("label");f.textContent=ia("Transform style");c.className="form-group";c.appendChild(f);c.appendChild(p);d.appendChild(c)}p=document.createElement("div");p.appendChild(b);p.appendChild(g);p.className="form-group";d.appendChild(p);b.addEventListener("click",
function(f){a.actionPerformed({action:"CPTransformAccept"});f.preventDefault()});g.addEventListener("click",function(f){a.actionPerformed({action:"CPTransformReject"});f.preventDefault()})}function Qh(a){a.preventDefault();a.stopPropagation()}function Ic(a){let c=document.createElement("span");return c.className="fa "+a,c}function Lf(a){let c=document.createElement("span");return c.className="chickenpaint-icon chickenpaint-icon-"+a,c}function Rg(a,c){let d=document.createElement("div"),b=document.createElement("label");
return b.tabIndex=-1,a.tabIndex=-1,d.className="form-check",a.className="form-check-input",b.className="form-check-label",b.setAttribute("for",a.id),b.appendChild(a),b.appendChild(document.createTextNode(c)),d.appendChild(a),d.appendChild(b),d}function Re(a){function c(){let K=g.getActiveLayer();K.getAlpha()!=l.value&&l.setValue(K.getAlpha());let P=g.getActiveLayer();for(;h.lastChild;)h.removeChild(h.lastChild);for(let L=V.LM_FIRST;L<=V.LM_LAST;L++)if(L!=V.LM_MULTIPLY2&&(L==P.blendMode||L===V.LM_PASSTHROUGH&&
P instanceof nb||L<=V.LM_LAST_CHIBIPAINT)){let ba=document.createElement("option");ba.appendChild(document.createTextNode(ia(V.BLEND_MODE_DISPLAY_NAMES[L])));L!==V.LM_MULTIPLY||P.blendMode===L||P.useLegacyMultiply?ba.value=L:ba.value=V.LM_MULTIPLY2;h.appendChild(ba)}K.getBlendMode()!=parseInt(h.value,10)&&(h.value=K.getBlendMode());K.getLockAlpha()!=t.checked&&(t.checked=K.getLockAlpha());(function(){var L=g.getActiveLayer();let ba=g.isEditingMask();L={"image-layer":L instanceof Ma,"layer-group":L instanceof
nb,"clipping-mask":L instanceof Ma&&L.clip,"no-clipping-mask":L instanceof Ma&&!L.clip,"no-clipping-mask-or-is-group":!(L instanceof Ma)||!L.clip,mask:L&&null!==L.mask,"no-mask":L&&null===L.mask,"mask-enabled":L&&null!==L.mask&&L.maskVisible,"mask-disabled":L&&null!==L.mask&&!L.maskVisible,isNotEditingMask:L&&!ba,isEditingMask:L&&null!==L.mask&&ba};for(let X of"mask no-mask isEditingMask isNotEditingMask clipping-mask no-clipping-mask-or-is-group image-layer layer-group".split(" "))for(let Y of x.getElementsByClassName("chickenpaint-action-require-"+
X))Y.style.display=L[X]?"inline-block":"none";x.querySelectorAll("[data-action]").forEach(function(X){let Y=X.getAttribute("data-action");X.classList.toggle("disabled",!a.isActionAllowed(Y))})})()}function d(){g=this;m.resize();c()}lc.call(this,a,"layers","Layers",{resizeHorz:!0,resizeVert:!0});let b=this,g=a.getArtwork(),p=null,f=this.getBodyElement(),e=this.getElement(),m=new function(){function K(Na){let ja=$a.querySelectorAll(".chickenpaint-layer");return ja[ja.length-1-Na]}function P(Na){Na=
Na.closest(".chickenpaint-layer");if(!Na)return-1;let ja=Array.from($a.querySelectorAll(".chickenpaint-layer"));return ja.length-1-ja.indexOf(Na)}function L(){if(2===pa.state){let sa=e.getBoundingClientRect();var Na=!0;let fa=!0;if(pa.dropTarget=function(La,qa){var Ra=ma(Ba)(".chickenpaint-layer",$a);La={layer:p[p.length-1],displayIndex:p.length-1,direction:"over"};for(var Ia=0;Ia<Ra.length;Ia++){let hb=Ra[Ra.length-1-Ia].getBoundingClientRect();if(0===Ia&&qa>hb.bottom){La=g.getLayersRoot().layers[0];
La={layer:La,displayIndex:p.indexOf(La),direction:"under"};break}if(qa>=hb.top){Ra=p[Ia];let Yb=hb.bottom-hb.top;La={layer:Ra,displayIndex:Ia};Ra instanceof nb?qa>=hb.top+.75*Yb?Ra.expanded&&0<Ra.layers.length?(La.layer=Ra.layers[Ra.layers.length-1],La.displayIndex--,La.direction="over"):La.direction="under":qa>=hb.top+.25*Yb?Ra.expanded&&0<Ra.layers.length?(La.layer=Ra.layers[Ra.layers.length-1],La.displayIndex--,La.direction="over"):La.direction="inside":La.direction="over":qa>=hb.top+.5*Yb?La.direction=
"under":La.direction="over";break}}return La.layer.parent==pa.layer.parent&&("over"==La.direction||"under"==La.direction)&&(qa=La.layer.parent,Ia=qa.indexOf(La.layer),"over"==La.direction&&qa.layers[Ia+1]==pa.layer||"under"==La.direction&&qa.layers[Ia-1]==pa.layer||La.layer==pa.layer)?null:pa.layer instanceof nb&&(La.layer==pa.layer&&"inside"==La.direction||La.layer.hasAncestor(pa.layer))?null:La}(pa.dragX,pa.dragY),pa.dropTarget){var ja=K(pa.dropTarget.displayIndex);switch(pa.dropTarget.direction){case "over":case "under":$a.appendChild(pa.dropBetweenMarkerElem);
Na=pa.dropTarget.layer.getDepth()-1;var Fa;if(ja=ja.getBoundingClientRect(),"under"==pa.dropTarget.direction&&pa.dropTarget.layer instanceof nb&&pa.dropTarget.layer.expanded){for(Fa=pa.dropTarget.displayIndex-1;0<=Fa&&p[Fa].hasAncestor(pa.dropTarget.layer);Fa--);Fa=K(Fa+1).getBoundingClientRect().bottom}else Fa=ja.bottom;Na=ja.left-sa.left+(0<Na?26+16*Na:0);pa.dropBetweenMarkerElem.style.left=Na+"px";pa.dropBetweenMarkerElem.style.width=ja.right-sa.left-Na+"px";pa.dropBetweenMarkerElem.style.top=
("over"==pa.dropTarget.direction?ja.top-1:Fa+1)-sa.top+"px";ma(Ba)(".chickenpaint-layer-drop-target",$a).removeClass("chickenpaint-layer-drop-target");Na=!1;break;case "inside":let La=ma(Ba)(".chickenpaint-layer",$a);La.each(function(qa){ma(Ba)(this).toggleClass("chickenpaint-layer-drop-target",La.length-1-qa==pa.dropTarget.displayIndex)});fa=!1}}fa&&ma(Ba)(".chickenpaint-layer-drop-target",$a).removeClass("chickenpaint-layer-drop-target");Na&&pa.dropBetweenMarkerElem&&pa.dropBetweenMarkerElem.remove();
pa.frameElem.style.top=pa.dragY-sa.top-parseInt(pa.frameElem.style.height,10)/2+"px"}else pa.dropBetweenMarkerElem&&pa.dropBetweenMarkerElem.remove(),pa.frameElem&&pa.frameElem.remove()}function ba(Na){let ja=Na.getImageThumbnail().getAsCanvas(Gb);return ja.title=ia("Image"),ja.className="chickenpaint-layer-thumbnail chickenpaint-layer-image-thumbnail",ja.style.maxWidth=ja.width/ja.height*25+"px",Na!=g.getActiveLayer()||g.isEditingMask()||(ja.className+=" active"),ja}function X(Na){let ja=Na.getMaskThumbnail().getAsCanvas(Gb);
(ja.title=ia("Layer mask"),ja.className="chickenpaint-layer-thumbnail chickenpaint-layer-mask-thumbnail",ja.style.maxWidth=ja.width/ja.height*25+"px",Na==g.getActiveLayer()&&g.isEditingMask()&&(ja.className+=" active"),Na.maskVisible)||(ja.className+=" disabled",Na=ja.getContext("2d"),Na.strokeStyle="red",Na.lineWidth=3,Na.moveTo(5,5),Na.lineTo(ja.width-5,ja.height-5),Na.moveTo(ja.width-5,5),Na.lineTo(5,ja.height-5),Na.stroke());return ja}function Y(Na,ja){let Fa=document.createElement("div");var sa=
document.createElement("div");let fa=document.createElement("div");var La=document.createElement("div");let qa=document.createElement("div"),Ra=document.createElement("div"),Ia=document.createElement("div");if(Fa.className="chickenpaint-layer list-group-item",ja==g.getActiveLayer()&&(Fa.className+=" active"),sa.className="chickenpaint-layer-eye",ja.ancestorsAreVisible()||(sa.className+=" chickenpaint-layer-eye-hidden-ancestors"),sa.style.marginRight=2+16*(ja.getDepth()-1)+"px",ja.visible?(Fa.className+=
" chickenpaint-layer-visible",sa.appendChild(Ic("icon-eye"))):(Fa.className+=" chickenpaint-layer-hidden",sa.appendChild(Ic("icon-eye-slash"))),Fa.appendChild(sa),fa.className="chickenpaint-layer-description",ja instanceof Ma){if(ja.clip&&(Fa.className+=" chickenpaint-layer-clipped",La.appendChild(Ic("icon-level-down-alt fa-flip-horizontal"))),ja.lockAlpha)sa=Lf("lock-alpha"),sa.title=ia("Transparency locked"),Ra.appendChild(sa)}else ja instanceof nb&&(Fa.className+=" chickenpaint-layer-group",ja.expanded?
(Fa.className+=" chickenpaint-layer-group-expanded",La.appendChild(Ic("icon-folder-open chickenpaint-layer-group-toggle"))):(Fa.className+=" chickenpaint-layer-group-collapsed",La.appendChild(Ic("icon-folder chickenpaint-layer-group-toggle"))));La.childNodes.length&&(La.className="chickenpaint-layer-icons",Fa.appendChild(La));try{ja instanceof Ma&&Fa.appendChild(ba(ja)),ja.mask&&Fa.appendChild(X(ja))}catch(hb){console.log("Failed to create layer thumb")}La=ja.name&&0<ja.name.length?ja.name:"(unnamed "+
(ja instanceof nb?"group":"layer")+")";return qa.innerText=La,qa.setAttribute("title",La),qa.className="chickenpaint-layer-name",Ia.innerText=ia(V.BLEND_MODE_DISPLAY_NAMES[ja.blendMode])+": "+ja.alpha+"%",Ia.className="chickenpaint-layer-blend",fa.appendChild(qa),fa.appendChild(Ia),Fa.appendChild(fa),Ra.className="chickenpaint-layer-status",Fa.appendChild(Ra),Fa.setAttribute("data-display-index",""+Na),Fa}function ka(Na){if(-1<Na){let ja=p[Na];Na=K(Na);ja&&Na&&n.show(ja,Na)}}function Aa(Na){2===pa.state?
(ma(Ba)(pa.layerElem).removeClass("chickenpaint-layer-dragging"),pa.dropTarget&&("inside"==pa.dropTarget.direction?a.actionPerformed({action:"CPRelocateLayer",layer:pa.layer,toGroup:pa.dropTarget.layer,toIndex:pa.dropTarget.layer.layers.length}):a.actionPerformed({action:"CPRelocateLayer",layer:pa.layer,toGroup:pa.dropTarget.layer.parent,toIndex:pa.dropTarget.layer.parent.indexOf(pa.dropTarget.layer)+ +("over"==pa.dropTarget.direction)})),pa.dropTarget=null,pa.state=0,L()):pa.state=0;Ka&&(clearTimeout(Ka),
Ka=null);$a.releasePointerCapture(Na.pointerId);$a.removeEventListener("pointermove",U);$a.removeEventListener("pointerup",Aa)}function Ga(){pa.state=2;pa.frameElem=document.createElement("div");pa.frameElem.className="chickenpaint-layer-drag-frame";pa.frameElem.style.width=ma(Ba)(pa.layerElem).outerWidth(!1)+"px";pa.frameElem.style.height=ma(Ba)(pa.layerElem).outerHeight(!1)+"px";pa.dropBetweenMarkerElem=document.createElement("div");pa.dropBetweenMarkerElem.className="chickenpaint-layer-drop-between-mark";
pa.layerElem.className+=" chickenpaint-layer-dragging";$a.appendChild(pa.frameElem)}function U(Na){Na=Na.clientY;switch(pa.state){case 3:if(5<Math.abs(Na-pa.dragY))pa.state=4;else break;case 4:$a.scrollTop=pa.initialScrollTop+pa.dragY-Na;break;case 1:if(5<Math.abs(Na-pa.dragY))Ga();else break;case 2:pa.dragY=Na,L()}}function ya(Na,ja,Fa){try{Fa?ma(Ba)(".chickenpaint-layer-mask-thumbnail",Na).replaceWith(X(ja)):ma(Ba)(".chickenpaint-layer-image-thumbnail",Na).replaceWith(ba(ja))}catch(sa){}}let pa=
{state:0,layer:null,layerElem:null,dragX:0,dragY:0,initialScrollTop:0,dropTarget:null,dropBetweenMarkerElem:null,frameElem:null},qb=document.createElement("div"),$a=document.createElement("div"),Gb=0,Fb=!1,Ka=null;for(let Na of(this.buildLayers=function(){let ja=(p=g.getLayersRoot().getLinearizedLayerList(!0)).map((sa,fa)=>Y(fa,sa)),Fa=document.createDocumentFragment();ma(Ba)($a).empty();for(let sa=ja.length-1;0<=sa;sa--)Fa.appendChild(ja[sa]);$a.appendChild(Fa);L()},this.layerChanged=function(ja){let Fa=
p.indexOf(ja),sa=ma(Ba)(K(Fa));0===sa.length||ja instanceof nb&&(ja.expanded!=ma(Ba)(sa).hasClass("chickenpaint-layer-group-expanded")||ja.visible!=ma(Ba)(sa).hasClass("chickenpaint-layer-visible"))?this.buildLayers():sa.replaceWith(Y(Fa,ja))},this.setRotation90=function(ja){if(Gb!=ja)for(Gb=ja,ja=0;ja<p.length;ja++){let Fa=p[ja],sa=ma(Ba)(K(ja));0<sa.length&&(ya(sa,Fa,!1),Fa.mask&&ya(sa,Fa,!0))}},this.layerImageThumbChanged=function(ja){var Fa=p.indexOf(ja);Fa=ma(Ba)(K(Fa));0<Fa.length&&ya(Fa,ja,
!1)},this.layerMaskThumbChanged=function(ja){var Fa=p.indexOf(ja);Fa=ma(Ba)(K(Fa));0<Fa.length&&(ja.mask?ya(Fa,ja,!0):ma(Ba)(".chickenpaint-layer-mask-thumbnail",Fa).remove())},this.activeLayerChanged=function(ja,Fa){ma(Ba)(".active",$a).removeClass("active");ja=ma(Ba)(K(p.indexOf(ja)));ja.addClass("active");ma(Ba)(".chickenpaint-layer-image-thumbnail",ja).toggleClass("active",!Fa);ma(Ba)(".chickenpaint-layer-mask-thumbnail",ja).toggleClass("active",Fa)},this.resize=function(){b.dismissNotification();
this.buildLayers()},this.getElement=function(){return qb},this.revealLayer=function(ja){ja=K(ja);let Fa=ja.getBoundingClientRect(),sa=$a.getBoundingClientRect();return $a.scrollTop=Math.max(Math.min(Math.max($a.scrollTop,$a.scrollTop+Fa.bottom-sa.bottom),$a.scrollTop+Fa.top-sa.top),0),ja},e.id="chickenpaint-layer-pop",qb.className="chickenpaint-layers-widget",qb.addEventListener("contextmenu",ja=>ja.preventDefault(),!0),$a.className="list-group",$a.addEventListener("dblclick",function(ja){0===ja.button&&
0<ma(Ba)(ja.target).closest(".chickenpaint-layer-description").length&&0===ma(Ba)(ja.target).closest("input").length&&(ka(P(ja.target)),ja.preventDefault())}),$a.addEventListener("pointerdown",function(ja){let Fa=P(ja.target.closest(".chickenpaint-layer"));if(-1!=Fa){let sa=p[Fa];if(0==ja.button&&ma(Ba)(ja.target).closest(".chickenpaint-layer-eye").length)a.actionPerformed({action:"CPSetLayerVisibility",layer:sa,visible:!sa.visible});else if(0==ja.button&&sa instanceof nb&&ma(Ba)(ja.target).closest(".chickenpaint-layer-group-toggle").length)a.actionPerformed({action:"CPExpandLayerGroup",
group:sa,expand:!sa.expanded});else{let fa=g.getActiveLayer()!=sa;if(Fb=0<ma(Ba)(ja.target).closest(".chickenpaint-layer-mask-thumbnail").length||sa instanceof nb&&null!==sa.mask&&fa,0==ja.button&&ja.shiftKey&&!ja.ctrlKey&&!ja.metaKey&&Fb)a.actionPerformed({action:"CPSetMaskVisible",layer:sa,visible:!sa.maskVisible});else{let La,qa;(La=0==ja.button||fa?Fb:g.isEditingMask(),qa=g.isEditingMask()!=La,(fa||qa)&&a.actionPerformed({action:"CPSetActiveLayer",layer:sa,mask:La}),La&&ja.altKey)?a.actionPerformed({action:"CPToggleMaskView"}):
La&&!ja.shiftKey&&(ja.ctrlKey||ja.metaKey)?a.actionPerformed({action:"CPApplyLayerMask"}):La&&ja.shiftKey&&(ja.ctrlKey||ja.metaKey)?a.actionPerformed({action:"CPRemoveLayerMask"}):0==ja.button?("pen"===ja.pointerType||"touch"===ja.pointerType?(pa.state=3,pa.initialScrollTop=$a.scrollTop,Ka&&clearTimeout(Ka),Ka=setTimeout(()=>{3===pa.state&&(Ga(),pa.dragY=ja.clientY,L())},800)):pa.state=1,pa.dropTarget=null,pa.layer=sa,pa.layerElem=K(Fa),pa.dragX=ja.clientX,pa.dragY=ja.clientY,$a.setPointerCapture(ja.pointerId),
$a.addEventListener("pointermove",U),$a.addEventListener("pointerup",Aa)):2!=ja.button||fa||(ja.preventDefault(),-1!=P(ja.target)&&(ka(P(ja.target)),ja.preventDefault()))}}}}),$a.setAttribute("touch-action","none"),["ontouchstart","ontouchmove","ontouchend","ontouchcancel"]))$a.addEventListener(Na,Qh);qb.appendChild($a)},l=new Hc(0,100,!1,!1,208),h=document.createElement("select"),n=new function(){let K=null,P="",L=document.createElement("input"),ba=this;this.hide=function(){K=null;let X=ma(Ba)(L).parent();
X&&(ma(Ba)(L).remove(),X.text(P))};this.renameAndHide=function(){K&&K.name!=L.value&&a.actionPerformed({action:"CPSetLayerName",layer:K,name:L.value});this.hide()};this.show=function(X,Y){L.value=P=(K=X).name;(X=Y.querySelector(".chickenpaint-layer-name"))&&X.parentNode&&(Y=X.firstChild)&&Y.nodeType===Node.TEXT_NODE&&(X.removeChild(Y),X.appendChild(L));L.select()};L.type="text";L.className="chickenpaint-layer-rename form-control input-sm";L.addEventListener("keydown",function(X){X.stopPropagation()});
L.addEventListener("keydown",function(X){"Enter"===X.key&&ba.renameAndHide();X.stopPropagation()});L.addEventListener("keyup",function(X){"Escape"===X.key&&ba.hide();X.stopPropagation()});L.addEventListener("blur",function(X){K&&ba.renameAndHide()})},r=document.createElement("input"),t=document.createElement("input"),v=!1,x,D=this.setSize,G=this.setWidth,N=this.setHeight;this.setSize=function(K,P){D.call(this,K,P);this.dismissNotification();l.resize()};this.setWidth=function(K){G.call(this,K);l.resize();
m.resize()};this.setHeight=function(K){N.call(this,K);m.resize()};this.setRotation90=function(K){m.setRotation90(K)};this.dismissNotification=function(){ma(Ba)(".chickenpaint-layer[aria-describedby],.chickenpaint-slider[aria-describedby]",f).each((K,P)=>{P=ma(Ba)(P);(K=qc.Popover.getInstance(P[0]))&&K.dispose()});v&&(clearTimeout(v),v=!1)};this.showNotification=(K,P,L)=>{let ba=p.indexOf(K);K=g.getActiveLayer()==K&&"opacity"==L?l.getElement():m.revealLayer(ba);this.dismissNotification();(new qc.Popover(K,
{html:!1,content:P,placement:"left",trigger:"manual",fallbackPlacement:[],boundary:"window",container:b.getElement()})).show();v=setTimeout(()=>{v=!1;this.dismissNotification()},Math.max(Math.round(70*P.length),3E3))};h.className="form-control form-control-sm";h.tabIndex=-1;h.title=ia("Layer blending mode");h.addEventListener("change",function(K){a.actionPerformed({action:"CPSetLayerBlendMode",blendMode:parseInt(h.value,10)});h.blur()});f.appendChild(h);l.title=function(K){return ia("Opacity")+": "+
K+"%"};l.on("valueChange",function(K){a.actionPerformed({action:"CPSetLayerAlpha",alpha:K})});f.appendChild(l.getElement());r.id="chickenpaint-chk-sample-all-layers";r.type="checkbox";r.addEventListener("click",function(K){g.setSampleAllLayers(r.checked);document.activeElement.blur()});f.appendChild(Rg(r,ia("Sample all layers")));t.id="chickenpaint-chk-lock-alpha";t.type="checkbox";t.addEventListener("click",function(K){a.actionPerformed({action:"CPSetLayerLockAlpha",lock:t.checked});document.activeElement.blur()});
f.appendChild(Rg(t,ia("Lock transparency")));f.appendChild(m.getElement());x=function(){var K=[{title:"Add layer",icon:Ic("icon-file"),action:"CPAddLayer"},{title:"Add group",icon:Ic("icon-folder"),action:"CPAddGroup"},{title:"Merge down",icon:Ic("icon-download_FILL"),action:"CPLayerMergeDown",require:["image-layer"]},{title:"Merge group",icon:Ic("icon-collapse_all_FILL"),action:"CPGroupMerge",require:["layer-group"]},{title:"Clip to the layer below",icon:Ic("icon-level-down-alt fa-flip-horizontal"),
action:"CPCreateClippingMask",require:"no-clipping-mask-or-is-group"},{title:"Unclip from the layer below",icon:Ic("icon-level-down-alt fa-flip-horizontal"),action:"CPReleaseClippingMask",require:"clipping-mask"},{title:"Add layer mask",icon:Lf("mask"),action:"CPAddLayerMask",require:["no-mask"]},{title:"Apply mask",icon:Lf("mask"),action:"CPApplyLayerMask",require:["mask"]},{title:"Duplicate",icon:Ic("icon-clone"),action:"CPLayerDuplicate"},{title:"Delete layer mask",icon:Ic("icon-trash"),action:"CPRemoveLayerMask",
require:"isEditingMask"},{title:"Delete layer",icon:Ic("icon-trash"),action:"CPRemoveLayer",require:"isNotEditingMask"}];let P=document.createElement("ul");for(let L of(P.className="chickenpaint-layer-buttons list-unstyled",K))K=document.createElement("li"),K.setAttribute("data-action",L.action),K.className="chickenpaint-small-toolbar-button "+(L.require?"chickenpaint-action-require-"+L.require:""),K.title=ia(L.title),K.appendChild(L.icon),K.addEventListener("click",function(){a.actionPerformed({action:L.action})}),
P.appendChild(K);return P}();f.appendChild(x);g.on("changeActiveLayer",function(K,P,L){m.activeLayerChanged(P,L);c()});g.on("changeLayer",function(K){g=this;b.dismissNotification();m.layerChanged(K);c()});g.on("changeStructure",d);g.on("changeLayerMaskThumb",function(K){g=this;m.layerMaskThumbChanged(K)});g.on("changeLayerImageThumb",function(K){g=this;m.layerImageThumbChanged(K)});a.on("layerNotification",this.showNotification.bind(this));d.call(g)}function Rh(){this.table=new Uint8Array(256);this.loadIdentity=
function(){for(var a=0;256>a;a++)this.table[a]=a};this.loadBrightnessContrast=function(a,c){c=0<c?1/(1.0001-c):1+c;a=.5-.5*c+a;for(var d=0;256>d;d++)this.table[d]=Math.min(255,Math.max(~~(255*(d/255*c+a)),0))};this.invert=function(){for(var a=0;256>a;a++)this.table[a]=255-this.table[a]}}function Sg(a,c){let d=document.createElement("div"),b=document.createElement("label");return d.className="form-check",a.className="form-check-input",b.className="form-check-label",b.setAttribute("for",a.id),b.appendChild(a),
b.appendChild(document.createTextNode(c)),d.appendChild(a),d.appendChild(b),d}function Se(a){function c(ba){for(let X=0;X<ba.length;X++){let Y=new e(ba[X],32,32);Y.on("click",function(){r=this.texture;f()});K.appendChild(Y.getElement())}}function d(ba){let X=new Xa(ba,ba,8);for(let Y=1;Y<ba*ba;Y++)X.data[Y]=255;return X}function b(ba){let X=2*ba,Y=new Xa(X,X,8);for(let ka=0;ka<X;ka++)for(let Aa=0;Aa<X;Aa++)Y.data[ka+Aa*X]=255*(0!=(~~(ka/ba)+~~(Aa/ba))%2);return Y}function g(ba,X){let Y=new Xa(X,X,
8);for(let ka=0;ka<X*X;ka++)~~(ka%X)>=ba&&(Y.data[ka]=255);return Y}function p(ba,X){let Y=new Xa(X,X,8);for(let ka=0;ka<X*X;ka++)ka/X>=ba&&(Y.data[ka]=255);return Y}function f(){if(null!=r){t=r.clone();v&&t.mirrorHorizontally();let ba=new Rh;ba.loadBrightnessContrast(D,G);x&&ba.invert();t.applyLUT(ba)}else t=null;a.getArtwork().setBrushTexture(t);null!=N&&N.updateTexture()}function e(ba,X,Y){let ka=document.createElement("canvas"),Aa=ka.getContext("2d"),Ga=this;this.setTexture=function(U){this.texture=
U;this.paint()};this.getElement=function(){return ka};this.paint=function(){null!=this.texture?Aa.fillStyle=Aa.createPattern(this.texture.getAsCanvas(),"repeat"):Aa.fillStyle="white";Aa.fillRect(0,0,ka.width,ka.height)};ka.addEventListener("click",function(){Ga.emit("click")});ka.width=X;ka.height=Y;this.setTexture(ba)}var m;let l,h,n;lc.call(this,a,"textures","Textures");let r,t,v=!1,x=!1,D=0,G=0,N,K=document.createElement("div"),P=this.getBodyElement();e.prototype=Object.create(ma($b).prototype);
e.prototype.constructor=e;N=new function(){function ba(){Ga.checked=x;U.checked=v;ya.setValue(100*D+100);pa.setValue(100*G+100)}let X,Y,ka,Aa=document.createElement("div"),Ga=document.createElement("input"),U=document.createElement("input"),ya=new Hc(0,200,!0),pa=new Hc(0,200,!0),qb=new e(null,64,64),$a=document.createElement("button"),Gb,Fb=new qc.Popover($a,{html:!0,content:()=>Gb,trigger:"manual",placement:"right",container:P});this.updateTexture=function(){$a.disabled=null==t;qb.setTexture(t)};
this.getElement=function(){return Aa};Aa.className="chickenpaint-texture-options";Aa.appendChild(qb.getElement());$a.type="button";$a.className="btn btn-light btn-sm";$a.setAttribute("data-bs-toggle","popover");$a.setAttribute("data-bs-placement","right");$a.textContent=ia("Customize");(X=document.createElement("div")).className="chickenpaint-texture-controls";Ga.id="chickenpaint-chk-texture-invert";Ga.type="checkbox";Ga.addEventListener("click",function(Ka){x=this.checked;f()});X.appendChild(Sg(Ga,
ia("Inverse")));U.id="chickenpaint-chk-texture-mirror";U.type="checkbox";U.addEventListener("click",function(Ka){v=this.checked;f()});X.appendChild(Sg(U,ia("Mirror")));ya.title=function(Ka){return ia("Brightness")+": "+(Ka-100)+"%"};ya.on("valueChange",function(Ka){D=(Ka-100)/100;f()});X.appendChild(ya.getElement());pa.title=function(Ka){return ia("Contrast")+": "+(Ka-100)+"%"};pa.on("valueChange",function(Ka){G=(Ka-100)/100;f()});X.appendChild(pa.getElement());Y=document.createElement("button");
ka=document.createElement("button");Y.textContent="Ok";Y.className="btn btn-primary btn-sm";Y.type="button";Y.addEventListener("click",function(Ka){Fb.hide()});X.appendChild(Y);X.appendChild(document.createTextNode(" "));ka.textContent="Reset";ka.className="btn btn-secondary btn-sm";ka.type="button";ka.addEventListener("click",function(Ka){G=D=0;x=v=!1;ba();f()});X.appendChild(ka);ba();Gb=X;$a.addEventListener("click",function(){Fb.toggle()});Aa.appendChild($a);this.updateTexture()};P.appendChild(N.getElement());
K.className="chickenpaint-texture-swatches";P.appendChild(K);c((m=[null],(l=new Xa(2,2,8)).data[0]=255,l.data[3]=255,m.push(l),m.push(d(2)),m.push(d(3)),m.push(d(4)),m.push(d(6)),m.push(d(8)),m.push(g(1,2)),m.push(g(2,4)),m.push(p(1,2)),m.push(p(2,4)),m.push(b(2)),m.push(b(4)),m.push(b(8)),m.push(b(16)),m.push(function(ba){let X=new Xa(256,ba,8);for(let Y=0;Y<ba*ba;Y++)X.data[Y]=Math.max(0,Math.min(255,Math.floor(.65*(.65*Math.floor(256*Math.random())-128)+128)));return X}(256)),m));m=a.getResourcesRoot()+
"gfx/textures32.png?20241024.1";var L=function(ba){c(ba)};h=new Image;n=[];h.onload=function(){var ba=document.createElement("canvas");let X=ba.getContext("2d",{willReadFrequently:!0});ba.width=h.width;ba.height=h.height;for(ba=0;2>ba;ba++){X.drawImage(h,0,32*ba,32,32,0,0,32,32);try{let Y=X.getImageData(0,0,32,32),ka=new Xa(32,32,8);for(let Aa=0;1024>Aa;Aa++)ka.data[Aa]=Y.data[4*Aa];n.push(ka)}catch(Y){console.log(Y)}}L(n)};h.src=m}function Te(a){function c(D){let G=document.createElement("div"),
N=document.createElement("a"),K=document.createElement("ul"),P=document.createElement("a"),L=document.createElement("a"),ba=this;this.getElement=function(){return G};this.setColor=function(Y){N.setAttribute("data-color",Y);var ka=N.style;for(Y=""+Number(Y).toString(16);6>Y.length;)Y="0"+Y;ka.backgroundColor="#"+Y};this.setColor(D);N.href="#";N.className="chickenpaint-color-swatch dropdown-toggle";P.className="dropdown-item";P.href="#";P.textContent=ia("Remove");P.addEventListener("click",function(Y){Y.preventDefault();
G.remove();h=!0});L.className="dropdown-item";L.href="#";L.textContent=ia("Replace with current color");L.addEventListener("click",function(Y){Y.preventDefault();ba.setColor(a.getCurColor().getRgb());h=!0});K.className="dropdown-menu";D=document.createElement("li");let X=document.createElement("li");D.appendChild(P);X.appendChild(L);K.appendChild(D);K.appendChild(X);G.className="chickenpaint-color-swatch-wrapper";G.appendChild(N);G.appendChild(K)}function d(D){D=new c(D);n.appendChild(D.getElement())}
function b(D){let G=document.createElement("span");return G.className="fa icon-"+D,G}var g;let p;let f,e,m;lc.call(this,a,"swatches","Color swatches");var l=[16777215,0,16711680,65280,255,16776960];let h=!1,n=document.createElement("ul"),r=document.createElement("div"),t,v=this;this.getSwatches=function(){let D=n.querySelectorAll(".chickenpaint-color-swatch"),G=Array(D.length);for(let N=0;N<D.length;N++)G[N]=parseInt(D[N].getAttribute("data-color"),10);return G};this.setSwatches=function(D){for(;n.lastChild;)n.removeChild(n.lastChild);
for(let G=0;G<D.length;G++)d(D[G]);h=!0};this.isModified=function(){return h};n.className="chickenpaint-color-swatches list-unstyled";for(g=0;g<l.length;g++)n.appendChild((new c(l[g])).getElement());n.addEventListener("click",function(D){let G=D.target;/^<a data-color=/i.test(G.outerHTML)&&/chickenpaint-color-swatch/.test(G.className)&&0==D.button&&void 0!==G.getAttribute("data-color")&&(a.setCurColor(new Ab(parseInt(G.getAttribute("data-color"),10))),D.stopPropagation(),D.preventDefault())});n.addEventListener("contextmenu",
function(D){let G=D.target;if(/^<a data-color=/i.test(G.outerHTML)&&/chickenpaint-color-swatch/.test(G.className)){D.preventDefault();var N=new qc.Dropdown(G);N.toggle();document.addEventListener("click",function L(P){N.hide();document.removeEventListener("click",L)})}});this.getBodyElement().appendChild(n);l=document.createElement("button");g=document.createElement("button");p=document.createElement("ul");var x=document.createElement("a");f=document.createElement("a");g.type="button";g.title=ia("Add the current brush color as a new swatch");
g.className="btn chickenpaint-small-toolbar-button chickenpaint-color-swatch-add";g.appendChild(b("plus"));l.type="button";l.className="btn dropdown-toggle chickenpaint-small-toolbar-button chickenpaint-color-swatch-settings";l.setAttribute("data-bs-toggle","dropdown");l.appendChild(b("cog"));x.className="dropdown-item";x.href="#";x.textContent=ia("Save swatches to your computer...");x.addEventListener("click",function(D){D.preventDefault();D=new Blob([(new Ud).write(v.getSwatches())],{type:"application/octet-stream"});
ma(oe).saveAs(D,"oekakiswatches.aco")});f.className="dropdown-item";f.href="#";f.textContent=ia("Load swatches from your computer...");f.addEventListener("click",function(D){D.preventDefault();t.onchange=function(){var G=this.files;if(!(1>G.length)){G=G[0];var N=new FileReader;N.onload=function(){let K=(new Ud).read(this.result);null!=K&&0<K.length?v.setSwatches(K):alert(ia("The swatches could not be read, did you select an .aco file?"))};N.readAsArrayBuffer(G)}};t.click()});p.className="dropdown-menu";
e=document.createElement("li");m=document.createElement("li");e.appendChild(x);m.appendChild(f);p.appendChild(e);p.appendChild(m);(x=document.createElement("div")).className="btn-group";x.appendChild(l);x.appendChild(p);g.addEventListener("click",function(D){d(a.getCurColor().getRgb());h=!0});r.className="chickenpaint-color-swatches-buttons";window.File&&window.FileReader&&window.FileList&&window.Blob&&((t=document.createElement("input")).type="file",t.multiple=!1,t.style.display="none",r.appendChild(x),
r.appendChild(t));r.appendChild(g);this.getBodyElement().appendChild(r)}function Ue(a){function c(){let h=f.closest(".chickenpaint").querySelector(".chickenpaint-canvas");return{width:h.offsetWidth,height:h.offsetHeight}}function d(h,n){let r=h.getElement();n?f.contains(r)||f.appendChild(r):f.contains(r)&&f.removeChild(r);e.emitEvent("paletteVisChange",[h.name,n])}let b={tool:new Ne(a),misc:new Oe(a),stroke:new Pe(a),color:new Qe(a),brush:new Wd(a),layers:new Re(a),textures:new Se(a),swatches:new Te(a)},
g={tool:!1,color:!1,misc:!1};var p={color:!0,textures:!0,layers:!0};let f=document.createElement("div"),e=this,m=[],l=[];for(let h in this.palettes=b,this.showPaletteByName=function(n,r){(n=b[n])&&d(n,r)},this.togglePalettes=function(){if(0===l.length)f.querySelectorAll(".chickenpaint-palette").forEach(function(n){e.showPaletteByName(n.getAttribute("data-paletteName"),!1);l.push(n)});else{for(let n=0;n<l.length;n++)e.showPaletteByName(l[n].getAttribute("data-paletteName"),!0);l=[]}},this.constrainPalettes=
function(){let n=c();for(var r in b){let t=b[r];t.getX()+t.getWidth()/2>n.width&&t.setLocation(n.width-t.getWidth(),t.getY());t.getY()+t.getHeight()/2>n.height&&t.setLocation(t.getX(),n.height-t.getHeight())}r=0<n.width-b.tool.getWidth()-b.misc.getWidth()-b.stroke.getWidth()-b.color.getWidth()-b.brush.getWidth()-15;b.swatches.getX()+b.swatches.getWidth()==b.brush.getX()+b.brush.getWidth()&&20>Math.abs(b.swatches.getY()-b.brush.getY())&&b.swatches.setLocation(b.brush.getX()-b.swatches.getWidth()-(r?
5:1),0);b.layers.getY()+b.layers.getHeight()>n.height&&b.layers.setHeight(Math.max(n.height-b.layers.getY(),200))},this.arrangePalettes=function(){let n=c();if(a.getSmallScreenMode()){b.tool.setLocation(0,0);b.misc.setLocation(b.tool.getX()+b.tool.getWidth()+1,0);var r=16>=n.width-(b.tool.getWidth()+b.misc.getWidth()+b.brush.getWidth())?b.misc.getY()+b.misc.getHeight()+1:0;b.brush.setLocation(n.width-b.brush.getWidth()-15,r);b.textures.setWidth(n.width-b.textures.getX());b.layers.setLocation(b.brush.getX()+
b.brush.getWidth()-b.layers.getWidth(),b.textures.getY()-b.layers.getHeight());r=Math.max(b.textures.getY()-330-1,370);b.layers.setHeight(r);b.layers.setWidth(218);b.stroke.setLocation(b.misc.getX(),b.misc.getY()+b.misc.getHeight()+1);b.swatches.setLocation(b.stroke.getX(),b.stroke.getY()+b.stroke.getHeight()+1)}else{r=0<n.width-b.tool.getWidth()-b.misc.getWidth()-b.stroke.getWidth()-b.color.getWidth()-b.brush.getWidth()-15;b.brush.setLocation(n.width-b.brush.getWidth()-15,0);var t=b.brush.getY()+
b.brush.getHeight();t=300<n.height-t?t+2:t;b.layers.setSize(b.brush.getWidth()+30*!!r,n.height-t);b.layers.setLocation(b.brush.getX()+b.brush.getWidth()-b.layers.getWidth(),t);b.tool.setLocation(0,0);b.misc.setLocation(b.tool.getX()+b.tool.getWidth()+(r?5:1),0);r?b.stroke.setLocation(b.misc.getX()+b.misc.getWidth()+(r?5:1),0):b.stroke.setLocation(b.misc.getX(),b.misc.getY()+b.misc.getHeight()+1);b.swatches.setLocation(Math.max(b.brush.getX()-b.swatches.getWidth()-(r?5:1),b.tool.getX()+b.tool.getWidth()),
0);b.textures.setWidth(Math.min(b.layers.getX()-b.textures.getX(),490))}b.textures.setLocation(b.color.getX()+b.color.getWidth()+4,n.height-b.textures.getHeight());b.color.setLocation(0,Math.max(b.tool.getY()+b.tool.getHeight(),n.height-b.color.getHeight()))},a.on("smallScreen",function(n){if(n)for(let r in b)b[r].toggleCollapse(n&&(!(r in g)||g[r]))}),this.getElement=function(){return f},f.className="chickenpaint-palettes",b){let n=b[h],r=n.getElement();n.on("paletteVisChange",function(){d(this,
!1)});h in p&&n.setCollapseDownwards(!0);r.setAttribute("data-paletteName",h);m.push(r)}for(let h in b)p=b[h].getElement(),f.appendChild(p)}function Sh(a,c){function d(f){let e=f.data("action"),m=f.data("checkbox"),l;a.isActionAllowed(e)&&(m?(f.toggleClass("selected"),l=f.hasClass("selected")):l=!1,a.actionPerformed({action:e,checkbox:m,selected:l}))}let b=ma(Ba)('<nav class="navbar navbar-expand-md bg-light"><div class="navbar-upper"><a class="navbar-brand" href="#">ChickenPaint Be</a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#chickenpaint-main-menu-content" aria-controls="chickenpaint-main-menu-content" aria-expanded="false" aria-label="Toggle main menu"><span class="navbar-toggler-icon"></span></button></div><div class="collapse navbar-collapse" id="chickenpaint-main-menu-content"><div class="navbar-nav"></div></div><div class="widget-nav" id="chickenpaint-palette-toggler-content"></div></nav>'),
g=navigator.userAgent.toLowerCase().includes("mac os");b[0].addEventListener("touchmove",f=>{f.preventDefault()},{passive:!1});this.getElement=function(){return b[0]};(function(f,e){f.append(e.map(m=>{let l=ma(Ba)('<div class="nav-item dropdown"><a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">'+ia(m.name)+'</a><ul class="dropdown-menu"></ul></div>'),h=ma(Ba)(".dropdown-toggle",l),n=ma(Ba)(".dropdown-menu",l);return h[0].addEventListener("show.bs.dropdown",
r=>{ma(Ba)("[data-action]",l).each(function(){let v=ma(Ba)(this);var x=this.getAttribute("data-action");x=a.isActionAllowed(x);v.toggleClass("disabled",!x).toggleClass("hidden",!x&&!0===v.data("hideIfNotAvailable"))});ma(Ba)(".dropdown-divider",l).removeClass("hidden");r=ma(Ba)(".dropdown-item:not(.hidden),.dropdown-divider:not(.hidden)",l);let t=null;for(let v=0;v<r.length;v++){let x=ma(Ba)(r[v]);x.hasClass("dropdown-divider")?0===v||t?x.addClass("hidden"):t=x:t=null}t&&t.addClass("hidden")}),n.append(m.children.map(r=>
{let t;if(!r.action||a.isActionSupported(r.action)){if("CPSend"!=r.action||a.isActionSupported("CPContinue")||(r.name=ia("Post Oekaki"),r.shortcut="ctrl+p"),"-"==r.name?t=ma(Ba)('<hr class="dropdown-divider">'):(t=ma(Ba)('<a class="dropdown-item" href="#" data-action="'+r.action+'"><span>'+ia(r.name)+"</span></a>"),r.checkbox&&ma(Ba)(t).data("checkbox",!0).toggleClass("selected",!!r.checked),r.hideIfNotAvailable&&t.data("hideIfNotAvailable",!0)),r.title&&t.attr("title",ia(r.title)),r.shortcut){let x=
t,D=document.createElement("small");g&&(r.shortcut=r.shortcut.replace(/SHIFT/im,"\u21e7"),r.shortcut=r.shortcut.replace(/ALT/im,"\u2325"),r.shortcut=r.shortcut.replace(/CTRL/im,"\u2318"));D.className="chickenpaint-shortcut";var v=(v=(v=(v=r.shortcut).toUpperCase()).replace(/(,.+)$/,"")).replace("=","+");D.textContent=v=g?v.replace(/([^+])\+/g,"$1"):v.replace(/([^+])\+/g,"$1 ");x.append(D);ma(Ub)(r.shortcut,function(G){return d(x),G.preventDefault(),G.stopPropagation(),!1})}return ma(Ba)("<li>").append(t)}})),
l}))})(ma(Ba)(".navbar-nav",b),Tg);(function(f,e){f.append(e.filter(m=>!!m.mnemonic&&a.isActionSupported(m.action)).map(m=>{let l=ma(Ba)(`<button class="widget-toggler selected" type="button" data-action="${m.action}" data-checkbox="true" data-selected="${!m.checked}"><span>`+m.mnemonic+"</span></button>");return l.on("click",h=>{d(l);h.preventDefault()}),l}))})(ma(Ba)(".widget-nav",b),Tg[5].children);ma(Ba)(b).on("click","a:not(.dropdown-toggle)",function(f){d(ma(Ba)(this));f.preventDefault()});
c.getPaletteManager().on("paletteVisChange",function(f,e){ma(Ba)('[data-action="CPPal'+f.substring(0,1).toUpperCase()+f.substring(1)+'"]',b).toggleClass("selected",e)});let p=ma(Ba)(".dropdown-item[data-action=CPFullScreen]",b);a.on("fullScreen",f=>p.toggleClass("selected",f));p.toggleClass("selected",a.isFullScreen())}function Ve(a,c){let d=document.createElement("div"),b=new Me(a),g=new Ue(a),p,f=!1,e=this;this.togglePalettes=function(){g.togglePalettes()};this.arrangePalettes=function(){setTimeout(g.arrangePalettes.bind(g),
0)};this.constrainPalettes=function(){g.constrainPalettes()};this.showPalette=function(l,h){g.showPaletteByName(l,h)};this.getSwatches=function(){return g.palettes.swatches.getSwatches()};this.setSwatches=function(l){g.palettes.swatches.setSwatches(l)};this.getPaletteManager=function(){return g};this.setRotation90=function(l){b.setRotation(l*Math.PI/2);g.palettes.layers.setRotation90(l)};this.setFullScreenMode=function(l){f!==l&&(f=l,e.resize(),e.arrangePalettes())};this.resize=function(){let l=window.innerHeight,
h=p.getElement().getBoundingClientRect().height;b.resize(f?l-h:Math.min(Math.max(l-h-65,500),850),!1);e.constrainPalettes()};p=new Sh(a,this);c.appendChild(p.getElement());d.className="chickenpaint-main-section";d.appendChild(b.getElement());d.appendChild(g.getElement());c.appendChild(d);b.on("canvasRotated90",function(l){g.palettes.layers.setRotation90(l)});screen.orientation&&screen.orientation.addEventListener("change",l=>{this.resize();a.actionPerformed({action:"CPArrangePalettes"});setTimeout(()=>
{this.resize();a.actionPerformed({action:"CPArrangePalettes"})},10);Promise.resolve().then(()=>{this.resize()}).then(()=>{a.actionPerformed({action:"CPArrangePalettes"})})});let m=document.getElementById("chickenpaint-main-menu-content");if(document.addEventListener("show.bs.modal",()=>{m&&m.classList.contains("show")&&(new qc.Collapse(m,{toggle:!1})).hide()}),m){let l=document.querySelector(".chickenpaint .widget-nav");l&&(m.addEventListener("show.bs.collapse",h=>{l.classList.add("hidden")}),m.addEventListener("hidden.bs.collapse",
h=>{l.classList.remove("hidden")}));window.addEventListener("resize",()=>{l.classList.remove("hidden")})}document.addEventListener("hidden.bs.collapse",this.resize.bind(this));window.addEventListener("resize",this.resize.bind(this));a.on("fullScreen",l=>this.setFullScreenMode(l));a.on("unsavedChanges",l=>{c.classList.toggle("chickenpaint-unsaved",l)});setTimeout(this.resize.bind(this),0)}function Th(a){var c=ma(Ba)('<div class="modal fade chickenpaint-about-dialog" tabindex="-1" role="dialog">\n                <div class="modal-dialog">\n                    <div class="modal-content">\n                        <div class="modal-header">\n                            <h5 class="modal-title">About ChickenPaint Be</h5>\n                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">\n                            </button>\n                        </div>\n                        <div class="modal-body">\n                        <a class="chickenpaint-on-github" target="_blank" href="https://github.com/satopian/ChickenPaint_Be" rel="noopener"><span class="icon-github"></span> ChickenPaint Be on GitHub</a>\n                        <p>\n                        ChickenPaint Be is a customized version of <a href="https://github.com/thenickdude/chickenpaint" target="_blank" rel="noopener">ChickenPaint</a> by satopian.\n                        </p>\n                        <p>\n                        Built on:2025-03-31T00:20:25<br>\n                        <a href="https://www.gnu.org/licenses/" target="_blank" rel="noopener">GNU General Public License</a><br>\n                        </p>\n                        <a class="chickenpaint-on-github" target="_blank" href="https://github.com/thenickdude/chickenpaint" rel="noopener"><span class="icon-github"></span> ChickenPaint on GitHub</a>\n                            \n                            <p>\n                                ChickenPaint is a translation of <a href="https://github.com/thenickdude/chibipaint" target="_blank" rel="noopener">ChibiPaint</a>\n                                from Java to JavaScript by Nicholas Sherlock / Chicken Smoothie\n                            </p>\n                            <p>\n                                ChibiPaint is Copyright (c) 2006-2008 Marc Schefer. All Rights Reserved\n                            </p>\n                            <p>\n                                ChickenPaint is free software: you can redistribute it and/or modify\n                                it under the terms of the GNU General Public License as published by\n                                the Free Software Foundation, either version 3 of the License, or\n                                (at your option) any later version.\n                            </p>\n        \n                            <p>\n                                ChickenPaint is distributed in the hope that it will be useful,\n                                but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n                                <a target="_blank" href="https://www.gnu.org/licenses/" rel="noopener">GNU General Public License</a> for more details.\n                            </p>\n        \n                            <pre class="pre-scrollable chickenpaint-third-party-licenses">Toolbar icons designed by <a target="_blank" href="https://github.com/Anteira" rel="noopener">Miglena Lapavicheva (Anteira)</a>\n    These icons are dual-licensed under <a target="_blank" href="https://spdx.org/licenses/GPL-3.0-or-later.html" rel="noopener">GPL-3.0-or-later</a> and <a target="_blank" href="https://creativecommons.org/licenses/by/3.0/" rel="noopener">CC-BY-3.0</a>\n\nIncludes these MIT-licensed libraries:\n\n    Includes the <a target="_blank" href="https://github.com/eligrey/FileSaver.js" rel="noopener">FileSaver.js library</a>\n    FileSaver.js Copyright \u00a9 2015 <a target="_blank" href="https://eligrey.com/" rel="noopener">Eli Grey</a>\n\n    Includes the <a target="_blank" href="https://github.com/nodeca/pako" rel="noopener">Pako zlib compression library</a>\n    Copyright (C) 2014-2015 by Vitaly Puzrin\n    \n    Includes the <a target="_blank" href="https://github.com/madrobby/keymaster" rel="noopener">keymaster.js</a> keyboard library\n    Copyright (c) 2011-2013 Thomas Fuchs\n\n    Includes the <a target="_blank" href="https://benalman.com/projects/jquery-throttle-debounce-plugin/" rel="noopener">jQuery throttle-debounce</a> library\n    Copyright (c) 2010 "Cowboy" Ben Alman\n\n    Permission is hereby granted, free of charge, to any person\n    obtaining a copy of this software and associated documentation\n    files (the "Software"), to deal in the Software without\n    restriction, including without limitation the rights to use,\n    copy, modify, merge, publish, distribute, sublicense, and/or\n    sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following\n    conditions:\n\n    The above copyright notice and this permission notice shall be\n    included in all copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\n    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT \n    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n    OTHER DEALINGS IN THE SOFTWARE.\n\nIncludes the <a href="https://jquery.com/" target="_blank" rel="noopener">jQuery library</a> \nCopyright <a href="https://jquery.com/license/" target="_blank" rel="noopener">OpenJS Foundation and other contributors</a>\n    \n    This software consists of voluntary contributions made by many\n    individuals. For exact contribution history, see the revision \n    history available at https://github.com/jquery/jquery\n    \n    The following license applies to all parts of this software \n    except as documented below:\n    \n    Permission is hereby granted, free of charge, to any person \n    obtaining a copy of this software and associated documentation\n    files (the "Software"), to deal in the Software without\n    restriction, including without limitation the rights to use, \n    copy, modify, merge, publish, distribute, sublicense, and/or\n    sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following\n    conditions:\n    \n    The above copyright notice and this permission notice shall be\n    included in all copies or substantial portions of the Software.\n    \n    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\n    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n    OTHER DEALINGS IN THE SOFTWARE.\n\nIncludes the <a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a> \nCopyright <a href="https://github.com/twbs/bootstrap/blob/main/LICENSE" target="_blank" rel="noopener">The Bootstrap Authors</a>\n    \n    Permission is hereby granted, free of charge, to any person obtaining a copy\n    of this software and associated documentation files (the "Software"), to deal\n    in the Software without restriction, including without limitation the rights\n    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n    copies of the Software, and to permit persons to whom the Software is\n    furnished to do so, subject to the following conditions:\n\n    The above copyright notice and this permission notice shall be included in\n    all copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n    THE SOFTWARE.\n    \nIncludes Font Awesome by Fonticons, Inc. - <a href="https://fontawesome.com/" target="_blank" rel="noopener">https://fontawesome.com/</a>\nIncludes Material Design icons by Google - <a href="https://fonts.google.com/" target="_blank" rel="noopener">https://fonts.google.com/</a>\n                    </pre>\n                </div>\n            </div>\n        </div>\n    ');
c[0].addEventListener("hidden.bs.modal",b=>{c.remove()});var d=new qc.Modal(c[0]);a.appendChild(c[0]);this.show=function(){d.show()}}function We(a,c){var d=ma(Ba)(`<div class="modal fade" tabindex="-1" role="dialog">
	            <div class="modal-dialog">
	                <div class="modal-content">
	                    <div class="modal-header">
	                        <h5 class="modal-title">${ia("Complete transform")}</h5>
	                        <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
	                        </button>
	                    </div>
	                    <div class="modal-body">
	                        <p>
							${ia("You need to finish transforming this layer before you can do that. What would you like to do with the transform?")}
							</p>
	                    </div>
	                    <div class="modal-footer">
	                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">${ia("Cancel")}</button>
	                        <button type="button" class="btn btn-light chickenpaint-reject-transform" data-bs-dismiss="modal">${ia("Undo transform")}</button>
	                        <button type="button" class="btn btn-primary chickenpaint-accept-transform" data-bs-dismiss="modal">${ia("Apply transform")}</button>
	                    </div>
	                </div>
	            </div>
	        </div>
	    `),b=this,g=ma(Ba)(".chickenpaint-accept-transform",d),p=ma(Ba)(".chickenpaint-reject-transform",d);g.on("click",function(e){c.actionPerformed({action:"CPTransformAccept"});b.emitEvent("accept")});p.on("click",function(e){c.actionPerformed({action:"CPTransformReject"});b.emitEvent("reject")});var f=new qc.Modal(d[0]);this.show=function(){f.show()};d[0].addEventListener("hidden.bs.modal",e=>{d.remove()});a.addEventListener("keydown",function l(m){"Enter"===m.key&&(f.hide(),c.actionPerformed({action:"CPTransformAccept"}),
b.emitEvent("accept"),a.removeEventListener("keydown",l))});a.appendChild(d[0])}function Uh(a){var c=ma(Ba)(`<div class="modal fade chickenpaint-shortcuts-dialog" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">${ia("Shortcuts")}</h5>
                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>
                                ${ia("Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.")}
                            </p>
                            <p>
                                ${ia("Here are some other shortcuts which are not as obvious!")}
                            </p>
                            <div class="chickenpaint-shortcuts-sections">
                                <div class="chickenpaint-shortcuts-section">
                                    <h5>${ia("Color swatches palette")}</h5>
                                    <ul class="chickenpaint-shortcuts-list list-unstyled">
                                        <li>
                                            <dl>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Use as the drawing color")}
                                                </dd>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${ia("Right")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Remove or replace a color swatch")}
                                                </dd>
                                             </dl>
                                        </li>
                                    </ul>
                                </div>
                                <div class="chickenpaint-shortcuts-section">
                                    <h5>${ia("Line drawing mode")}</h5>
                                    <ul class="chickenpaint-shortcuts-list list-unstyled">
                                        <li>
                                            <dl>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                   ${ia("Snap line to nearest 45 degrees")}
                                                </dd>
                                             </dl>
                                        </li>
                                    </ul>
                                </div>
                                <div class="chickenpaint-shortcuts-section">
                                    <h5>${ia("Painting tools")}</h5>
                                    <ul class="chickenpaint-shortcuts-list list-unstyled">
                                        <li>
                                            <dl>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">1</span> - <span class="chickenpaint-shortcut-key">9</span> , <span class="chickenpaint-shortcut-key">0</span></span>
                                                </dt>
                                                <dd>
                                                    ${ia("Change brush opacity")}
                                                </dd>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">[</span> , <span class="chickenpaint-shortcut-key">]</span></span>
                                                </dt>
                                                <dd>
                                                    ${ia("Change brush size")}
                                                </dd>
                                            </dl>
                                        </li>
                                    </ul>
                                </div>
                                <div class="chickenpaint-shortcuts-section">
                                    <h5>${ia("Brush palette")}</h5>
                                    <ul class="chickenpaint-shortcuts-list list-unstyled">
                                        <li>
                                            <dl>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${ia("Right")}</span>
													<span class="chickenpaint-shortcut-alternate">${ia("or")}</span>
													<span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Adjust brush sliders more precisely")}
                                                </dd>
                                            </dl>
                                        </li>
                                    </ul>
                                </div>
                                <div class="chickenpaint-shortcuts-section">
                                    <h5>${ia("Drawing canvas")}</h5>
                                    <ul class="chickenpaint-shortcuts-list list-unstyled">
                                        <li>
                                            <dl>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${ia("Middle")}</span> <span class="chickenpaint-shortcut-alternate">${ia("or")}</span> <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Space</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Move the canvas around")}
                                                </dd>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">R</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Rotate the canvas")}
                                                </dd>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${ia("Right")}</span> <span class="chickenpaint-shortcut-alternate">${ia("or")}</span> <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Alt</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Sample the color under the cursor")}
                                                </dd>
                                             </dl>
                                        </li>
                                    </ul>
                                </div>
                                <div class="chickenpaint-shortcuts-section">
                                    <h5>${ia("Layers palette")}</h5>
                                    <ul class="chickenpaint-shortcuts-list list-unstyled">
                                        <li>
                                            <dl>
                                                <dt>
                                                    <span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${ia("Double click")}</span> <span class="chickenpaint-shortcut-alternate">${ia("or")}</span> <span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${ia("Right")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Rename layer")}
                                                </dd>
                                                <dt>
												<span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Toggle mask enable/disable")}
                                                </dd>
                                                <dt>
												<span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Alt</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Toggle mask View")}
                                                </dd>
												<dt>
												<span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Ug}</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Apply layer mask")}
                                                </dd>
												<dt>
												<span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span></span> +
												<span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Ug}</span> + <span class="fa icon-mouse-pointer"></span> ${ia("Left")}</span>
                                                </dt>
                                                <dd>
                                                    ${ia("Delete layer mask")}
                                                </dd>
                                             </dl>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `);c[0].addEventListener("hidden.bs.modal",b=>{c.remove()});var d=new qc.Modal(c[0]);a.appendChild(c[0]);this.show=function(){d.show()}}function Vh(a,c){let d=ma(Ba)(`<div class="modal fade" tabindex="-1" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">${ia("Box blur")}</h5>
                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="form-group">
                                    <label>${ia("Blur amount (pixels)")}</label>
                                    <input type="number" class="form-control chickenpaint-blur-amount" value="3" min="1">
                                </div>
                                <div class="form-group">
                                    <label>${ia("Iterations (1-8, larger gives smoother blur)")}</label>
                                    <input type="number" class="form-control chickenpaint-blur-iterations" value="1" min="1" max="8">
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-light" data-bs-dismiss="modal">${ia("Cancel")}</button>
                            <button type="button" class="btn btn-primary chickenpaint-apply-box-blur" data-bs-dismiss="modal">${ia("Ok")}</button>
                        </div>
                    </div>
                </div>
            </div>
        `),b=ma(Ba)(".chickenpaint-blur-amount",d),g=ma(Ba)(".chickenpaint-blur-iterations",d),p=ma(Ba)(".chickenpaint-apply-box-blur",d);var f=new qc.Modal(d[0]);this.show=function(){let e=document.getElementById("chickenpaint-main-menu-content");e&&e.classList.contains("show")&&(new qc.Collapse(e,{toggle:!1})).hide();f.show()};p[0].addEventListener("click",e=>{e=Math.max(parseInt(b.val(),10),1);let m=Math.min(Math.max(parseInt(g.val(),10),1),8);c.getArtwork().boxBlur(e,e,m);f.hide()});d[0].addEventListener("hidden.bs.modal",
e=>{document.activeElement.blur();d[0].remove()});d[0].addEventListener("shown.bs.modal",e=>{b[0].focus()});d[0].addEventListener("keydown",e=>{"Enter"===e.key&&d.hasClass("show")&&(p[0].click(),e.preventDefault())});a.appendChild(d[0])}function Wh(a){let c=ma(Ba)('<div class="modal fade" tabindex="-1" role="dialog">\n                <div class="modal-dialog" role="document">\n                    <div class="modal-content">\n                        <div class="modal-header">\n                            <h5 class="modal-title">Drawing tablet support</h5>\n                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">\n                            </button>\n                        </div>\n                        <div class="modal-body">\n                            <p class="chickenpaint-tablet-there-are-two-options">\n                                There are two ways you could use your tablet\'s pen pressure support with ChickenPaint.\n                            </p>\n                            <div class="chickenpaint-tablet-support chickenpaint-wacom-support">\n                                <h5>\n                                    Plugin for Wacom tablets\n                                </h5>\n                                <div class="chickenpaint-supported-browsers">\n                                    <div class="chickenpaint-supported-browser">\n                                        <span class="icon-firefox"></span>\n                                        Firefox (32-bit only)\n                                    </div>\n                                    <div class="chickenpaint-supported-browser">\n                                        <span class="icon-safari"></span>\n                                        Safari\n                                    </div>\n                                        <div class="chickenpaint-supported-browser">\n                                        <span class="icon-opera"></span>\n                                        Opera\n                                    </div>\n                                </div>\n                                <p class="chickenpaint-not-installed">\n                                    The plugin for Wacom tablets doesn\'t seem to be installed in your browser yet.\n                                </p>\n                                <p class="chickenpaint-not-installed">\n                                    Please make sure that you\'ve installed the latest drivers for your tablet from the \n                                    <a href="http://www.wacom.com/en-us/support/product-support/drivers" target="_blank">Wacom drivers page</a>,\n                                    then restart your browser.\n                                </p>\n                                <p class="chickenpaint-not-supported">\n                                    Your browser doesn\'t support the Wacom tablet plugin, please \n                                    try one of the browsers listed above instead.\n                                </p>\n                                <p class="chickenpaint-supported alert alert-success">\n                                    The Wacom tablet plugin is installed and working.\n                                </p>\n                            </div>\n                            <div class="chickenpaint-tablet-support chickenpaint-pointerevents-support">\n                                <h5>\n                                    Built-in support for most tablets.\n                                    <small>macOS, Windows 10 or newer</small>\n                                </h5>\n                                <div class="chickenpaint-supported-browsers">\n\t\t\t\t\t\t\t\t\t<div class="chickenpaint-supported-browser">\n\t\t\t\t\t\t\t\t\t<span class="icon-chrome"></span>\n\t\t\t\t\t\t\t\t\t\tChrome\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="chickenpaint-supported-browser">\n                                        <span class="icon-edge"></span>\n                                        Edge (Windows 10)\n                                    </div>\n                                    <div class="chickenpaint-supported-browser">\n                                        <span class="icon-firefox"></span>\n                                        Firefox (<a href="https://github.com/satopian/ChickenPaint_Be/blob/main/help/Firefox%20pressure%20support.md" target="_blank" rel="noopener">help <i class="fa icon-external-link-alt"></i></a>)\n                                    </div>\n                                </div>\n                                <p class="chickenpaint-not-supported">\n                                    Your browser doesn\'t have built-in support for drawing tablets, please try\n                                    one of the other browsers listed above.\n                                </p>\n                                <p class="chickenpaint-supported alert alert-success">\n                                    Your browser has built-in support for drawing tablets!\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n       '),
d=ma(Ba)(".chickenpaint-wacom-support",c),b=ma(Ba)(".chickenpaint-pointerevents-support",c),g=ma(Ba)(".chickenpaint-tablet-there-are-two-options",c),p=ed.getRef().isTabletPresent(),f=!!window.hasNativePointerEvents;d.toggleClass("supported",p);p?(b.hide(),g.hide()):((/Chrome/i.test(navigator.userAgent)&&!/OPR/.test(navigator.userAgent)||/iPad/.test(navigator.userAgent)||/iPhone/.test(navigator.userAgent))&&d.addClass("not-supported"),f&&(d.hide(),g.hide()));b.toggleClass("supported",f);b.toggleClass("not-supported",
!f);c[0].addEventListener("hidden.bs.modal",m=>{c.remove()});var e=new qc.Modal(c[0]);a.appendChild(c[0]);this.show=function(){e.show()}}function Xh(a,c){var d=ma(Ba)(`<div class="modal fade" tabindex="-1" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">${ia("Grid options")}</h5>
                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="form-group">
                                    <label>${ia("Grid size")}</label>
                                    <input type="number" class="form-control chickenpaint-grid-size" value="" min="3">
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-light" data-bs-dismiss="modal">${ia("Cancel")}</button>
                            <button type="button" class="btn btn-primary chickenpaint-apply-grid-settings" data-bs-dismiss="modal">${ia("Ok")}</button>
                        </div>
                    </div>
                </div>
            </div>
        `),b=ma(Ba)(".chickenpaint-grid-size",d),g=ma(Ba)(".chickenpaint-apply-grid-settings",d),p=new qc.Modal(d[0]);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new qc.Collapse(f,{toggle:!1})).hide();p.show()};b.val(c.getGridSize());d[0].addEventListener("hidden.bs.modal",f=>{d[0].remove()});g[0].addEventListener("click",f=>{f=parseInt(b.val(),10);c.setGridSize(f);f=qc.Modal.getInstance(d[0]);document.activeElement.blur();
f.hide()});d[0].addEventListener("shown.bs.modal",f=>{b[0].focus()});d[0].addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),g[0].click())});a.appendChild(d[0])}function Xe(a,c,d){let b=ma(Ba)(`<div class="modal fade chickenpaint-send-dialog" tabindex="-1" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content" data-stage="saving">
                        <div class="modal-header">
                            <h5 class="modal-title">${ia("Saving drawing...")}</h5>
                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <p class="chickenpaint-saving-progress-message">${ia("Preparing your drawing to be saved, please wait...")}</p>
                            <pre class="chickenpaint-saving-error-message pre-scrollable"></pre>
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-light chickenpaint-send-cancel" data-bs-dismiss="modal">${ia("Cancel")}</button>
                        </div>
                    </div>
                    <div class="modal-content" data-stage="success-not-previously-posted" style="display:none">
                        <div class="modal-header">
                            <h5 class="modal-title">${ia("Drawing saved!")}</h5>
                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>${ia("Your drawing has been saved, would you like to post it to the forum now?")}</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${ia("Yes, post it now")}</button>
                            <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${ia("No, keep drawing")}</button>
                            <button type="button" class="btn btn-light chickenpaint-exit" data-bs-dismiss="modal">${ia("No, quit and I'll finish it later")}</button>
                        </div>
                    </div>
                    <div class="modal-content" data-stage="success-already-posted" style="display:none">
                        <div class="modal-header">
                            <h5 class="modal-title">${ia("Drawing saved!")}</h5>
                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>${ia("Your drawing has been saved, would you like to view it on the forum now?")}</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${ia("Yes, view the post")}</button>
                            <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${ia("No, keep drawing")}</button>
                        </div>
                    </div>
                    <div class="modal-content" data-stage="success-redirect" style="display:none">
                        <div class="modal-header">
                            <h5 class="modal-title">${ia("Drawing saved!")}</h5>
                            <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="btn btn-close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>${ia("Your drawing has been saved, redirecting you to view your new post now...")}</p>
                        </div>
                    </div>
                </div>
            </div>
        `),g=ma(Ba)(".chickenpaint-saving-progress-message",b),p=ma(Ba)(".chickenpaint-saving-error-message",b),f=ma(Ba)(".progress-bar",b),e=this;d.on("savingProgress",function(h,n){h*=100;g.text(n);ma(Ba)(f).attr("aria-valuenow",h).css("width",h+"%")});d.on("savingComplete",function(){let h=b[0];h.querySelector(".modal-content[data-stage='saving']").style.display="none";a.isActionSupported("CPContinue")?a.isActionSupported("CPExit")?h.querySelector(".modal-content[data-stage='success-not-previously-posted']").style.display=
"block":h.querySelector(".modal-content[data-stage='success-already-posted']").style.display="block":h.querySelector(".modal-content[data-stage='success-redirect']").style.display="block"});d.on("savingFailure",function(h){f.addClass("progress-bar-danger");let n=ia("Sorry, your drawing could not be saved, please try again later.");h&&(0<(h=h.replace(/^CHIBIERROR\s*/,"")).length&&(n+=`<br><br>${ia("The error returned from the server was")}:`,p.text(h).show()),g.html(n))});b[0].querySelector(".chickenpaint-post-drawing").addEventListener("click",
function(){a.actionPerformed({action:"CPPost"})});let m=b[0].querySelector(".chickenpaint-exit");m&&(m.style.display=a.isActionSupported("CPExit")?"":"none",m.addEventListener("click",function(){alert("When you want to come back and finish your drawing, just click the 'new drawing' button again and you can choose to continue this drawing.");a.actionPerformed({action:"CPExit"})}));b[0].querySelector(".chickenpaint-send-cancel").addEventListener("click",function(){d.cancel()});b[0].addEventListener("hidden.bs.modal",
h=>{b.remove()});b.appendTo(c);let l=new qc.Modal(b[0]);this.show=function(){l.show();e.emitEvent("shown")}}function na(a){function c(U){this.palName=U}function d(U){this.toolNum=U}function b(U){this.modeNum=U}function g(U){let ya;switch(D=U==Ec.EDITING_MODE_IMAGE?na.COLOR_MODE_RGB:na.COLOR_MODE_GREYSCALE,n.emitEvent("colorModeChange",[U==Ec.EDITING_MODE_IMAGE?"rgb":"greyscale"]),D){case na.COLOR_MODE_RGB:ya=v.clone();break;case na.COLOR_MODE_GREYSCALE:ya=new Ab(Ab.greyToRGB(x))}n.artwork.setForegroundColor(ya.getRgb());
n.emitEvent("colorChange",[ya])}function p(){n.emitEvent("toolChange",[G,X[G]])}function f(U){N!=U&&(U==na.M_TRANSFORM&&(K=N),N=U,n.emitEvent("modeChange",[N]))}function e(U){f(na.M_DRAW);G=U;n.artwork.setBrush(X[U]);p()}function m(U,ya){h&&(h.addEventListener("dblclick",function(pa){pa.preventDefault();pa.stopPropagation()}),n.artwork.on("editModeChanged",g),t=new Ve(n,h),n.emitEvent("fullScreen",[ba]),n.emitEvent("smallScreen",[L]),Y.load(),e(na.T_PEN),t.arrangePalettes(),U&&t.setSwatches(U),ya&&
t.setRotation90(ya),ed.getRef().detectTablet(),window.addEventListener("beforeunload",function(pa){n.artwork.getHasUnsavedChanges()&&pa.preventDefault()}),n.artwork.on("unsavedChanges",pa=>{a.allowMultipleSends&&n.emitEvent("unsavedChanges",[pa])}))}var l;!function(){try{if("undefined"!=typeof navigator){let U=navigator.languages;for(let ya of(Array.isArray(U)||(U=[U]),U)){let pa=/^(..)([-_].+)?$/.exec(ya);if(pa){if(pa[1]=pa[1].toLowerCase(),pa[1]in If){Hf(ya);break}if("en"===pa[1]){Hf("en");break}}}}}catch(U){console.error(U)}}();
a.language&&Hf(a.language);let h=a.uiElem;document.addEventListener("keydown",U=>{((U.ctrlKey||U.metaKey)&&"+;=-shro".split("").includes(U.key.toLowerCase())||"Enter"===U.key)&&U.preventDefault()});h.addEventListener("contextmenu",U=>{U.preventDefault();U.stopPropagation()},{passive:!1});let n=this,r,t,v=new Ab(0),x=255,D=na.COLOR_MODE_RGB,G=na.T_PENCIL,N=na.M_DRAW,K=N,P=[4278190080,4294967295],L=!1,ba=!1,X=((l=Array(na.T_MAX))[na.T_PENCIL]=new Ca({toolNb:na.T_PENCIL,size:16,alpha:255,isAA:!0,minSpacing:.5,
spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_AA,brushMode:Ca.BRUSH_MODE_PAINT,paintMode:Ca.PAINT_MODE_OPACITY}),l[na.T_ERASER]=new Ca({toolNb:na.T_ERASER,size:16,alpha:255,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!1,texture:0,tip:Ca.TIP_ROUND_AA,brushMode:Ca.BRUSH_MODE_ERASE,paintMode:Ca.PAINT_MODE_OPACITY}),l[na.T_PEN]=new Ca({toolNb:na.T_PEN,size:2,alpha:128,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!0,pressureAlpha:!1,tip:Ca.TIP_ROUND_AA,brushMode:Ca.BRUSH_MODE_PAINT,
paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.5}),l[na.T_SOFTERASER]=new Ca({toolNb:na.T_SOFTERASER,size:16,alpha:64,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,texture:1,tip:Ca.TIP_ROUND_AIRBRUSH,brushMode:Ca.BRUSH_MODE_ERASE,paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.125}),l[na.T_AIRBRUSH]=new Ca({toolNb:na.T_AIRBRUSH,size:50,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_AIRBRUSH,brushMode:Ca.BRUSH_MODE_PAINT,paintMode:Ca.PAINT_MODE_FLOW,
alphaScale:.125}),l[na.T_DODGE]=new Ca({toolNb:na.T_DODGE,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_AIRBRUSH,brushMode:Ca.BRUSH_MODE_DODGE,paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.125}),l[na.T_BURN]=new Ca({toolNb:na.T_BURN,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_AIRBRUSH,brushMode:Ca.BRUSH_MODE_BURN,paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.125}),l[na.T_WATER]=new Ca({toolNb:na.T_WATER,
size:30,alpha:70,isAA:!1,minSpacing:.5,spacing:.02,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_AA,brushMode:Ca.BRUSH_MODE_WATER,paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.125,resat:.3,bleed:.6}),l[na.T_BLUR]=new Ca({toolNb:na.T_BLUR,size:20,alpha:255,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_PIXEL,brushMode:Ca.BRUSH_MODE_BLUR,paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.125}),l[na.T_SMUDGE]=new Ca({toolNb:na.T_SMUDGE,size:20,alpha:128,isAA:!1,minSpacing:.5,
spacing:.01,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_AIRBRUSH,brushMode:Ca.BRUSH_MODE_SMUDGE,paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:1}),l[na.T_BLENDER]=new Ca({toolNb:na.T_BLENDER,size:20,alpha:60,isAA:!1,minSpacing:.5,spacing:.1,pressureSize:!1,pressureAlpha:!0,tip:Ca.TIP_ROUND_AIRBRUSH,brushMode:Ca.BRUSH_MODE_OIL,paintMode:Ca.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:.07}),l),Y=new Yh,ka,Aa,Ga={CPFullScreen:{action:function(){n.setFullScreen(!ba)},isSupported:function(){return"disable"!==
a.fullScreenMode&&"force"!==a.fullScreenMode&&!1!==a.allowFullScreen},modifies:{gui:!0}},CPZoomIn:{action:function(){r.zoomIn()},modifies:{gui:!0}},CPZoomOut:{action:function(){r.zoomOut()},modifies:{gui:!0}},CPZoom100:{action:function(){r.zoom100()},modifies:{gui:!0}},CPUndo:{action:function(){n.artwork.undo()},modifies:{document:!0},allowed:"isUndoAllowed"},CPRedo:{action:function(){n.artwork.redo()},modifies:{document:!0},allowed:"isRedoAllowed"},CPClearHistory:{action:function(){confirm(ia("You're about to clear the current Undo/Redo history.\nThis operation cannot be undone, are you sure you want to do that?"))&&
n.artwork.clearHistory()},modifies:{document:!0}},CPPencil:new d(na.T_PENCIL),CPPen:new d(na.T_PEN),CPEraser:new d(na.T_ERASER),CPSoftEraser:new d(na.T_SOFTERASER),CPAirbrush:new d(na.T_AIRBRUSH),CPDodge:new d(na.T_DODGE),CPBurn:new d(na.T_BURN),CPWater:new d(na.T_WATER),CPBlur:new d(na.T_BLUR),CPSmudge:new d(na.T_SMUDGE),CPBlender:new d(na.T_BLENDER),CPFloodFill:new b(na.M_FLOODFILL),CPGradientFill:new b(na.M_GRADIENTFILL),CPRectSelection:new b(na.M_RECT_SELECTION),CPMoveTool:new b(na.M_MOVE_TOOL),
CPRotateCanvas:new b(na.M_ROTATE_CANVAS),CPPanCanvas:new b(na.M_PAN_CANVAS),CPColorPicker:new b(na.M_COLOR_PICKER),CPTransform:{action:function(){let U=n.artwork.getActiveLayer();null==n.artwork.transformAffineBegin()?n.showLayerNotification(U,ia("Whoops! All of the selected pixels are transparent!"),"layer"):f(na.M_TRANSFORM)},modifies:{mode:!0},allowed:function(){let U=n.artwork.getActiveLayer();if(U.visible)if(0==U.alpha)n.showLayerNotification(U,ia("Whoops! This layer's opacity is currently 0%"),
"opacity");else{if(null!=n.artwork.transformAffineBegin())return 0!=U.getEffectiveAlpha();n.showLayerNotification(U,ia("Whoops! All of the selected pixels are transparent!"),"layer")}else n.showLayerNotification(U,ia("Whoops! This layer is currently hidden"),"layer")}},CPTransformAccept:{action:function(){N==na.M_TRANSFORM&&(n.artwork.transformAffineFinish(),f(K))},modifies:{mode:!0}},CPTransformReject:{action:function(){N==na.M_TRANSFORM&&(n.artwork.transformAffineAbort(),f(K))},modifies:{document:!0,
mode:!0}},CPFreeHand:{action:function(){X[G].strokeMode=Ca.STROKE_MODE_FREEHAND;p()},modifies:{tool:!0}},CPLine:{action:function(){X[G].strokeMode=Ca.STROKE_MODE_LINE;p()},modifies:{tool:!0}},CPBezier:{action:function(){X[G].strokeMode=Ca.STROKE_MODE_BEZIER;p()},modifies:{tool:!0}},CPAbout:{action:function(){(new Th(h)).show()},modifies:{}},CPShortcuts:{action:function(){(new Uh(h)).show()},modifies:{}},CPTabletSupport:{action:function(){(new Wh(h)).show()},modifies:{}},CPLayerDuplicate:{action:function(){n.artwork.duplicateLayer()},
modifies:{document:!0}},CPLayerMergeDown:{action:function(){n.artwork.mergeDown()},modifies:{document:!0},allowed:"isMergeDownAllowed"},CPGroupMerge:{action:function(){n.artwork.mergeGroup()},modifies:{document:!0},allowed:"isMergeGroupAllowed"},CPLayerMergeAll:{action:function(){n.artwork.mergeAllLayers()},modifies:{document:!0},allowed:"isMergeAllLayersAllowed"},CPExpandLayerGroup:{action:function(U){n.artwork.expandLayerGroup(U.group,U.expand)},modifies:{document:!0}},CPFill:{action:function(){n.artwork.fill(4278190080|
n.getCurColor().getRgb())},modifies:{document:!0},requiresDrawable:!0},CPClear:{action:function(){n.artwork.clear()},modifies:{document:!0},requiresDrawable:!0},CPSelectAll:{action:function(){n.artwork.rectangleSelection(n.artwork.getBounds());r.repaintAll()},modifies:{document:!0}},CPDeselectAll:{action:function(){n.artwork.rectangleSelection(new Ha(0,0,0,0));r.repaintAll()},modifies:{document:!0}},CPHFlip:{action:function(){n.artwork.hFlip()},modifies:{document:!0},requiresDrawable:!0},CPVFlip:{action:function(){n.artwork.vFlip()},
modifies:{document:!0},requiresDrawable:!0},CPMNoise:{action:function(){n.artwork.monochromaticNoise()},modifies:{document:!0},requiresDrawable:!0},CPCNoise:{action:function(){n.artwork.colorNoise()},modifies:{document:!0},allowed:"isColorNoiseAllowed"},CPFXBoxBlur:{action:function(){ka||=new Vh(h,n);ka.show()},modifies:{document:!0},requiresDrawable:!0},CPFXInvert:{action:function(){n.artwork.invert()},modifies:{document:!0},requiresDrawable:!0},CPBrightnessToOpacity:{action:function(){n.artwork.brightnessToOpacity()},
modifies:{document:!0},requiresDrawable:!0},CPCut:{action:function(){n.artwork.cutSelection()},modifies:{document:!0},requiresDrawable:!0,allowed:"isCutSelectionAllowed"},CPCopy:{action:function(){n.artwork.copySelection()},modifies:{document:!0},requiresDrawable:!0,allowed:"isCopySelectionAllowed"},CPCopyMerged:{action:function(){n.artwork.copySelectionMerged()},modifies:{document:!0},allowed:"isCopySelectionMergedAllowed"},CPPaste:{action:function(){n.artwork.pasteClipboard()},modifies:{document:!0},
allowed:"isPasteClipboardAllowed"},CPToggleGrid:{action:function(U){r.showGrid(U.selected)},modifies:{gui:!0}},CPGridOptions:{action:function(){Aa||=new Xh(h,r);Aa.show()},modifies:{gui:!0}},CPLinearInterpolation:{action:function(U){r.setInterpolation(U.selected)},modifies:{gui:!0},isSupported:function(){return!!rf(Yc(0,0).getContext("2d"))}},CPResetCanvasRotation:{action:function(){r.resetRotation()},modifies:{gui:!0}},CPAddLayer:{action:function(){n.artwork.addLayer("layer")},modifies:{document:!0}},
CPAddGroup:{action:function(){n.artwork.addLayer("group")},modifies:{document:!0}},CPAddLayerMask:{action:function(){n.artwork.addLayerMask()},modifies:{document:!0},allowed:"isAddLayerMaskAllowed"},CPApplyLayerMask:{action:function(){n.artwork.applyLayerMask(!0)},modifies:{document:!0},allowed:"isApplyLayerMaskAllowed"},CPRemoveLayerMask:{action:function(){n.artwork.removeLayerMask()},modifies:{document:!0},allowed:"isRemoveLayerMaskAllowed"},CPRemoveLayer:{action:function(){n.artwork.removeLayer()||
alert(ia("Sorry, you can't remove the last remaining layer in the drawing."))},modifies:{document:!0},allowed:"isRemoveLayerAllowed"},CPCreateClippingMask:{action:function(){n.artwork.createClippingMask()},modifies:{document:!0},allowed:"isCreateClippingMaskAllowed"},CPReleaseClippingMask:{action:function(){n.artwork.releaseClippingMask()},modifies:{document:!0},allowed:"isReleaseClippingMaskAllowed"},CPRelocateLayer:{action:function(U){n.artwork.relocateLayer(U.layer,U.toGroup,U.toIndex)},modifies:{document:!0}},
CPSetActiveLayer:{action:function(U){U.mask&&U.layer.mask&&!U.layer.maskVisible&&n.artwork.setLayerMaskVisible(U.layer,!0);n.artwork.setActiveLayer(U.layer,U.mask);n.artwork.performIdleTasks()},modifies:{document:!0}},CPToggleMaskView:{action:function(){let U=n.artwork.toggleMaskView();U&&n.emitEvent("maskViewOpened",[U])},modifies:{gui:!0}},CPSetMaskVisible:{action:function(U){n.artwork.setLayerMaskVisible(U.layer,U.visible)},modifies:{layerProp:!0}},CPSetLayerVisibility:{action:function(U){n.artwork.setLayerVisibility(U.layer,
U.visible)},modifies:{layerProp:!0}},CPSetLayerName:{action:function(U){n.artwork.setLayerName(U.layer,U.name)},modifies:{layerProp:!0}},CPSetLayerBlendMode:{action:function(U){n.artwork.setLayerBlendMode(U.blendMode)},modifies:{layerProp:!0}},CPSetLayerAlpha:{action:function(U){n.artwork.setLayerAlpha(U.alpha)},modifies:{layerProp:!0}},CPSetLayerLockAlpha:{action:function(U){n.artwork.setLayerLockAlpha(U.lock)},modifies:{layerProp:!0}},CPPalColor:new c("color"),CPPalBrush:new c("brush"),CPPalLayers:new c("layers"),
CPPalStroke:new c("stroke"),CPPalSwatches:new c("swatches"),CPPalTool:new c("tool"),CPPalMisc:new c("misc"),CPPalTextures:new c("textures"),CPTogglePalettes:{action:function(){t.togglePalettes()},modifies:{gui:!0}},CPArrangePalettes:{action:function(){t.arrangePalettes()},modifies:{gui:!0}},CPSave:{action:function(){let U;(U=new ne({artwork:n.getArtwork(),rotation:r.getRotation90(),swatches:t.getSwatches()})).on("savingComplete",function(){n.artwork.setHasUnsavedChanges(!1)});U.on("savingFailure",
function(){alert(ia("Sorry, your drawing could not be saved, Please see the error message."))});U.save()},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPSend:{action:function(){!function(){if(n.isActionSupported("CPContinue")||confirm(ia("Are you sure you want to send your drawing to the server and finish drawing now?"))){var U=new ne({artwork:n.getArtwork(),rotation:r.getRotation90(),swatches:t.getSwatches(),url:a.saveUrl,post_max_size:a.post_max_size}),ya=new Xe(n,
h,U);U.on("savingComplete",function(){n.artwork.setHasUnsavedChanges(!1);!n.isActionSupported("CPContinue")&&n.isActionSupported("CPPost")&&n.actionPerformed({action:"CPPost"})});U.on("savingFailure",function(){alert(ia("Sorry, your drawing could not be saved, Please see the error message."))});ya.on("shown",function(){U.save()});ya.show()}}()},isSupported:function(){return!!a.saveUrl},modifies:{document:!0}},CPPost:{action:function(){if("function"==typeof handleExit)return handleExit();window.location=
a.postUrl},isSupported:function(){return!(!a.postUrl&&"function"!=typeof handleExit)},modifies:{document:!0}},CPContinue:{action:function(){},isSupported:function(){return!!a.allowMultipleSends}},CPExit:{action:function(){window.location=a.exitUrl},isSupported:function(){return!!a.exitUrl},modifies:{}}};switch(c.prototype.action=function(U){t.showPalette(this.palName,U.selected)},c.prototype.modifies={gui:!0},d.prototype.action=function(){e(this.toolNum)},d.prototype.modifies={mode:!0,tool:!0},d.prototype.requiresDrawable=
!0,b.prototype.action=function(){f(this.modeNum)},b.prototype.modifies={mode:!0},this.callToolListeners=function(){p()},this.getArtwork=function(){return this.artwork},this.setCanvas=function(U){r=U},this.setTransformInterpolation=function(U){this.artwork.setTransformInterpolation(U)},this.setCurColor=function(U){switch(D){case na.COLOR_MODE_RGB:v.isEqual(U)||(v.copyFrom(U),this.artwork.setForegroundColor(U.getRgb()),this.emitEvent("colorChange",[U]));break;case na.COLOR_MODE_GREYSCALE:if(U=U.getValue(),
x!=U){let ya=Ab.greyToRGB(U);this.artwork.setForegroundColor(ya);x=U;this.emitEvent("colorChange",[new Ab(ya)])}}},this.getCurColor=function(){switch(D){case na.COLOR_MODE_RGB:return v.clone();case na.COLOR_MODE_GREYSCALE:return new Ab(Ab.greyToRGB(x))}},this.setCurGradient=function(U){P=U.slice(0);this.emitEvent("gradientChange",[P])},this.getCurGradient=function(){return P.slice(0)},this.setBrushSize=function(U){X[G].size=Math.max(1,Math.min(200,U));p()},this.getBrushSize=function(){return X[G].size},
this.setAlpha=function(U){X[G].alpha=U;p()},this.getAlpha=function(){return X[G].alpha},this.getCurMode=function(){return N},this.getCurTool=function(){return G},this.getBrushInfo=function(){return X[G]},this.isActionSupported=function(U){if(Ga[U]){let ya=typeof Ga[U].isSupported;return"function"==ya?Ga[U].isSupported():"undefined"==ya||Ga[U].isSupported}return!1},this.isActionAllowed=function(U){U=Ga[U];return!!U&&("function"==typeof U.allowed?U.allowed():"string"==typeof U.allowed?this.artwork[U.allowed]():
!U.requiresDrawable||this.artwork.isActiveLayerDrawable())},this.showLayerNotification=function(U,ya,pa){this.emitEvent("layerNotification",[U,ya,pa])},this.actionPerformed=function(U){if(null!=this.artwork&&null!=r){var ya=Ga[U.action];ya&&(N==na.M_TRANSFORM&&(ya.modifies.document||ya.modifies.mode)&&-1==["CPTransformAccept","CPTransformReject"].indexOf(U.action)?"CPUndo"==U.action?Ga.CPTransformReject.action():"CPTransform"!=U.action&&(ya=new We(h,this),ya.on("accept",this.actionPerformed.bind(this,
U)),ya.on("reject",this.actionPerformed.bind(this,U)),ya.show()):ya.action(U))}},this.setSmallScreenMode=function(U){L!==U&&(L=U,h.classList.toggle("chickenpaint-small-screen",L),n.emitEvent("smallScreen",[L]))},this.getSmallScreenMode=function(){return L},this.setFullScreen=function(U){ba!==U&&(ba=U,document.body.classList.toggle("chickenpaint-full-screen",ba),h.classList.toggle("chickenpaint-full-screen",ba),U=document.querySelectorAll('head meta[name="viewport"]').length,ba&&0===U?(U=document.createElement("meta"),
U.name="viewport",U.content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,,user-scalable=no",document.head.appendChild(U),setTimeout(()=>n.emitEvent("fullScreen",[ba]),200)):n.emitEvent("fullScreen",[ba]))},this.isFullScreen=function(){return ba},this.setToolbarStyle=function(U){Y.set("toolbarStyle",U);Y.save()},this.getToolbarStyle=function(){return Y.get("toolbarStyle")},this.getResourcesRoot=function(){return a.resourcesRoot},!function(){var U;if(!((U=Yc(0,0)).getContext&&
U.getContext("2d")&&"Uint8Array"in window))throw new na.UnsupportedBrowserException;U=(-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("iPod")||-1!=navigator.userAgent.indexOf("iPhone"))&&-1!=navigator.userAgent.indexOf(" OS 8_0 ");let ya=-1==navigator.userAgent.indexOf("CriOS")&&-1!=navigator.userAgent.indexOf("Safari");if(U&&ya)throw new na.UnsupportedBrowserException("You are using Safari 8.0.0, which is unable to upload drawings. That bug was fixed in the iOS 8.0.2 update, or in Chrome for iOS.");
}(),h&&(!(("string"==typeof document.body.style.flexBasis||"string"==typeof document.body.style.msFlexDirection)&&!/Presto/.test(navigator.userAgent))&&(h.className+=" no-flexbox"),h.className+=" chickenpaint chickenpaint-lang-"+Jf),a.resourcesRoot=a.resourcesRoot||"chickenpaint/",this.setSmallScreenMode(!!("number"==typeof navigator.maxTouchPoints&&2<navigator.maxTouchPoints&&(820>=window.screen.width||820>=window.screen.height))),a.fullScreenMode){case "force":this.setFullScreen(!0);break;case "auto":this.setFullScreen(L)}(Y.on("toolbarStyle",
U=>this.emitEvent("toolbarStyleChange",[U])),a.loadImageUrl||a.loadChibiFileUrl)?(l=new Ie(a),new Kh(h,l,a.resourcesRoot),l.on("loadingComplete",function(U){n.artwork=U.layers||U.flat;m(U.swatches,a.rotation);a.onLoaded&&a.onLoaded(this)}),l.load()):(a.artwork?this.artwork=a.artwork:(this.artwork=new Ec(a.canvasWidth||800,a.canvasHeight||600),this.artwork.addBackgroundLayer(),this.artwork.addDefaultLayer()),m(),a.onLoaded&&a.onLoaded(this))}var Vg,Wg,Xg,Mf,Nf,Ye="undefined"!=typeof globalThis?globalThis:
"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};Ca.STROKE_MODE_FREEHAND=0;Ca.STROKE_MODE_LINE=1;Ca.STROKE_MODE_BEZIER=2;Ca.TIP_ROUND_PIXEL=0;Ca.TIP_ROUND_AA=1;Ca.TIP_ROUND_AIRBRUSH=2;Ca.TIP_SQUARE_PIXEL=3;Ca.TIP_SQUARE_AA=4;Ca.BRUSH_MODE_PAINT=0;Ca.BRUSH_MODE_ERASE=1;Ca.BRUSH_MODE_DODGE=2;Ca.BRUSH_MODE_BURN=3;Ca.BRUSH_MODE_WATER=4;Ca.BRUSH_MODE_BLUR=5;Ca.BRUSH_MODE_SMUDGE=6;Ca.BRUSH_MODE_OIL=7;Ca.PAINT_MODE_OPACITY=0;Ca.PAINT_MODE_FLOW=1;Ca.DEFAULTS=
{isAA:!1,minSpacing:0,spacing:0,pressureSize:!0,pressureAlpha:!1,pressureScattering:!1,alphaScale:1,tip:Ca.TIP_ROUND_PIXEL,brushMode:Ca.BRUSH_MODE_PAINT,paintMode:Ca.PAINT_MODE_OPACITY,strokeMode:Ca.STROKE_MODE_FREEHAND,resat:1,bleed:0,texture:1,size:0,curSize:0,alpha:0,curAlpha:0,scattering:0,curScattering:0,squeeze:0,curSqueeze:0,angle:Math.PI,curAngle:0,smoothing:0};Ca.prototype.applyPressure=function(a){this.pressureSize&&this.brushMode!=Ca.BRUSH_MODE_SMUDGE&&this.brushMode!=Ca.BRUSH_MODE_OIL?
this.curSize=Math.max(.1,this.size*a):this.curSize=Math.max(.1,this.size);16<this.curSize&&(this.curSize=Math.floor(this.curSize));this.curSize=Math.min(this.curSize,400);this.curAlpha=this.pressureAlpha?Math.floor(this.alpha*Math.min(a,1)):this.alpha;this.curSqueeze=this.squeeze;this.curAngle=this.angle;this.curScattering=this.scattering*this.curSize*(this.pressureScattering?a:1)};Ca.prototype.clone=function(){return new Ca(this)};Ha.prototype.makeEmpty=function(){this.bottom=this.right=this.top=
this.left=0};Ha.prototype.union=function(a){this.isEmpty()?this.set(a):a.isEmpty()||(this.left=Math.min(this.left,a.left),this.top=Math.min(this.top,a.top),this.right=Math.max(this.right,a.right),this.bottom=Math.max(this.bottom,a.bottom))};Ha.prototype.getUnion=function(a){var c=this.clone();return c.union(a),c};Ha.prototype.getIntersection=function(a){return new Ha(Math.max(this.left,a.left),Math.max(this.top,a.top),Math.min(this.right,a.right),Math.min(this.bottom,a.bottom))};Ha.prototype.clipTo=
function(a){return this.isEmpty()||(a.isEmpty()?this.makeEmpty():(this.left=Math.min(Math.max(this.left,a.left),a.right),this.top=Math.min(Math.max(this.top,a.top),a.bottom),this.right=Math.max(Math.min(this.right,a.right),a.left),this.bottom=Math.max(Math.min(this.bottom,a.bottom),a.top))),this};Ha.prototype.containsPoint=function(a){return!(a.x<this.left||a.y<this.top||a.x>=this.right||a.y>=this.bottom)};Ha.prototype.isInside=function(a){return this.left>=a.left&&this.top>=a.top&&this.right<=a.right&&
this.bottom<=a.bottom};Ha.prototype.clipSourceDest=function(a,c){c.right=c.left+a.getWidth();c.bottom=c.top+a.getHeight();this.isEmpty()||c.left>=this.right||c.top>=this.bottom||c.right<=this.left||c.bottom<=this.top?(a.makeEmpty(),c.makeEmpty()):(c.right>this.right&&(a.right-=c.right-this.right,c.right=this.right),c.bottom>this.bottom&&(a.bottom-=c.bottom-this.bottom,c.bottom=this.bottom),c.left<this.left&&(a.left+=this.left-c.left,c.left=this.left),c.top<this.top&&(a.top+=this.top-c.top,c.top=this.top))};
Ha.prototype.getWidth=function(){return this.right-this.left};Ha.prototype.getHeight=function(){return this.bottom-this.top};Ha.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Ha.prototype.isEmpty=function(){return this.right<=this.left||this.bottom<=this.top};Ha.prototype.set=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom};Ha.prototype.clone=function(){return new Ha(this.left,this.top,this.right,this.bottom)};Ha.prototype.translate=function(a,
c){return this.left+=a,this.right+=a,this.top+=c,this.bottom+=c,this};Ha.prototype.getTranslated=function(a,c){var d=this.clone();return d.translate(a,c),d};Ha.prototype.moveTo=function(a,c){this.translate(a-this.left,c-this.top)};Ha.prototype.equals=function(a){return this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom};Ha.prototype.grow=function(a,c){this.left-=a;this.right+=a;this.top-=c;this.bottom+=c};Ha.prototype.toString=function(){return"("+this.left+","+this.top+
","+this.right+","+this.bottom+")"};Ha.prototype.toPoints=function(){return[{x:this.left,y:this.top},{x:this.right,y:this.top},{x:this.right,y:this.bottom},{x:this.left,y:this.bottom}]};Ha.prototype.roundNearest=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this};Ha.prototype.roundContain=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.right=Math.ceil(this.right),
this.bottom=Math.ceil(this.bottom),this};Ha.createBoundingBox=function(a){if(0===a.length)return new Ha(0,0,0,0);let c=new Ha(a[0].x,a[0].y,a[0].x,a[0].y);for(let d=1;d<a.length;d++)c.left=Math.min(c.left,a[d].x),c.top=Math.min(c.top,a[d].y),c.right=Math.max(c.right,a[d].x),c.bottom=Math.max(c.bottom,a[d].y);return c};Ha.prototype.subtract=function(a){return Ha.subtract(this,a)};Ha.subtract=function(a,c){a instanceof Ha&&(a=[a]);c instanceof Ha&&(c=[c]);a=a.slice(0);for(let b=0;b<c.length;b++){let g=
c[b],p=a.length;for(let f=0;f<p;f++){var d=a[f];if(!d)continue;let e=d.getIntersection(g);if(!e.isEmpty()){let m=[];if(d.top<g.top&&m.push(new Ha(d.left,d.top,d.right,e.top)),d.bottom>g.bottom&&m.push(new Ha(d.left,e.bottom,d.right,d.bottom)),d.left<g.left&&m.push(new Ha(d.left,e.top,e.left,e.bottom)),d.right>g.right&&m.push(new Ha(e.right,e.top,d.right,e.bottom)),0<(m=m.filter(l=>!l.isEmpty())).length)for(a[f]=m[0],d=1;d<m.length;d++)a.push(m[d]);else a[f]=null}}}return a.filter(b=>null!=b)};Ha.union=
function(a){if(a instanceof Ha)a=[a];else{a=a.slice(0);for(let d=0;d<a.length;d++){let b=a[d],g=a.length;if(b)for(let p=d+1;p<g;p++){var c=a[p];if(c&&!b.getIntersection(c).isEmpty()){c=Ha.subtract(c,b);a[p]=c[0];for(let f=1;f<c.length;f++)a.push(c[f])}}}}return a.filter(d=>d&&!d.isEmpty())};"object"==typeof window&&(window.cpRectGarbage=new Ha(1.5,2.5,3.5,4.5));Dd.prototype.getBounds=function(){return new Ha(0,0,this.width,this.height)};Dd.prototype.isInside=function(a,c){return 0<=a&&0<=c&&a<this.width&&
c<this.height};H.prototype=Object.create(Dd.prototype);H.prototype.constructor=H;H.BYTES_PER_PIXEL=4;H.RED_BYTE_OFFSET=0;H.GREEN_BYTE_OFFSET=1;H.BLUE_BYTE_OFFSET=2;H.ALPHA_BYTE_OFFSET=3;H.prototype.clone=function(){return this.cloneRect(this.getBounds())};H.prototype.cloneRect=function(a){var c=new H(a.getWidth(),a.getHeight());return c.copyBitmapRect(this,0,0,a),c};H.prototype.getPixel=function(a,c){a=Math.max(0,Math.min(this.width-1,a));c=Math.max(0,Math.min(this.height-1,c));a=this.offsetOfPixel(a,
c);return this.data[a+H.ALPHA_BYTE_OFFSET]<<24|this.data[a+H.RED_BYTE_OFFSET]<<16|this.data[a+H.GREEN_BYTE_OFFSET]<<8|this.data[a+H.BLUE_BYTE_OFFSET]};H.prototype.copyRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),b=new Uint8Array(d*c.getHeight()*H.BYTES_PER_PIXEL),g=0,p=this.offsetOfPixel(c.left,c.top),f=a.offsetOfPixel(c.left,c.top),e=(this.width-d)*H.BYTES_PER_PIXEL,m=(a.width-d)*H.BYTES_PER_PIXEL;d*=H.BYTES_PER_PIXEL;for(var l=c.top;l<c.bottom;l++,p+=e,f+=m)for(var h=0;h<
d;h++,g++,p++,f++)b[g]=this.data[p]^a.data[f];return b};H.prototype.setRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),b=c.getHeight();c=this.offsetOfPixel(c.left,c.top);var g=0,p=(this.width-d)*H.BYTES_PER_PIXEL;d*=H.BYTES_PER_PIXEL;for(var f=0;f<b;f++){for(var e=0;e<d;e++)this.data[c++]^=a[g++];c+=p}};H.prototype.copyBitmapRect=function(a,c,d,b){var g=new Ha(c,d,0,0);b=b.clone();this.getBounds().clipSourceDest(b,g);c=0|g.getWidth();d=0|g.getHeight();if(0==g.left&&0==g.top&&
c==this.width&&d==this.height&&c==a.width&&d==a.height)this.copyPixelsFrom(a);else{g=this.offsetOfPixel(g.left,g.top);var p=(this.width-c)*H.BYTES_PER_PIXEL;b=a.offsetOfPixel(b.left,b.top);for(var f=(a.width-c)*H.BYTES_PER_PIXEL,e=0;e<d;e++,b+=f,g+=p)for(var m=0;m<c;m++,b+=H.BYTES_PER_PIXEL,g+=H.BYTES_PER_PIXEL)this.data[g]=a.data[b],this.data[g+1]=a.data[b+1],this.data[g+2]=a.data[b+2],this.data[g+3]=a.data[b+3]}};H.prototype.copyAlphaFrom=function(a,c){var d=0|(c=this.getBounds().clipTo(c)).getWidth(),
b=0|c.getHeight();c=this.offsetOfPixel(c.left,c.top)+H.ALPHA_BYTE_OFFSET|0;for(var g=(this.width-d)*H.BYTES_PER_PIXEL|0,p=0;p<b;p++,c+=g)for(var f=0;f<d;f++,c+=H.BYTES_PER_PIXEL)this.data[c]=a.data[c]};H.prototype.setToSize=function(a){(a.width!=this.width||a.height!=this.height)&&(this.width=a.width,this.height=a.height,this.imageData=of(this.width,this.height),this.data=this.imageData.data)};H.prototype.copyPixelsFrom=function(a){if(this.setToSize(a),"set"in this.data)this.data.set(a.data);else for(var c=
0;c<this.data.length;c++)this.data[c]=a.data[c]};H.prototype.copyPixelsFromGreyscale=function(a){var c,d=0,b=a.width*a.height;this.setToSize(a);for(c=0;c<b;c++,d+=H.BYTES_PER_PIXEL)this.data[d+H.RED_BYTE_OFFSET]=a.data[c],this.data[d+H.GREEN_BYTE_OFFSET]=a.data[c],this.data[d+H.BLUE_BYTE_OFFSET]=a.data[c],this.data[d+H.ALPHA_BYTE_OFFSET]=255};H.prototype.copyScaledNearestNeighbor=function(a){for(var c,d=0,b=a.width/this.width,g=a.height/this.height,p=0,f=0;p<this.height;p++,f+=g){c=a.offsetOfPixel(0,
Math.round(f));for(var e=0,m=0;e<this.width;e++,d+=H.BYTES_PER_PIXEL,m+=b){var l=c+Math.round(m)*H.BYTES_PER_PIXEL;this.data[d]=a.data[l];this.data[d+1]=a.data[l+1];this.data[d+2]=a.data[l+2];this.data[d+H.ALPHA_BYTE_OFFSET]=a.data[l+H.ALPHA_BYTE_OFFSET]}}};H.prototype.createThumbnailFrom=function(a){let c=Math.min(Math.floor(a.width/this.width),3);if(2>c)this.copyScaledNearestNeighbor(a);else{var d=new Uint16Array(5*this.width),b=a.width*H.BYTES_PER_PIXEL,g=Math.floor(a.width/this.width)*H.BYTES_PER_PIXEL,
p=Math.floor(a.width/this.width/c)*H.BYTES_PER_PIXEL,f=g-p*c,e=Math.floor(a.height/this.height/c);g=e*b-g*this.width;b*=Math.floor(a.height/this.height)-e*c;var m=e=0;for(let r=0;r<this.height;r++,e+=b){let t;d.fill(0);for(var l=0;l<c;l++,e+=g){t=0;for(var h=0;h<this.width;h++,t+=5,e+=f)for(var n=0;n<c;n++,e+=p){let v=a.data[e+H.ALPHA_BYTE_OFFSET],x=v/255;d[t]+=a.data[e]*x;d[t+1]+=a.data[e+1]*x;d[t+2]+=a.data[e+2]*x;d[t+H.ALPHA_BYTE_OFFSET]+=v;d[t+4]=Math.max(d[t+4],v)}}t=0;for(l=0;l<this.width;l++,
t+=5,m+=H.BYTES_PER_PIXEL)h=d[t+4],0==h?this.data[m+H.ALPHA_BYTE_OFFSET]=0:(n=h/d[t+H.ALPHA_BYTE_OFFSET],this.data[m]=d[t]*n,this.data[m+1]=d[t+1]*n,this.data[m+2]=d[t+2]*n,this.data[m+H.ALPHA_BYTE_OFFSET]=h)}}};H.prototype.floodFill=function(a,c,d){if(this.isInside(a,c)){var b=this.getPixel(a,c),g=b>>24&255,p=b>>16&255,f=b>>8&255,e=255&b,m=d>>24&255,l=d>>16&255,h=d>>8&255,n=255&d,r=[],t=this.getBounds(),v=this.data;if(t.left*=H.BYTES_PER_PIXEL,t.right*=H.BYTES_PER_PIXEL,r.push({x1:a*H.BYTES_PER_PIXEL,
x2:a*H.BYTES_PER_PIXEL,y:c,dy:-1}),r.push({x1:a*H.BYTES_PER_PIXEL,x2:a*H.BYTES_PER_PIXEL,y:c+1,dy:1}),0==g){if(0!=m)for(;0<r.length;)if(p=r.pop(),!(p.y<t.top||p.y>=t.bottom)){f=this.offsetOfPixel(0,p.y);for(e=p.x1;e>=t.left&&0==v[e+f+H.ALPHA_BYTE_OFFSET];)v[e+f+H.RED_BYTE_OFFSET]=l,v[e+f+H.GREEN_BYTE_OFFSET]=h,v[e+f+H.BLUE_BYTE_OFFSET]=n,v[e+f+H.ALPHA_BYTE_OFFSET]=m,e-=H.BYTES_PER_PIXEL;if(e>=p.x1){for(;e<=p.x2&&v[e+f+H.ALPHA_BYTE_OFFSET]!=g;)e+=H.BYTES_PER_PIXEL;if(a=e+H.BYTES_PER_PIXEL,e>p.x2)continue}else(e+=
H.BYTES_PER_PIXEL)<p.x1&&r.push({x1:e,x2:p.x1-H.BYTES_PER_PIXEL,y:p.y-p.dy,dy:-p.dy}),a=p.x1+H.BYTES_PER_PIXEL;do{v[e+f+H.RED_BYTE_OFFSET]=l;v[e+f+H.GREEN_BYTE_OFFSET]=h;v[e+f+H.BLUE_BYTE_OFFSET]=n;for(v[e+f+H.ALPHA_BYTE_OFFSET]=m;a<t.right&&v[a+f+H.ALPHA_BYTE_OFFSET]==g;)v[a+f+H.RED_BYTE_OFFSET]=l,v[a+f+H.GREEN_BYTE_OFFSET]=h,v[a+f+H.BLUE_BYTE_OFFSET]=n,v[a+f+H.ALPHA_BYTE_OFFSET]=m,a+=H.BYTES_PER_PIXEL;r.push({x1:e,x2:a-H.BYTES_PER_PIXEL,y:p.y+p.dy,dy:p.dy});a-H.BYTES_PER_PIXEL>p.x2&&r.push({x1:p.x2+
H.BYTES_PER_PIXEL,x2:a-H.BYTES_PER_PIXEL,y:p.y-p.dy,dy:-p.dy});for(e=a+H.BYTES_PER_PIXEL;e<=p.x2&&v[e+f+H.ALPHA_BYTE_OFFSET]!=g;)e+=H.BYTES_PER_PIXEL;a=e+H.BYTES_PER_PIXEL}while(e<=p.x2)}}else if(d!=b)for(;0<r.length;)if(a=r.pop(),!(a.y<t.top||a.y>=t.bottom)){c=this.offsetOfPixel(0,a.y);for(d=a.x1;d>=t.left&&v[d+c+H.RED_BYTE_OFFSET]==p&&v[d+c+H.GREEN_BYTE_OFFSET]==f&&v[d+c+H.BLUE_BYTE_OFFSET]==e&&v[d+c+H.ALPHA_BYTE_OFFSET]==g;)v[d+c+H.RED_BYTE_OFFSET]=l,v[d+c+H.GREEN_BYTE_OFFSET]=h,v[d+c+H.BLUE_BYTE_OFFSET]=
n,v[d+c+H.ALPHA_BYTE_OFFSET]=m,d-=H.BYTES_PER_PIXEL;if(d>=a.x1){for(;d<=a.x2&&(v[d+c+H.RED_BYTE_OFFSET]!=p||v[d+c+H.GREEN_BYTE_OFFSET]!=f||v[d+c+H.BLUE_BYTE_OFFSET]!=e||v[d+c+H.ALPHA_BYTE_OFFSET]!=g);)d+=H.BYTES_PER_PIXEL;if(b=d+H.BYTES_PER_PIXEL,d>a.x2)continue}else(d+=H.BYTES_PER_PIXEL)<a.x1&&r.push({x1:d,x2:a.x1-H.BYTES_PER_PIXEL,y:a.y-a.dy,dy:-a.dy}),b=a.x1+H.BYTES_PER_PIXEL;do{v[d+c+H.RED_BYTE_OFFSET]=l;v[d+c+H.GREEN_BYTE_OFFSET]=h;v[d+c+H.BLUE_BYTE_OFFSET]=n;for(v[d+c+H.ALPHA_BYTE_OFFSET]=m;b<
t.right&&v[b+c+H.RED_BYTE_OFFSET]==p&&v[b+c+H.GREEN_BYTE_OFFSET]==f&&v[b+c+H.BLUE_BYTE_OFFSET]==e&&v[b+c+H.ALPHA_BYTE_OFFSET]==g;)v[b+c+H.RED_BYTE_OFFSET]=l,v[b+c+H.GREEN_BYTE_OFFSET]=h,v[b+c+H.BLUE_BYTE_OFFSET]=n,v[b+c+H.ALPHA_BYTE_OFFSET]=m,b+=H.BYTES_PER_PIXEL;r.push({x1:d,x2:b-H.BYTES_PER_PIXEL,y:a.y+a.dy,dy:a.dy});b-H.BYTES_PER_PIXEL>a.x2&&r.push({x1:a.x2+H.BYTES_PER_PIXEL,x2:b-H.BYTES_PER_PIXEL,y:a.y-a.dy,dy:-a.dy});for(d=b+H.BYTES_PER_PIXEL;d<=a.x2&&(v[d+c+H.RED_BYTE_OFFSET]!=p||v[d+c+H.GREEN_BYTE_OFFSET]!=
f||v[d+c+H.BLUE_BYTE_OFFSET]!=e||v[d+c+H.ALPHA_BYTE_OFFSET]!=g);)d+=H.BYTES_PER_PIXEL;b=d+H.BYTES_PER_PIXEL}while(d<=a.x2)}}};H.prototype.copyPixelColumnToArray=function(a,c,d,b){var g=(this.width-1)*H.BYTES_PER_PIXEL,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++){for(var f=0;f<H.BYTES_PER_PIXEL;f++)b[p++]=this.data[a++];a+=g}};H.prototype.copyArrayToPixelColumn=function(a,c,d,b){var g=(this.width-1)*H.BYTES_PER_PIXEL,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++){for(var f=0;f<H.BYTES_PER_PIXEL;f++)this.data[a++]=
b[p++];a+=g}};H.prototype.boxBlur=function(a,c,d){let b=(a=this.getBounds().clipTo(a)).getWidth(),g=b*H.BYTES_PER_PIXEL,p=a.getHeight();var f=Math.max(b,p);let e=new Uint8Array(f*H.BYTES_PER_PIXEL);f=new Uint8Array(f*H.BYTES_PER_PIXEL);for(let h=a.top;h<a.bottom;h++){var m=this.offsetOfPixel(a.left,h);for(var l=0;l<g;l++)e[l]=this.data[m++];!function(n,r){for(var t=0,v=0;v<r;v++){for(var x=n[t+H.ALPHA_BYTE_OFFSET],D=0;3>D;D++,t++)n[t]=Math.round(n[t]*x/255);t++}}(e,b);ig(e,f,b,c);m=this.offsetOfPixel(a.left,
h);for(l=0;l<g;l++)this.data[m++]=f[l]}for(c=a.left;c<a.right;c++)this.copyPixelColumnToArray(c,a.top,p,e),ig(e,f,p,d),function(h,n){for(var r=0,t=0;t<n;t++){var v=h[r+H.ALPHA_BYTE_OFFSET];if(0!=v){v=255/v;for(var x=0;3>x;x++,r++)h[r]=Math.min(Math.round(h[r]*v),255);r++}else r+=H.BYTES_PER_PIXEL}}(f,p),this.copyArrayToPixelColumn(c,a.top,p,f)};H.prototype.offsetOfPixel=function(a,c){return 4*(c*this.width+a)|0};H.prototype.getMemorySize=function(){return this.data.length};H.prototype.getImageData=
function(){return this.imageData};H.prototype.setImageData=function(a){this.width=a.width;this.height=a.height;this.imageData=a;this.data=a.data};H.prototype.clearAll=function(a){if(0==a&&"fill"in this.data)this.data.fill(0);else{var c=a>>24&255,d=a>>16&255,b=a>>8&255;a&=255;for(var g=0;g<this.width*this.height*H.BYTES_PER_PIXEL;)this.data[g++]=d,this.data[g++]=b,this.data[g++]=a,this.data[g++]=c}};H.prototype.clearRect=function(a,c){a=this.getBounds().clipTo(a);var d=c>>24&255,b=c>>16&255,g=c>>8&
255;c&=255;for(var p=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,f=this.offsetOfPixel(a.left,a.top),e=a.top;e<a.bottom;e++,f+=p)for(var m=a.left;m<a.right;m++)this.data[f++]=b,this.data[f++]=g,this.data[f++]=c,this.data[f++]=d};H.prototype.copyRegionHFlip=function(a,c){a=this.getBounds().clipTo(a);for(var d=a.top;d<a.bottom;d++)for(var b=this.offsetOfPixel(a.left,d),g=c.offsetOfPixel(a.right-1,d),p=a.left;p<a.right;p++,g-=2*H.BYTES_PER_PIXEL)for(var f=0;f<H.BYTES_PER_PIXEL;f++)this.data[b++]=c.data[g++]};
H.prototype.copyRegionVFlip=function(a,c){for(var d=(a=this.getBounds().clipTo(a)).getWidth()*H.BYTES_PER_PIXEL,b=a.top;b<a.bottom;b++)for(var g=this.offsetOfPixel(a.left,b),p=c.offsetOfPixel(a.left,a.bottom-1-(b-a.top)),f=0;f<d;f++)this.data[g++]=c.data[p++]};H.prototype.fillWithNoise=function(a){a=this.getBounds().clipTo(a);for(var c,d=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,b=this.offsetOfPixel(a.left,a.top),g=a.top;g<a.bottom;g++,b+=d)for(var p=a.left;p<a.right;p++,b+=H.BYTES_PER_PIXEL)c=
256*Math.random()|0,this.data[b+H.RED_BYTE_OFFSET]=c,this.data[b+H.GREEN_BYTE_OFFSET]=c,this.data[b+H.BLUE_BYTE_OFFSET]=c,this.data[b+H.ALPHA_BYTE_OFFSET]=255};H.prototype.gradientHorzReplace=function(a,c,d,b){var g={r:b[0]>>16&255,g:b[0]>>8&255,b:255&b[0],a:b[0]>>24&255};b={r:b[1]>>16&255,g:b[1]>>8&255,b:255&b[1],a:b[1]>>24&255};var p=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,f=0|this.offsetOfPixel(a.left,a.top),e=a.bottom-a.top|0;if(d<c){var m=d;d=c;c=m;m=g;g=b;b=m}var l=d-c|0;m=(b.r-g.r)/l;var h=
(b.g-g.g)/l,n=(b.b-g.b)/l;l=(b.a-g.a)/l;for(var r=Math.max(a.left-c,0),t=0;t<e;t++,f+=p){for(var v=a.left,x=0|Math.min(c,a.right);v<x;v++,f+=H.BYTES_PER_PIXEL)this.data[f+H.RED_BYTE_OFFSET]=g.r,this.data[f+H.GREEN_BYTE_OFFSET]=g.g,this.data[f+H.BLUE_BYTE_OFFSET]=g.b,this.data[f+H.ALPHA_BYTE_OFFSET]=g.a;var D=g.r+m*r,G=g.g+h*r,N=g.b+n*r,K=g.a+l*r;for(x=0|Math.min(d,a.right);v<x;v++,f+=H.BYTES_PER_PIXEL)this.data[f+H.RED_BYTE_OFFSET]=D,this.data[f+H.GREEN_BYTE_OFFSET]=G,this.data[f+H.BLUE_BYTE_OFFSET]=
N,this.data[f+H.ALPHA_BYTE_OFFSET]=K,D+=m,G+=h,N+=n,K+=l;for(;v<a.right;v++,f+=H.BYTES_PER_PIXEL)this.data[f+H.RED_BYTE_OFFSET]=b.r,this.data[f+H.GREEN_BYTE_OFFSET]=b.g,this.data[f+H.BLUE_BYTE_OFFSET]=b.b,this.data[f+H.ALPHA_BYTE_OFFSET]=b.a}};H.prototype.gradientVertReplace=function(a,c,d,b){var g={r:b[0]>>16&255,g:b[0]>>8&255,b:255&b[0],a:b[0]>>24&255};b={r:b[1]>>16&255,g:b[1]>>8&255,b:255&b[1],a:b[1]>>24&255};let p=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,f=0|this.offsetOfPixel(a.left,a.top),
e=a.right-a.left|0;if(d<c){var m=d;d=c;c=m;m=g;g=b;b=m}m=a.top;for(var l=0|Math.min(a.bottom,c);m<l;m++,f+=p)for(var h=0;h<e;h++,f+=H.BYTES_PER_PIXEL)this.data[f+H.RED_BYTE_OFFSET]=g.r,this.data[f+H.GREEN_BYTE_OFFSET]=g.g,this.data[f+H.BLUE_BYTE_OFFSET]=g.b,this.data[f+H.ALPHA_BYTE_OFFSET]=g.a;var n=d-c|0;l=(b.r-g.r)/n;h=(b.g-g.g)/n;var r=(b.b-g.b)/n;n=(b.a-g.a)/n;var t=Math.max(m-c,0);c=g.r+l*t;var v=g.g+h*t,x=g.b+r*t;g=g.a+n*t;for(d=0|Math.min(a.bottom,d);m<d;m++,f+=p){for(t=0;t<e;t++,f+=H.BYTES_PER_PIXEL)this.data[f+
H.RED_BYTE_OFFSET]=c,this.data[f+H.GREEN_BYTE_OFFSET]=v,this.data[f+H.BLUE_BYTE_OFFSET]=x,this.data[f+H.ALPHA_BYTE_OFFSET]=g;c+=l;v+=h;x+=r;g+=n}for(;m<a.bottom;m++,f+=p)for(d=0;d<e;d++,f+=H.BYTES_PER_PIXEL)this.data[f+H.RED_BYTE_OFFSET]=b.r,this.data[f+H.GREEN_BYTE_OFFSET]=b.g,this.data[f+H.BLUE_BYTE_OFFSET]=b.b,this.data[f+H.ALPHA_BYTE_OFFSET]=b.a};H.prototype.gradientReplace=function(a,c,d,b,g,p){var f=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(a.left,a.top),m=a.right-a.left|
0,l=p[0]>>16&255,h=p[0]>>8&255,n=255&p[0],r=p[0]>>24&255,t=p[1]>>16&255,v=p[1]>>8&255,x=255&p[1];p=p[1]>>24&255;var D=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var G=a.top;G<a.bottom;G++,e+=f)for(var N=(a.left-c)/b+(G-d)/D,K=0;K<m;K++,e+=H.BYTES_PER_PIXEL){var P=Math.min(Math.max(N,0),1),L=1-P;this.data[e+H.RED_BYTE_OFFSET]=l*L+t*P;this.data[e+H.GREEN_BYTE_OFFSET]=h*L+v*P;this.data[e+H.BLUE_BYTE_OFFSET]=n*L+x*P;this.data[e+H.ALPHA_BYTE_OFFSET]=r*L+p*P;N+=g}};H.prototype.gradientAlpha=
function(a,c,d,b,g,p){var f=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(a.left,a.top),m=a.right-a.left|0,l=p[0]>>16&255,h=p[0]>>8&255,n=255&p[0],r=p[0]>>24&255,t=p[1]>>16&255,v=p[1]>>8&255,x=255&p[1];p=p[1]>>24&255;var D=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var G=a.top;G<a.bottom;G++,e+=f)for(var N=(a.left-c)/b+(G-d)/D,K=0;K<m;K++,e+=H.BYTES_PER_PIXEL){var P=Math.min(Math.max(N,0),1),L=1-P,ba=l*L+t*P,X=h*L+v*P,Y=n*L+x*P;L=r*L+p*P;P=this.data[e+H.ALPHA_BYTE_OFFSET];
P=L+P-L*P/255|0;if(0<P){L=255*L/P|0;var ka=255-L;this.data[e+H.RED_BYTE_OFFSET]=(ba*L+this.data[e+H.RED_BYTE_OFFSET]*ka)/255|0;this.data[e+H.GREEN_BYTE_OFFSET]=(X*L+this.data[e+H.GREEN_BYTE_OFFSET]*ka)/255|0;this.data[e+H.BLUE_BYTE_OFFSET]=(Y*L+this.data[e+H.BLUE_BYTE_OFFSET]*ka)/255|0;this.data[e+H.ALPHA_BYTE_OFFSET]=P}N+=g}};H.prototype.gradient=function(a,c,d,b,g,p,f){a=this.getBounds().clipTo(a);(c!=b||d!=g)&&(f||255==p[0]>>>24&&255==p[1]>>>24?c==b?this.gradientVertReplace(a,d,g,p):d==g?this.gradientHorzReplace(a,
c,b,p):this.gradientReplace(a,c,d,b,g,p):this.gradientAlpha(a,c,d,b,g,p))};H.prototype.fillWithColorNoise=function(a){a=this.getBounds().clipTo(a);for(var c,d=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,b=this.offsetOfPixel(a.left,a.top),g=a.top;g<a.bottom;g++,b+=d)for(var p=a.left;p<a.right;p++,b+=H.BYTES_PER_PIXEL)c=16777216*Math.random()|0,this.data[b+H.RED_BYTE_OFFSET]=c>>16&255,this.data[b+H.GREEN_BYTE_OFFSET]=c>>8&255,this.data[b+H.BLUE_BYTE_OFFSET]=255&c,this.data[b+H.ALPHA_BYTE_OFFSET]=255};
H.prototype.invert=function(a){a=this.getBounds().clipTo(a);for(var c=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var g=a.left;g<a.right;g++,d+=H.BYTES_PER_PIXEL)this.data[d+H.RED_BYTE_OFFSET]^=255,this.data[d+H.GREEN_BYTE_OFFSET]^=255,this.data[d+H.BLUE_BYTE_OFFSET]^=255};H.prototype.brightnessToOpacity=function(a){a=this.getBounds().clipTo(a);let c=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top);for(let g=
a.top;g<a.bottom;g++,d+=c)for(let p=a.left;p<a.right;p++,d+=H.BYTES_PER_PIXEL){var b=void 0;b=(this.data[d+H.RED_BYTE_OFFSET]+this.data[d+H.GREEN_BYTE_OFFSET]+this.data[d+H.BLUE_BYTE_OFFSET])/3;let f=this.data[d+H.ALPHA_BYTE_OFFSET]/255;b=250<b?0:Math.round(255*(1-b/250));this.data[d+H.ALPHA_BYTE_OFFSET]=Math.round(b*f);0<b&&(this.data[d+H.RED_BYTE_OFFSET]=0,this.data[d+H.GREEN_BYTE_OFFSET]=0,this.data[d+H.BLUE_BYTE_OFFSET]=0)}};H.prototype.getNonTransparentBounds=function(a){var c,d,b=a.clone();
var g=(this.width-b.getWidth())*H.BYTES_PER_PIXEL;a=this.offsetOfPixel(b.left,b.top)+H.ALPHA_BYTE_OFFSET;for(d=b.top;d<b.bottom;d++,a+=g){var p=0;for(c=b.left;c<b.right;c++,a+=H.BYTES_PER_PIXEL)p|=this.data[a];if(0!=p)break}if(b.top=d,b.top==b.bottom)return b;a=this.offsetOfPixel(b.right-1,b.bottom-1)+H.ALPHA_BYTE_OFFSET;for(d=b.bottom-1;d>=b.top;d--,a-=g){p=0;for(c=b.right-1;c>=b.left;c--,a-=H.BYTES_PER_PIXEL)p|=this.data[a];if(0!=p)break}b.bottom=d+1;g=H.BYTES_PER_PIXEL*this.width;for(c=b.left;c<
b.right;c++){a=this.offsetOfPixel(c,b.top)+H.ALPHA_BYTE_OFFSET;p=0;for(d=b.top;d<b.bottom;d++,a+=g)p|=this.data[a];if(0!=p)break}b.left=c;for(c=b.right-1;c>=b.left;c--){a=this.offsetOfPixel(c,b.top)+H.ALPHA_BYTE_OFFSET;p=0;for(d=b.top;d<b.bottom;d++,a+=g)p|=this.data[a];if(0!=p)break}return b.right=c+1,b};H.prototype.getAsCanvas=function(a){var c=Yc(this.imageData.width,this.imageData.height);return c.getContext("2d").putImageData(this.imageData,0,0),jg(c,a||0)};H.prototype.getAsPNG=function(a){var c;
return"string"==typeof(c=this.getAsCanvas(a).toDataURL("image/png"))&&!!c.match(/^data:image\/png;base64,/i)&&window.atob(c.substring(22))};H.prototype.getAsPNGBuffer=function(a){return this.getAsCanvas(a).toBuffer("image/png")};H.prototype.hasAlphaInRect=function(a){a=this.getBounds().clipTo(a);for(var c=(this.width-a.getWidth())*H.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top)+H.ALPHA_BYTE_OFFSET,b=a.top;b<a.bottom;b++,d+=c){for(var g=255,p=a.left;p<a.right;p++,d+=H.BYTES_PER_PIXEL)g&=this.data[d];
if(255!=g)return!0}return!1};H.prototype.hasAlpha=function(){return this.hasAlphaInRect(this.getBounds())};H.createFromImage=function(a){var c=Yc(a.width,a.height).getContext("2d");return c.globalCompositeOperation="copy",c.drawImage(a,0,0),new H(c.getImageData(0,0,a.width,a.height))};H.prototype.equals=function(a){if(this.width!=a.width||this.height!=a.height)return!1;for(let c=0;c<this.data.length;c+=H.BYTES_PER_PIXEL)if(!(0==this.data[c+H.ALPHA_BYTE_OFFSET]&&0==a.data[c+H.ALPHA_BYTE_OFFSET]||this.data[c]==
a.data[c]&&this.data[c+1]==a.data[c+1]&&this.data[c+2]==a.data[c+2]&&this.data[c+3]==a.data[c+3]))return!1;return!0};nb.prototype=Object.create(rb.prototype);nb.prototype.constructor=nb;nb.prototype.getLinearizedLayerList=function(a,c){for(let d of(c=c||[],this.layers))d instanceof nb&&(d.expanded||!a)&&d.getLinearizedLayerList(a,c),c.push(d);return c};nb.prototype.clearLayers=function(){this.layers=[]};nb.prototype.addLayer=function(a){a.parent=this;this.layers.push(a)};nb.prototype.insertLayer=
function(a,c){c.parent=this;this.layers.splice(a,0,c)};nb.prototype.removeLayer=function(a){a=this.layers.indexOf(a);-1<a&&this.layers.splice(a,1)};nb.prototype.removeLayerAtIndex=function(a){var c=this.layers[a];return c&&this.layers.splice(a,1),c};nb.prototype.setLayerAtIndex=function(a,c){var d=this.layers[a];return c.parent=this,this.layers[a]=c,d};nb.prototype.setExpanded=function(a){this.expanded=a};nb.prototype.getExpanded=function(){return this.expanded};nb.prototype.indexOf=function(a){return this.layers.indexOf(a)};
nb.prototype.getMemoryUsed=function(){return this.layers.map(a=>a.getMemoryUsed()).reduce(sh,0)};nb.prototype.clone=function(){var a=new nb(this.name,this.blendMode);return rb.prototype.copyFrom.call(a,this),a.expanded=this.expanded,a.layers=this.layers.map(c=>c.clone()),a.layers.forEach(c=>c.parent=a),a};nb.prototype.getNonTransparentBounds=function(a){var c=new Ha(0,0,0,0);return this.layers.forEach(d=>c.union(d.getNonTransparentBounds(a))),c};Xa.prototype=Object.create(Dd.prototype);Xa.prototype.constructor=
Xa;Xa.prototype.createBitmap=function(a,c,d){switch(this.bitDepth=d,d){case 32:this.data=new Uint32Array(a*c);break;case 16:this.data=new Uint16Array(a*c);break;default:this.data=new Uint8Array(a*c)}};Xa.prototype.clone=function(){var a=new Xa(this.width,this.height,this.bitDepth);return a.copyPixelsFrom(this),a};Xa.prototype.cloneRect=function(a){var c=new Xa(a.getWidth(),a.getHeight(),this.bitDepth);return c.copyBitmapRect(this,0,0,a),c};Xa.prototype.getPixel=function(a,c){return a=Math.max(0,Math.min(this.width-
1,a)),c=Math.max(0,Math.min(this.height-1,c)),this.data[this.offsetOfPixel(a,c)]};Xa.prototype.clearAll=function(a){this.data.fill(a)};Xa.prototype.clearRect=function(a,c){if((a=this.getBounds().clipTo(a)).equals(this.getBounds()))this.clearAll(c);else{let d=this.width,b=a.right-a.left,g=this.offsetOfPixel(a.left,a.top);for(let p=a.top;p<a.bottom;p++,g+=d)this.data.fill(c,g,g+b)}};Xa.prototype.copyScaledNearestNeighbor=function(a){for(var c,d=0,b=a.width/this.width,g=a.height/this.height,p=0,f=0;p<
this.height;p++,f+=g){c=a.offsetOfPixel(0,Math.round(f));for(var e=0,m=0;e<this.width;e++,d++,m+=b)this.data[d]=a.data[c+Math.round(m)]}};Xa.prototype.floodFill=function(a,c,d){if(this.isInside(a,c)){d&=255;var b=this.getPixel(a,c),g=[],p=this.getBounds(),f=this.data;if(g.push({x1:a,x2:a,y:c,dy:-1}),g.push({x1:a,x2:a,y:c+1,dy:1}),d!=b)for(;0<g.length;){a=g.pop();if(a.y<p.top||a.y>=p.bottom)continue;c=this.offsetOfPixel(0,a.y);let e=a.x1,m;for(;e>=p.left&&f[e+c]==b;)f[e+c]=d,e--;if(e>=a.x1){for(;e<=
a.x2&&f[e+c]!=b;)e++;if(m=e+1,e>a.x2)continue}else++e<a.x1&&g.push({x1:e,x2:a.x1-1,y:a.y-a.dy,dy:-a.dy}),m=a.x1+1;do{for(f[e+c]=d;m<p.right&&f[m+c]==b;)f[m+c]=d,m++;g.push({x1:e,x2:m-1,y:a.y+a.dy,dy:a.dy});m-1>a.x2&&g.push({x1:a.x2+1,x2:m-1,y:a.y-a.dy,dy:-a.dy});for(e=m+1;e<=a.x2&&f[e+c]!=b;)e++;m=e+1}while(e<=a.x2)}}};Xa.prototype.createThumbnailFrom=function(a){let c=Math.min(Math.floor(a.width/this.width),3);if(2>c)this.copyScaledNearestNeighbor(a);else{var d=new Uint16Array(this.width),b=a.width,
g=Math.floor(a.width/this.width),p=Math.floor(a.width/this.width/c),f=g-p*c,e=Math.floor(a.height/this.height/c);g=e*b-g*this.width;b*=Math.floor(a.height/this.height)-e*c;var m=e=0;for(let h=0;h<this.height;h++,e+=b){let n;d.fill(0);for(var l=0;l<c;l++,e+=g){n=0;for(let r=0;r<this.width;r++,n++,e+=f)for(let t=0;t<c;t++,e+=p)d[n]+=a.data[e]}n=0;for(l=0;l<this.width;l++,n++,m++)this.data[m]=d[n]/(c*c)}}};Xa.prototype.mirrorHorizontally=function(){let a=this.width,c=this.height,d=new Uint8Array(a*c),
b=0,g=a;for(let p=0;p<c;p++,g+=a+a)for(let f=0;f<a;f++)d[b++]=this.data[--g];this.data=d};Xa.prototype.applyLUT=function(a){for(var c=0;c<this.data.length;c++)this.data[c]=a.table[this.data[c]]};Xa.prototype.getAsCanvas=function(a){var c=this.getImageData(0,0,this.width,this.height),d=Yc(this.width,this.height);return d.getContext("2d").putImageData(c,0,0),jg(d,a||0)};Xa.prototype.getImageData=function(a,c,d,b){let g=of(d,b);a=this.offsetOfPixel(a,c);c=0;let p=this.width-d;for(let f=0;f<b;f++,a+=
p)for(let e=0;e<d;e++,a++)g.data[c++]=this.data[a],g.data[c++]=this.data[a],g.data[c++]=this.data[a],g.data[c++]=255;return g};Xa.prototype.pasteImageData=function(a,c,d){let b=0;c=this.offsetOfPixel(c,d);d=this.width-a.width;for(let g=0;g<a.height;g++,c+=d)for(let p=0;p<a.width;p++,b+=4,c++)this.data[c]=a.data[b];return a};Xa.prototype.copyPixelsFrom=function(a){a.width!=this.width||a.height!=this.height||a.bitDepth!=this.bitDepth?(this.data=a.data.slice(0),this.width=a.width,this.height=a.height,
this.bitDepth=a.bitDepth):this.data.set(a.data)};Xa.prototype.copyRectXOR=function(a,c){for(var d=(c=this.getBounds().clipTo(c)).getWidth(),b=new Uint8Array(d*c.getHeight()),g=0,p=this.offsetOfPixel(c.left,c.top),f=a.offsetOfPixel(c.left,c.top),e=this.width-d,m=a.width-d,l=c.top;l<c.bottom;l++,p+=e,f+=m)for(var h=0;h<d;h++,g++,p++,f++)b[g]=this.data[p]^a.data[f];return b};Xa.prototype.setRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),b=c.getHeight();c=this.offsetOfPixel(c.left,
c.top);for(var g=0,p=this.width-d,f=0;f<b;f++){for(var e=0;e<d;e++)this.data[c++]^=a[g++];c+=p}};Xa.prototype.copyBitmapRect=function(a,c,d,b){var g=new Ha(c,d,0,0);b=b.clone();this.getBounds().clipSourceDest(b,g);c=0|g.getWidth();d=0|g.getHeight();if(0==g.left&&0==g.top&&c==this.width&&d==this.height&&c==a.width&&d==a.height)this.copyPixelsFrom(a);else{g=this.offsetOfPixel(g.left,g.top);var p=this.width-c;b=a.offsetOfPixel(b.left,b.top);for(var f=a.width-c,e=0;e<d;e++,b+=f,g+=p)for(var m=0;m<c;m++,
b++,g++)this.data[g]=a.data[b]}};Xa.prototype.copyRegionHFlip=function(a,c){a=this.getBounds().clipTo(a);for(var d=a.top;d<a.bottom;d++)for(var b=this.offsetOfPixel(a.left,d),g=c.offsetOfPixel(a.right-1,d),p=a.left;p<a.right;p++,g-=2)this.data[b++]=c.data[g++]};Xa.prototype.copyRegionVFlip=function(a,c){for(var d=(a=this.getBounds().clipTo(a)).getWidth(),b=a.top;b<a.bottom;b++)for(var g=this.offsetOfPixel(a.left,b),p=c.offsetOfPixel(a.left,a.bottom-1-(b-a.top)),f=0;f<d;f++)this.data[g++]=c.data[p++]};
Xa.prototype.copyPixelColumnToArray=function(a,c,d,b){var g=this.width,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++)b[p]=this.data[a],a+=g,p++};Xa.prototype.copyArrayToPixelColumn=function(a,c,d,b){var g=this.width,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++)this.data[a]=b[p],a+=g,p++};Xa.prototype.boxBlur=function(a,c,d){let b=(a=this.getBounds().clipTo(a)).getWidth(),g=a.getHeight();var p=Math.max(b,g);let f=new this.data.constructor(p);p=new this.data.constructor(p);for(let l=a.top;l<a.bottom;l++){var e=
this.offsetOfPixel(a.left,l);for(var m=0;m<b;m++)f[m]=this.data[e++];kg(f,p,b,c);e=this.offsetOfPixel(a.left,l);for(m=0;m<b;m++)this.data[e++]=p[m]}for(c=a.left;c<a.right;c++)this.copyPixelColumnToArray(c,a.top,g,f),kg(f,p,g,d),this.copyArrayToPixelColumn(c,a.top,g,p)};Xa.prototype.offsetOfPixel=function(a,c){return c*this.width+a};Xa.prototype.fillWithNoise=function(a){a=this.getBounds().clipTo(a);for(var c=this.width-a.getWidth(),d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var g=
a.left;g<a.right;g++,d++)this.data[d]=256*Math.random()|0};Xa.prototype.invert=function(a){a=this.getBounds().clipTo(a);for(var c=this.width-a.getWidth(),d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var g=a.left;g<a.right;g++,d++)this.data[d]=~this.data[d]};Xa.prototype.brightnessToOpacity=function(a){a=this.getBounds().clipTo(a);let c=(this.width-a.getWidth())*Xa.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top);for(let g=a.top;g<a.bottom;g++,d+=c)for(let p=a.left;p<a.right;p++,
d++){var b=void 0;b=this.data[d];let f=this.data[d+Xa.ALPHA_BYTE_OFFSET]/255;b=250<b?0:Math.round(255*(1-b/250));this.data[d+Xa.ALPHA_BYTE_OFFSET]=Math.round(b*f);0<b&&(this.data[d]=0)}};Xa.prototype.getValueBounds=function(a,c){var d,b,g=a.clone();var p=this.width-g.getWidth();a=this.offsetOfPixel(g.left,g.top);for(b=g.top;b<g.bottom;b++,a+=p){var f=!1;for(d=g.left;d<g.right;d++,a++)if(this.data[a]!=c){f=!0;break}if(f)break}if(g.top=b,g.top==g.bottom)return g;a=this.offsetOfPixel(g.right-1,g.bottom-
1);for(b=g.bottom-1;b>=g.top;b--,a-=p){f=!1;for(d=g.right-1;d>=g.left;d--,a--)if(this.data[a]!=c){f=!0;break}if(f)break}g.bottom=b+1;p=this.width;for(d=g.left;d<g.right;d++){a=this.offsetOfPixel(d,g.top);f=!1;for(b=g.top;b<g.bottom;b++,a+=p)if(this.data[a]!=c){f=!0;break}if(f)break}g.left=d;for(d=g.right-1;d>=g.left;d--){a=this.offsetOfPixel(d,g.top);f=!1;for(b=g.top;b<g.bottom;b++,a+=p)if(this.data[a]!=c){f=!0;break}if(f)break}return g.right=d+1,g};Xa.prototype.gradientHorzReplace=function(a,c,d,
b){var g=255&b[0];b=255&b[1];var p=this.width-a.getWidth(),f=0|this.offsetOfPixel(a.left,a.top),e=a.bottom-a.top|0;if(d<c){var m=d;d=c;c=m;m=g;g=b;b=m}m=(b-g)/(d-c|0);for(var l=Math.max(a.left-c,0),h=0;h<e;h++,f+=p){for(var n=a.left,r=0|Math.min(c,a.right);n<r;n++,f++)this.data[f]=g;var t=g+m*l;for(r=0|Math.min(d,a.right);n<r;n++,f++)this.data[f]=t,t+=m;for(;n<a.right;n++,f++)this.data[f]=b}};Xa.prototype.gradientVertReplace=function(a,c,d,b){var g=255&b[0];b=255&b[1];let p=this.width-a.getWidth(),
f=0|this.offsetOfPixel(a.left,a.top),e=a.right-a.left|0;if(d<c){var m=d;d=c;c=m;m=g;g=b;b=m}m=a.top;for(var l=0|Math.min(a.bottom,c);m<l;m++,f+=p)for(let h=0;h<e;h++,f++)this.data[f]=g;l=(b-g)/(d-c|0);c=g+l*Math.max(m-c,0);for(d=0|Math.min(a.bottom,d);m<d;m++,f+=p){for(g=0;g<e;g++,f++)this.data[f]=c;c+=l}for(;m<a.bottom;m++,f+=p)for(d=0;d<e;d++,f++)this.data[f]=b};Xa.prototype.gradientReplace=function(a,c,d,b,g,p){var f=this.width-a.getWidth(),e=0|this.offsetOfPixel(a.left,a.top),m=a.right-a.left|
0,l=255&p[0];p=255&p[1];var h=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var n=a.top;n<a.bottom;n++,e+=f)for(var r=(a.left-c)/b+(n-d)/h,t=0;t<m;t++,e++){var v=Math.min(Math.max(r,0),1);this.data[e]=l*(1-v)+p*v;r+=g}};Xa.prototype.gradientAlpha=function(a,c,d,b,g,p){var f=this.width-a.getWidth(),e=0|this.offsetOfPixel(a.left,a.top),m=a.right-a.left|0,l=255&p[0],h=p[0]>>24&255,n=255&p[1];p=p[1]>>24&255;var r=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var t=a.top;t<a.bottom;t++,
e+=f)for(var v=(a.left-c)/b+(t-d)/r,x=0;x<m;x++,e++){var D=Math.min(Math.max(v,0),1),G=1-D,N=h*G+p*D;this.data[e]=((l*G+n*D)*N+this.data[e]*(255-N))/255|0;v+=g}};Xa.prototype.gradient=function(a,c,d,b,g,p,f){a=this.getBounds().clipTo(a);(c!=b||d!=g)&&(f||255==p[0]>>>24&&255==p[1]>>>24?c==b?this.gradientVertReplace(a,d,g,p):d==g?this.gradientHorzReplace(a,c,b,p):this.gradientReplace(a,c,d,b,g,p):this.gradientAlpha(a,c,d,b,g,p))};Xa.prototype.equals=function(a){if(this.width!=a.width||this.height!=
a.height)return!1;for(let c=0;c<this.data.length;c++)if(this.data[c]!=a.data[c])return!1;return!0};let Rb=Array(256),Sb=Array(256);V.multiplyOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l;m&&(l=a.data[b],a.data[b]=l-((255^c.data[b])*l*m/65025|0),l=a.data[b+1],a.data[b+1]=l-((255^c.data[b+1])*l*m/65025|0),l=a.data[b+2],a.data[b+2]=l-((255^
c.data[b+2])*l*m/65025|0))}};V.multiplyOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h;l&&(h=a.data[b],a.data[b]=h-((255^c.data[b])*h*l/65025|0),h=a.data[b+1],a.data[b+1]=h-((255^c.data[b+1])*h*l/65025|0),h=a.data[b+2],a.data[b+2]=h-((255^c.data[b+2])*h*l/65025|0))}};V.multiplyOntoTransparentFusionWithOpaqueLayer=function(a,
c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*t+h*v+(f*h*r/255|0))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*t+h*v+(f*h*r/255|0))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(f*t+h*v+(f*h*r/255|0))/n|0;a.data[b+3]=n}}};V.multiplyOntoTransparentFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(e*v+n*x+(e*n*t/255|0))/r|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(e*v+n*x+(e*n*t/255|0))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(e*v+n*x+(e*n*t/255|0))/r|0;a.data[b+3]=r}}};
V.multiplyOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r;n&&(r=a.data[e],a.data[e]=r-((255^c.data[e])*r*n/65025|0),r=a.data[e+1],a.data[e+1]=r-((255^c.data[e+1])*r*n/65025|0),r=a.data[e+2],a.data[e+2]=r-((255^c.data[e+2])*r*n/65025|0))}};V.multiplyOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t;r&&(t=a.data[m],a.data[m]=t-((255^c.data[m])*t*r/65025|0),t=a.data[m+1],a.data[m+1]=t-((255^c.data[m+1])*t*r/65025|0),t=a.data[m+2],a.data[m+2]=t-((255^c.data[m+2])*t*r/65025|0))}};V.multiplyOntoTransparentFusionWithOpaqueLayerMasked=function(a,
c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(l*D+t*G+(l*t*x/255|0))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(l*D+t*G+(l*t*x/255|0))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+
2]=(l*D+t*G+(l*t*x/255|0))/v|0;a.data[e+3]=v}}};V.multiplyOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(h*G+
v*N+(h*v*D/255|0))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(h*G+v*N+(h*v*D/255|0))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(h*G+v*N+(h*v*D/255|0))/x|0;a.data[m+3]=x}}};V.multiply2OntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l;m&&(l=a.data[b],a.data[b]=l-Math.ceil((255^c.data[b])*l*m/65025),l=a.data[b+1],a.data[b+1]=l-Math.ceil((255^
c.data[b+1])*l*m/65025),l=a.data[b+2],a.data[b+2]=l-Math.ceil((255^c.data[b+2])*l*m/65025))}};V.multiply2OntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h;l&&(h=a.data[b],a.data[b]=h-Math.ceil((255^c.data[b])*h*l/65025),h=a.data[b+1],a.data[b+1]=h-Math.ceil((255^c.data[b+1])*h*l/65025),h=a.data[b+2],a.data[b+2]=h-Math.ceil((255^
c.data[b+2])*h*l/65025))}};V.multiply2OntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*t+h*v+(f*h*r/255|0))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*t+h*v+(f*h*r/255|0))/n|0;f=c.data[b+2];h=a.data[b+
2];a.data[b+2]=(f*t+h*v+(f*h*r/255|0))/n|0;a.data[b+3]=n}}};V.multiply2OntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(e*v+n*x+(e*n*t/255|0))/r|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=
(e*v+n*x+(e*n*t/255|0))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(e*v+n*x+(e*n*t/255|0))/r|0;a.data[b+3]=r}}};V.multiply2OntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r;n&&(r=a.data[e],a.data[e]=r-Math.ceil((255^c.data[e])*r*n/65025),r=a.data[e+1],a.data[e+
1]=r-Math.ceil((255^c.data[e+1])*r*n/65025),r=a.data[e+2],a.data[e+2]=r-Math.ceil((255^c.data[e+2])*r*n/65025))}};V.multiply2OntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t;r&&(t=a.data[m],a.data[m]=t-Math.ceil((255^c.data[m])*t*r/65025),t=a.data[m+
1],a.data[m+1]=t-Math.ceil((255^c.data[m+1])*t*r/65025),t=a.data[m+2],a.data[m+2]=t-Math.ceil((255^c.data[m+2])*t*r/65025))}};V.multiply2OntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*
(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(l*D+t*G+(l*t*x/255|0))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(l*D+t*G+(l*t*x/255|0))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(l*D+t*G+(l*t*x/255|0))/v|0;a.data[e+3]=v}}};V.multiply2OntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=
0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(h*G+v*N+(h*v*D/255|0))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(h*G+v*N+(h*v*D/255|0))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(h*G+v*N+(h*v*D/255|0))/x|0;a.data[m+3]=x}}};V.normalOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,
b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l;if(m)if(255==m)a.data[b]=c.data[b],a.data[b+1]=c.data[b+1],a.data[b+2]=c.data[b+2];else{let h=255-m;l=c.data[b];a.data[b]=(l*m+a.data[b]*h)/255|0;l=c.data[b+1];a.data[b+1]=(l*m+a.data[b+1]*h)/255|0;l=c.data[b+2];a.data[b+2]=(l*m+a.data[b+2]*h)/255|0}}};V.normalOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,
b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let n=255-l;h=c.data[b];a.data[b]=(h*l+a.data[b]*n)/255|0;h=c.data[b+1];a.data[b+1]=(h*l+a.data[b+1]*n)/255|0;h=c.data[b+2];a.data[b+2]=(h*l+a.data[b+2]*n)/255|0}}};V.normalOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l;if(f){let h=f+(l=a.data[b+3])-(f*l/255|0)|
0;f=255*f/h|0;let n=255-f;a.data[b]=(c.data[b]*f+a.data[b]*n)/255|0;a.data[b+1]=(c.data[b+1]*f+a.data[b+1]*n)/255|0;a.data[b+2]=(c.data[b+2]*f+a.data[b+2]*n)/255|0;a.data[b+3]=h}}};V.normalOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h;if(e){let n=e+(h=a.data[b+3])-(e*h/255|0)|0;e=255*e/n|0;let r=255-e;a.data[b]=
(c.data[b]*e+a.data[b]*r)/255|0;a.data[b+1]=(c.data[b+1]*e+a.data[b+1]*r)/255|0;a.data[b+2]=(c.data[b+2]*e+a.data[b+2]*r)/255|0;a.data[b+3]=n}}};V.normalOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r;if(n)if(255==n)a.data[e]=c.data[e],a.data[e+1]=c.data[e+
1],a.data[e+2]=c.data[e+2];else{let t=255-n;r=c.data[e];a.data[e]=(r*n+a.data[e]*t)/255|0;r=c.data[e+1];a.data[e+1]=(r*n+a.data[e+1]*t)/255|0;r=c.data[e+2];a.data[e+2]=(r*n+a.data[e+2]*t)/255|0}}};V.normalOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|
0,t;if(r){let v=255-r;t=c.data[m];a.data[m]=(t*r+a.data[m]*v)/255|0;t=c.data[m+1];a.data[m+1]=(t*r+a.data[m+1]*v)/255|0;t=c.data[m+2];a.data[m+2]=(t*r+a.data[m+2]*v)/255|0}}};V.normalOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r;if(l){let t=l+(r=
a.data[e+3])-(l*r/255|0)|0;l=255*l/t|0;let v=255-l;a.data[e]=(c.data[e]*l+a.data[e]*v)/255|0;a.data[e+1]=(c.data[e+1]*l+a.data[e+1]*v)/255|0;a.data[e+2]=(c.data[e+2]*l+a.data[e+2]*v)/255|0;a.data[e+3]=t}}};V.normalOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*
d/25500|0;let t;if(h){let v=h+(t=a.data[m+3])-(h*t/255|0)|0;h=255*h/v|0;let x=255-h;a.data[m]=(c.data[m]*h+a.data[m]*x)/255|0;a.data[m+1]=(c.data[m+1]*h+a.data[m+1]*x)/255|0;a.data[m+2]=(c.data[m+2]*h+a.data[m+2]*x)/255|0;a.data[m+3]=v}}};V.addOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3];m&&(a.data[b]=a.data[b]+m*c.data[b]/255|0,a.data[b+
1]=a.data[b+1]+m*c.data[b+1]/255|0,a.data[b+2]=a.data[b+2]+m*c.data[b+2]/255|0)}};V.addOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0;l&&(a.data[b]=a.data[b]+l*c.data[b]/255|0,a.data[b+1]=a.data[b+1]+l*c.data[b+1]/255|0,a.data[b+2]=a.data[b+2]+l*c.data[b+2]/255|0)}};V.addOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=
0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l;if(m){let h=m+(l=a.data[b+3])-(m*l/255|0)|0;a.data[b]=(l*a.data[b]+m*c.data[b])/h|0;a.data[b+1]=(l*a.data[b+1]+m*c.data[b+1])/h|0;a.data[b+2]=(l*a.data[b+2]+m*c.data[b+2])/h|0;a.data[b+3]=h}}};V.addOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,
b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let n=l+(h=a.data[b+3])-(l*h/255|0)|0;a.data[b]=(h*a.data[b]+l*c.data[b])/n|0;a.data[b+1]=(h*a.data[b+1]+l*c.data[b+1])/n|0;a.data[b+2]=(h*a.data[b+2]+l*c.data[b+2])/n|0;a.data[b+3]=n}}};V.addOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,
e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0;n&&(a.data[e]=a.data[e]+n*c.data[e]/255|0,a.data[e+1]=a.data[e+1]+n*c.data[e+1]/255|0,a.data[e+2]=a.data[e+2]+n*c.data[e+2]/255|0)}};V.addOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*
d/25500|0;r&&(a.data[m]=a.data[m]+r*c.data[m]/255|0,a.data[m+1]=a.data[m+1]+r*c.data[m+1]/255|0,a.data[m+2]=a.data[m+2]+r*c.data[m+2]/255|0)}};V.addOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r;if(n){let t=n+(r=a.data[e+3])-(n*r/255|0)|0;a.data[e]=(r*
a.data[e]+n*c.data[e])/t|0;a.data[e+1]=(r*a.data[e+1]+n*c.data[e+1])/t|0;a.data[e+2]=(r*a.data[e+2]+n*c.data[e+2])/t|0;a.data[e+3]=t}}};V.addOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t;if(r){let v=r+(t=a.data[m+3])-(r*t/255|0)|0;a.data[m]=
(t*a.data[m]+r*c.data[m])/v|0;a.data[m+1]=(t*a.data[m+1]+r*c.data[m+1])/v|0;a.data[m+2]=(t*a.data[m+2]+r*c.data[m+2])/v|0;a.data[m+3]=v}}};V.subtractOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3];m&&(a.data[b]=a.data[b]+m*c.data[b]/255-m|0,a.data[b+1]=a.data[b+1]+m*c.data[b+1]/255-m|0,a.data[b+2]=a.data[b+2]+m*c.data[b+2]/255-m|0)}};V.subtractOntoOpaqueFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0;l&&(a.data[b]=a.data[b]+l*c.data[b]/255-l|0,a.data[b+1]=a.data[b+1]+l*c.data[b+1]/255-l|0,a.data[b+2]=a.data[b+2]+l*c.data[b+2]/255-l|0)}};V.subtractOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,
b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l;if(m){let h=m+(l=a.data[b+3])-(m*l/255|0)|0,n=m*l;a.data[b]=(l*a.data[b]+m*c.data[b]-n)/h|0;a.data[b+1]=(l*a.data[b+1]+m*c.data[b+1]-n)/h|0;a.data[b+2]=(l*a.data[b+2]+m*c.data[b+2]-n)/h|0;a.data[b+3]=h}}};V.subtractOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let n=
l+(h=a.data[b+3])-(l*h/255|0)|0,r=l*h;a.data[b]=(h*a.data[b]+l*c.data[b]-r)/n|0;a.data[b+1]=(h*a.data[b+1]+l*c.data[b+1]-r)/n|0;a.data[b+2]=(h*a.data[b+2]+l*c.data[b+2]-r)/n|0;a.data[b+3]=n}}};V.subtractOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0;n&&(a.data[e]=
a.data[e]+n*c.data[e]/255-n|0,a.data[e+1]=a.data[e+1]+n*c.data[e+1]/255-n|0,a.data[e+2]=a.data[e+2]+n*c.data[e+2]/255-n|0)}};V.subtractOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0;r&&(a.data[m]=a.data[m]+r*c.data[m]/255-r|0,a.data[m+1]=a.data[m+1]+
r*c.data[m+1]/255-r|0,a.data[m+2]=a.data[m+2]+r*c.data[m+2]/255-r|0)}};V.subtractOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r;if(n){let t=n+(r=a.data[e+3])-(n*r/255|0)|0,v=n*r;a.data[e]=(r*a.data[e]+n*c.data[e]-v)/t|0;a.data[e+1]=(r*a.data[e+1]+n*c.data[e+
1]-v)/t|0;a.data[e+2]=(r*a.data[e+2]+n*c.data[e+2]-v)/t|0;a.data[e+3]=t}}};V.subtractOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t;if(r){let v=r+(t=a.data[m+3])-(r*t/255|0)|0,x=r*t;a.data[m]=(t*a.data[m]+r*c.data[m]-x)/v|0;a.data[m+1]=(t*a.data[m+
1]+r*c.data[m+1]-x)/v|0;a.data[m+2]=(t*a.data[m+2]+r*c.data[m+2]-x)/v|0;a.data[m+3]=v}}};V.screenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l;if(m){let h=255^m;l=a.data[b];a.data[b]=255^((255^l)*h+(255^c.data[b])*(255^l)*m/255)/255;l=a.data[b+1];a.data[b+1]=255^((255^l)*h+(255^c.data[b+1])*(255^l)*m/255)/255;l=a.data[b+2];a.data[b+2]=
255^((255^l)*h+(255^c.data[b+2])*(255^l)*m/255)/255}}};V.screenOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let n=255^l;h=a.data[b];a.data[b]=255^((255^h)*n+(255^c.data[b])*(255^h)*l/255)/255;h=a.data[b+1];a.data[b+1]=255^((255^h)*n+(255^c.data[b+1])*(255^h)*l/255)/255;h=a.data[b+2];a.data[b+2]=255^((255^h)*n+(255^
c.data[b+2])*(255^h)*l/255)/255}}};V.screenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=255^((255^f)*t+(255^h)*v+(255^f)*(255^h)*r/255)/n;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=255^((255^f)*t+(255^
h)*v+(255^f)*(255^h)*r/255)/n;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=255^((255^f)*t+(255^h)*v+(255^f)*(255^h)*r/255)/n;a.data[b+3]=n}}};V.screenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=
255^((255^e)*v+(255^n)*x+(255^e)*(255^n)*t/255)/r;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=255^((255^e)*v+(255^n)*x+(255^e)*(255^n)*t/255)/r;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=255^((255^e)*v+(255^n)*x+(255^e)*(255^n)*t/255)/r;a.data[b+3]=r}}};V.screenOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,
e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r;if(n){let t=255^n;r=a.data[e];a.data[e]=255^((255^r)*t+(255^c.data[e])*(255^r)*n/255)/255;r=a.data[e+1];a.data[e+1]=255^((255^r)*t+(255^c.data[e+1])*(255^r)*n/255)/255;r=a.data[e+2];a.data[e+2]=255^((255^r)*t+(255^c.data[e+2])*(255^r)*n/255)/255}}};V.screenOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);
for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t;if(r){let v=255^r;t=a.data[m];a.data[m]=255^((255^t)*v+(255^c.data[m])*(255^t)*r/255)/255;t=a.data[m+1];a.data[m+1]=255^((255^t)*v+(255^c.data[m+1])*(255^t)*r/255)/255;t=a.data[m+2];a.data[m+2]=255^((255^t)*v+(255^c.data[m+2])*(255^t)*r/255)/255}}};V.screenOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,
b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=255^((255^l)*D+(255^t)*G+(255^l)*(255^t)*x/255)/v;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=255^((255^l)*D+(255^t)*G+(255^l)*(255^t)*x/255)/v;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=255^((255^l)*D+(255^t)*G+(255^l)*(255^
t)*x/255)/v;a.data[e+3]=v}}};V.screenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=255^((255^h)*G+(255^v)*N+
(255^h)*(255^v)*D/255)/x;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=255^((255^h)*G+(255^v)*N+(255^h)*(255^v)*D/255)/x;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=255^((255^h)*G+(255^v)*N+(255^h)*(255^v)*D/255)/x;a.data[m+3]=x}}};V.lightenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=h>=l?
h:(h*n+l*m)/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=h>=l?h:(h*n+l*m)/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=h>=l?h:(h*n+l*m)/255|0}}};V.lightenOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];a.data[b]=n>=h?n:(n*r+h*l)/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=n>=
h?n:(n*r+h*l)/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=n>=h?n:(n*r+h*l)/255|0}}};V.lightenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=l*(255^f)/n|0,t=255^r,v=f*(255^l)/n|0,x=255^v;f=c.data[b];h=a.data[b];a.data[b]=(h>=f?f*v+h*x:h*r+f*t)/255|0;f=c.data[b+1];h=a.data[b+1];
a.data[b+1]=(h>=f?f*v+h*x:h*r+f*t)/255|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(h>=f?f*v+h*x:h*r+f*t)/255|0;a.data[b+3]=n}}};V.lightenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=h*(255^e)/r|0,v=255^t,x=e*(255^h)/r|0,D=255^x;e=c.data[b];n=a.data[b];a.data[b]=(n>=
e?e*x+n*D:n*t+e*v)/255|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(n>=e?e*x+n*D:n*t+e*v)/255|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(n>=e?e*x+n*D:n*t+e*v)/255|0;a.data[b+3]=r}}};V.lightenOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r,t;if(n){let v=255^n;
r=c.data[e];t=a.data[e];a.data[e]=t>=r?t:(t*v+r*n)/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=t>=r?t:(t*v+r*n)/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=t>=r?t:(t*v+r*n)/255|0}}};V.lightenOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=
255^r;t=c.data[m];v=a.data[m];a.data[m]=v>=t?v:(v*x+t*r)/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=v>=t?v:(v*x+t*r)/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=v>=t?v:(v*x+t*r)/255|0}}};V.lightenOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,
t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=r*(255^l)/v|0,D=255^x,G=l*(255^r)/v|0,N=255^G;l=c.data[e];t=a.data[e];a.data[e]=(t>=l?l*G+t*N:t*x+l*D)/255|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(t>=l?l*G+t*N:t*x+l*D)/255|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(t>=l?l*G+t*N:t*x+l*D)/255|0;a.data[e+3]=v}}};V.lightenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=t*(255^h)/x|0,G=255^D,N=h*(255^t)/x|0,K=255^N;h=c.data[m];v=a.data[m];a.data[m]=(v>=h?h*N+v*K:v*D+h*G)/255|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(v>=h?h*N+v*K:v*D+h*G)/255|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(v>=h?h*N+v*K:v*D+h*G)/255|0;a.data[m+3]=x}}};V.darkenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=
0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=h>=l?(h*n+l*m)/255|0:h;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=h>=l?(h*n+l*m)/255|0:h;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=h>=l?(h*n+l*m)/255|0:h}}};V.darkenOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=
0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];a.data[b]=n>=h?(n*r+h*l)/255|0:n;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=n>=h?(n*r+h*l)/255|0:n;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=n>=h?(n*r+h*l)/255|0:n}}};V.darkenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,
h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*(255^l)/n|0,t=255^r,v=l*(255^f)/n|0,x=255^v;f=c.data[b];h=a.data[b];a.data[b]=(h>=f?h*v+f*x:f*r+h*t)/255|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(h>=f?h*v+f*x:f*r+h*t)/255|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(h>=f?h*v+f*x:f*r+h*t)/255|0;a.data[b+3]=n}}};V.darkenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=
0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*(255^h)/r|0,v=255^t,x=h*(255^e)/r|0,D=255^x;e=c.data[b];n=a.data[b];a.data[b]=(n>=e?n*x+e*D:e*t+n*v)/255|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(n>=e?n*x+e*D:e*t+n*v)/255|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(n>=e?n*x+e*D:e*t+n*v)/255|0;a.data[b+3]=r}}};V.darkenOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,
b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=t>=r?(t*v+r*n)/255|0:t;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=t>=r?(t*v+r*n)/255|0:t;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=t>=r?(t*v+r*n)/255|0:t}}};V.darkenOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,
b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=v>=t?(v*x+t*r)/255|0:v;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=v>=t?(v*x+t*r)/255|0:v;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=v>=t?(v*x+t*r)/255|0:v}}};V.darkenOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,
b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*(255^r)/v|0,D=255^x,G=r*(255^l)/v|0,N=255^G;l=c.data[e];t=a.data[e];a.data[e]=(t>=l?t*G+l*N:l*x+t*D)/255|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(t>=l?t*G+l*N:l*x+t*D)/255|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(t>=l?t*G+l*N:l*x+t*D)/255|0;a.data[e+3]=v}}};V.darkenOntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*(255^t)/x|0,G=255^D,N=t*(255^h)/x|0,K=255^N;h=c.data[m];v=a.data[m];a.data[m]=(v>=h?v*N+h*K:h*D+v*G)/255|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(v>=h?v*N+h*K:h*D+v*G)/255|0;h=c.data[m+2];
v=a.data[m+2];a.data[m+2]=(v>=h?v*N+h*K:h*D+v*G)/255|0;a.data[m+3]=x}}};V.dodgeOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=(h*n+m*(255==l?255:Math.min(255,255*h/(255^l)|0)))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(h*n+m*(255==l?255:Math.min(255,255*h/(255^l)|0)))/255|0;l=
c.data[b+2];h=a.data[b+2];a.data[b+2]=(h*n+m*(255==l?255:Math.min(255,255*h/(255^l)|0)))/255|0}}};V.dodgeOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];a.data[b]=(n*r+l*(255==h?255:Math.min(255,255*n/(255^h)|0)))/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=(n*r+l*(255==h?255:Math.min(255,
255*n/(255^h)|0)))/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=(n*r+l*(255==h?255:Math.min(255,255*n/(255^h)|0)))/255|0}}};V.dodgeOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*t+h*v+r*(255==f?255:
Math.min(255,255*h/(255^f)|0)))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*t+h*v+r*(255==f?255:Math.min(255,255*h/(255^f)|0)))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(f*t+h*v+r*(255==f?255:Math.min(255,255*h/(255^f)|0)))/n|0;a.data[b+3]=n}}};V.dodgeOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=
e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(e*v+n*x+t*(255==e?255:Math.min(255,255*n/(255^e)|0)))/r|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(e*v+n*x+t*(255==e?255:Math.min(255,255*n/(255^e)|0)))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(e*v+n*x+t*(255==e?255:Math.min(255,255*n/(255^e)|0)))/r|0;a.data[b+3]=r}}};V.dodgeOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-
p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=(t*v+n*(255==r?255:Math.min(255,255*t/(255^r)|0)))/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=(t*v+n*(255==r?255:Math.min(255,255*t/(255^r)|0)))/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=(t*v+n*(255==r?255:Math.min(255,255*t/(255^r)|0)))/255|0}}};V.dodgeOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=(v*x+r*(255==t?255:Math.min(255,255*v/(255^t)|0)))/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=(v*x+r*(255==t?255:Math.min(255,255*v/(255^t)|0)))/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+
2]=(v*x+r*(255==t?255:Math.min(255,255*v/(255^t)|0)))/255|0}}};V.dodgeOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(l*
D+t*G+x*(255==l?255:Math.min(255,255*t/(255^l)|0)))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(l*D+t*G+x*(255==l?255:Math.min(255,255*t/(255^l)|0)))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(l*D+t*G+x*(255==l?255:Math.min(255,255*t/(255^l)|0)))/v|0;a.data[e+3]=v}}};V.dodgeOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,
m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(h*G+v*N+D*(255==h?255:Math.min(255,255*v/(255^h)|0)))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(h*G+v*N+D*(255==h?255:Math.min(255,255*v/(255^h)|0)))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(h*G+v*N+D*(255==h?255:Math.min(255,255*v/(255^h)|0)))/x|0;a.data[m+3]=x}}};V.burnOntoOpaqueFusionWithOpaqueLayer=
function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=(h*n+m*(0==l?0:255^Math.min(255,255*(255^h)/l)))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(h*n+m*(0==l?0:255^Math.min(255,255*(255^h)/l)))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(h*n+m*(0==l?0:255^Math.min(255,255*(255^h)/l)))/255|0}}};V.burnOntoOpaqueFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];a.data[b]=(n*r+l*(0==h?0:255^Math.min(255,255*(255^n)/h)))/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=(n*r+l*(0==h?0:255^Math.min(255,255*(255^n)/h)))/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=(n*r+l*(0==h?0:255^Math.min(255,255*(255^n)/h)))/255|0}}};V.burnOntoTransparentFusionWithOpaqueLayer=
function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*t+h*v+r*(0==f?0:255^Math.min(255,255*(255^h)/f)))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*t+h*v+r*(0==f?0:255^Math.min(255,255*(255^h)/f)))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+
2]=(f*t+h*v+r*(0==f?0:255^Math.min(255,255*(255^h)/f)))/n|0;a.data[b+3]=n}}};V.burnOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(e*v+n*x+t*(0==e?0:255^Math.min(255,255*(255^n)/e)))/r|0;
e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(e*v+n*x+t*(0==e?0:255^Math.min(255,255*(255^n)/e)))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(e*v+n*x+t*(0==e?0:255^Math.min(255,255*(255^n)/e)))/r|0;a.data[b+3]=r}}};V.burnOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/
255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=(t*v+n*(0==r?0:255^Math.min(255,255*(255^t)/r)))/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=(t*v+n*(0==r?0:255^Math.min(255,255*(255^t)/r)))/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=(t*v+n*(0==r?0:255^Math.min(255,255*(255^t)/r)))/255|0}}};V.burnOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=(v*x+r*(0==t?0:255^Math.min(255,255*(255^v)/t)))/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=(v*x+r*(0==t?0:255^Math.min(255,255*(255^v)/t)))/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=(v*x+r*(0==t?0:255^Math.min(255,255*(255^v)/t)))/255|0}}};V.burnOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=
0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(l*D+t*G+x*(0==l?0:255^Math.min(255,255*(255^t)/l)))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(l*D+t*G+x*(0==l?0:255^Math.min(255,255*(255^t)/l)))/v|0;l=c.data[e+
2];t=a.data[e+2];a.data[e+2]=(l*D+t*G+x*(0==l?0:255^Math.min(255,255*(255^t)/l)))/v|0;a.data[e+3]=v}}};V.burnOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^
h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(h*G+v*N+D*(0==h?0:255^Math.min(255,255*(255^v)/h)))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(h*G+v*N+D*(0==h?0:255^Math.min(255,255*(255^v)/h)))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(h*G+v*N+D*(0==h?0:255^Math.min(255,255*(255^v)/h)))/x|0;a.data[m+3]=x}}};V.overlayOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<
g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=(n*h+(127>=h?2*m*l*h/255:m*(2*(255^l)*(255^h)/255^255)))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(n*h+(127>=h?2*m*l*h/255:m*(2*(255^l)*(255^h)/255^255)))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(n*h+(127>=h?2*m*l*h/255:m*(2*(255^l)*(255^h)/255^255)))/255|0}}};V.overlayOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,
b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];a.data[b]=(r*n+(127>=n?2*l*h*n/255:l*(2*(255^h)*(255^n)/255^255)))/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=(r*n+(127>=n?2*l*h*n/255:l*(2*(255^h)*(255^n)/255^255)))/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=(r*n+(127>=n?2*l*h*n/255:l*(2*(255^h)*(255^n)/255^255)))/255|0}}};V.overlayOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|
b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(t*f+v*h+(127>=h?2*r*f*h/255:r*(2*(255^f)*(255^h)/255^255)))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(t*f+v*h+(127>=h?2*r*f*h/255:r*(2*(255^f)*(255^h)/255^255)))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(t*f+v*h+(127>=h?2*r*f*
h/255:r*(2*(255^f)*(255^h)/255^255)))/n|0;a.data[b+3]=n}}};V.overlayOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(v*e+x*n+(127>=n?2*t*e*n/255:t*(2*(255^e)*(255^n)/255^255)))/r|0;e=c.data[b+
1];n=a.data[b+1];a.data[b+1]=(v*e+x*n+(127>=n?2*t*e*n/255:t*(2*(255^e)*(255^n)/255^255)))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(v*e+x*n+(127>=n?2*t*e*n/255:t*(2*(255^e)*(255^n)/255^255)))/r|0;a.data[b+3]=r}}};V.overlayOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/
255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=(v*t+(127>=t?2*n*r*t/255:n*(2*(255^r)*(255^t)/255^255)))/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=(v*t+(127>=t?2*n*r*t/255:n*(2*(255^r)*(255^t)/255^255)))/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=(v*t+(127>=t?2*n*r*t/255:n*(2*(255^r)*(255^t)/255^255)))/255|0}}};V.overlayOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-
f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=(x*v+(127>=v?2*r*t*v/255:r*(2*(255^t)*(255^v)/255^255)))/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=(x*v+(127>=v?2*r*t*v/255:r*(2*(255^t)*(255^v)/255^255)))/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=(x*v+(127>=v?2*r*t*v/255:r*(2*(255^t)*(255^v)/255^255)))/255|0}}};V.overlayOntoTransparentFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(D*l+G*t+(127>=t?2*x*l*t/255:x*(2*(255^l)*(255^t)/255^255)))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(D*l+G*t+
(127>=t?2*x*l*t/255:x*(2*(255^l)*(255^t)/255^255)))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(D*l+G*t+(127>=t?2*x*l*t/255:x*(2*(255^l)*(255^t)/255^255)))/v|0;a.data[e+3]=v}}};V.overlayOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=
h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(G*h+N*v+(127>=v?2*D*h*v/255:D*(2*(255^h)*(255^v)/255^255)))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(G*h+N*v+(127>=v?2*D*h*v/255:D*(2*(255^h)*(255^v)/255^255)))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(G*h+N*v+(127>=v?2*D*h*v/255:D*(2*(255^h)*(255^v)/255^255)))/x|0;a.data[m+3]=x}}};V.hardLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),
p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=(n*h+(127>=l?2*m*l*h/255:m*(2*(255^l)*(255^h)/255^255)))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(n*h+(127>=l?2*m*l*h/255:m*(2*(255^l)*(255^h)/255^255)))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(n*h+(127>=l?2*m*l*h/255:m*(2*(255^l)*(255^h)/255^255)))/255|0}}};V.hardLightOntoOpaqueFusionWithTransparentLayer=function(a,
c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];a.data[b]=(r*n+(127>=h?2*l*h*n/255:l*(2*(255^h)*(255^n)/255^255)))/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=(r*n+(127>=h?2*l*h*n/255:l*(2*(255^h)*(255^n)/255^255)))/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=(r*n+(127>=h?2*l*h*n/255:l*(2*(255^h)*(255^n)/255^255)))/255|0}}};
V.hardLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(t*f+v*h+(127>=f?2*r*f*h/255:r*(2*(255^f)*(255^h)/255^255)))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(t*f+v*h+(127>=f?2*r*f*h/255:r*(2*(255^
f)*(255^h)/255^255)))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(t*f+v*h+(127>=f?2*r*f*h/255:r*(2*(255^f)*(255^h)/255^255)))/n|0;a.data[b+3]=n}}};V.hardLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=
a.data[b];a.data[b]=(v*e+x*n+(127>=e?2*t*e*n/255:t*(2*(255^e)*(255^n)/255^255)))/r|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(v*e+x*n+(127>=e?2*t*e*n/255:t*(2*(255^e)*(255^n)/255^255)))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(v*e+x*n+(127>=e?2*t*e*n/255:t*(2*(255^e)*(255^n)/255^255)))/r|0;a.data[b+3]=r}}};V.hardLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=(v*t+(127>=r?2*n*r*t/255:n*(2*(255^r)*(255^t)/255^255)))/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=(v*t+(127>=r?2*n*r*t/255:n*(2*(255^r)*(255^t)/255^255)))/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=(v*t+(127>=r?2*n*r*t/255:n*(2*(255^r)*(255^t)/255^255)))/255|0}}};V.hardLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=
0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=(x*v+(127>=t?2*r*t*v/255:r*(2*(255^t)*(255^v)/255^255)))/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=(x*v+(127>=t?2*r*t*v/255:r*(2*(255^t)*(255^v)/255^255)))/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=(x*v+(127>=
t?2*r*t*v/255:r*(2*(255^t)*(255^v)/255^255)))/255|0}}};V.hardLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(D*l+
G*t+(127>=l?2*x*l*t/255:x*(2*(255^l)*(255^t)/255^255)))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(D*l+G*t+(127>=l?2*x*l*t/255:x*(2*(255^l)*(255^t)/255^255)))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(D*l+G*t+(127>=l?2*x*l*t/255:x*(2*(255^l)*(255^t)/255^255)))/v|0;a.data[e+3]=v}}};V.hardLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);
for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(G*h+N*v+(127>=h?2*D*h*v/255:D*(2*(255^h)*(255^v)/255^255)))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(G*h+N*v+(127>=h?2*D*h*v/255:D*(2*(255^h)*(255^v)/255^255)))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(G*h+N*v+(127>=h?2*D*h*v/255:D*(2*(255^h)*(255^v)/255^255)))/
x|0;a.data[m+3]=x}}};V.softLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=(n*h+m*(127>=l?((2*l-255)*Rb[h]/255|0)+h:((2*l-255)*Sb[h]/255|0)+h))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(n*h+m*(127>=l?((2*l-255)*Rb[h]/255|0)+h:((2*l-255)*Sb[h]/255|0)+h))/255|0;l=c.data[b+2];
h=a.data[b+2];a.data[b+2]=(n*h+m*(127>=l?((2*l-255)*Rb[h]/255|0)+h:((2*l-255)*Sb[h]/255|0)+h))/255|0}}};V.softLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];a.data[b]=(r*n+l*(127>=h?((2*h-255)*Rb[n]/255|0)+n:((2*h-255)*Sb[n]/255|0)+n))/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+
1]=(r*n+l*(127>=h?((2*h-255)*Rb[n]/255|0)+n:((2*h-255)*Sb[n]/255|0)+n))/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=(r*n+l*(127>=h?((2*h-255)*Rb[n]/255|0)+n:((2*h-255)*Sb[n]/255|0)+n))/255|0}}};V.softLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|
0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(t*f+v*h+(127>=f?r*(((2*f-255)*Rb[h]/255|0)+h):r*(((2*f-255)*Sb[h]/255|0)+h)))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(t*f+v*h+(127>=f?r*(((2*f-255)*Rb[h]/255|0)+h):r*(((2*f-255)*Sb[h]/255|0)+h)))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(t*f+v*h+(127>=f?r*(((2*f-255)*Rb[h]/255|0)+h):r*(((2*f-255)*Sb[h]/255|0)+h)))/n|0;a.data[b+3]=n}}};V.softLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),
f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(v*e+x*n+(127>=e?t*(((2*e-255)*Rb[n]/255|0)+n):t*(((2*e-255)*Sb[n]/255|0)+n)))/r|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(v*e+x*n+(127>=e?t*(((2*e-255)*Rb[n]/255|0)+n):t*(((2*e-255)*Sb[n]/255|0)+n)))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+
2]=(v*e+x*n+(127>=e?t*(((2*e-255)*Rb[n]/255|0)+n):t*(((2*e-255)*Sb[n]/255|0)+n)))/r|0;a.data[b+3]=r}}};V.softLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=(v*t+n*(127>=r?((2*r-255)*Rb[t]/255|0)+t:
((2*r-255)*Sb[t]/255|0)+t))/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=(v*t+n*(127>=r?((2*r-255)*Rb[t]/255|0)+t:((2*r-255)*Sb[t]/255|0)+t))/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=(v*t+n*(127>=r?((2*r-255)*Rb[t]/255|0)+t:((2*r-255)*Sb[t]/255|0)+t))/255|0}}};V.softLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=
e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=(x*v+r*(127>=t?((2*t-255)*Rb[v]/255|0)+v:((2*t-255)*Sb[v]/255|0)+v))/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=(x*v+r*(127>=t?((2*t-255)*Rb[v]/255|0)+v:((2*t-255)*Sb[v]/255|0)+v))/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=(x*v+r*(127>=t?((2*t-255)*Rb[v]/255|0)+v:((2*t-255)*Sb[v]/255|0)+v))/255|0}}};V.softLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,
c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(D*l+G*t+(127>=l?x*(((2*l-255)*Rb[t]/255|0)+t):x*(((2*l-255)*Sb[t]/255|0)+t)))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(D*
l+G*t+(127>=l?x*(((2*l-255)*Rb[t]/255|0)+t):x*(((2*l-255)*Sb[t]/255|0)+t)))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(D*l+G*t+(127>=l?x*(((2*l-255)*Rb[t]/255|0)+t):x*(((2*l-255)*Sb[t]/255|0)+t)))/v|0;a.data[e+3]=v}}};V.softLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=
c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(G*h+N*v+(127>=h?D*(((2*h-255)*Rb[v]/255|0)+v):D*(((2*h-255)*Sb[v]/255|0)+v)))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(G*h+N*v+(127>=h?D*(((2*h-255)*Rb[v]/255|0)+v):D*(((2*h-255)*Sb[v]/255|0)+v)))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(G*h+N*v+(127>=h?D*(((2*h-255)*Rb[v]/255|0)+v):D*(((2*h-255)*Sb[v]/255|0)+v)))/x|0;a.data[m+
3]=x}}};V.vividLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=(n*h+(127>=l?m*(0==l?0:255-Math.min(255,255*(255-h)/(2*l)|0)):m*(255==l?255:Math.min(255,255*h/(2*(255-l))|0))))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(n*h+(127>=l?m*(0==l?0:255-Math.min(255,255*(255-h)/(2*l)|
0)):m*(255==l?255:Math.min(255,255*h/(2*(255-l))|0))))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(n*h+(127>=l?m*(0==l?0:255-Math.min(255,255*(255-h)/(2*l)|0)):m*(255==l?255:Math.min(255,255*h/(2*(255-l))|0))))/255|0}}};V.vividLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];
a.data[b]=(r*n+(127>=h?l*(0==h?0:255-Math.min(255,255*(255-n)/(2*h)|0)):l*(255==h?255:Math.min(255,255*n/(2*(255-h))|0))))/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=(r*n+(127>=h?l*(0==h?0:255-Math.min(255,255*(255-n)/(2*h)|0)):l*(255==h?255:Math.min(255,255*n/(2*(255-h))|0))))/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=(r*n+(127>=h?l*(0==h?0:255-Math.min(255,255*(255-n)/(2*h)|0)):l*(255==h?255:Math.min(255,255*n/(2*(255-h))|0))))/255|0}}};V.vividLightOntoTransparentFusionWithOpaqueLayer=function(a,
c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(t*f+v*h+(127>=f?r*(0==f?0:255-Math.min(255,255*(255-h)/(2*f)|0)):r*(255==f?255:Math.min(255,255*h/(2*(255-f))|0))))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(t*f+v*h+(127>=f?r*(0==f?0:255-Math.min(255,
255*(255-h)/(2*f)|0)):r*(255==f?255:Math.min(255,255*h/(2*(255-f))|0))))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(t*f+v*h+(127>=f?r*(0==f?0:255-Math.min(255,255*(255-h)/(2*f)|0)):r*(255==f?255:Math.min(255,255*h/(2*(255-f))|0))))/n|0;a.data[b+3]=n}}};V.vividLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,
n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(v*e+x*n+(127>=e?t*(0==e?0:255-Math.min(255,255*(255-n)/(2*e)|0)):t*(255==e?255:Math.min(255,255*n/(2*(255-e))|0))))/r|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(v*e+x*n+(127>=e?t*(0==e?0:255-Math.min(255,255*(255-n)/(2*e)|0)):t*(255==e?255:Math.min(255,255*n/(2*(255-e))|0))))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(v*e+x*n+(127>=e?t*(0==e?0:255-Math.min(255,255*(255-
n)/(2*e)|0)):t*(255==e?255:Math.min(255,255*n/(2*(255-e))|0))))/r|0;a.data[b+3]=r}}};V.vividLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=(v*t+(127>=r?n*(0==r?0:255-Math.min(255,255*(255-t)/(2*r)|
0)):n*(255==r?255:Math.min(255,255*t/(2*(255-r))|0))))/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=(v*t+(127>=r?n*(0==r?0:255-Math.min(255,255*(255-t)/(2*r)|0)):n*(255==r?255:Math.min(255,255*t/(2*(255-r))|0))))/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=(v*t+(127>=r?n*(0==r?0:255-Math.min(255,255*(255-t)/(2*r)|0)):n*(255==r?255:Math.min(255,255*t/(2*(255-r))|0))))/255|0}}};V.vividLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-
f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=(x*v+(127>=t?r*(0==t?0:255-Math.min(255,255*(255-v)/(2*t)|0)):r*(255==t?255:Math.min(255,255*v/(2*(255-t))|0))))/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=(x*v+(127>=t?r*(0==t?0:255-Math.min(255,255*(255-v)/(2*t)|0)):r*(255==t?255:Math.min(255,255*v/(2*(255-
t))|0))))/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=(x*v+(127>=t?r*(0==t?0:255-Math.min(255,255*(255-v)/(2*t)|0)):r*(255==t?255:Math.min(255,255*v/(2*(255-t))|0))))/255|0}}};V.vividLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=
l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(D*l+G*t+(127>=l?x*(0==l?0:255-Math.min(255,255*(255-t)/(2*l)|0)):x*(255==l?255:Math.min(255,255*t/(2*(255-l))|0))))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(D*l+G*t+(127>=l?x*(0==l?0:255-Math.min(255,255*(255-t)/(2*l)|0)):x*(255==l?255:Math.min(255,255*t/(2*(255-l))|0))))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(D*l+G*t+(127>=l?x*(0==l?0:255-Math.min(255,255*(255-t)/(2*l)|0)):
x*(255==l?255:Math.min(255,255*t/(2*(255-l))|0))))/v|0;a.data[e+3]=v}}};V.vividLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];
v=a.data[m];a.data[m]=(G*h+N*v+(127>=h?D*(0==h?0:255-Math.min(255,255*(255-v)/(2*h)|0)):D*(255==h?255:Math.min(255,255*v/(2*(255-h))|0))))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(G*h+N*v+(127>=h?D*(0==h?0:255-Math.min(255,255*(255-v)/(2*h)|0)):D*(255==h?255:Math.min(255,255*v/(2*(255-h))|0))))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(G*h+N*v+(127>=h?D*(0==h?0:255-Math.min(255,255*(255-v)/(2*h)|0)):D*(255==h?255:Math.min(255,255*v/(2*(255-h))|0))))/x|0;a.data[m+3]=x}}};V.linearLightOntoOpaqueFusionWithOpaqueLayer=
function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l;if(m){let h=255^m;l=a.data[b];a.data[b]=(h*l+m*Math.min(255,Math.max(0,l+2*c.data[b]-255)))/255|0;l=a.data[b+1];a.data[b+1]=(h*l+m*Math.min(255,Math.max(0,l+2*c.data[b+1]-255)))/255|0;l=a.data[b+2];a.data[b+2]=(h*l+m*Math.min(255,Math.max(0,l+2*c.data[b+2]-255)))/255|0}}};V.linearLightOntoOpaqueFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let n=255^l;h=a.data[b];a.data[b]=(n*h+l*Math.min(255,Math.max(0,h+2*c.data[b]-255)))/255|0;h=a.data[b+1];a.data[b+1]=(n*h+l*Math.min(255,Math.max(0,h+2*c.data[b+1]-255)))/255|0;h=a.data[b+2];a.data[b+2]=(n*h+l*Math.min(255,Math.max(0,h+2*c.data[b+2]-255)))/255|0}}};V.linearLightOntoTransparentFusionWithOpaqueLayer=
function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(t*f+v*h+r*Math.min(255,Math.max(0,h+2*f-255)))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(t*f+v*h+r*Math.min(255,Math.max(0,h+2*f-255)))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(t*f+
v*h+r*Math.min(255,Math.max(0,h+2*f-255)))/n|0;a.data[b+3]=n}}};V.linearLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(v*e+x*n+t*Math.min(255,Math.max(0,n+2*e-255)))/r|0;e=c.data[b+
1];n=a.data[b+1];a.data[b+1]=(v*e+x*n+t*Math.min(255,Math.max(0,n+2*e-255)))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(v*e+x*n+t*Math.min(255,Math.max(0,n+2*e-255)))/r|0;a.data[b+3]=r}}};V.linearLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r;if(n){let t=
255^n;r=a.data[e];a.data[e]=(t*r+n*Math.min(255,Math.max(0,r+2*c.data[e]-255)))/255|0;r=a.data[e+1];a.data[e+1]=(t*r+n*Math.min(255,Math.max(0,r+2*c.data[e+1]-255)))/255|0;r=a.data[e+2];a.data[e+2]=(t*r+n*Math.min(255,Math.max(0,r+2*c.data[e+2]-255)))/255|0}}};V.linearLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,
b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t;if(r){let v=255^r;t=a.data[m];a.data[m]=(v*t+r*Math.min(255,Math.max(0,t+2*c.data[m]-255)))/255|0;t=a.data[m+1];a.data[m+1]=(v*t+r*Math.min(255,Math.max(0,t+2*c.data[m+1]-255)))/255|0;t=a.data[m+2];a.data[m+2]=(v*t+r*Math.min(255,Math.max(0,t+2*c.data[m+2]-255)))/255|0}}};V.linearLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,
b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(D*l+G*t+x*Math.min(255,Math.max(0,t+2*l-255)))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(D*l+G*t+x*Math.min(255,Math.max(0,t+2*l-255)))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(D*l+G*t+x*Math.min(255,Math.max(0,
t+2*l-255)))/v|0;a.data[e+3]=v}}};V.linearLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(G*h+N*v+D*Math.min(255,
Math.max(0,v+2*h-255)))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(G*h+N*v+D*Math.min(255,Math.max(0,v+2*h-255)))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(G*h+N*v+D*Math.min(255,Math.max(0,v+2*h-255)))/x|0;a.data[m+3]=x}}};V.pinLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;if(m){let n=255^m;l=c.data[b];h=a.data[b];a.data[b]=
(n*h+m*(h>=2*l?2*l:h<=2*l-255?2*l-255:h))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(n*h+m*(h>=2*l?2*l:h<=2*l-255?2*l-255:h))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(n*h+m*(h>=2*l?2*l:h<=2*l-255?2*l-255:h))/255|0}}};V.pinLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;if(l){let r=255^l;h=c.data[b];n=a.data[b];
a.data[b]=(r*n+l*(n>=2*h?2*h:n<=2*h-255?2*h-255:n))/255|0;h=c.data[b+1];n=a.data[b+1];a.data[b+1]=(r*n+l*(n>=2*h?2*h:n<=2*h-255?2*h-255:n))/255|0;h=c.data[b+2];n=a.data[b+2];a.data[b+2]=(r*n+l*(n>=2*h?2*h:n<=2*h-255?2*h-255:n))/255|0}}};V.pinLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let m=0;m<g;m++,b+=4){var f=c.data[b+3];let l,h;if(f){let n=f+(l=a.data[b+3])-(f*
l/255|0)|0,r=f*l/255|0,t=f*(255^l)/255|0,v=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(t*f+v*h+r*(h>=2*f?2*f:h<=2*f-255?2*f-255:h))/n|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(t*f+v*h+r*(h>=2*f?2*f:h<=2*f-255?2*f-255:h))/n|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(t*f+v*h+r*(h>=2*f?2*f:h<=2*f-255?2*f-255:h))/n|0;a.data[b+3]=n}}};V.pinLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);
for(let m=0;m<g;m++,b+=f)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,n;if(e){let r=e+(h=a.data[b+3])-(e*h/255|0)|0,t=e*h/255|0,v=e*(255^h)/255|0,x=(255^e)*h/255|0;e=c.data[b];n=a.data[b];a.data[b]=(v*e+x*n+t*(n>=2*e?2*e:n<=2*e-255?2*e-255:n))/r|0;e=c.data[b+1];n=a.data[b+1];a.data[b+1]=(v*e+x*n+t*(n>=2*e?2*e:n<=2*e-255?2*e-255:n))/r|0;e=c.data[b+2];n=a.data[b+2];a.data[b+2]=(v*e+x*n+t*(n>=2*e?2*e:n<=2*e-255?2*e-255:n))/r|0;a.data[b+3]=r}}};V.pinLightOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0,r,t;if(n){let v=255^n;r=c.data[e];t=a.data[e];a.data[e]=(v*t+n*(t>=2*r?2*r:t<=2*r-255?2*r-255:t))/255|0;r=c.data[e+1];t=a.data[e+1];a.data[e+1]=(v*t+n*(t>=2*r?2*r:t<=2*r-255?2*r-255:t))/255|0;r=c.data[e+2];t=a.data[e+2];a.data[e+2]=(v*t+n*(t>=2*r?2*
r:t<=2*r-255?2*r-255:t))/255|0}}};V.pinLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3]*g.data[b]*d/25500|0,t,v;if(r){let x=255^r;t=c.data[m];v=a.data[m];a.data[m]=(x*v+r*(v>=2*t?2*t:v<=2*t-255?2*t-255:v))/255|0;t=c.data[m+1];v=a.data[m+1];a.data[m+1]=(x*v+r*(v>=2*
t?2*t:v<=2*t-255?2*t-255:v))/255|0;t=c.data[m+2];v=a.data[m+2];a.data[m+2]=(x*v+r*(v>=2*t?2*t:v<=2*t-255?2*t-255:v))/255|0}}};V.pinLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=m)for(let n=0;n<p;n++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let r,t;if(l){let v=l+(r=a.data[e+3])-(l*r/255|0)|0,x=l*r/255|0,D=l*(255^
r)/255|0,G=(255^l)*r/255|0;l=c.data[e];t=a.data[e];a.data[e]=(D*l+G*t+x*(t>=2*l?2*l:t<=2*l-255?2*l-255:t))/v|0;l=c.data[e+1];t=a.data[e+1];a.data[e+1]=(D*l+G*t+x*(t>=2*l?2*l:t<=2*l-255?2*l-255:t))/v|0;l=c.data[e+2];t=a.data[e+2];a.data[e+2]=(D*l+G*t+x*(t>=2*l?2*l:t<=2*l-255?2*l-255:t))/v|0;a.data[e+3]=v}}};V.pinLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let n=0;n<p;n++,m+=e,b+=l)for(let r=0;r<f;r++,m+=4,b++){var h=c.data[m+3]*g.data[b]*d/25500|0;let t,v;if(h){let x=h+(t=a.data[m+3])-(h*t/255|0)|0,D=h*t/255|0,G=h*(255^t)/255|0,N=(255^h)*t/255|0;h=c.data[m];v=a.data[m];a.data[m]=(G*h+N*v+D*(v>=2*h?2*h:v<=2*h-255?2*h-255:v))/x|0;h=c.data[m+1];v=a.data[m+1];a.data[m+1]=(G*h+N*v+D*(v>=2*h?2*h:v<=2*h-255?2*h-255:v))/x|0;h=c.data[m+2];v=a.data[m+2];a.data[m+2]=(G*h+N*v+D*(v>=2*h?2*h:v<=2*h-255?2*h-255:v))/x|0;a.data[m+3]=x}}};V.passthroughOntoOpaqueFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3],h=d/100,n=1-h,r=l*h+255*n;a.data[b]=(c.data[b]*l*h+255*a.data[b]*n)/r|0;a.data[b+1]=(c.data[b+1]*l*h+255*a.data[b+1]*n)/r|0;a.data[b+2]=(c.data[b+2]*l*h+255*a.data[b+2]*n)/r|0;a.data[b+3]=r}};V.passthroughOntoOpaqueFusionWithOpaqueLayer=V.passthroughOntoOpaqueFusionWithTransparentLayer;V.passthroughOntoTransparentFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3],h=a.data[b+3],n=d/100,r=1-n,t=l*n+h*r;a.data[b]=(c.data[b]*l*n+a.data[b]*h*r)/t|0;a.data[b+1]=(c.data[b+1]*l*n+a.data[b+1]*h*r)/t|0;a.data[b+2]=(c.data[b+2]*l*n+a.data[b+2]*h*r)/t|0;a.data[b+3]=t}};V.passthroughOntoTransparentFusionWithOpaqueLayer=V.passthroughOntoTransparentFusionWithTransparentLayer;V.passthroughOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3],t=g.data[b]*d/25500,v=1-t,x=r*t+255*v;a.data[m]=(c.data[m]*r*t+255*a.data[m]*v)/x|0;a.data[m+1]=(c.data[m+1]*r*t+255*a.data[m+1]*v)/x|0;a.data[m+2]=(c.data[m+2]*r*t+255*a.data[m+2]*v)/x|0;a.data[m+3]=x}};V.passthroughOntoOpaqueFusionWithOpaqueLayerMasked=V.passthroughOntoOpaqueFusionWithTransparentLayerMasked;
V.passthroughOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+3],t=a.data[m+3],v=g.data[b]*d/25500,x=1-v,D=r*v+t*x;a.data[m]=(c.data[m]*r*v+a.data[m]*t*x)/D|0;a.data[m+1]=(c.data[m+1]*r*v+a.data[m+1]*t*x)/D|0;a.data[m+2]=(c.data[m+2]*r*v+a.data[m+2]*t*x)/D|0;a.data[m+
3]=D}};V.passthroughOntoTransparentFusionWithOpaqueLayerMasked=V.passthroughOntoTransparentFusionWithTransparentLayerMasked;V.replaceOntoFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0;a.data[b]=c.data[b];a.data[b+1]=c.data[b+1];a.data[b+2]=c.data[b+2];a.data[b+3]=l}};V.replaceOntoFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();
let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3];a.data[b]=c.data[b];a.data[b+1]=c.data[b+1];a.data[b+2]=c.data[b+2];a.data[b+3]=m}};V.replaceOntoFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++){let r=c.data[m+
3]*g.data[b]*d/25500|0;a.data[m]=c.data[m];a.data[m+1]=c.data[m+1];a.data[m+2]=c.data[m+2];a.data[m+3]=r}};V.replaceOntoFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++){let n=c.data[e+3]*g.data[b]/255|0;a.data[e]=c.data[e];a.data[e+1]=c.data[e+1];a.data[e+2]=c.data[e+2];a.data[e+3]=n}};V.replaceAlphaOntoFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4)a.data[b+3]=c.data[b+3]*d/100|0};V.replaceAlphaOntoFusionWithTransparentLayerMasked=function(a,c,d,b,g){let p=0|b.getHeight(),f=0|b.getWidth(),e=4*(c.width-f)|0,m=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<p;h++,m+=e,b+=l)for(let n=0;n<f;n++,m+=4,b++)a.data[m+3]=c.data[m+3]*g.data[b]*d/25500|
0};V.replaceAlphaOntoFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4)a.data[b+3]=c.data[b+3]};V.replaceAlphaOntoFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let p=0|b.getWidth(),f=4*(c.width-p)|0,e=0|c.offsetOfPixel(b.left,b.top),m=g.width-p|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=m)for(let h=0;h<p;h++,e+=4,b++)a.data[e+3]=
c.data[e+3]*g.data[b]/255|0};V.upgradeMultiplyOfOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),p=4*(c.width-g)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=p)for(let e=0;e<g;e++,b+=4){let m=c.data[b+3],l,h;m&&(l=c.data[b],h=a.data[b],c.data[b]=l+Math.ceil((255-l)*h*m%65025/(h*m)),l=c.data[b+1],h=a.data[b+1],c.data[b+1]=l+Math.ceil((255-l)*h*m%65025/(h*m)),l=c.data[b+2],h=a.data[b+2],c.data[b+2]=l+Math.ceil((255-l)*h*m%65025/(h*m)))}};V.upgradeMultiplyOfTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),p=0|b.getWidth(),f=4*(c.width-p)|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let m=0;m<p;m++,b+=4){let l=c.data[b+3]*d/100|0,h,n;l&&(h=c.data[b],n=a.data[b],c.data[b]=h+Math.ceil((255-h)*n*l%65025/(n*l)),h=c.data[b+1],n=a.data[b+1],c.data[b+1]=h+Math.ceil((255-h)*n*l%65025/(n*l)),h=c.data[b+2],n=a.data[b+2],c.data[b+2]=h+Math.ceil((255-h)*n*l%65025/(n*l)))}};V._normalFuseImageOntoImageAtPosition=function(a,c,d,b,g,p){d=0|b.getHeight();let f=
0|b.getWidth(),e=4*(c.width-f)|0;b=0|c.offsetOfPixel(b.left,b.top);let m=4*(a.width-f)|0;g=0|a.offsetOfPixel(g,p);for(p=0;p<d;p++,b+=e,g+=m)for(let h=0;h<f;h++,b+=4,g+=4){var l=c.data[b+3];let n;if(l){let r=l+(n=a.data[g+3])-(l*n/255|0)|0;l=255*l/r|0;let t=255-l;a.data[g]=(c.data[b]*l+a.data[g]*t)/255|0;a.data[g+1]=(c.data[b+1]*l+a.data[g+1]*t)/255|0;a.data[g+2]=(c.data[b+2]*l+a.data[g+2]*t)/255|0;a.data[g+3]=r}}};V.LM_NORMAL=0;V.LM_MULTIPLY=1;V.LM_ADD=2;V.LM_SCREEN=3;V.LM_LIGHTEN=4;V.LM_DARKEN=5;
V.LM_SUBTRACT=6;V.LM_DODGE=7;V.LM_BURN=8;V.LM_OVERLAY=9;V.LM_HARDLIGHT=10;V.LM_SOFTLIGHT=11;V.LM_VIVIDLIGHT=12;V.LM_LINEARLIGHT=13;V.LM_PINLIGHT=14;V.LM_PASSTHROUGH=15;V.LM_MULTIPLY2=16;V.LM_FIRST=0;V.LM_LAST=16;V.LM_LAST_CHIBIPAINT=V.LM_PINLIGHT;V.BLEND_MODE_CODENAMES="normal multiply add screen lighten darken subtract dodge burn overlay hardLight softLight vividLight linearLight pinLight passthrough multiply2".split(" ");V.BLEND_MODE_DISPLAY_NAMES="Normal;Multiply;Add;Screen;Lighten;Darken;Subtract;Dodge;Burn;Overlay;Hard Light;Soft Light;Vivid Light;Linear Light;Pin Light;Passthrough;Multiply".split(";");
for(let a=0;256>a;a++){let c=a/255;Rb[a]=255*(c-c*c)|0}for(let a=0;256>a;a++){let c=a/255;Sb[a]=255*(Math.sqrt(c)-c)|0}rb.prototype.copyFrom=function(a){this.name=a.name;this.blendMode=a.blendMode;this.useLegacyMultiply=a.useLegacyMultiply;this.alpha=a.alpha;this.visible=a.visible;this.parent=a.parent;this.lockAlpha=a.lockAlpha;a.mask?this.mask?this.mask.copyPixelsFrom(a.mask):this.mask=a.mask.clone():this.mask=null;this.maskLinked=a.maskLinked;this.maskVisible=a.maskVisible;a.maskThumbnail?this.maskThumbnail?
this.maskThumbnail.copyPixelsFrom(a.maskThumbnail):this.maskThumbnail=a.maskThumbnail.clone():this.maskThumbnail=null};rb.prototype.setMask=function(a){(this.mask=a)||(this.maskThumbnail=null)};rb.prototype.setAlpha=function(a){this.alpha=a};rb.prototype.getAlpha=function(){return this.alpha};rb.prototype.getEffectiveAlpha=function(){return this.visible?this.alpha:0};rb.prototype.getEffectiveMask=function(){return this.maskVisible?this.mask:null};rb.prototype.setName=function(a){this.name=a};rb.prototype.getName=
function(){return this.name};rb.prototype.setBlendMode=function(a){this.blendMode=a;a===V.LM_MULTIPLY?this.useLegacyMultiply=!0:a===V.LM_MULTIPLY2&&(this.useLegacyMultiply=!1)};rb.prototype.getBlendMode=function(){return this.blendMode};rb.prototype.getLockAlpha=function(){return this.lockAlpha};rb.prototype.setLockAlpha=function(a){this.lockAlpha=a};rb.prototype.setVisible=function(a){this.visible=a};rb.prototype.getVisible=function(){return this.visible};rb.prototype.isVisible=rb.prototype.getVisible;
rb.prototype.setMaskLinked=function(a){this.maskLinked=a};rb.prototype.getMaskLinked=function(){return this.maskLinked};rb.prototype.setMaskVisible=function(a){this.maskVisible=a};rb.prototype.getMaskVisible=function(){return this.maskVisible};rb.prototype.getMemoryUsed=function(){return 0};rb.prototype.getDepth=function(){return null==this.parent?0:this.parent.getDepth()+1};rb.prototype.ancestorsAreVisible=function(){return null==this.parent||this.parent.visible&&this.parent.ancestorsAreVisible()};
rb.prototype.hasAncestor=function(a){return this.parent==a||this.parent&&this.parent.hasAncestor(a)};rb.prototype.clone=function(){throw"Pure virtual CPLayer.clone() call";};rb.prototype.getNonTransparentBounds=function(a){return new Ha(0,0,0,0)};rb.prototype.rebuildMaskThumbnail=function(){if(this.mask){if(!this.maskThumbnail){var a=Math.ceil(Math.max(this.mask.width/rb.LAYER_THUMBNAIL_WIDTH,this.mask.height/rb.LAYER_THUMBNAIL_HEIGHT));this.maskThumbnail=new Xa(Math.floor(this.mask.width/a),Math.floor(this.mask.height/
a),8)}this.maskThumbnail.createThumbnailFrom(this.mask)}else this.maskThumbnail=null};rb.prototype.getMaskThumbnail=function(){return!this.maskThumbnail&&this.mask&&this.rebuildMaskThumbnail(),this.maskThumbnail};rb.LAYER_THUMBNAIL_WIDTH=80;rb.LAYER_THUMBNAIL_HEIGHT=50;Ma.prototype=Object.create(rb.prototype);Ma.prototype.constructor=Ma;Ma.createFromImage=function(a,c){c=new Ma(0,0,c);return c.image=a,c};Ma.prototype.clone=function(){var a=new Ma(0,0,this.name);return a.copyFrom(this),a};Ma.prototype.copyFrom=
function(a){rb.prototype.copyFrom.call(this,a);this.clip=a.clip;this.image?this.image.copyPixelsFrom(a.image):this.image=a.image.clone()};Ma.prototype.hasAlpha=function(){return 100!=this.alpha||this.image.hasAlpha()};Ma.prototype.hasAlphaInRect=function(a){return 100!=this.alpha||this.image.hasAlphaInRect(a)};Ma.prototype.copyImageFrom=function(a){this.image.copyPixelsFrom(a)};Ma.prototype.getClippingBase=function(){if(this.clip&&this.parent)for(var a=this.parent.indexOf(this)-1;0<=a;a--)if(this.parent.layers[a]instanceof
Ma){if(!this.parent.layers[a].clip)return this.parent.layers[a]}else break;return null};Ma.prototype.getClip=function(){return this.clip};Ma.prototype.setClip=function(a){this.clip=a};Ma.prototype.getNonTransparentBounds=function(a){return this.image.getNonTransparentBounds(a)};Ma.prototype.getBounds=function(){return new Ha(0,0,this.image.width,this.image.height)};Ma.prototype.getMemoryUsed=function(){return this.image?this.image.getMemorySize():0};Ma.prototype.rebuildImageThumbnail=function(){if(!this.imageThumbnail){var a=
Math.ceil(Math.max(this.image.width/rb.LAYER_THUMBNAIL_WIDTH,this.image.height/rb.LAYER_THUMBNAIL_HEIGHT));this.imageThumbnail=new H(Math.floor(this.image.width/a),Math.floor(this.image.height/a))}this.imageThumbnail.createThumbnailFrom(this.image)};Ma.prototype.getImageThumbnail=function(){return this.imageThumbnail||this.rebuildImageThumbnail(),this.imageThumbnail};V.blendFunctionNameForParameters=function(a,c,d,b){d=V.BLEND_MODE_CODENAMES[d]+"Onto";return a?d+="TransparentFusion":d+="OpaqueFusion",
100==c?d+="WithOpaqueLayer":d+="WithTransparentLayer",b&&(d+="Masked"),d};V.fuseImageOntoImage=function(a,c,d,b,g,p,f){0>=b||(c=V.blendFunctionNameForParameters(c,b,g,null!=f),p=a.getBounds().clipTo(p),this[c](a,d,b,p,f))};V.normalFuseImageOntoImageAtPosition=function(a,c,d,b,g){g=g.clone();d=new Ha(d,b,0,0);a.getBounds().clipSourceDest(g,d);this._normalFuseImageOntoImageAtPosition(a,c,100,g,d.left,d.top)};V.multiplyAlphaBy=function(a,c){if(100>c)if(0==c)a.clearAll(0);else{a=a.data;for(var d=3;d<
a.length;d+=4)a[d]=Math.round(a[d]*c/100)}};V.multiplyAlphaByMask=function(a,c,d){c/=25500;for(var b=H.ALPHA_BYTE_OFFSET,g=0;b<a.data.length;b+=H.BYTES_PER_PIXEL,g++)a.data[b]=Math.round(a.data[b]*d.data[g]*c)};V.copyAndMultiplyAlphaBy=function(a,c,d,b){if(100==d)a.copyBitmapRect(c,b.left,b.top,b);else if(0==d)a.clearRect(b,0);else for(a=c.data,c=0;c<a.length;c+=4)a[c]=a[c],a[c+1]=a[c+1],a[c+2]=a[c+2],a[c+3]=Math.round(a[c+3]*d/100)};ge.prototype.addChildren=function(a){null!=a&&(Array.isArray(a)?
(a.forEach(c=>c.parent=this),this.layers=this.layers.concat(a)):(a.parent=this,this.layers.push(a)))};var $b={};!function(a){function c(){}function d(f,e){for(var m=f.length;m--;)if(f[m].listener===e)return m;return-1}function b(f){return function(){return this[f].apply(this,arguments)}}var g=c.prototype,p=a.EventEmitter;g.getListeners=function(f){var e,m,l=this._getEvents();if(f instanceof RegExp)for(m in e={},l)l.hasOwnProperty(m)&&f.test(m)&&(e[m]=l[m]);else e=l[f]||(l[f]=[]);return e};g.flattenListeners=
function(f){var e,m=[];for(e=0;e<f.length;e+=1)m.push(f[e].listener);return m};g.getListenersAsObject=function(f){var e,m=this.getListeners(f);return m instanceof Array&&((e={})[f]=m),e||m};g.addListener=function(f,e){if(!function r(n){return"function"==typeof n||n instanceof RegExp||!!n&&"object"==typeof n&&r(n.listener)}(e))throw TypeError("listener must be a function");var m;f=this.getListenersAsObject(f);var l="object"==typeof e;for(m in f)f.hasOwnProperty(m)&&-1===d(f[m],e)&&f[m].push(l?e:{listener:e,
once:!1});return this};g.on=b("addListener");g.addOnceListener=function(f,e){return this.addListener(f,{listener:e,once:!0})};g.once=b("addOnceListener");g.defineEvent=function(f){return this.getListeners(f),this};g.defineEvents=function(f){for(var e=0;e<f.length;e+=1)this.defineEvent(f[e]);return this};g.removeListener=function(f,e){var m,l;f=this.getListenersAsObject(f);for(l in f)f.hasOwnProperty(l)&&-1!==(m=d(f[l],e))&&f[l].splice(m,1);return this};g.off=b("removeListener");g.addListeners=function(f,
e){return this.manipulateListeners(!1,f,e)};g.removeListeners=function(f,e){return this.manipulateListeners(!0,f,e)};g.manipulateListeners=function(f,e,m){var l,h,n=f?this.removeListener:this.addListener;f=f?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(l=m.length;l--;)n.call(this,e,m[l]);else for(l in e)e.hasOwnProperty(l)&&(h=e[l])&&("function"==typeof h?n.call(this,l,h):f.call(this,l,h));return this};g.removeEvent=function(f){var e,m=typeof f,l=this._getEvents();
if("string"===m)delete l[f];else if(f instanceof RegExp)for(e in l)l.hasOwnProperty(e)&&f.test(e)&&delete l[e];else delete this._events;return this};g.removeAllListeners=b("removeEvent");g.emitEvent=function(f,e){var m,l,h,n=this.getListenersAsObject(f);for(h in n)if(n.hasOwnProperty(h)){var r=0;for(m=n[h].slice(0);r<m.length;r++)!0===(l=m[r]).once&&this.removeListener(f,l.listener),l.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(f,l.listener)}return this};g.trigger=
b("emitEvent");g.emit=function(f){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(f,e)};g.setOnceReturnValue=function(f){return this._onceReturnValue=f,this};g._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue};g._getEvents=function(){return this._events||(this._events={})};c.noConflict=function(){return a.EventEmitter=p,c};"function"==typeof define&&define.amd?define(function(){return c}):$b?$b=c:a.EventEmitter=c}("undefined"!=
typeof window?window:$b||{});class vh extends ma($b){close(){this.layer=this.buffer=null;this.emitEvent("changeLayer")}setLayer(a){this.layer=a;this.invalidRect=a.getBounds();this.emitEvent("changeLayer")}isOpen(){return null!=this.layer}invalidateRect(a){this.invalidRect.union(a)}getImageData(){this.prepareMask();if(!this.invalidRect.isEmpty()&&this.layer&&this.layer.mask){var a=this.buffer,c=this.layer.mask,d=this.invalidRect,b=d.top*c.width+d.left,g=b*H.BYTES_PER_PIXEL,p=d.getWidth();d=d.getHeight();
var f=c.width-p,e=f*H.BYTES_PER_PIXEL;for(let m=0;m<d;m++,b+=f,g+=e)for(let l=0;l<p;l++,b++,g+=H.BYTES_PER_PIXEL)a.data[g+H.RED_BYTE_OFFSET]=c.data[b],a.data[g+H.GREEN_BYTE_OFFSET]=c.data[b],a.data[g+H.BLUE_BYTE_OFFSET]=c.data[b],a.data[g+H.ALPHA_BYTE_OFFSET]=255;!0;this.invalidRect.makeEmpty()}return this.buffer}constructor(a,c){super();this.layer=a;this.buffer=a.mask.getImageData(0,0,a.mask.width,a.mask.height);this.invalidRect=new Ha(0,0,0,0);this.prepareMask=c}}class Bc{merge(a){return!1}noChange(){return!1}getMemoryUsed(a,
c){return 0}compact(){}}Ab.prototype.getRgb=function(){return this.rgb};Ab.prototype.getSaturation=function(){return this.saturation};Ab.prototype.getHue=function(){return this.hue};Ab.prototype.getValue=function(){return this.value};Ab.prototype.setRgbComponents=function(a,c,d){this.setRgb(a<<16|c<<8|d)};Ab.prototype.setRgb=function(a){this.rgb=a;var c=a>>16&255,d=a>>8&255;a&=255;this.value=Math.max(c,Math.max(d,a));var b=Math.min(c,Math.min(d,a));if(0==this.value?this.saturation=0:this.saturation=
~~((this.value-b)/this.value*255),0==this.saturation)this.hue=0;else{var g=(this.value-c)/(this.value-b),p=(this.value-d)/(this.value-b);b=(this.value-a)/(this.value-b);var f=0;this.value==c&&(f=b-p);this.value==d&&(f=2+g-b);this.value==a&&(f=4+p-g);0>(f*=60)&&(f+=360);this.hue=~~f}};Ab.prototype.setHsv=function(a,c,d){this.hue=a;this.saturation=c;this.value=d;this.rgb=De(this)};Ab.prototype.setHue=function(a){this.hue=a;this.rgb=De(this)};Ab.prototype.setSaturation=function(a){this.saturation=a;
this.rgb=De(this)};Ab.prototype.setValue=function(a){this.value=a;this.rgb=De(this)};Ab.prototype.setGreyscale=function(a){this.rgb=Ab.greyToRGB(a);this.saturation=this.hue=0;this.value=a};Ab.prototype.clone=function(){var a=new Ab(0);return a.copyFrom(this),a};Ab.prototype.copyFrom=function(a){this.rgb=a.rgb;this.hue=a.hue;this.saturation=a.saturation;this.value=a.value};Ab.prototype.isEqual=function(a){return this.rgb==a.rgb&&this.hue==a.hue&&this.saturation==a.saturation&&this.value==a.value};
Ab.greyToRGB=function(a){return a|a<<8|a<<16};Jb.prototype.setToIdentity=function(){this.m=[1,0,0,1,0,0]};Jb.prototype.multiply=function(a){var c=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],b=this.m[1]*a.m[2]+this.m[3]*a.m[3],g=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],p=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=this.m[0]*a.m[0]+this.m[2]*a.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=g;this.m[5]=p};Jb.prototype.preMultiply=function(a){var c=a.m[1]*this.m[0]+
a.m[3]*this.m[1],d=a.m[0]*this.m[2]+a.m[2]*this.m[3],b=a.m[1]*this.m[2]+a.m[3]*this.m[3],g=a.m[0]*this.m[4]+a.m[2]*this.m[5]+a.m[4],p=a.m[1]*this.m[4]+a.m[3]*this.m[5]+a.m[5];this.m[0]=a.m[0]*this.m[0]+a.m[2]*this.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=g;this.m[5]=p};Jb.prototype.invert=function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),c=-this.m[1]*a,d=-this.m[2]*a,b=this.m[0]*a,g=a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),p=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=
this.m[3]*a;this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=g;this.m[5]=p};Jb.prototype.getInverted=function(){var a=new Jb;return a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=this.m[4],a.m[5]=this.m[5],a.invert(),a};Jb.prototype.rotate=function(a){var c=Math.cos(a);a=Math.sin(a);var d=this.m[1]*c+this.m[3]*a,b=-(this.m[0]*a)+this.m[2]*c,g=-(this.m[1]*a)+this.m[3]*c;this.m[0]=this.m[0]*c+this.m[2]*a;this.m[1]=d;this.m[2]=b;this.m[3]=g};Jb.prototype.rotateAroundPoint=function(a,
c,d){this.translate(c,d);this.rotate(a);this.translate(-c,-d)};Jb.prototype.translate=function(a,c){this.m[4]+=this.m[0]*a+this.m[2]*c;this.m[5]+=this.m[1]*a+this.m[3]*c};Jb.prototype.scale=function(a,c){this.m[0]*=a;this.m[1]*=a;this.m[2]*=c;this.m[3]*=c};Jb.prototype.scaleAroundPoint=function(a,c,d,b){this.translate(d,b);this.scale(a,c);this.translate(-d,-b)};Jb.prototype.shear=function(a,c){var d=this.m[1]+this.m[3]*c,b=this.m[2]+this.m[0]*a;a=this.m[3]+this.m[1]*a;this.m[0]+=this.m[2]*c;this.m[1]=
d;this.m[2]=b;this.m[3]=a};Jb.prototype.getTransformedPoint=function(a){return{x:a.x*this.m[0]+a.y*this.m[2]+this.m[4],y:a.x*this.m[1]+a.y*this.m[3]+this.m[5]}};Jb.prototype.transformPoints=function(a){for(var c=0;c<a.length;c++)a[c]=this.getTransformedPoint(a[c])};Jb.prototype.getTranslateX=function(){return this.m[4]};Jb.prototype.getTranslateY=function(){return this.m[5]};Jb.prototype.clone=function(){var a=new Jb;return a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=
this.m[4],a.m[5]=this.m[5],a};Jb.prototype.getDeterminant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]};Jb.prototype.decompose=function(){var a=this.getDeterminant(),c=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return{translate:{x:this.m[4],y:this.m[5]},rotate:Math.sign(this.m[1])*Math.acos(this.m[0]/c),scale:{x:c,y:a/c},shear:{x:Math.atan((this.m[0]*this.m[2]+this.m[1]*this.m[3])/(c*c)),y:0}}};Jb.prototype.toString=function(){return"["+this.m[0].toFixed(2)+" "+this.m[2].toFixed(2)+
" "+this.m[4].toFixed(2)+"]\n["+this.m[1].toFixed(2)+" "+this.m[3].toFixed(2)+" "+this.m[5].toFixed(2)+"]\n[0.00 0.00 1.00]"};Math.sign=Math.sign||function(a){return 0==(a*=1)||isNaN(a)?a:0<a?1:-1};cd.prototype.toInt=function(){return Math.max(0,Math.min(255,Math.round(255*this.r)))<<16|Math.max(0,Math.min(255,Math.round(255*this.g)))<<8|Math.max(0,Math.min(255,Math.round(255*this.b)))};cd.prototype.mixWith=function(a,c){this.r=this.r*(1-c)+a.r*c;this.g=this.g*(1-c)+a.g*c;this.b=this.b*(1-c)+a.b*
c};cd.prototype.clone=function(){return new cd(this.r,this.g,this.b)};cd.createFromInt=function(a){return new cd((a>>>16&255)/255,(a>>>8&255)/255,(255&a)/255)};class Qd{paintDab(a,c,d,b,g,p,f){a=Math.max(1,Math.ceil(p.alpha*b.alphaScale));switch(b.paintMode){case Ca.PAINT_MODE_FLOW:this._paintFlow(g,c,p.brush,p.width,a);break;case Ca.PAINT_MODE_OPACITY:this._paintOpacity(g,c,p.brush,p.width,a)}}mergeOntoImage(a,c,d){let b=this._strokeBuffer.data;var g=this._strokedRegion;c=c.data;let p=a.data,f=d>>
16&255,e=d>>8&255;d&=255;let m=0|g.getWidth(),l=0|g.getHeight(),h=this._strokeBuffer.offsetOfPixel(g.left,g.top);g=a.offsetOfPixel(g.left,g.top);let n=this._strokeBuffer.width-m|0;a=(a.width-m)*H.BYTES_PER_PIXEL|0;for(let t=0;t<l;t++,h+=n,g+=a)for(let v=0;v<m;v++,h++,g+=H.BYTES_PER_PIXEL){var r=b[h]/255+.5|0;if(0<r){let x=r+c[g+H.ALPHA_BYTE_OFFSET]*(255-r)/255|0;r=255*r/x|0;let D=255-r;p[g]=(f*r+c[g]*D)/255&255;p[g+1]=(e*r+c[g+1]*D)/255&255;p[g+2]=(d*r+c[g+2]*D)/255&255;p[g+3]=x}}}mergeOntoMask(a,
c,d){let b=this._strokeBuffer.data;var g=this._strokedRegion;c=c.data;let p=a.data,f=0|g.getWidth(),e=0|g.getHeight(),m=a.offsetOfPixel(g.left,g.top);g=this._strokeBuffer.offsetOfPixel(g.left,g.top);let l=this._strokeBuffer.width-f|0;a=a.width-f|0;for(let h=0;h<e;h++,g+=l,m+=a)for(let n=0;n<f;n++,g++,m++){let r=b[g]/255|0;0<r&&(p[m]=(d*r+c[m]*(255-r))/255)}}_paintFlow(a,c,d,b,g){let p=this._strokeBuffer.data;a=a.left+a.top*b;let f=this._strokeBuffer.offsetOfPixel(c.left,c.top),e=c.getHeight(),m=c.getWidth();
b-=m;let l=this._strokeBuffer.width-m;this._strokedRegion.union(c);for(c=0;c<e;c++,a+=b,f+=l)for(let h=0;h<m;h++,a++,f++){let n=d[a]*g;0!=n&&(p[f]=Math.min(65025,p[f]+(255-p[f]/255)*n/255))}}_paintOpacity(a,c,d,b,g){let p=this._strokeBuffer.data;a=a.left+a.top*b;let f=this._strokeBuffer.offsetOfPixel(c.left,c.top),e=c.getWidth();b-=e;let m=this._strokeBuffer.width-e;g=Math.min(255,g);this._strokedRegion.union(c);for(let l=c.top;l<c.bottom;l++,a+=b,f+=m)for(let h=0;h<e;h++,a++,f++)p[f]=Math.max(d[a]*
g,p[f])}beginStroke(){}endStroke(){}constructor(a,c){this._strokeBuffer=a;this._strokedRegion=c;this.wantsOutputAsInput=!0}}class wh extends Qd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion;c=c.data;let g=a.data;for(let p=b.top;p<b.bottom;p++){let f=a.offsetOfPixel(b.left,p)+H.ALPHA_BYTE_OFFSET,e=this._strokeBuffer.offsetOfPixel(b.left,p);for(let m=b.left;m<b.right;m++,f+=H.BYTES_PER_PIXEL){let l=d[e++]/255|0;0<l&&(g[f]=c[f]*(255-l)/255)}}}}class xh extends Qd{mergeOntoImage(a,
c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let g=b.getWidth(),p=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=(a.width-g)*H.BYTES_PER_PIXEL,m=this._strokeBuffer.width-g;c=c.data;a=a.data;for(let h=0;h<p;h++,b+=m,f+=e)for(let n=0;n<g;n++,b++,f+=H.BYTES_PER_PIXEL){var l=d[b]/255|0;0<l&&0!=c[f+H.ALPHA_BYTE_OFFSET]&&(l=(l+255)/255,a[f+H.RED_BYTE_OFFSET]=c[f+H.RED_BYTE_OFFSET]*l,a[f+H.GREEN_BYTE_OFFSET]=c[f+H.GREEN_BYTE_OFFSET]*l,a[f+
H.BLUE_BYTE_OFFSET]=c[f+H.BLUE_BYTE_OFFSET]*l)}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let g=b.getWidth(),p=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=a.width-g,m=this._strokeBuffer.width-g;c=c.data;a=a.data;for(let l=0;l<p;l++,b+=m,f+=e)for(let h=0;h<g;h++,b++,f++){let n=d[b]/255|0;0<n&&(a[f]=Math.min((n+255)/255*c[f],255))}}}class yh extends Qd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;
let g=b.getWidth(),p=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=(a.width-g)*H.BYTES_PER_PIXEL,m=this._strokeBuffer.width-g;c=c.data;a=a.data;for(let l=0;l<p;l++,b+=m,f+=e)for(let h=0;h<g;h++,b++,f+=H.BYTES_PER_PIXEL){let n=d[b]/255|0;0<n&&0!=c[f+H.ALPHA_BYTE_OFFSET]&&(a[f+H.RED_BYTE_OFFSET]=c[f+H.RED_BYTE_OFFSET]-(260-c[f+H.RED_BYTE_OFFSET])*n/255|0,a[f+H.GREEN_BYTE_OFFSET]=c[f+H.GREEN_BYTE_OFFSET]-(260-c[f+H.GREEN_BYTE_OFFSET])*n/255|0,a[f+
H.BLUE_BYTE_OFFSET]=c[f+H.BLUE_BYTE_OFFSET]-(260-c[f+H.BLUE_BYTE_OFFSET])*n/255|0)}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let g=b.getWidth(),p=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=a.width-g,m=this._strokeBuffer.width-g;c=c.data;a=a.data;for(let l=0;l<p;l++,b+=m,f+=e)for(let h=0;h<g;h++,b++,f++){let n=d[b]/255|0;0<n&&(a[f]=Math.max(c[f]-(260-c[f])*n/255,0))}}}class zh extends Qd{mergeOntoImage(a,c,d){d=
this._strokeBuffer.data;let b=this._strokedRegion,g=c.data;a=a.data;var p=b.getWidth();let f=c.width*H.BYTES_PER_PIXEL,e=c.offsetOfPixel(b.left,b.top),m=this._strokeBuffer.offsetOfPixel(b.left,b.top),l=(c.width-p)*H.BYTES_PER_PIXEL;p=this._strokeBuffer.width-p;let h,n,r,t,v=function(D){h+=g[D+H.RED_BYTE_OFFSET];n+=g[D+H.GREEN_BYTE_OFFSET];r+=g[D+H.BLUE_BYTE_OFFSET];t+=g[D+H.ALPHA_BYTE_OFFSET]};for(let D=b.top;D<b.bottom;D++,e+=l,m+=p)for(let G=b.left;G<b.right;G++,e+=H.BYTES_PER_PIXEL,m++){var x=
d[m]/255|0;if(0<x){x=64+-63*x/255|0;let N=x+4;h=x*g[e+H.RED_BYTE_OFFSET];n=x*g[e+H.GREEN_BYTE_OFFSET];r=x*g[e+H.BLUE_BYTE_OFFSET];t=x*g[e+H.ALPHA_BYTE_OFFSET];v(0<D?e-f:e);v(D<c.height-1?e+f:e);v(0<G?e-H.BYTES_PER_PIXEL:e);v(G<c.width-1?e+H.BYTES_PER_PIXEL:e);t/=N;h/=N;n/=N;r/=N;a[e+H.RED_BYTE_OFFSET]=0|h;a[e+H.GREEN_BYTE_OFFSET]=0|n;a[e+H.BLUE_BYTE_OFFSET]=0|r;a[e+H.ALPHA_BYTE_OFFSET]=0|t}}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion,g=c.data;a=a.data;var p=b.getWidth();
let f=c.width,e=c.offsetOfPixel(b.left,b.top),m=this._strokeBuffer.offsetOfPixel(b.left,b.top),l=c.width-p;p=this._strokeBuffer.width-p;for(let r=b.top;r<b.bottom;r++,e+=l,m+=p)for(let t=b.left;t<b.right;t++,e++,m++){var h=d[m]/255|0;if(0<h){var n=64+-63*h/255|0;h=n+4;n=n*g[e]+g[0<r?e-f:e]+g[r<c.height-1?e+f:e]+g[0<t?e-1:e]+g[t<c.width-1?e+1:e];a[e]=n/h|0}}}}class Of extends Qd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;c=c.data;let g=a.data,p=this._strokeBuffer.offsetOfPixel(b.left,
b.top),f=a.offsetOfPixel(b.left,b.top),e=0|b.getWidth();b=0|b.getHeight();let m=this._strokeBuffer.width-e|0;a=(a.width-e)*H.BYTES_PER_PIXEL|0;for(let n=0;n<b;n++,p+=m,f+=a)for(let r=0;r<e;r++,p++,f+=H.BYTES_PER_PIXEL){let t=d[p];var l=t>>>24;if(0<l){var h=c[f+H.ALPHA_BYTE_OFFSET];h=l+h-l*h/255|0;l=255*l/h|0;let v=255-l;g[f]=((t>>16&255)*l+c[f]*v)/255|0;g[f+1]=((t>>8&255)*l+c[f+1]*v)/255|0;g[f+2]=((255&t)*l+c[f+2]*v)/255|0;g[f+3]=h}}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;
c=c.data;let g=a.data,p=this._strokeBuffer.offsetOfPixel(b.left,b.top),f=a.offsetOfPixel(b.left,b.top),e=0|b.getWidth();b=0|b.getHeight();let m=this._strokeBuffer.width-e|0;a=a.width-e|0;for(let l=0;l<b;l++,p+=m,f+=a)for(let h=0;h<e;h++,p++,f++){let n=d[p],r=n>>8;0<r&&(g[f]=((255&n)*r+c[f]*(255-r))/255|0)}}}let Yg=2/6;class he extends Of{static _sampleGrey(a,c,d,b,g){c|=0;d|=0;let p=[{x:c,y:d}];for(let f=.25;1.001>f;f+=.25)Array.prototype.push.apply(p,[{x:~~(c+f*b),y:d},{x:~~(c-f*b),y:d},{x:c,y:~~(d+
f*g)},{x:c,y:~~(d-f*g)},{x:~~(c+.7*f*b),y:~~(d+.7*f*g)},{x:~~(c+.7*f*b),y:~~(d-.7*f*g)},{x:~~(c-.7*f*b),y:~~(d+.7*f*g)},{x:~~(c-.7*f*b),y:~~(d-.7*f*g)}]);return lg(p.map(f=>a.getPixel(f.x,f.y)))}static _sampleRGB(a,c,d,b,g){c|=0;d|=0;let p=[{x:c,y:d}];for(let f=.25;1.001>f;f+=.25)Array.prototype.push.apply(p,[{x:~~(c+f*b),y:d},{x:~~(c-f*b),y:d},{x:c,y:~~(d+f*g)},{x:c,y:~~(d-f*g)},{x:~~(c+.7*f*b),y:~~(d+.7*f*g)},{x:~~(c+.7*f*b),y:~~(d-.7*f*g)},{x:~~(c-.7*f*b),y:~~(d+.7*f*g)},{x:~~(c-.7*f*b),y:~~(d-
.7*f*g)}]);return mg(p.map(f=>cd.createFromInt(a.getPixel(f.x,f.y))))}_paintToColorStrokeBuffer(a,c,d,b,g,p){let f=this._strokeBuffer.data,e=c.getWidth(),m=c.getHeight(),l=this._strokeBuffer.width-e,h=b-e;a=a.left+a.top*b;b=this._strokeBuffer.offsetOfPixel(c.left,c.top);this._strokedRegion.union(c);for(c=0;c<m;c++,a+=h,b+=l)for(let t=0;t<e;t++,a++,b++){var n=d[a]*g/255|0;if(0<n){let v=f[b];var r=v>>>24;r=n+r-n*r/255|0;n=255-(255*n/r|0);f[b]=r<<24|(p>>16&255)+((v>>16&255)*n-(p>>16&255)*n)/255<<16|
(p>>8&255)+((v>>8&255)*n-(p>>8&255)*n)/255<<8|(255&p)+((255&v)*n-(255&p)*n)/255}}}_paintToGreyscaleStrokeBuffer(a,c,d,b,g,p){let f=this._strokeBuffer.data;this._strokedRegion.union(c);for(let l=c.top,h=a.top;l<c.bottom;l++,h++){let n=a.left+h*b,r=this._strokeBuffer.offsetOfPixel(c.left,l);for(let t=c.left;t<c.right;t++,n++,r++){var e=d[n]*g/255|0;if(0>=e)continue;let v=f[r];var m=v>>8;m=e+m-e*m/255|0;0<m&&(e=255-(255*e/m|0),f[r]=m<<8|p+((255&v)*e-p*e)/255)}}}beginStroke(){this._previousSamples=null}paintDab(a,
c,d,b,g,p,f){var e,m;a=Math.max(1,p.alpha/4);var l=(c.left+c.right)/2,h=(c.top+c.bottom)/2,n=Math.max(1,Math.min(64,c.getWidth()*Yg)),r=Math.max(1,Math.min(64,c.getHeight()*Yg));if(d instanceof Xa){null==this._previousSamples&&(this._previousSamples=Array(50),this._previousSamples.fill(he._sampleGrey(d,l,h,n,r)));let v=lg(this._previousSamples);var t=v;f=t=v=t*(1-(e=b.resat*b.resat))+(255&f)*e;d=he._sampleGrey(d,l,h,n,r);v=f*(1-(m=b.bleed))+d*m;this._previousSamples.push(v);this._previousSamples.shift();
this._paintToGreyscaleStrokeBuffer(g,c,p.brush,p.width,a,Math.round(t))}else null==this._previousSamples&&(this._previousSamples=Array(50),this._previousSamples.fill(he._sampleRGB(d,l,h,n,r))),m=mg(this._previousSamples),m.mixWith(cd.createFromInt(f),b.resat*b.resat),f=m.toInt(),m.mixWith(he._sampleRGB(d,l,h,n,r),b.bleed),this._previousSamples.push(m),this._previousSamples.shift(),this._paintToColorStrokeBuffer(g,c,p.brush,p.width,a,f)}constructor(a,c){super(a,c);this.wantsOutputAsInput=!0}}class Bh extends Of{_accumulatePaintFromMask(a,
c,d,b){let g=this._brushBuffer.data,p=a.data,f=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=a.offsetOfPixel(d.left,d.top);let m=this._brushBuffer.width-f;a=a.width-f;if(!(0>=b))for(let h=0;h<e;h++,c+=m,d+=a)for(let n=0;n<f;n++,c++,d++){let r=p[d],t=g[c];var l=t>>8;l=b+l-b*l/255|0;let v=255-(255*b/l|0);g[c]=l<<8|r+((255&t)*v-r*v)/255}}_resaturateBrushWithGrey(a,c,d){if(!(0>=c)){var b=this._brushBuffer.data,g=a.getWidth(),p=a.getHeight();a=a.left+a.top*this._brushBuffer.width;
var f=this._brushBuffer.width-g;for(let m=0;m<p;m++,a+=f)for(let l=0;l<g;l++,a++){let h=b[a];var e=h>>8;e=c+e-c*e/255|0;let n=255-(255*c/e|0);b[a]=e<<8|d+((255&h)*n-d*n)/255}}}_paintToGreyscaleStrokeBuffer(a,c,d,b,g){let p=this._strokeBuffer.data,f=this._brushBuffer.data,e=a.data;this._strokedRegion.union(d);for(let l=d.top,h=c.top;l<d.bottom;l++,h++){let n=this._brushBuffer.offsetOfPixel(c.left,h),r=this._strokeBuffer.offsetOfPixel(d.left,l),t=a.offsetOfPixel(d.left,l);for(let v=d.left;v<d.right;v++,
n++,t++,r++){let x=f[n];var m=(x>>8)*b[n]*g/65025|0;0<m&&(m=255-m,p[r]=65280|(255&x)+(e[t]*m-(255&x)*m)/255)}}}_accumulatePaintFromImage(a,c,d,b){let g=this._brushBuffer.data,p=a.data,f=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=a.offsetOfPixel(d.left,d.top);let m=this._brushBuffer.width-f;a=(a.width-f)*H.BYTES_PER_PIXEL;for(let n=0;n<e;n++,c+=m,d+=a)for(let r=0;r<f;r++,c++,d+=H.BYTES_PER_PIXEL){var l=p[d+H.ALPHA_BYTE_OFFSET]*b/255|0;if(0<l){let t=g[c];var h=t>>>24;h=l+
h-l*h/255|0;l=255-(255*l/h|0);let v=p[d+H.RED_BYTE_OFFSET],x=p[d+H.GREEN_BYTE_OFFSET],D=p[d+H.BLUE_BYTE_OFFSET];g[c]=h<<24|v+((t>>16&255)*l-v*l)/255<<16|x+((t>>8&255)*l-x*l)/255<<8|D+((255&t)*l-D*l)/255}}}_resaturateBrushWithColor(a,c,d){if(!(0>=c)){var b=this._brushBuffer.data,g=a.getWidth(),p=a.getHeight();a=a.left+a.top*this._brushBuffer.width;var f=this._brushBuffer.width-g;for(let m=0;m<p;m++,a+=f)for(let l=0;l<g;l++,a++){let h=b[a];var e=h>>>24;e=c+e-c*e/255|0;let n=255-(255*c/e|0);b[a]=e<<
24|(d>>>16&255)+((h>>>16&255)*n-(d>>>16&255)*n)/255<<16|(d>>>8&255)+((h>>>8&255)*n-(d>>>8&255)*n)/255<<8|(255&d)+((255&h)*n-(255&d)*n)/255}}}_paintToColorStrokeBuffer(a,c,d,b,g){let p=this._strokeBuffer.data,f=this._brushBuffer.data,e=a.data;this._strokedRegion.union(d);for(let h=d.top,n=c.top;h<d.bottom;h++,n++){let r=this._brushBuffer.offsetOfPixel(c.left,n),t=this._strokeBuffer.offsetOfPixel(d.left,h),v=a.offsetOfPixel(d.left,h);for(let x=d.left;x<d.right;x++,r++,v+=H.BYTES_PER_PIXEL,t++){let D=
f[r];var m=(D>>>24)*b[r]*g/65025|0;if(0<m){var l=e[v+H.ALPHA_BYTE_OFFSET];l=m+l-m*l/255|0;m=255-(255*m/l|0);p[t]=l<<24|(D>>16&255)+(e[v+H.RED_BYTE_OFFSET]*m-(D>>16&255)*m)/255<<16|(D>>8&255)+(e[v+H.GREEN_BYTE_OFFSET]*m-(D>>8&255)*m)/255<<8|(255&D)+(e[v+H.BLUE_BYTE_OFFSET]*m-(255&D)*m)/255}}}}paintDab(a,c,d,b,g,p,f){a instanceof H?null==this._brushBuffer?(this._brushBuffer=new Xa(p.width,p.height,32),this._accumulatePaintFromImage(d,g,c,255)):(this._resaturateBrushWithColor(g,~~(0>=b.resat?0:Math.max(1,
b.resat*b.resat*255)),16777215&f),this._paintToColorStrokeBuffer(a,g,c,p.brush,p.alpha),this._accumulatePaintFromImage(d,g,c,~~(255*b.bleed))):null==this._brushBuffer?(this._brushBuffer=new Xa(p.width,p.height,16),this._accumulatePaintFromMask(d,g,c,255)):(this._resaturateBrushWithGrey(g,~~(0>=b.resat?0:Math.max(1,b.resat*b.resat*255)),255&f),this._paintToGreyscaleStrokeBuffer(a,g,c,p.brush,p.alpha),this._accumulatePaintFromMask(d,g,c,~~(255*b.bleed)))}endStroke(){this._brushBuffer=null}constructor(a,
c){super(a,c);this.wantsOutputAsInput=!0}}class Ah extends Of{_sampleFromMask(a,c,d,b){let g=this._brushBuffer.data,p=c.getWidth(),f=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let m=this._brushBuffer.width-p,l=a.width-p,h=255-b;if(255!=b){for(let n=0;n<f;n++,e+=m,d+=l)for(let r=0;r<p;r++,e++,d++){let t=a.data[d],v=g[e],x=(t*h+(255&v)*b)/255,D=(255*h+(v>>8)*b)/255<<8|x;D==v&&(t>x?D++:t<x&&D--);g[e]=D}ng(this._brushBuffer,c)}}_paintToMask(a,c,d,b){let g=
c.getWidth(),p=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let f=this._brushBuffer.width-g,e=a.width-g;a=a.data;let m=this._brushBuffer.data;for(let l=0;l<p;l++,d+=e,c+=f)for(let h=0;h<g;h++,c++,d++){let n=m[c],r=255&n;0<((n>>8)*b[c]/255|0)&&(a[d]=r)}}_sampleFromImage(a,c,d,b){let g=this._brushBuffer.data,p=c.getWidth(),f=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let m=this._brushBuffer.width-p,l=
(a.width-p)*H.BYTES_PER_PIXEL,h=255-b;if(255!=b){for(let r=0;r<f;r++,e+=m,d+=l)for(let t=0;t<p;t++,e++,d+=H.BYTES_PER_PIXEL){let v=a.data[d+H.RED_BYTE_OFFSET],x=a.data[d+H.GREEN_BYTE_OFFSET],D=a.data[d+H.BLUE_BYTE_OFFSET];var n=g[e];let G=(a.data[d+H.ALPHA_BYTE_OFFSET]*h+(n>>24&255)*b)/255<<24&4278190080|(v*h+(n>>16&255)*b)/255<<16&16711680|(x*h+(n>>8&255)*b)/255<<8&65280|(D*h+(255&n)*b)/255&255;if(G==n){n=(16711680&G)>>16;let N=(65280&G)>>8,K=255&G;v>n?G+=65536:v<n&&(G-=65536);x>N?G+=256:x<N&&(G-=
256);D>K?G+=1:D<K&&--G}g[e]=G}ng(this._brushBuffer,c)}}_paintToImage(a,c,d,b){let g=c.getWidth(),p=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let f=this._brushBuffer.width-g,e=(a.width-g)*H.BYTES_PER_PIXEL;a=a.data;let m=this._brushBuffer.data;for(let l=0;l<p;l++,d+=e,c+=f)for(let h=0;h<g;h++,c++,d+=H.BYTES_PER_PIXEL){let n=m[c];0<((n>>>24)*b[c]/255|0)&&(a[d+H.RED_BYTE_OFFSET]=n>>16&255,a[d+H.GREEN_BYTE_OFFSET]=n>>8&255,a[d+H.BLUE_BYTE_OFFSET]=255&
n,a[d+H.ALPHA_BYTE_OFFSET]=n>>24&255)}}paintDab(a,c,d,b,g,p,f){a instanceof H?null==this._brushBuffer?(this._brushBuffer=new Xa(p.width,p.height,32),this._sampleFromImage(d,g,c,0)):(this._sampleFromImage(d,g,c,p.alpha),this._paintToImage(a,g,c,p.brush)):null==this._brushBuffer?(this._brushBuffer=new Xa(p.width,p.height,16),this._sampleFromMask(d,g,c,0)):(this._sampleFromMask(d,g,c,p.alpha),this._paintToMask(a,g,c,p.brush))}mergeOntoImage(a,c,d){}mergeOntoMask(a,c,d){}beginStroke(){this._brushBuffer=
null}endStroke(){this._brushBuffer=null}constructor(a,c){super(a,c);this._brushBuffer=null;this.noMergePhase=this.wantsOutputAsInput=!0}}"use strict";"use strict";Ec.prototype=Object.create(ma($b).prototype);Ec.prototype.constructor=Ec;Ec.prototype.getBounds=function(){return new Ha(0,0,this.width,this.height)};Ec.prototype.isPointWithin=function(a,c){return 0<=a&&0<=c&&a<this.width&&c<this.height};Ec.EDITING_MODE_IMAGE=0;Ec.EDITING_MODE_MASK=1;ub.prototype.readChar=function(){return this.pos<this.end?
String.fromCharCode(this.data[this.pos++]):(this.eof=!0,-1)};ub.prototype.readByte=function(){return this.pos<this.end?this.data[this.pos++]:(this.eof=!0,-1)};ub.prototype.readU8=ub.prototype.readByte;ub.prototype.readS8=function(){var a;return 128&(a=this.readByte())?4294967040|a:a};ub.prototype.unreadChar=function(a){this.pos--};ub.prototype.peekChar=function(){return this.pos<this.end?String.fromCharCode(this.data[this.pos]):(this.eof=!0,-1)};ub.prototype.readString=function(a){var c,d=Array(a);
for(c=0;c<a;c++)d[c]=this.readChar();return d.join("")};ub.prototype.readS16=function(){var a;return 32768&(a=this.readByte()<<8|this.readByte())?4294901760|a:a};ub.prototype.readU16BE=function(){return this.readByte()<<8|this.readByte()};ub.prototype.readU16LE=function(){var a=this.readByte();return this.readByte()<<8|a};ub.prototype.readU32BE=function(){return(this.readByte()<<24|this.readByte()<<16|this.readByte()<<8|this.readByte())>>>0};ub.prototype.readU32LE=function(){var a=this.readByte(),
c=this.readByte(),d=this.readByte();return(this.readByte()<<24|d<<16|c<<8|a)>>>0};ub.prototype.readBytes=function(a){var c=this.data.subarray(this.pos,this.pos+a);return this.pos+=a,this.pos>this.end&&(this.eof=!0),c};ub.prototype.skip=function(a){this.pos+=a;this.pos>this.end&&(this.eof=!0)};ub.prototype.seek=function(a){this.pos=a};ub.prototype.writeBytes=function(a){for(var c=0;c<a.length;c++)this.data[this.pos++]=a[c]};ub.prototype.writeByte=function(a){this.data[this.pos++]=a};ub.prototype.writeU8=
ub.prototype.writeByte;ub.prototype.writeU16LE=function(a){this.data[this.pos++]=a;this.data[this.pos++]=a>>8};ub.prototype.writeU16BE=function(a){this.data[this.pos++]=a>>8;this.data[this.pos++]=a};ub.prototype.writeU32BE=function(a){this.data[this.pos++]=a>>24;this.data[this.pos++]=a>>16;this.data[this.pos++]=a>>8;this.data[this.pos++]=a};ub.prototype.writeU32LE=function(a){this.data[this.pos++]=a;this.data[this.pos++]=a>>8;this.data[this.pos++]=a>>16;this.data[this.pos++]=a>>24};ub.prototype.writeDoubleBE=
function(a){a=new Uint8Array((new Float64Array([a])).buffer);for(var c=a.length-1;0<=c;c--)this.writeByte(a[c])};ub.prototype.writeFloatBE=function(a){a=new Uint8Array((new Float32Array([a])).buffer);for(var c=a.length-1;0<=c;c--)this.writeByte(a[c])};ub.prototype.writeString=function(a){for(var c=0;c<a.length;c++)this.data[this.pos++]=a.charCodeAt(c)};ub.prototype.writeUnsignedIntBE=function(a,c){switch(void 0===c&&(c=this.measureUnsignedInt(a)),c){case 5:this.writeU8(Math.floor(a/4294967296));case 4:this.writeU8(a>>
24);case 3:this.writeU8(a>>16);case 2:this.writeU8(a>>8);case 1:this.writeU8(a);break;default:throw"Bad UINT size "+c;}};ub.prototype.measureUnsignedInt=function(a){return 256>a?1:65536>a?2:16777216>a?3:4294967296>a?4:5};ub.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw"ArrayDataStream's pos lies beyond end of buffer";};ub.prototype.EOF=-1;var Gf={},Ya={},Zh="undefined"!=typeof Uint8Array&&
"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;Ya.assign=function(a){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var d=c.shift();if(d){if("object"!=typeof d)throw TypeError(d+"must be non-object");for(var b in d)Object.prototype.hasOwnProperty.call(d,b)&&(a[b]=d[b])}}return a};Ya.shrinkBuf=function(a,c){return a.length===c?a:a.subarray?a.subarray(0,c):(a.length=c,a)};"use strict";"use strict";"use strict";var $h={arraySet:function(a,c,d,b,g){if(c.subarray&&a.subarray)a.set(c.subarray(d,
d+b),g);else for(var p=0;p<b;p++)a[g+p]=c[d+p]},flattenChunks:function(a){var c,d;var b=c=0;for(d=a.length;c<d;c++)b+=a[c].length;c=0;var g=new Uint8Array(b);b=0;for(d=a.length;c<d;c++){var p=a[c];g.set(p,b);b+=p.length}return g}},ai={arraySet:function(a,c,d,b,g){for(var p=0;p<b;p++)a[g+p]=c[d+p]},flattenChunks:function(a){return[].concat.apply([],a)}};Ya.setTyped=function(a){a?(Ya.Buf8=Uint8Array,Ya.Buf16=Uint16Array,Ya.Buf32=Int32Array,Ya.assign(Ya,$h)):(Ya.Buf8=Array,Ya.Buf16=Array,Ya.Buf32=Array,
Ya.assign(Ya,ai))};Ya.setTyped(Zh);var bi=Ya.assign,re={};od(re,"Deflate",function(){return Zg},function(a){return Zg=a});od(re,"deflate",function(){return $g},function(a){return $g=a});od(re,"deflateRaw",function(){return ah},function(a){return ah=a});od(re,"gzip",function(){return bh},function(a){return bh=a});var wf=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Fe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ci=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ch=[16,
17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fd=Array(576);Rd(fd);var se=Array(60);Rd(se);var ie=Array(512);Rd(ie);var ke=Array(256);Rd(ke);var xf=Array(29);Rd(xf);var Ge=Array(30);Rd(Ge);var dh=!1;"use strict";var Eh=function(a){if(!dh){var c,d,b=Array(16);for(c=d=0;28>d;d++){var g=0;for(xf[d]=c;g<1<<wf[d];g++)ke[c++]=d}ke[c-1]=d;for(d=c=0;16>d;d++)for(g=0,Ge[d]=c;g<1<<Fe[d];g++)ie[c++]=d;for(c>>=7;30>d;d++)for(g=0,Ge[d]=c<<7;g<1<<Fe[d]-7;g++)ie[256+c++]=d;for(g=0;15>=g;g++)b[g]=0;for(g=0;143>=g;)fd[2*
g+1]=8,g++,b[8]++;for(;255>=g;)fd[2*g+1]=9,g++,b[9]++;for(;279>=g;)fd[2*g+1]=7,g++,b[7]++;for(;287>=g;)fd[2*g+1]=8,g++,b[8]++;rg(fd,287,b);for(g=0;30>g;g++)se[2*g+1]=5,se[2*g]=qg(g,5);Vg=new tf(fd,wf,257,286,15);Wg=new tf(se,Fe,0,30,15);Xg=new tf([],ci,0,19,7);!0;dh=!0}a.l_desc=new uf(a.dyn_ltree,Vg);a.d_desc=new uf(a.dyn_dtree,Wg);a.bl_desc=new uf(a.bl_tree,Xg);a.bi_buf=0;a.bi_valid=0;sg(a)};var Ch=function(a,c,d,b){var g,p,f=0;0<a.level?(2===a.strm.data_type&&(a.strm.data_type=function(e){var m,
l=4093624447;for(m=0;31>=m;m++,l>>>=1)if(1&l&&0!==e.dyn_ltree[2*m])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(m=32;256>m;m++)if(0!==e.dyn_ltree[2*m])return 1;return 0}(a)),yf(a,a.l_desc),yf(a,a.d_desc),f=function(e){var m;wg(e,e.dyn_ltree,e.l_desc.max_code);wg(e,e.dyn_dtree,e.d_desc.max_code);yf(e,e.bl_desc);for(m=18;3<=m&&0===e.bl_tree[2*ch[m]+1];m--);return e.opt_len+=3*(m+1)+14,m}(a),g=a.opt_len+3+7>>>3,(p=a.static_len+3+7>>>3)<=g&&(g=p)):g=p=d+5;d+4<=
g&&-1!==c?yg(a,c,d,b):4===a.strategy||p===g?(Gc(a,2+ +!!b,3),vg(a,fd,se)):(Gc(a,4+ +!!b,3),function(e,m,l,h){var n;Gc(e,m-257,5);Gc(e,l-1,5);Gc(e,h-4,4);for(n=0;n<h;n++)Gc(e,e.bl_tree[2*ch[n]+1],3);xg(e,e.dyn_ltree,m-1);xg(e,e.dyn_dtree,l-1)}(a,a.l_desc.max_code+1,a.d_desc.max_code+1,f+1),vg(a,a.dyn_ltree,a.dyn_dtree));sg(a);b&&tg(a)};var sd=function(a,c,d){return a.pending_buf[a.d_buf+2*a.last_lit]=c>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&c,a.pending_buf[a.l_buf+a.last_lit]=255&d,a.last_lit++,
0===c?a.dyn_ltree[2*d]++:(a.matches++,c--,a.dyn_ltree[2*(ke[d]+256+1)]++,a.dyn_dtree[2*pg(c)]++),a.last_lit===a.lit_bufsize-1};var di=function(a){Gc(a,2,3);Zc(a,256,fd);16===a.bi_valid?(je(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):8<=a.bi_valid&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)};"use strict";var Sd={};Sd=function(a,c,d,b){var g=65535&a|0;a=a>>>16&65535|0;for(var p;0!==d;){p=2E3<d?2E3:d;d-=p;do a=a+(g=g+c[b++]|0)|0;while(--p);g%=65521;a%=65521}return g|a<<16|0};"use strict";
var fc={},ei=function(){for(var a,c=[],d=0;256>d;d++){a=d;for(var b=0;8>b;b++)a=1&a?3988292384^a>>>1:a>>>1;c[d]=a}return c}();fc=function(a,c,d,b){d=b+d;for(a^=-1;b<d;b++)a=a>>>8^ei[(a^c[b])&255];return-1^a};var Ed={};Ed={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};var me=[new $c(0,0,0,0,function(a,c){var d=65535;for(65535>a.pending_buf_size-5&&(d=a.pending_buf_size-5);;){if(1>=
a.lookahead){if(Fd(a),0===a.lookahead&&0===c)return 1;if(0===a.lookahead)break}a.strstart+=a.lookahead;a.lookahead=0;var b=a.block_start+d;if((0===a.strstart||a.strstart>=b)&&(a.lookahead=a.strstart-b,a.strstart=b,oc(a,!1),0===a.strm.avail_out)||a.strstart-a.block_start>=a.w_size-262&&(oc(a,!1),0===a.strm.avail_out))return 1}return(a.insert=0,4===c)?(oc(a,!0),0===a.strm.avail_out)?3:4:(a.strstart>a.block_start&&(oc(a,!1),a.strm.avail_out),1)}),new $c(4,4,8,4,zf),new $c(4,5,16,8,zf),new $c(4,6,32,
32,zf),new $c(4,4,16,16,Td),new $c(8,16,32,32,Td),new $c(8,16,128,128,Td),new $c(8,32,128,256,Td),new $c(32,128,258,1024,Td),new $c(32,258,258,4096,Td)];"use strict";var fi=function(a,c){if(!a||!a.state||5<c||0>c)return a?pd(a,-2):-2;if(b=a.state,!a.output||!a.input&&0!==a.avail_in||666===b.status&&4!==c)return pd(a,0===a.avail_out?-5:-2);if(b.strm=a,d=b.last_flush,b.last_flush=c,42===b.status)if(2===b.wrap)a.adler=0,Eb(b,31),Eb(b,139),Eb(b,8),b.gzhead?(Eb(b,+!!b.gzhead.text+2*!!b.gzhead.hcrc+4*!!b.gzhead.extra+
8*!!b.gzhead.name+16*!!b.gzhead.comment),Eb(b,255&b.gzhead.time),Eb(b,b.gzhead.time>>8&255),Eb(b,b.gzhead.time>>16&255),Eb(b,b.gzhead.time>>24&255),Eb(b,9===b.level?2:4*(2<=b.strategy||2>b.level)),Eb(b,255&b.gzhead.os),b.gzhead.extra&&b.gzhead.extra.length&&(Eb(b,255&b.gzhead.extra.length),Eb(b,b.gzhead.extra.length>>8&255)),b.gzhead.hcrc&&(a.adler=fc(a.adler,b.pending_buf,b.pending,0)),b.gzindex=0,b.status=69):(Eb(b,0),Eb(b,0),Eb(b,0),Eb(b,0),Eb(b,0),Eb(b,9===b.level?2:4*(2<=b.strategy||2>b.level)),
Eb(b,3),b.status=113);else{var d,b;var g=8+(b.w_bits-8<<4)<<8;g|=(2<=b.strategy||2>b.level?0:6>b.level?1:6===b.level?2:3)<<6;0!==b.strstart&&(g|=32);b.status=113;le(b,g+(31-g%31));0!==b.strstart&&(le(b,a.adler>>>16),le(b,65535&a.adler));a.adler=1}if(69===b.status)if(b.gzhead.extra){for(g=b.pending;b.gzindex<(65535&b.gzhead.extra.length)&&(b.pending!==b.pending_buf_size||(b.gzhead.hcrc&&b.pending>g&&(a.adler=fc(a.adler,b.pending_buf,b.pending-g,g)),rd(a),g=b.pending,b.pending!==b.pending_buf_size));)Eb(b,
255&b.gzhead.extra[b.gzindex]),b.gzindex++;b.gzhead.hcrc&&b.pending>g&&(a.adler=fc(a.adler,b.pending_buf,b.pending-g,g));b.gzindex===b.gzhead.extra.length&&(b.gzindex=0,b.status=73)}else b.status=73;if(73===b.status)if(b.gzhead.name){g=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>g&&(a.adler=fc(a.adler,b.pending_buf,b.pending-g,g)),rd(a),g=b.pending,b.pending===b.pending_buf_size)){var p=1;break}p=b.gzindex<b.gzhead.name.length?255&b.gzhead.name.charCodeAt(b.gzindex++):
0;Eb(b,p)}while(0!==p);b.gzhead.hcrc&&b.pending>g&&(a.adler=fc(a.adler,b.pending_buf,b.pending-g,g));0===p&&(b.gzindex=0,b.status=91)}else b.status=91;if(91===b.status)if(b.gzhead.comment){g=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>g&&(a.adler=fc(a.adler,b.pending_buf,b.pending-g,g)),rd(a),g=b.pending,b.pending===b.pending_buf_size)){p=1;break}p=b.gzindex<b.gzhead.comment.length?255&b.gzhead.comment.charCodeAt(b.gzindex++):0;Eb(b,p)}while(0!==p);b.gzhead.hcrc&&b.pending>
g&&(a.adler=fc(a.adler,b.pending_buf,b.pending-g,g));0===p&&(b.status=103)}else b.status=103;if(103===b.status&&(b.gzhead.hcrc?(b.pending+2>b.pending_buf_size&&rd(a),b.pending+2<=b.pending_buf_size&&(Eb(b,255&a.adler),Eb(b,a.adler>>8&255),a.adler=0,b.status=113)):b.status=113),0!==b.pending){if(rd(a),0===a.avail_out)return b.last_flush=-1,0}else if(0===a.avail_in&&(c<<1)-9*(4<c)<=(d<<1)-9*(4<d)&&4!==c)return pd(a,-5);if(666===b.status&&0!==a.avail_in)return pd(a,-5);if(0!==a.avail_in||0!==b.lookahead||
0!==c&&666!==b.status){d=2===b.strategy?function(f,e){for(var m;;){if(0===f.lookahead&&(Fd(f),0===f.lookahead)){if(0===e)return 1;break}if(f.match_length=0,m=sd(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++,m&&(oc(f,!1),0===f.strm.avail_out))return 1}return(f.insert=0,4===e)?(oc(f,!0),0===f.strm.avail_out)?3:4:f.last_lit&&(oc(f,!1),0===f.strm.avail_out)?1:2}(b,c):3===b.strategy?function(f,e){for(var m,l,h,n,r=f.window;;){if(258>=f.lookahead){if(Fd(f),258>=f.lookahead&&0===e)return 1;if(0===
f.lookahead)break}if(f.match_length=0,3<=f.lookahead&&0<f.strstart&&(l=r[h=f.strstart-1])===r[++h]&&l===r[++h]&&l===r[++h]){for(n=f.strstart+258;l===r[++h]&&l===r[++h]&&l===r[++h]&&l===r[++h]&&l===r[++h]&&l===r[++h]&&l===r[++h]&&l===r[++h]&&h<n;);f.match_length=258-(n-h);f.match_length>f.lookahead&&(f.match_length=f.lookahead)}if(3<=f.match_length?(m=sd(f,1,f.match_length-3),f.lookahead-=f.match_length,f.strstart+=f.match_length,f.match_length=0):(m=sd(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++),
m&&(oc(f,!1),0===f.strm.avail_out))return 1}return(f.insert=0,4===e)?(oc(f,!0),0===f.strm.avail_out)?3:4:f.last_lit&&(oc(f,!1),0===f.strm.avail_out)?1:2}(b,c):me[b.level].func(b,c);if((3===d||4===d)&&(b.status=666),1===d||3===d)return 0===a.avail_out&&(b.last_flush=-1),0;if(2===d&&(1===c?di(b):5!==c&&(yg(b,0,0,!1),3===c&&(qd(b.head),0===b.lookahead&&(b.strstart=0,b.block_start=0,b.insert=0))),rd(a),0===a.avail_out))return b.last_flush=-1,0}return 4!==c?0:0>=b.wrap?1:(2===b.wrap?(Eb(b,255&a.adler),
Eb(b,a.adler>>8&255),Eb(b,a.adler>>16&255),Eb(b,a.adler>>24&255),Eb(b,255&a.total_in),Eb(b,a.total_in>>8&255),Eb(b,a.total_in>>16&255),Eb(b,a.total_in>>24&255)):(le(b,a.adler>>>16),le(b,65535&a.adler)),rd(a),0<b.wrap&&(b.wrap=-b.wrap),+(0===b.pending))};var gi=function(a){var c;return a&&a.state?42!==(c=a.state.status)&&69!==c&&73!==c&&91!==c&&103!==c&&113!==c&&666!==c?pd(a,-2):(a.state=null,113===c?pd(a,-3):0):-2};var Fh=function(a,c){var d,b,g;var p=c.length;if(!a||!a.state||2===(b=(d=a.state).wrap)||
1===b&&42!==d.status||d.lookahead)return-2;1===b&&(a.adler=Sd(a.adler,c,p,0));d.wrap=0;p>=d.w_size&&(0===b&&(qd(d.head),d.strstart=0,d.block_start=0,d.insert=0),g=new Ya.Buf8(d.w_size),Ya.arraySet(g,c,p-d.w_size,d.w_size,0),c=g,p=d.w_size);g=a.avail_in;var f=a.next_in;var e=a.input;a.avail_in=p;a.next_in=0;a.input=c;for(Fd(d);3<=d.lookahead;){c=d.strstart;p=d.lookahead-2;do d.ins_h=(d.ins_h<<d.hash_shift^d.window[c+3-1])&d.hash_mask,d.prev[c&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=c,c++;while(--p);
d.strstart=c;d.lookahead=2;Fd(d)}return d.strstart+=d.lookahead,d.block_start=d.strstart,d.insert=d.lookahead,d.lookahead=0,d.match_length=d.prev_length=2,d.match_available=0,a.next_in=f,a.input=e,a.avail_in=g,d.wrap=b,0};var Cg=!0,Bg=!0;try{String.fromCharCode.apply(null,[0])}catch(a){Cg=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){Bg=!1}for(var te=new Ya.Buf8(256),td=0;256>td;td++)te[td]=252<=td?6:248<=td?5:240<=td?4:224<=td?3:192<=td?2:1;"use strict";te[254]=te[254]=1;var Bf=
function(a){var c,d,b,g=a.length,p=0;for(b=0;b<g;b++)55296==(64512&(c=a.charCodeAt(b)))&&b+1<g&&56320==(64512&(d=a.charCodeAt(b+1)))&&(c=65536+(c-55296<<10)+(d-56320),b++),p+=128>c?1:2048>c?2:65536>c?3:4;var f=0;var e=new Ya.Buf8(p);for(b=0;f<p;b++)55296==(64512&(c=a.charCodeAt(b)))&&b+1<g&&56320==(64512&(d=a.charCodeAt(b+1)))&&(c=65536+(c-55296<<10)+(d-56320),b++),128>c?e[f++]=c:(2048>c?e[f++]=192|c>>>6:(65536>c?e[f++]=224|c>>>12:(e[f++]=240|c>>>18,e[f++]=128|c>>>12&63),e[f++]=128|c>>>6&63),e[f++]=
128|63&c);return e};var hi=function(a){for(var c=new Ya.Buf8(a.length),d=0,b=c.length;d<b;d++)c[d]=a.charCodeAt(d);return c};var ii=function(a,c){var d,b,g,p=c||a.length,f=Array(2*p);for(c=d=0;c<p;)if(128>(b=a[c++]))f[d++]=b;else if(4<(g=te[b]))f[d++]=65533,c+=g-1;else{for(b&=2===g?31:3===g?15:7;1<g&&c<p;)b=b<<6|63&a[c++],g--;1<g?f[d++]=65533:65536>b?f[d++]=b:(b-=65536,f[d++]=55296|b>>10&1023,f[d++]=56320|1023&b)}return Ag(f,d)};var ji=function(a,c){var d;(c=c||a.length)>a.length&&(c=a.length);for(d=
c-1;0<=d&&128==(192&a[d]);)d--;return 0>d||0===d?c:d+te[a[d]]>c?d:c};var Af={};Af=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0};var Dg=Object.prototype.toString;"use strict";"use strict";Gd.prototype.push=function(a,c){var d,b,g=this.strm,p=this.options.chunkSize;if(this.ended)return!1;c=c===~~c?c:4*(!0===c);"string"==typeof a?g.input=Bf(a):"[object ArrayBuffer]"===
Dg.call(a)?g.input=new Uint8Array(a):g.input=a;g.next_in=0;g.avail_in=g.input.length;do{if(0===g.avail_out&&(g.output=new Ya.Buf8(p),g.next_out=0,g.avail_out=p),1!==(b=fi(g,c))&&0!==b)return this.onEnd(b),this.ended=!0,!1;(0===g.avail_out||0===g.avail_in&&(4===c||2===c))&&("string"===this.options.to?this.onData(Ag(d=Ya.shrinkBuf(g.output,g.next_out),d.length)):this.onData(Ya.shrinkBuf(g.output,g.next_out)))}while((0<g.avail_in||0===g.avail_out)&&1!==b);return 4===c?(b=gi(this.strm),this.onEnd(b),
this.ended=!0,0===b):(2===c&&(this.onEnd(0),g.avail_out=0),!0)};Gd.prototype.onData=function(a){this.chunks.push(a)};Gd.prototype.onEnd=function(a){0===a&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ya.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};var Zg=Gd;var $g=Cf;var ah=function(a,c){return(c=c||{}).raw=!0,Cf(a,c)};var bh=function(a,c){return(c=c||{}).gzip=!0,Cf(a,c)};"use strict";var ue={};od(ue,"Inflate",function(){return eh},function(a){return eh=
a});od(ue,"inflate",function(){return fh},function(a){return fh=a});od(ue,"inflateRaw",function(){return gh},function(a){return gh=a});od(ue,"ungzip",function(){return hh},function(a){return hh=a});"use strict";var ih={};ih=function(a,c){var d,b,g,p;var f=a.state;var e=a.next_in;var m=a.input;var l=e+(a.avail_in-5);var h=a.next_out;var n=a.output;c=h-(c-a.avail_out);var r=h+(a.avail_out-257);var t=f.dmax;var v=f.wsize;var x=f.whave;var D=f.wnext;var G=f.window;var N=f.hold;var K=f.bits;var P=f.lencode;
var L=f.distcode;var ba=(1<<f.lenbits)-1;var X=(1<<f.distbits)-1;a:do for(15>K&&(N+=m[e++]<<K,K+=8,N+=m[e++]<<K,K+=8),d=P[N&ba];;){if(N>>>=b=d>>>24,K-=b,0==(b=d>>>16&255))n[h++]=65535&d;else if(16&b){var Y=65535&d;(b&=15)&&(K<b&&(N+=m[e++]<<K,K+=8),Y+=N&(1<<b)-1,N>>>=b,K-=b);15>K&&(N+=m[e++]<<K,K+=8,N+=m[e++]<<K,K+=8);for(d=L[N&X];;){if(N>>>=b=d>>>24,K-=b,16&(b=d>>>16&255)){if(g=65535&d,K<(b&=15)&&(N+=m[e++]<<K,(K+=8)<b&&(N+=m[e++]<<K,K+=8)),(g+=N&(1<<b)-1)>t){a.msg="invalid distance too far back";
f.mode=30;break a}if(N>>>=b,K-=b,g>(b=h-c)){if((b=g-b)>x&&f.sane){a.msg="invalid distance too far back";f.mode=30;break a}if(d=0,p=G,0===D){if(d+=v-b,b<Y){Y-=b;do n[h++]=G[d++];while(--b);d=h-g;p=n}}else if(D<b){if(d+=v+D-b,(b-=D)<Y){Y-=b;do n[h++]=G[d++];while(--b);if(d=0,D<Y){Y-=b=D;do n[h++]=G[d++];while(--b);d=h-g;p=n}}}else if(d+=D-b,b<Y){Y-=b;do n[h++]=G[d++];while(--b);d=h-g;p=n}for(;2<Y;)n[h++]=p[d++],n[h++]=p[d++],n[h++]=p[d++],Y-=3;Y&&(n[h++]=p[d++],1<Y&&(n[h++]=p[d++]))}else{d=h-g;do n[h++]=
n[d++],n[h++]=n[d++],n[h++]=n[d++],Y-=3;while(2<Y);Y&&(n[h++]=n[d++],1<Y&&(n[h++]=n[d++]))}}else if(0==(64&b)){d=L[(65535&d)+(N&(1<<b)-1)];continue}else{a.msg="invalid distance code";f.mode=30;break a}break}}else if(0==(64&b)){d=P[(65535&d)+(N&(1<<b)-1)];continue}else{32&b?f.mode=12:(a.msg="invalid literal/length code",f.mode=30);break a}break}while(e<l&&h<r);e-=Y=K>>3;K-=Y<<3;a.next_in=e;a.next_out=h;a.avail_in=e<l?5+(l-e):5-(e-l);a.avail_out=h<r?257+(r-h):257-(h-r);f.hold=N&(1<<K)-1;f.bits=K};var Xd=
{},ki=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],li=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],mi=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ni=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Xd=function(a,c,d,b,g,p,f,e){var m,l,h,n,r,t,v=e.bits,x,D,G,N,K,P=0,L,ba=null,X=0,Y=
new Ya.Buf16(16);var ka=new Ya.Buf16(16);var Aa=null,Ga=0;for(x=0;15>=x;x++)Y[x]=0;for(D=0;D<b;D++)Y[c[d+D]]++;var U=15;for(G=v;1<=U&&0===Y[U];U--);if(G>U&&(G=U),0===U)return g[p++]=20971520,g[p++]=20971520,e.bits=1,0;for(v=1;v<U&&0===Y[v];v++);G<v&&(G=v);for(x=m=1;15>=x;x++)if(m<<=1,0>(m-=Y[x]))return-1;if(0<m&&(0===a||1!==U))return-1;x=1;for(ka[1]=0;15>x;x++)ka[x+1]=ka[x]+Y[x];for(D=0;D<b;D++)0!==c[d+D]&&(f[ka[c[d+D]]++]=D);if(0===a?(ba=Aa=f,n=19):1===a?(ba=ki,X-=257,Aa=li,Ga-=257,n=256):(ba=mi,
Aa=ni,n=-1),L=0,D=0,x=v,ka=p,N=G,K=0,h=-1,b=(P=1<<G)-1,1===a&&852<P||2===a&&592<P)return 1;for(;;){var ya=x-K;f[D]<n?(r=0,t=f[D]):f[D]>n?(r=Aa[Ga+f[D]],t=ba[X+f[D]]):(r=96,t=0);m=1<<x-K;v=l=1<<N;do g[ka+(L>>K)+(l-=m)]=ya<<24|r<<16|t|0;while(0!==l);for(m=1<<x-1;L&m;)m>>=1;if(0!==m?(L&=m-1,L+=m):L=0,D++,0==--Y[x]){if(x===U)break;x=c[d+f[D]]}if(x>G&&(L&b)!==h){0===K&&(K=G);ka+=v;for(m=1<<(N=x-K);N+K<U&&!(0>=(m-=Y[N+K]));)N++,m<<=1;if(P+=1<<N,1===a&&852<P||2===a&&592<P)return 1;g[h=L&b]=G<<24|N<<16|ka-
p|0}}return 0!==L&&(g[ka+L]=x-K<<24|4194304),e.bits=G,0};var jh=!0;"use strict";var oi=function(a,c){var d,b,g,p,f,e,m,l,h,n=0,r=new Ya.Buf8(4),t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return-2;12===(b=a.state).mode&&(b.mode=13);var v=a.next_out;var x=a.output;var D=a.avail_out;var G=a.next_in;var N=a.input;var K=a.avail_in;var P=b.hold;var L=b.bits;var ba=K;var X=D;var Y=0;a:for(;;)switch(b.mode){case 1:if(0===b.wrap){b.mode=13;break}for(;16>
L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(2&b.wrap&&35615===P){b.check=0;r[0]=255&P;r[1]=P>>>8&255;b.check=fc(b.check,r,2,0);L=P=0;b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&P)<<8)+(P>>8))%31){a.msg="incorrect header check";b.mode=30;break}if(8!=(15&P)){a.msg="unknown compression method";b.mode=30;break}if(P>>>=4,L-=4,l=(15&P)+8,0===b.wbits)b.wbits=l;else if(l>b.wbits){a.msg="invalid window size";b.mode=30;break}b.dmax=1<<l;a.adler=b.check=1;b.mode=512&P?10:12;L=
P=0;break;case 2:for(;16>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(b.flags=P,8!=(255&b.flags)){a.msg="unknown compression method";b.mode=30;break}if(57344&b.flags){a.msg="unknown header flags set";b.mode=30;break}b.head&&(b.head.text=P>>8&1);512&b.flags&&(r[0]=255&P,r[1]=P>>>8&255,b.check=fc(b.check,r,2,0));L=P=0;b.mode=3;case 3:for(;32>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}b.head&&(b.head.time=P);512&b.flags&&(r[0]=255&P,r[1]=P>>>8&255,r[2]=P>>>16&255,r[3]=P>>>24&255,b.check=fc(b.check,
r,4,0));L=P=0;b.mode=4;case 4:for(;16>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}b.head&&(b.head.xflags=255&P,b.head.os=P>>8);512&b.flags&&(r[0]=255&P,r[1]=P>>>8&255,b.check=fc(b.check,r,2,0));L=P=0;b.mode=5;case 5:if(1024&b.flags){for(;16>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}b.length=P;b.head&&(b.head.extra_len=P);512&b.flags&&(r[0]=255&P,r[1]=P>>>8&255,b.check=fc(b.check,r,2,0));L=P=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&((g=b.length)>K&&(g=K),g&&(b.head&&(l=b.head.extra_len-
b.length,b.head.extra||(b.head.extra=Array(b.head.extra_len)),Ya.arraySet(b.head.extra,N,G,g,l)),512&b.flags&&(b.check=fc(b.check,N,g,G)),K-=g,G+=g,b.length-=g),b.length))break a;b.length=0;b.mode=7;case 7:if(2048&b.flags){if(0===K)break a;g=0;do l=N[G+g++],b.head&&l&&65536>b.length&&(b.head.name+=String.fromCharCode(l));while(l&&g<K);if(512&b.flags&&(b.check=fc(b.check,N,g,G)),K-=g,G+=g,l)break a}else b.head&&(b.head.name=null);b.length=0;b.mode=8;case 8:if(4096&b.flags){if(0===K)break a;g=0;do l=
N[G+g++],b.head&&l&&65536>b.length&&(b.head.comment+=String.fromCharCode(l));while(l&&g<K);if(512&b.flags&&(b.check=fc(b.check,N,g,G)),K-=g,G+=g,l)break a}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;16>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(P!==(65535&b.check)){a.msg="header crc mismatch";b.mode=30;break}L=P=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0);a.adler=b.check=0;b.mode=12;break;case 10:for(;32>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}a.adler=b.check=
Eg(P);L=P=0;b.mode=11;case 11:if(0===b.havedict)return a.next_out=v,a.avail_out=D,a.next_in=G,a.avail_in=K,b.hold=P,b.bits=L,2;a.adler=b.check=1;b.mode=12;case 12:if(5===c||6===c)break a;case 13:if(b.last){P>>>=7&L;L-=7&L;b.mode=27;break}for(;3>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}switch(b.last=1&P,--L,3&(P>>>=1)){case 0:b.mode=14;break;case 1:if(jh){Mf=new Ya.Buf32(512);Nf=new Ya.Buf32(32);for(d=0;144>d;)b.lens[d++]=8;for(;256>d;)b.lens[d++]=9;for(;280>d;)b.lens[d++]=7;for(;288>d;)b.lens[d++]=
8;Xd(1,b.lens,0,288,Mf,0,b.work,{bits:9});for(d=0;32>d;)b.lens[d++]=5;Xd(2,b.lens,0,32,Nf,0,b.work,{bits:5});jh=!1}if(b.lencode=Mf,b.lenbits=9,b.distcode=Nf,b.distbits=5,b.mode=20,6===c){P>>>=2;L-=2;break a}break;case 2:b.mode=17;break;case 3:a.msg="invalid block type",b.mode=30}P>>>=2;L-=2;break;case 14:P>>>=7&L;for(L-=7&L;32>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if((65535&P)!=(P>>>16^65535)){a.msg="invalid stored block lengths";b.mode=30;break}if(b.length=65535&P,P=0,L=0,b.mode=15,6===c)break a;
case 15:b.mode=16;case 16:if(g=b.length){if(g>K&&(g=K),g>D&&(g=D),0===g)break a;Ya.arraySet(x,N,G,g,v);K-=g;G+=g;D-=g;v+=g;b.length-=g;break}b.mode=12;break;case 17:for(;14>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(b.nlen=(31&P)+257,L-=5,b.ndist=(31&(P>>>=5))+1,L-=5,b.ncode=(15&(P>>>=5))+4,P>>>=4,L-=4,286<b.nlen||30<b.ndist){a.msg="too many length or distance symbols";b.mode=30;break}b.have=0;b.mode=18;case 18:for(;b.have<b.ncode;){for(;3>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}b.lens[t[b.have++]]=
7&P;P>>>=3;L-=3}for(;19>b.have;)b.lens[t[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,h={bits:b.lenbits},Y=Xd(0,b.lens,0,19,b.lencode,0,b.work,h),b.lenbits=h.bits,Y){a.msg="invalid code lengths set";b.mode=30;break}b.have=0;b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;f=(n=b.lencode[P&(1<<b.lenbits)-1])>>>24,e=65535&n,!(f<=L);){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(16>e)P>>>=f,L-=f,b.lens[b.have++]=e;else{if(16===e){for(d=f+2;L<d;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(P>>>=f,L-=
f,0===b.have){a.msg="invalid bit length repeat";b.mode=30;break}l=b.lens[b.have-1];g=3+(3&P);P>>>=2;L-=2}else if(17===e){for(d=f+3;L<d;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}P>>>=f;L-=f;l=0;g=3+(7&P);P>>>=3;L-=3}else{for(d=f+7;L<d;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}P>>>=f;L-=f;l=0;g=11+(127&P);P>>>=7;L-=7}if(b.have+g>b.nlen+b.ndist){a.msg="invalid bit length repeat";b.mode=30;break}for(;g--;)b.lens[b.have++]=l}}if(30===b.mode)break;if(0===b.lens[256]){a.msg="invalid code -- missing end-of-block";
b.mode=30;break}if(b.lenbits=9,h={bits:b.lenbits},Y=Xd(1,b.lens,0,b.nlen,b.lencode,0,b.work,h),b.lenbits=h.bits,Y){a.msg="invalid literal/lengths set";b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,h={bits:b.distbits},Y=Xd(2,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,h),b.distbits=h.bits,Y){a.msg="invalid distances set";b.mode=30;break}if(b.mode=20,6===c)break a;case 20:b.mode=21;case 21:if(6<=K&&258<=D){a.next_out=v;a.avail_out=D;a.next_in=G;a.avail_in=K;b.hold=P;b.bits=L;ih(a,X);v=a.next_out;
x=a.output;D=a.avail_out;G=a.next_in;N=a.input;K=a.avail_in;P=b.hold;L=b.bits;12===b.mode&&(b.back=-1);break}for(b.back=0;f=(n=b.lencode[P&(1<<b.lenbits)-1])>>>24,d=n>>>16&255,e=65535&n,!(f<=L);){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(d&&0==(240&d)){var ka=f;var Aa=d;for(m=e;f=(n=b.lencode[m+((P&(1<<ka+Aa)-1)>>ka)])>>>24,d=n>>>16&255,e=65535&n,!(ka+f<=L);){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}P>>>=ka;L-=ka;b.back+=ka}if(P>>>=f,L-=f,b.back+=f,b.length=e,0===d){b.mode=26;break}if(32&d){b.back=
-1;b.mode=12;break}if(64&d){a.msg="invalid literal/length code";b.mode=30;break}b.extra=15&d;b.mode=22;case 22:if(b.extra){for(d=b.extra;L<d;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}b.length+=P&(1<<b.extra)-1;P>>>=b.extra;L-=b.extra;b.back+=b.extra}b.was=b.length;b.mode=23;case 23:for(;f=(n=b.distcode[P&(1<<b.distbits)-1])>>>24,d=n>>>16&255,e=65535&n,!(f<=L);){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(0==(240&d)){ka=f;Aa=d;for(m=e;f=(n=b.distcode[m+((P&(1<<ka+Aa)-1)>>ka)])>>>24,d=n>>>16&255,e=65535&
n,!(ka+f<=L);){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}P>>>=ka;L-=ka;b.back+=ka}if(P>>>=f,L-=f,b.back+=f,64&d){a.msg="invalid distance code";b.mode=30;break}b.offset=e;b.extra=15&d;b.mode=24;case 24:if(b.extra){for(d=b.extra;L<d;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}b.offset+=P&(1<<b.extra)-1;P>>>=b.extra;L-=b.extra;b.back+=b.extra}if(b.offset>b.dmax){a.msg="invalid distance too far back";b.mode=30;break}b.mode=25;case 25:if(0===D)break a;if(g=X-D,b.offset>g){if((g=b.offset-g)>b.whave&&b.sane){a.msg=
"invalid distance too far back";b.mode=30;break}g>b.wnext?(g-=b.wnext,p=b.wsize-g):p=b.wnext-g;g>b.length&&(g=b.length);d=b.window}else d=x,p=v-b.offset,g=b.length;g>D&&(g=D);D-=g;b.length-=g;do x[v++]=d[p++];while(--g);0===b.length&&(b.mode=21);break;case 26:if(0===D)break a;x[v++]=b.length;D--;b.mode=21;break;case 27:if(b.wrap){for(;32>L;){if(0===K)break a;K--;P|=N[G++]<<L;L+=8}if(X-=D,a.total_out+=X,b.total+=X,X&&(a.adler=b.check=b.flags?fc(b.check,x,X,v-X):Sd(b.check,x,X,v-X)),X=D,(b.flags?P:
Eg(P))!==b.check){a.msg="incorrect data check";b.mode=30;break}L=P=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;32>L;){if(0===K)break a;K--;P+=N[G++]<<L;L+=8}if(P!==(4294967295&b.total)){a.msg="incorrect length check";b.mode=30;break}L=P=0}b.mode=29;case 29:Y=1;break a;case 30:Y=-3;break a;case 31:return-4;default:return-2}return(a.next_out=v,a.avail_out=D,a.next_in=G,a.avail_in=K,b.hold=P,b.bits=L,(b.wsize||X!==a.avail_out&&30>b.mode&&(27>b.mode||4!==c))&&Fg(a,a.output,a.next_out,X-a.avail_out))?
(b.mode=31,-4):(ba-=a.avail_in,X-=a.avail_out,a.total_in+=ba,a.total_out+=X,b.total+=X,b.wrap&&X&&(a.adler=b.check=b.flags?fc(b.check,x,X,a.next_out-X):Sd(b.check,x,X,a.next_out-X)),a.data_type=b.bits+64*!!b.last+128*(12===b.mode)+256*(20===b.mode||15===b.mode),(0===ba&&0===X||4===c)&&0===Y&&(Y=-5),Y)};var pi=function(a){if(!a||!a.state)return-2;var c=a.state;return c.window&&(c.window=null),a.state=null,0};var Hh=function(a,c){var d;return a&&a.state&&0!=(2&(d=a.state).wrap)?(d.head=c,c.done=!1,
0):-2};var Ig=function(a,c){var d,b=c.length;return a&&a.state&&(0===(d=a.state).wrap||11===d.mode)?11===d.mode&&Sd(1,c,b,0)!==d.check?-3:Fg(a,c,b,b)?(d.mode=31,-4):(d.havedict=1,0):-2};"use strict";var Wb={};Wb={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,
Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Gg={};Gg=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1};var Hg=Object.prototype.toString;Hd.prototype.push=function(a,c){var d,b,g,p,f=this.strm,e=this.options.chunkSize,m=this.options.dictionary,l=!1;if(this.ended)return!1;c=c===~~c?c:!0===c?Wb.Z_FINISH:Wb.Z_NO_FLUSH;"string"==typeof a?f.input=hi(a):"[object ArrayBuffer]"===
Hg.call(a)?f.input=new Uint8Array(a):f.input=a;f.next_in=0;f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new Ya.Buf8(e),f.next_out=0,f.avail_out=e),(d=oi(f,Wb.Z_NO_FLUSH))===Wb.Z_NEED_DICT&&m&&(d=Ig(this.strm,m)),d===Wb.Z_BUF_ERROR&&!0===l&&(d=Wb.Z_OK,l=!1),d!==Wb.Z_STREAM_END&&d!==Wb.Z_OK)return this.onEnd(d),this.ended=!0,!1;f.next_out&&(0===f.avail_out||d===Wb.Z_STREAM_END||0===f.avail_in&&(c===Wb.Z_FINISH||c===Wb.Z_SYNC_FLUSH))&&("string"===this.options.to?(b=ji(f.output,f.next_out),
g=f.next_out-b,p=ii(f.output,b),f.next_out=g,f.avail_out=e-g,g&&Ya.arraySet(f.output,f.output,b,g,0),this.onData(p)):this.onData(Ya.shrinkBuf(f.output,f.next_out)));0===f.avail_in&&0===f.avail_out&&(l=!0)}while((0<f.avail_in||0===f.avail_out)&&d!==Wb.Z_STREAM_END);return(d===Wb.Z_STREAM_END&&(c=Wb.Z_FINISH),c===Wb.Z_FINISH)?(d=pi(this.strm),this.onEnd(d),this.ended=!0,d===Wb.Z_OK):(c===Wb.Z_SYNC_FLUSH&&(this.onEnd(Wb.Z_OK),f.avail_out=0),!0)};Hd.prototype.onData=function(a){this.chunks.push(a)};Hd.prototype.onEnd=
function(a){a===Wb.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ya.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};var eh=Hd;var fh=Df;var gh=function(a,c){return(c=c||{}).raw=!0,Df(a,c)};var hh=Df;var kh={};bi(kh,re,ue,Wb);Gf=kh;Ef.FIXED_HEADER_LENGTH=16;He.HEADER_LENGTH=8;class lh{readFixedHeader(a){this.payloadOffset=a.readU32BE();this.blendMode=a.readU32BE();this.alpha=a.readU32BE();let c=a.readU32BE();this.visible=0!=(1&c);this.clip=
0!=(2&c);this.hasMask=0!=(4&c);this.maskLinked=0!=(8&c);this.maskVisible=0!=(16&c);this.expanded=0!=(32&c);this.lockAlpha=0!=(64&c);this.blendMode===V.LM_MULTIPLY&&0!=(128&c)&&(this.blendMode=V.LM_MULTIPLY2);this.nameLength=a.readU32BE()}getFixedHeaderLen(){return 20}getVariableHeaderLen(){return this.nameLength}readVariableSizeHeader(a){this.name=a.readString(this.nameLength)}decode(a){for(var c;;){if(0<this.skipBytes){if(this.skipBytes>=a.length)return this.skipBytes-=a.length,null;a=a.subarray(this.skipBytes);
this.skipBytes=0}switch(this.state){case 0:if(a.length<this.getFixedHeaderLen())break;c=new ub(a);this.readFixedHeader(c);a=a.subarray(c.pos);this.state=1;continue;case 1:if(a.length<this.getVariableHeaderLen())break;c=new ub(a);this.readVariableSizeHeader(c);this.layer=this.createLayer();this.hasMask&&(this.layer.setMask(new Xa(this.width,this.height,8)),this.maskDecoder=new qi(this.layer.mask));this.layer instanceof Ma&&(this.colorDecoder=new ri(this.layer.image));this.skipBytes=this.payloadOffset-
this.getFixedHeaderLen();this.colorDecoder?this.state=3:this.maskDecoder?this.state=4:this.state=5;continue;case 3:if(a=this.colorDecoder.decode(a),this.colorDecoder.done){this.maskDecoder?this.state=4:this.state=5;continue}break;case 4:if(a=this.maskDecoder.decode(a),this.maskDecoder.done){this.state=5;continue}break;case 5:c=this.payloadOffset;this.colorDecoder&&(c+=this.colorDecoder.bytesTotal);this.maskDecoder&&(c+=this.maskDecoder.bytesTotal);this.state=6;this.skipBytes=this.chunkHeader.chunkSize-
c;continue;case 6:this.done=!0}break}return a}constructor(a,c,d){this.chunkHeader=a;this.width=c;this.height=d;this.nameLength=this.skipBytes=this.payloadOffset=this.state=0;this.done=!1;this.maskDecoder=this.colorDecoder=null}}class Ih extends lh{createLayer(){let a=new Ma(this.width,this.height,this.name);return a.setBlendMode(this.blendMode),a.setAlpha(this.alpha),a.setVisible(this.visible),a.setClip(this.clip),a.setMaskLinked(this.maskLinked),a.setMaskVisible(this.maskVisible),a.setLockAlpha(this.lockAlpha),
a}}class Jh extends lh{readFixedHeader(a){super.readFixedHeader.call(this,a);this.childLayers=a.readU32BE()}getFixedHeaderLen(){return super.getFixedHeaderLen.call(this)+4}createLayer(){let a=new nb(this.name,this.blendMode);return a.setAlpha(this.alpha),a.setVisible(this.visible),a.setExpanded(this.expanded),a.setMaskLinked(this.maskLinked),a.setMaskVisible(this.maskVisible),a}constructor(a,c,d){super(a,c,d);this.childLayers=0}}class ri{decode(a){if(null==a)return null;var c=this.bytesRead%H.BYTES_PER_PIXEL,
d=this.bytesRead-c;let b=0,g=[H.ALPHA_BYTE_OFFSET,H.RED_BYTE_OFFSET,H.GREEN_BYTE_OFFSET,H.BLUE_BYTE_OFFSET];for(;c<H.BYTES_PER_PIXEL&&b<a.length;c++)this.output[d+g[c]]=a[b],b++;this.bytesRead+=b;var p=0|Math.min(a.length-b,this.bytesTotal-this.bytesRead);c=p/H.BYTES_PER_PIXEL|0;p%=H.BYTES_PER_PIXEL;for(d=0;d<c;d++)this.output[this.bytesRead+H.ALPHA_BYTE_OFFSET]=a[b],this.output[this.bytesRead+H.RED_BYTE_OFFSET]=a[b+1],this.output[this.bytesRead+H.GREEN_BYTE_OFFSET]=a[b+2],this.output[this.bytesRead+
H.BLUE_BYTE_OFFSET]=a[b+3],this.bytesRead+=H.BYTES_PER_PIXEL,b+=H.BYTES_PER_PIXEL;c=0;for(d=this.bytesRead;c<p;c++)this.output[d+g[c]]=a[b],b++;return(this.bytesRead+=p,this.bytesRead>=this.bytesTotal&&(this.done=!0),b<a.length)?a.subarray(b):null}constructor(a){this.bytesRead=0;this.bytesTotal=a.width*a.height*H.BYTES_PER_PIXEL;this.output=a.data;this.done=!1}}class qi{decode(a){if(null==a)return null;let c=0|Math.min(a.length,this.bytesTotal-this.bytesRead),d=this.bytesRead,b;for(b=0;b<c;b++,d++)this.output[d]=
a[b];return(this.bytesRead=d,this.bytesRead>=this.bytesTotal&&(this.done=!0),b<a.length)?a.subarray(b):null}constructor(a){this.bytesRead=0;this.bytesTotal=a.width*a.height;this.output=a.data;this.done=!1}}Ud.prototype.read=function(a){if(null==a)return null;var c=new ub(new Uint8Array(a)),d=[];if(1!=c.readU16BE())return null;a=c.readU16BE();for(var b=0;b<a;b++)if(0==c.readU16BE()){var g=255*c.readU16BE()/65535,p=255*c.readU16BE()/65535,f=255*c.readU16BE()/65535;c.readU16BE();d.push(g<<16|p<<8|f)}return d};
Ud.prototype.write=function(a){var c=new ub(new Uint8Array(4+10*a.length));c.writeU16BE(1);c.writeU16BE(a.length);for(var d=0;d<a.length;d++){var b=a[d];c.writeU16BE(0);c.writeU16BE(257*(b>>16&255));c.writeU16BE(257*(b>>8&255));c.writeU16BE(257*(255&b));c.writeU16BE(0)}return c.getAsDataArray()};Ie.prototype=Object.create(ma($b).prototype);Ie.prototype.constructor=Ie;var oe={};var mh=function(){function a(f,e,m){var l=new XMLHttpRequest;l.open("GET",f);l.responseType="blob";l.onload=function(){p(l.response,
e,m)};l.onerror=function(){console.error("could not download file")};l.send()}function c(f){var e=new XMLHttpRequest;e.open("HEAD",f,!1);try{e.send()}catch(m){}return 200<=e.status&&299>=e.status}function d(f){try{f.dispatchEvent(new MouseEvent("click"))}catch(m){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null);f.dispatchEvent(e)}}var b="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:
"object"==typeof Ye&&Ye.global===Ye?Ye:void 0,g=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),p=b.saveAs||("object"!=typeof window||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!g?function(f,e,m){var l=b.URL||b.webkitURL,h=document.createElement("a");h.download=e=e||f.name||"download";h.rel="noopener";"string"==typeof f?(h.href=f,h.origin===location.origin?d(h):c(h.href)?a(f,e,m):d(h,h.target="_blank")):
(h.href=l.createObjectURL(f),setTimeout(function(){l.revokeObjectURL(h.href)},4E4),setTimeout(function(){d(h)},0))}:"msSaveOrOpenBlob"in navigator?function(f,e,m){if(e=e||f.name||"download","string"!=typeof f){var l;navigator.msSaveOrOpenBlob((void 0===(l=m)?l={autoBom:!1}:"object"!=typeof l&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\ufeff",f],
{type:f.type}):f),e)}else if(c(f))a(f,e,m);else{var h=document.createElement("a");h.href=f;h.target="_blank";setTimeout(function(){d(h)})}}:function(f,e,m,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof f)return a(f,e,m);e="application/octet-stream"===f.type;m=/constructor/i.test(b.HTMLElement)||b.safari;var h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||e&&m||g)&&"undefined"!=typeof FileReader){var n=new FileReader;n.onloadend=function(){var v=
n.result;v=h?v:v.replace(/^data:[^;]*;/,"data:attachment/file;");l?l.location.href=v:location=v;l=null};n.readAsDataURL(f)}else{var r=b.URL||b.webkitURL,t=r.createObjectURL(f);l?l.location=t:location.href=t;l=null;setTimeout(function(){r.revokeObjectURL(t)},4E4)}});oe=b.saveAs=p.saveAs=p};"function"==typeof define&&define.amd?define([],mh):mh();var Ke={};Ke=JSON.parse('{"Dodge (tool)":"Dodge","Burn (tool)":"Burn","Color (picker)":"Color","Color swatches (shorter)":"Swatches"}');let If={ja:JSON.parse('{"File":"\u30d5\u30a1\u30a4\u30eb","Save to my computer":"PC\u306b\u4fdd\u5b58","Post Oekaki":"\u753b\u50cf\u3092\u6295\u7a3f","Edit":"\u7de8\u96c6","Undo":"\u53d6\u308a\u6d88\u3057","Redo":"\u3084\u308a\u76f4\u3057","Cut":"\u5207\u308a\u53d6\u308a","Copy":"\u30b3\u30d4\u30fc","Clear history":"\u5c65\u6b74\u6d88\u53bb","Copy merged":"\u7d50\u5408\u30b3\u30d4\u30fc","Paste":"\u8cbc\u308a\u4ed8\u3051","Select all":"\u3059\u3079\u3066\u9078\u629e","Deselect":"\u9078\u629e\u89e3\u9664","Transform":"\u5909\u5f62","Layers":"\u30ec\u30a4\u30e4\u30fc","Duplicate":"\u8907\u88fd","Merge down":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3068\u7d50\u5408","Merge group":"\u30b0\u30eb\u30fc\u30d7\u7d50\u5408","Merge all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u7d50\u5408","Add layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Delete mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Delete layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Apply mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Apply layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Disable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u7121\u52b9\u5316","Enable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u6709\u52b9\u5316","Clip to the layer below":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3067\u30af\u30ea\u30c3\u30d4\u30f3\u30b0","Unclip from the layer below":"\u30af\u30ea\u30c3\u30d4\u30f3\u30b0\u89e3\u9664","Effects":"\u52b9\u679c","Clear":"\u6d88\u53bb","Fill":"\u5857\u308a\u6f70\u3057","Flip horizontal":"\u5de6\u53f3\u53cd\u8ee2","Flip vertical":"\u4e0a\u4e0b\u53cd\u8ee2","Invert":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Convert brightness to opacity":"\u8f1d\u5ea6\u3092\u900f\u660e\u5ea6\u306b\u5909\u63db","Box blur...":"\u307c\u304b\u3057","Box blur":"\u307c\u304b\u3057","Blur amount (pixels)":"\u307c\u304b\u3057\u91cf(\u30d4\u30af\u30bb\u30eb\u5358\u4f4d)","Iterations (1-8, larger gives smoother blur)":"\u53cd\u5fa9(1-8,\u5927\u304d\u3044\u307b\u3069\u307c\u304b\u3057\u304c\u6ed1\u3089\u304b)","Monochromatic noise":"\u5358\u8272\u30ce\u30a4\u30ba","Color noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba","View":"\u8868\u793a","Full-screen mode":"\u30d5\u30eb\u30b9\u30af\u30ea\u30fc\u30f3\u30e2\u30fc\u30c9","Zoom in":"\u62e1\u5927","Zoom out":"\u7e2e\u5c0f","Zoom 100%":"100%","Smooth-out zoomed canvas":"\u30ba\u30fc\u30e0\u3092\u306a\u3081\u3089\u304b\u306b\u8868\u793a\u3059\u308b","Show grid":"\u30b0\u30ea\u30c3\u30c9\u3092\u8868\u793a","Grid options...":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Palettes":"\u30d1\u30ec\u30c3\u30c8","Rearrange":"\u521d\u671f\u5316","Toggle palettes":"\u8868\u793a\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Use old icons":"\u53e4\u3044\u30a2\u30a4\u30b3\u30f3","Show tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Show color":"\u30ab\u30e9\u30fc","Show layers":"\u30ec\u30a4\u30e4\u30fc","Show misc":"\u64cd\u4f5c","Show stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Show swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Show textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Show tools":"\u30c4\u30fc\u30eb","Help":"\u30d8\u30eb\u30d7","Tablet support":"\u30bf\u30d6\u30ec\u30c3\u30c8\u30b5\u30dd\u30fc\u30c8","Shortcuts":"\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8","About":"ChickenPaint Be\u306b\u3064\u3044\u3066","Removes all undo/redo information to regain memory":"\u5c65\u6b74\u3092\u30af\u30ea\u30a2\u3057\u3066\u30e1\u30e2\u30ea\u3092\u958b\u653e\u3057\u307e\u3059","Clears the selected area":"\u6d88\u53bb","Invert the image colors":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Blur effect":"\u307c\u304b\u3057\u30d5\u30a3\u30eb\u30bf","Fills the selection with noise":"\u5358\u8272\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Fills the selection with colored noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Linear interpolation is used to give a smoothed looked to the picture when zoomed in":"\u753b\u50cf\u306e\u62e1\u5927\u6642\u306b\u88dc\u5b8c\u3057\u3066\u6ed1\u3089\u304b\u306b\u8868\u793a\u3057\u307e\u3059","Rearrange the palette windows":"\u30d1\u30ec\u30c3\u30c8\u3092\u518d\u914d\u7f6e","Hides or shows all palettes":"\u30d1\u30ec\u30c3\u30c8\u306e\u8868\u793a/\u975e\u8868\u793a","You\'re about to clear the current Undo/Redo history.\\nThis operation cannot be undone, are you sure you want to do that?":"\u30a2\u30f3\u30c9\u30a5\u30fb\u30ea\u30c9\u30a5\u306e\u5c65\u6b74\u3092\u6d88\u53bb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\\n\u3053\u306e\u64cd\u4f5c\u306f\u5143\u306b\u623b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b?","Misc":"\u64cd\u4f5c","Round Pixelated":"\u5186\u30d4\u30af\u30bb\u30eb","Round Hard Edge":"\u5186\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Round Soft":"\u5186\u30bd\u30d5\u30c8","Square Pixelated":"\u89d2\u30d4\u30af\u30bb\u30eb","Square Hard Edge":"\u89d2\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Color (picker)":"\u30ab\u30e9\u30fc","Tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Opacity":"\u4e0d\u900f\u660e\u5ea6","Color":"\u8272\u88dc\u5145","Blend":"\u6df7\u8272","Spacing":"\u9593\u9694","Scattering":"\u6563\u4e71","Smoothing":"\u624b\u3076\u308c\u88dc\u6b63","Color swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Color swatches (shorter)":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Remove":"\u524a\u9664","Replace with current color":"\u9078\u629e\u4e2d\u306e\u8272\u306b\u7f6e\u304d\u63db\u3048","Save swatches to your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u306b\u4fdd\u5b58","Load swatches from your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u304b\u3089\u8aad\u307f\u8fbc\u307f","Add the current brush color as a new swatch":"\u9078\u629e\u4e2d\u306e\u8272\u3092\u8ffd\u52a0","Sample all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u6df7\u5408","Lock transparency":"\u900f\u660e\u90e8\u5206\u3092\u4fdd\u8b77","Textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Customize":"\u30ab\u30b9\u30bf\u30de\u30a4\u30ba","Inverse":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Mirror":"\u5de6\u53f3\u53cd\u8ee2","Brightness":"\u8f1d\u5ea6","Contrast":"\u30b3\u30f3\u30c8\u30e9\u30b9\u30c8","Reset":"\u30ea\u30bb\u30c3\u30c8","Layer blending mode":"\u5408\u6210\u30e2\u30fc\u30c9","Normal":"\u901a\u5e38","Multiply":"\u4e57\u7b97","Add":"\u52a0\u7b97","Screen":"\u30b9\u30af\u30ea\u30fc\u30f3","Lighten":"\u6bd4\u8f03(\u660e)","Darken":"\u6bd4\u8f03(\u6697)","Subtract":"\u6e1b\u7b97","Dodge":"\u8986\u3044\u713c\u304d","Burn":"\u713c\u304d\u8fbc\u307f","Overlay":"\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4","Hard Light":"\u30cf\u30fc\u30c9\u30e9\u30a4\u30c8","Soft Light":"\u30bd\u30d5\u30c8\u30e9\u30a4\u30c8","Vivid Light":"\u30d3\u30d3\u30c3\u30c9\u30e9\u30a4\u30c8","Linear Light":"\u30ea\u30cb\u30a2\u30e9\u30a4\u30c8","Pin Light":"\u30d4\u30f3\u30e9\u30a4\u30c8","Passthrough":"\u901a\u904e","Stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Free-hand":"\u30d5\u30ea\u30fc\u30cf\u30f3\u30c9","Straight line":"\u76f4\u7dda","Bezier curve":"Bz\uff08\u30d9\u30b8\u30a7\uff09\u66f2\u7dda","Tools":"\u30c4\u30fc\u30eb","Marquee":"\u9078\u629e\u7bc4\u56f2","Move tool":"\u79fb\u52d5","Flood fill":"\u5857\u308a\u6f70\u3057","Gradient fill":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3","Color picker":"\u30b9\u30dd\u30a4\u30c8","Rotate canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Grab canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u4f4d\u7f6e","Pencil":"\u925b\u7b46","Pen":"\u30da\u30f3","Airbrush":"\u30a8\u30a2\u30d6\u30e9\u30b7","Waterpaint":"\u6c34\u5f69","Eraser":"\u6d88\u3057\u30b4\u30e0","Soft eraser":"\u8584\u6d88\u3057","Smudge":"\u6307\u5148","Blender":"\u6df7\u8272","Dodge (tool)":"\u8986\u3044\u713c\u304d","Burn (tool)":"\u713c\u304d\u8fbc\u307f","Blur":"\u307c\u304b\u3057","Grid options":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Grid size":"\u30b0\u30ea\u30c3\u30c9\u30b5\u30a4\u30ba","Rename...":"\u540d\u524d\u3092\u5909\u66f4","Add layer":"\u65b0\u898f\u30ec\u30a4\u30e4\u30fc","Delete layer":"\u30ec\u30a4\u30e4\u30fc\u524a\u9664","Add group":"\u65b0\u898f\u30b0\u30eb\u30fc\u30d7","Delete group":"\u30b0\u30eb\u30fc\u30d7\u524a\u9664","Add mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Gradient":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210","Transform style":"\u5909\u5f62\u30b9\u30bf\u30a4\u30eb","Apply transform":"\u5909\u5f62\u78ba\u5b9a","Complete transform":"\u5909\u5f62\u3092\u5b8c\u4e86","Undo transform":"\u53d6\u308a\u6d88\u3057","You need to finish transforming this layer before you can do that. What would you like to do with the transform?":"\u7d9a\u884c\u3059\u308b\u305f\u3081\u306b\u5909\u5f62\u3092\u5b8c\u4e86\u3057\u307e\u3059\u3002","Smooth":"\u30b9\u30e0\u30fc\u30ba","Sharp":"\u30b7\u30e3\u30fc\u30d7","Opacity: ":"\u4e0d\u900f\u660e\u5ea6:","Please enter a color in hex format":"16\u9032\u5f62\u5f0f\u3067\u8272\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff08#xxxxxx\u306e\u5f62\uff09","Cancel":"\u30ad\u30e3\u30f3\u30bb\u30eb","Ok":"OK","Okay":"OK","OK":"OK","Whoops! This layer is currently hidden":"\u975e\u8868\u793a\u30ec\u30a4\u30e4\u30fc\u3067\u3059\u3002","Whoops! This layer\'s opacity is currently 0%":"\u30ec\u30a4\u30e4\u30fc\u306e\u4e0d\u900f\u660e\u5ea6\u304c0%\u3067\u3059","Whoops! You can\'t draw on a group":"\u30b0\u30eb\u30fc\u30d7\u30d5\u30a9\u30eb\u30c0\u306b\u306f\u63cf\u3051\u307e\u305b\u3093","Whoops! All of the selected pixels are transparent!":"\u30ec\u30a4\u30e4\u30fc\u304c\u7a7a\u3067\u3059","Image":"\u753b\u50cf","Layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af","Sorry, you can\'t remove the last remaining layer in the drawing.":"\u6700\u5f8c\u306e1\u3064\u306a\u306e\u3067\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3002","Are you sure you want to send your drawing to the server and finish drawing now?":"\u753b\u50cf\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Your drawing has unsaved changes! Are you sure to want to navigate away?":"\u753b\u50cf\u306b\u672a\u4fdd\u5b58\u306e\u5909\u66f4\u304c\u3042\u308a\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.":"\u5229\u7528\u53ef\u80fd\u306a\u30ad\u30fc\u30dc\u30fc\u30c9\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u306e\u3044\u304f\u3064\u304b\u306f\u30e1\u30cb\u30e5\u30fc\u306e\u6a2a\u3084\u30c4\u30fc\u30eb\u30c1\u30c3\u30d7\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002","Here are some other shortcuts which are not as obvious!":"\u3053\u306e\u4e00\u89a7\u306f\u305d\u308c\u4ee5\u5916\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\u3067\u3059\u3002","Right":"\u53f3","Left":"\u5de6","Middle":"\u4e2d","or":"\u307e\u305f\u306f","Double click":"\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af","Color swatches palette":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Use as the drawing color":"\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u53d6\u5f97","Remove or replace a color swatch":"\u30d1\u30ec\u30c3\u30c8\u306e\u5909\u66f4\uff65\u524a\u9664","Line drawing mode":"\u76f4\u7dda\u30e2\u30fc\u30c9","Snap line to nearest 45 degrees":"45\u00b0\u5358\u4f4d\u3067\u30b9\u30ca\u30c3\u30d7","Painting tools":"\u30c4\u30fc\u30eb","Change brush opacity":"\u30d6\u30e9\u30b7\u306e\u4e0d\u900f\u660e\u5ea6","Change brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Brush palette":"\u30d6\u30e9\u30b7\u30d1\u30ec\u30c3\u30c8","Adjust brush sliders more precisely":"\u30d6\u30e9\u30b7\u30b9\u30e9\u30a4\u30c0\u30fc\u3092\u3088\u308a\u7d30\u304b\u304f\u8abf\u6574","Drawing canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9","Move the canvas around":"\u30ad\u30e3\u30f3\u30d0\u30b9\u3092\u79fb\u52d5","Rotate the canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Sample the color under the cursor":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u8272\u3092\u30b9\u30dd\u30a4\u30c8","Layers palette":"\u30ec\u30a4\u30e4\u30fc\u30d1\u30ec\u30c3\u30c8","Rename layer":"\u30ec\u30a4\u30e4\u30fc\u540d\u5909\u66f4","Toggle mask enable/disable":"\u30de\u30b9\u30af\u306e\u6709\u52b9/\u7121\u52b9\u5207\u308a\u66ff\u3048","Toggle mask View":"\u30de\u30b9\u30af\u306e\u8868\u793a/\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Save Oekaki":"\u4fdd\u5b58","Saving drawing...":"\u753b\u50cf\u3092\u4fdd\u5b58\u4e2d\u2026","Preparing your drawing to be saved, please wait...":"\u753b\u50cf\u3092\u4fdd\u5b58\u3059\u308b\u6e96\u5099\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044\u2026","Drawing saved!":"\u753b\u50cf\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\uff01","Your drawing has been saved, would you like to post it to the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, post it now":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059","No, keep drawing":"\u307e\u3060\u63cf\u304d\u307e\u3059","No, quit and I\'ll finish it later":"\u30a2\u30d7\u30ea\u3092\u7d42\u4e86\u3057\u3066\u7d9a\u304d\u3092\u5f8c\u3067\u63cf\u304f","Your drawing has been saved, would you like to view it on the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, view the post":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059\u3002","Your drawing has been saved, redirecting you to view your new post now...":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u6295\u7a3f\u5148\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002","Sorry, your drawing could not be saved, Please see the error message.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002","Sorry, your drawing could not be saved, please try again later.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u6642\u9593\u3092\u7f6e\u3044\u3066\u518d\u5ea6\u6295\u7a3f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002","The error returned from the server was":"\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u8fd4\u3063\u3066\u6765\u305f\u30a8\u30e9\u30fc","The file size exceeds the server limit.":"\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u304c\u30b5\u30fc\u30d0\u30fc\u306e\u4e0a\u9650\u3092\u8d85\u3048\u3066\u3044\u307e\u3059\u3002","The total size of FormData is within the acceptable range.":"FormData\u306e\u5408\u8a08\u30b5\u30a4\u30ba\u306f\u5236\u9650\u7bc4\u56f2\u5185\u3067\u3059\u3002","Limit size":"\u4e0a\u9650\u30b5\u30a4\u30ba","Current size":"\u73fe\u5728\u306e\u30b5\u30a4\u30ba","Network response was not OK":"\u901a\u4fe1\u30a8\u30e9\u30fc","HTTP status code":"HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9"}'),
en:Ke},Je=Ke,Jf="en";ne.prototype=Object.create(ma($b).prototype);ne.prototype.constructor=ne;var qc={};qc=function(){function a(q,z){return z&&`${z}::${Wa++}`||q.uidEvent||Wa++}function c(q){let z=a(q);return q.uidEvent=z,nc[z]=nc[z]||{},nc[z]}function d(q,z,I=null){return Object.values(q).find(k=>k.callable===z&&k.delegationSelector===I)}function b(q,z,I){let k="string"==typeof z,u=f(q);return dd.has(u)||(u=q),[k,k?I:z||I,u]}function g(q,z,I,k,u){var w,A;if("string"==typeof z&&q){var [B,F,J]=b(z,
I,k);if(z in Rc){let Q;Q=F;F=function(T){if(!T.relatedTarget||T.relatedTarget!==T.delegateTarget&&!T.delegateTarget.contains(T.relatedTarget))return Q.call(this,T)}}k=c(q);k=k[J]||(k[J]={});var M=d(k,F,B?I:null);if(M)return void(M.oneOff=M.oneOff&&u);z=a(F,z.replace(Tb,""));M=B?(w=F,function ha(T){let W=q.querySelectorAll(I);for(let {target:oa}=T;oa&&oa!==this;oa=oa.parentNode)for(let ra of W)if(ra===oa)return e(T,{delegateTarget:oa}),ha.oneOff&&y.off(q,T.type,I,w),w.apply(oa,[T])}):(A=F,function W(ha){return e(ha,
{delegateTarget:q}),W.oneOff&&y.off(q,ha.type,A),A.apply(q,[ha])});M.delegationSelector=B?I:null;M.callable=F;M.oneOff=u;M.uidEvent=z;k[z]=M;q.addEventListener(J,M,B)}}function p(q,z,I,k,u){(k=d(z[I],k,u))&&(q.removeEventListener(I,k,!!u),delete z[I][k.uidEvent])}function f(q){return Rc[q=q.replace(cb,"")]||q}function e(q,z={}){for(let [I,k]of Object.entries(z))try{q[I]=k}catch(u){Object.defineProperty(q,I,{configurable:!0,get:()=>k})}return q}function m(q){if("true"===q)return!0;if("false"===q)return!1;
if(q===Number(q).toString())return Number(q);if(""===q||"null"===q)return null;if("string"!=typeof q)return q;try{return JSON.parse(decodeURIComponent(q))}catch(z){return q}}function l(q){return q.replace(/[A-Z]/g,z=>`-${z.toLowerCase()}`)}function h(q){return q?(q.nodeName||"").toLowerCase():null}function n(q){return null==q?window:"[object Window]"!==q.toString()?(q=q.ownerDocument)&&q.defaultView||window:q}function r(q){return q instanceof n(q).Element||q instanceof Element}function t(q){return q instanceof
n(q).HTMLElement||q instanceof HTMLElement}function v(q){return"undefined"!=typeof ShadowRoot&&(q instanceof n(q).ShadowRoot||q instanceof ShadowRoot)}function x(q){return q.split("-")[0]}function D(){var q=navigator.userAgentData;return null!=q&&q.brands&&Array.isArray(q.brands)?q.brands.map(function(z){return z.brand+"/"+z.version}).join(" "):navigator.userAgent}function G(){return!/^((?!chrome|android).)*safari/i.test(D())}function N(q,z,I){void 0===z&&(z=!1);void 0===I&&(I=!1);var k=q.getBoundingClientRect(),
u=1,w=1;z&&t(q)&&(u=0<q.offsetWidth&&Ta(k.width)/q.offsetWidth||1,w=0<q.offsetHeight&&Ta(k.height)/q.offsetHeight||1);q=(r(q)?n(q):window).visualViewport;z=!G()&&I;I=(k.left+(z&&q?q.offsetLeft:0))/u;q=(k.top+(z&&q?q.offsetTop:0))/w;u=k.width/u;k=k.height/w;return{width:u,height:k,top:q,right:I+u,bottom:q+k,left:I,x:I,y:q}}function K(q){var z=N(q),I=q.offsetWidth,k=q.offsetHeight;return 1>=Math.abs(z.width-I)&&(I=z.width),1>=Math.abs(z.height-k)&&(k=z.height),{x:q.offsetLeft,y:q.offsetTop,width:I,
height:k}}function P(q,z){var I=z.getRootNode&&z.getRootNode();if(q.contains(z))return!0;if(I&&v(I)){do{if(z&&q.isSameNode(z))return!0;z=z.parentNode||z.host}while(z)}return!1}function L(q){return n(q).getComputedStyle(q)}function ba(q){return((r(q)?q.ownerDocument:q.document)||window.document).documentElement}function X(q){return"html"===h(q)?q:q.assignedSlot||q.parentNode||(v(q)?q.host:null)||ba(q)}function Y(q){return t(q)&&"fixed"!==L(q).position?q.offsetParent:null}function ka(q){for(var z=n(q),
I=Y(q);I&&0<=["table","td","th"].indexOf(h(I))&&"static"===L(I).position;)I=Y(I);if(!I||"html"!==h(I)&&("body"!==h(I)||"static"!==L(I).position)){if(!I)a:{I=/firefox/i.test(D());if(!/Trident/i.test(D())||!t(q)||"fixed"!==L(q).position)for(q=X(q),v(q)&&(q=q.host);t(q)&&0>["html","body"].indexOf(h(q));){var k=L(q);if("none"!==k.transform||"none"!==k.perspective||"paint"===k.contain||-1!==["transform","perspective"].indexOf(k.willChange)||I&&"filter"===k.willChange||I&&k.filter&&"none"!==k.filter){I=
q;break a}q=q.parentNode}I=null}z=I||z}return z}function Aa(q){return 0<=["top","bottom"].indexOf(q)?"x":"y"}function Ga(q){return Object.assign({},{top:0,right:0,bottom:0,left:0},q)}function U(q,z){return z.reduce(function(I,k){return I[k]=q,I},{})}function ya(q){return q.split("-")[1]}function pa(q){var z,I=q.popper,k=q.popperRect,u=q.placement,w=q.variation,A=q.offsets,B=q.position,F=q.gpuAcceleration,J=q.adaptive,M=q.roundOffsets,Q=q.isFixed;q=A.x;q=void 0===q?0:q;var T=A.y;T=void 0===T?0:T;T=
"function"==typeof M?M({x:q,y:T}):{x:q,y:T};q=T.x;T=T.y;var ha=A.hasOwnProperty("x");A=A.hasOwnProperty("y");var W="left",oa="top",ra=window;if(J){var va=ka(I),Ua="clientHeight",Qa="clientWidth";va===n(I)&&"static"!==L(va=ba(I)).position&&"absolute"===B&&(Ua="scrollHeight",Qa="scrollWidth");("top"===u||("left"===u||"right"===u)&&"end"===w)&&(oa="bottom",T-=(Q&&va===ra&&ra.visualViewport?ra.visualViewport.height:va[Ua])-k.height,T*=F?1:-1);"left"!==u&&("top"!==u&&"bottom"!==u||"end"!==w)||(W="right",
q-=(Q&&va===ra&&ra.visualViewport?ra.visualViewport.width:va[Qa])-k.width,q*=F?1:-1)}var wa,jb,pb,Va,Sa,Oa;k=Object.assign({position:B},J&&ob);M=!0===M?(wa={x:q,y:T},jb=n(I),pb=wa.x,Va=wa.y,{x:Ta(pb*(Sa=jb.devicePixelRatio||1))/Sa||0,y:Ta(Va*Sa)/Sa||0}):{x:q,y:T};return q=M.x,T=M.y,F?Object.assign({},k,((Oa={})[oa]=A?"0":"",Oa[W]=ha?"0":"",Oa.transform=1>=(ra.devicePixelRatio||1)?"translate("+q+"px, "+T+"px)":"translate3d("+q+"px, "+T+"px, 0)",Oa)):Object.assign({},k,((z={})[oa]=A?T+"px":"",z[W]=
ha?q+"px":"",z.transform="",z))}function qb(q){return q.replace(/left|right|bottom|top/g,function(z){return Ze[z]})}function $a(q){return q.replace(/start|end/g,function(z){return Jd[z]})}function Gb(q){q=n(q);return{scrollLeft:q.pageXOffset,scrollTop:q.pageYOffset}}function Fb(q){return N(ba(q)).left+Gb(q).scrollLeft}function Ka(q){q=L(q);return/auto|scroll|overlay|hidden/.test(q.overflow+q.overflowY+q.overflowX)}function Na(q,z){void 0===z&&(z=[]);var I,k=function A(w){return 0<=["html","body",
"#document"].indexOf(h(w))?w.ownerDocument.body:t(w)&&Ka(w)?w:A(X(w))}(q);q=k===(null==(I=q.ownerDocument)?void 0:I.body);I=n(k);k=q?[I].concat(I.visualViewport||[],Ka(k)?k:[]):k;z=z.concat(k);return q?z:z.concat(Na(X(k)))}function ja(q){return Object.assign({},q,{left:q.x,top:q.y,right:q.x+q.width,bottom:q.y+q.height})}function Fa(q,z,I){var k,u,w,A,B,F,J;if("viewport"===z){z=n(q);var M=ba(q);z=z.visualViewport;var Q=M.clientWidth;M=M.clientHeight;var T=k=0;z&&(Q=z.width,M=z.height,((u=G())||!u&&
"fixed"===I)&&(k=z.offsetLeft,T=z.offsetTop));q={width:Q,height:M,x:k+Fb(q),y:T};I=ja(q)}else I=r(z)?((Q=N(z,!1,"fixed"===I)).top=Q.top+z.clientTop,Q.left+=z.clientLeft,Q.bottom=Q.top+z.clientHeight,Q.right=Q.left+z.clientWidth,Q.width=z.clientWidth,Q.height=z.clientHeight,Q.x=Q.left,Q.y=Q.top,Q):ja((M=ba(q),T=ba(M),u=Gb(M),w=null==(k=M.ownerDocument)?void 0:k.body,A=Ea(T.scrollWidth,T.clientWidth,w?w.scrollWidth:0,w?w.clientWidth:0),B=Ea(T.scrollHeight,T.clientHeight,w?w.scrollHeight:0,w?w.clientHeight:
0),F=-u.scrollLeft+Fb(M),J=-u.scrollTop,"rtl"===L(w||T).direction&&(F+=Ea(T.clientWidth,w?w.clientWidth:0)-A),{width:A,height:B,x:F,y:J}));return I}function sa(q){var z=q.reference,I=q.element,k=(q=q.placement)?x(q):null;q=q?ya(q):null;var u=z.x+z.width/2-I.width/2;var w=z.y+z.height/2-I.height/2;switch(k){case "top":u={x:u,y:z.y-I.height};break;case "bottom":u={x:u,y:z.y+z.height};break;case "right":u={x:z.x+z.width,y:w};break;case "left":u={x:z.x-I.width,y:w};break;default:u={x:z.x,y:z.y}}k=k?Aa(k):
null;if(null!=k)switch(w="y"===k?"height":"width",q){case "start":u[k]-=z[w]/2-I[w]/2;break;case "end":u[k]+=z[w]/2-I[w]/2}return u}function fa(q,z){void 0===z&&(z={});var I,k,u,w,A,B,F,J,M=z;z=M.placement;z=void 0===z?q.placement:z;var Q=M.strategy,T=void 0===Q?q.strategy:Q,ha=M.boundary,W=M.rootBoundary;Q=M.elementContext;Q=void 0===Q?"popper":Q;var oa=M.altBoundary;M=M.padding;M=void 0===M?0:M;M=Ga("number"!=typeof M?M:U(M,gb));var ra=q.rects.popper;oa=q.elements[void 0!==oa&&oa?"popper"===Q?"reference":
"popper":Q];oa=(I=r(oa)?oa:oa.contextElement||ba(q.elements.popper),k=void 0===ha?"clippingParents":ha,u=void 0===W?"viewport":W,F=(B=[].concat("clippingParents"===k?(w=Na(X(I)),r(A=0<=["absolute","fixed"].indexOf(L(I).position)&&t(I)?ka(I):I)?w.filter(function(Qa){return r(Qa)&&P(Qa,A)&&"body"!==h(Qa)}):[]):[].concat(k),[u]))[0],(J=B.reduce(function(Qa,wa){wa=Fa(I,wa,T);return Qa.top=Ea(wa.top,Qa.top),Qa.right=Pa(wa.right,Qa.right),Qa.bottom=Pa(wa.bottom,Qa.bottom),Qa.left=Ea(wa.left,Qa.left),Qa},
Fa(I,F,T))).width=J.right-J.left,J.height=J.bottom-J.top,J.x=J.left,J.y=J.top,J);k=N(q.elements.reference);u=sa({reference:k,element:ra,strategy:"absolute",placement:z});u=ja(Object.assign({},ra,u));k="popper"===Q?u:k;var va={top:oa.top-k.top+M.top,bottom:k.bottom-oa.bottom+M.bottom,left:oa.left-k.left+M.left,right:k.right-oa.right+M.right};q=q.modifiersData.offset;if("popper"===Q&&q){var Ua=q[z];Object.keys(va).forEach(function(Qa){var wa=0<=["right","bottom"].indexOf(Qa)?1:-1,jb=0<=["top","bottom"].indexOf(Qa)?
"y":"x";va[Qa]+=Ua[jb]*wa})}return va}function La(q,z,I){return void 0===I&&(I={x:0,y:0}),{top:q.top-z.height-I.y,right:q.right-z.width+I.x,bottom:q.bottom-z.height+I.y,left:q.left-z.width-I.x}}function qa(q){return["top","right","bottom","left"].some(function(z){return 0<=q[z]})}function Ra(){for(var q=arguments.length,z=Array(q),I=0;I<q;I++)z[I]=arguments[I];return!z.some(function(k){return!(k&&"function"==typeof k.getBoundingClientRect)})}function Ia(q){void 0===q&&(q={});var z=q.defaultModifiers,
I=void 0===z?[]:z;q=q.defaultOptions;var k=void 0===q?ve:q;return function(u,w,A){function B(){Q.forEach(function(W){return W()});Q=[]}void 0===A&&(A=k);var F,J,M={placement:"bottom",orderedModifiers:[],options:Object.assign({},ve,k),modifiersData:{},elements:{reference:u,popper:w},attributes:{},styles:{}},Q=[],T=!1,ha={state:M,setOptions:function(W){W="function"==typeof W?W(M.options):W;B();M.options=Object.assign({},k,M.options,W);M.scrollParents={reference:r(u)?Na(u):u.contextElement?Na(u.contextElement):
[],popper:Na(w)};var oa,ra,va,Ua,Qa;W=(oa=Object.keys(Qa=[].concat(I,M.options.modifiers).reduce(function(wa,jb){var pb=wa[jb.name];return wa[jb.name]=pb?Object.assign({},pb,jb,{options:Object.assign({},pb.options,jb.options),data:Object.assign({},pb.data,jb.data)}):jb,wa},{})).map(function(wa){return Qa[wa]}),ra=new Map,va=new Set,Ua=[],oa.forEach(function(wa){ra.set(wa.name,wa)}),oa.forEach(function(wa){va.has(wa.name)||function Va(pb){va.add(pb.name);[].concat(pb.requires||[],pb.requiresIfExists||
[]).forEach(function(Sa){va.has(Sa)||(Sa=ra.get(Sa))&&Va(Sa)});Ua.push(pb)}(wa)}),Bb.reduce(function(wa,jb){return wa.concat(Ua.filter(function(pb){return pb.phase===jb}))},[]));return M.orderedModifiers=W.filter(function(wa){return wa.enabled}),M.orderedModifiers.forEach(function(wa){var jb=wa.name,pb=wa.options;wa=wa.effect;"function"==typeof wa&&(jb=wa({state:M,name:jb,instance:ha,options:void 0===pb?{}:pb}),Q.push(jb||function(){}))}),ha.update()},forceUpdate:function(){if(!T){var W=M.elements,
oa=W.reference;W=W.popper;if(Ra(oa,W)){M.rects={reference:(ra=ka(W),va="fixed"===M.options.strategy,jb=t(ra),pb=t(ra)&&(Qa=Ta((Ua=ra.getBoundingClientRect()).width)/ra.offsetWidth||1,wa=Ta(Ua.height)/ra.offsetHeight||1,1!==Qa||1!==wa),Va=ba(ra),Sa=N(oa,pb,va),Oa={scrollLeft:0,scrollTop:0},lb={x:0,y:0},(jb||!jb&&!va)&&(("body"!==h(ra)||Ka(Va))&&(Oa=ra!==n(ra)&&t(ra)?{scrollLeft:ra.scrollLeft,scrollTop:ra.scrollTop}:Gb(ra)),t(ra)?((lb=N(ra,!0)).x+=ra.clientLeft,lb.y+=ra.clientTop):Va&&(lb.x=Fb(Va))),
{x:Sa.left+Oa.scrollLeft-lb.x,y:Sa.top+Oa.scrollTop-lb.y,width:Sa.width,height:Sa.height}),popper:K(W)};M.reset=!1;M.placement=M.options.placement;M.orderedModifiers.forEach(function(Mb){return M.modifiersData[Mb.name]=Object.assign({},Mb.data)});var ra,va,Ua,Qa,wa,jb,pb,Va,Sa,Oa,lb;for(oa=0;oa<M.orderedModifiers.length;oa++)!0!==M.reset?(va=M.orderedModifiers[oa],ra=va.fn,Ua=va.options,Ua=void 0===Ua?{}:Ua,va=va.name,"function"==typeof ra&&(M=ra({state:M,options:Ua,name:va,instance:ha})||M)):(M.reset=
!1,oa=-1)}}},update:(F=function(){return new Promise(function(W){ha.forceUpdate();W(M)})},function(){return J||=new Promise(function(W){Promise.resolve().then(function(){J=void 0;W(F())})}),J}),destroy:function(){B();T=!0}};return Ra(u,w)?(ha.setOptions(A).then(function(W){!T&&A.onFirstUpdate&&A.onFirstUpdate(W)}),ha):ha}}let hb=new Map,Yb={set(q,z,I){hb.has(q)||hb.set(q,new Map);q=hb.get(q);q.has(z)||0===q.size?q.set(z,I):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(q.keys())[0]}.`)},
get:(q,z)=>hb.has(q)&&hb.get(q).get(z)||null,remove(q,z){if(hb.has(q)){var I=hb.get(q);I.delete(z);0===I.size&&hb.delete(q)}}},ic=q=>(q&&window.CSS&&window.CSS.escape&&(q=q.replace(/#([^\s"#']+)/g,(z,I)=>`#${CSS.escape(I)}`)),q),Qb=q=>!(!q||"object"!=typeof q)&&(void 0!==q.jquery&&(q=q[0]),void 0!==q.nodeType),Cb=q=>Qb(q)?q.jquery?q[0]:q:"string"==typeof q&&0<q.length?document.querySelector(ic(q)):null,Kb=q=>{if(!Qb(q)||0===q.getClientRects().length)return!1;let z="visible"===getComputedStyle(q).getPropertyValue("visibility"),
I=q.closest("details:not([open])");return I?I!==q&&((q=q.closest("summary"))&&q.parentNode!==I||null===q)?!1:z:z},yb=q=>!q||q.nodeType!==Node.ELEMENT_NODE||!!q.classList.contains("disabled")||(void 0!==q.disabled?q.disabled:q.hasAttribute("disabled")&&"false"!==q.getAttribute("disabled")),xb=q=>document.documentElement.attachShadow?"function"==typeof q.getRootNode?(q=q.getRootNode(),q instanceof ShadowRoot?q:null):q instanceof ShadowRoot?q:q.parentNode?xb(q.parentNode):null:null,fb=()=>{},ib=q=>{q.offsetHeight},
dc=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,mb=[],Nb=q=>{var z=()=>{let I=dc();if(I){let k=q.NAME,u=I.fn[k];I.fn[k]=q.jQueryInterface;I.fn[k].Constructor=q;I.fn[k].noConflict=()=>(I.fn[k]=u,q.jQueryInterface)}};"loading"===document.readyState?(mb.length||document.addEventListener("DOMContentLoaded",()=>{for(let I of mb)I()}),mb.push(z)):z()},Ob=(q,z=[],I=q)=>"function"==typeof q?q(...z):I,vc=(q,z,I=!0)=>{if(!I)return void Ob(q);I=(w=>{if(!w)return 0;let {transitionDuration:A,
transitionDelay:B}=window.getComputedStyle(w);w=Number.parseFloat(A);let F=Number.parseFloat(B);return w||F?(A=A.split(",")[0],B=B.split(",")[0],1E3*(Number.parseFloat(A)+Number.parseFloat(B))):0})(z)+5;let k=!1,u=({target:w})=>{w===z&&(k=!0,z.removeEventListener("transitionend",u),Ob(q))};z.addEventListener("transitionend",u);setTimeout(()=>{k||z.dispatchEvent(new Event("transitionend"))},I)},cc=(q,z,I,k)=>{let u=q.length;z=q.indexOf(z);return-1===z?!I&&k?q[u-1]:q[0]:(z+=I?1:-1,k&&(z=(z+u)%u),q[Math.max(0,
Math.min(z,u-1))])},Tb=/[^.]*(?=\..*)\.|.*/,cb=/\..*/,db=/::\d+$/,nc={},Wa=1,Rc={mouseenter:"mouseover",mouseleave:"mouseout"},dd=new Set("click dblclick mouseup mousedown contextmenu mousewheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange touchstart touchmove touchend touchcancel pointerdown pointermove pointerup pointerleave pointercancel gesturestart gesturechange gestureend focus blur change reset select submit focusin focusout load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll".split(" ")),
y={on(q,z,I,k){g(q,z,I,k,!1)},one(q,z,I,k){g(q,z,I,k,!0)},off(q,z,I,k){if("string"==typeof z&&q){var [u,w,A]=b(z,I,k);k=A!==z;var B=c(q),F=B[A]||{},J=z.startsWith(".");if(void 0===w){if(J)for(var M of Object.keys(B)){I=z.slice(1);for(let [Q,T]of Object.entries(B[M]||{}))Q.includes(I)&&p(q,B,M,T.callable,T.delegationSelector)}for(let [Q,T]of Object.entries(F))M=Q.replace(db,""),k&&!z.includes(M)||p(q,B,A,T.callable,T.delegationSelector)}else Object.keys(F).length&&p(q,B,A,w,u?I:null)}},trigger(q,z,
I){if("string"!=typeof z||!q)return null;let k=dc(),u=null,w=!0,A=!0,B=!1;z!==f(z)&&k&&(u=k.Event(z,I),k(q).trigger(u),w=!u.isPropagationStopped(),A=!u.isImmediatePropagationStopped(),B=u.isDefaultPrevented());z=e(new Event(z,{bubbles:w,cancelable:!0}),I);return B&&z.preventDefault(),A&&q.dispatchEvent(z),z.defaultPrevented&&u&&u.preventDefault(),z}},wc={setDataAttribute(q,z,I){q.setAttribute(`data-bs-${l(z)}`,I)},removeDataAttribute(q,z){q.removeAttribute(`data-bs-${l(z)}`)},getDataAttributes(q){if(!q)return{};
let z={};for(let I of Object.keys(q.dataset).filter(k=>k.startsWith("bs")&&!k.startsWith("bsConfig"))){let k=I.replace(/^bs/,"");z[k=k.charAt(0).toLowerCase()+k.slice(1,k.length)]=m(q.dataset[I])}return z},getDataAttribute:(q,z)=>m(q.getAttribute(`data-bs-${l(z)}`))};class Mc{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw Error('You have to implement the static method "NAME", for each component!');}_getConfig(q){return q=this._mergeConfigObj(q),q=this._configAfterMerge(q),
this._typeCheckConfig(q),q}_configAfterMerge(q){return q}_mergeConfigObj(q,z){let I=Qb(z)?wc.getDataAttribute(z,"config"):{};return{...this.constructor.Default,...("object"==typeof I?I:{}),...(Qb(z)?wc.getDataAttributes(z):{}),...("object"==typeof q?q:{})}}_typeCheckConfig(q,z=this.constructor.DefaultType){for(let [I,k]of Object.entries(z))if(z=q[I],z=Qb(z)?"element":null==z?`${z}`:Object.prototype.toString.call(z).match(/\s([a-z]+)/i)[1].toLowerCase(),!(new RegExp(k)).test(z))throw TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${I}" provided type "${z}" but expected type "${k}".`);
}}class jc extends Mc{dispose(){for(let q of(Yb.remove(this._element,this.constructor.DATA_KEY),y.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this)))this[q]=null}_queueCallback(q,z,I=!0){vc(q,z,I)}_getConfig(q){return q=this._mergeConfigObj(q,this._element),q=this._configAfterMerge(q),this._typeCheckConfig(q),q}static getInstance(q){return Yb.get(Cb(q),this.DATA_KEY)}static getOrCreateInstance(q,z={}){return this.getInstance(q)||new this(q,"object"==typeof z?z:null)}static get VERSION(){return"5.3.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(q){return`${q}${this.EVENT_KEY}`}constructor(q,
z){super();(q=Cb(q))&&(this._element=q,this._config=this._getConfig(z),Yb.set(this._element,this.constructor.DATA_KEY,this))}}let Fc=q=>{let z=q.getAttribute("data-bs-target");if(!z||"#"===z){q=q.getAttribute("href");if(!q||!q.includes("#")&&!q.startsWith("."))return null;q.includes("#")&&!q.startsWith("#")&&(q=`#${q.split("#")[1]}`);z=q&&"#"!==q?q.trim():null}return z?z.split(",").map(I=>ic(I)).join(","):null},xa={find:(q,z=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(z,
q)),findOne:(q,z=document.documentElement)=>Element.prototype.querySelector.call(z,q),children:(q,z)=>[].concat(...q.children).filter(I=>I.matches(z)),parents(q,z){let I=[];for(q=q.parentNode.closest(z);q;)I.push(q),q=q.parentNode.closest(z);return I},prev(q,z){for(q=q.previousElementSibling;q;){if(q.matches(z))return[q];q=q.previousElementSibling}return[]},next(q,z){for(q=q.nextElementSibling;q;){if(q.matches(z))return[q];q=q.nextElementSibling}return[]},focusableChildren(q){let z='a button input textarea select details [tabindex] [contenteditable="true"]'.split(" ").map(I=>
`${I}:not([tabindex^="-"])`).join(",");return this.find(z,q).filter(I=>!yb(I)&&Kb(I))},getSelectorFromElement(q){return(q=Fc(q))&&xa.findOne(q)?q:null},getElementFromSelector(q){return(q=Fc(q))?xa.findOne(q):null},getMultipleElementsFromSelector(q){return(q=Fc(q))?xa.find(q):[]}},Vb=(q,z="hide")=>{let I=q.NAME;y.on(document,`click.dismiss${q.EVENT_KEY}`,`[data-bs-dismiss="${I}"]`,function(k){(["A","AREA"].includes(this.tagName)&&k.preventDefault(),yb(this))||(k=xa.getElementFromSelector(this)||this.closest(`.${I}`),
q.getOrCreateInstance(k)[z]())})};class xc extends jc{static get NAME(){return"alert"}close(){if(!y.trigger(this._element,"close.bs.alert").defaultPrevented){this._element.classList.remove("show");var q=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,q)}}_destroyElement(){this._element.remove();y.trigger(this._element,"closed.bs.alert");this.dispose()}static jQueryInterface(q){return this.each(function(){let z=xc.getOrCreateInstance(this);if("string"==
typeof q){if(void 0===z[q]||q.startsWith("_")||"constructor"===q)throw TypeError(`No method named "${q}"`);z[q](this)}})}}Vb(xc,"close");Nb(xc);class C extends jc{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(q){return this.each(function(){let z=C.getOrCreateInstance(this);"toggle"===q&&z[q]()})}}y.on(document,"click.bs.button.data-api",'[data-bs-toggle="button"]',q=>{q.preventDefault();q=q.target.closest('[data-bs-toggle="button"]');
C.getOrCreateInstance(q).toggle()});Nb(C);let R={endCallback:null,leftCallback:null,rightCallback:null},da={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ea extends Mc{static get Default(){return R}static get DefaultType(){return da}static get NAME(){return"swipe"}dispose(){y.off(this._element,".bs.swipe")}_start(q){this._supportPointerEvents?this._eventIsPointerPenTouch(q)&&(this._deltaX=q.clientX):this._deltaX=q.touches[0].clientX}_end(q){this._eventIsPointerPenTouch(q)&&
(this._deltaX=q.clientX-this._deltaX);this._handleSwipe();Ob(this._config.endCallback)}_move(q){this._deltaX=q.touches&&1<q.touches.length?0:q.touches[0].clientX-this._deltaX}_handleSwipe(){var q=Math.abs(this._deltaX);40>=q||(q/=this._deltaX,this._deltaX=0,q&&Ob(0<q?this._config.rightCallback:this._config.leftCallback))}_initEvents(){this._supportPointerEvents?(y.on(this._element,"pointerdown.bs.swipe",q=>this._start(q)),y.on(this._element,"pointerup.bs.swipe",q=>this._end(q)),this._element.classList.add("pointer-event")):
(y.on(this._element,"touchstart.bs.swipe",q=>this._start(q)),y.on(this._element,"touchmove.bs.swipe",q=>this._move(q)),y.on(this._element,"touchend.bs.swipe",q=>this._end(q)))}_eventIsPointerPenTouch(q){return this._supportPointerEvents&&("pen"===q.pointerType||"touch"===q.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||0<navigator.maxTouchPoints}constructor(q,z){super();(this._element=q)&&ea.isSupported()&&(this._config=this._getConfig(z),this._deltaX=0,this._supportPointerEvents=
!!window.PointerEvent,this._initEvents())}}let E={ArrowLeft:"right",ArrowRight:"left"},O={interval:5E3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Z={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class la extends jc{static get Default(){return O}static get DefaultType(){return Z}static get NAME(){return"carousel"}next(){this._slide("next")}nextWhenVisible(){!document.hidden&&Kb(this._element)&&this.next()}prev(){this._slide("prev")}pause(){this._isSliding&&
this._element.dispatchEvent(new Event("transitionend"));this._clearInterval()}cycle(){this._clearInterval();this._updateInterval();this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?y.one(this._element,"slid.bs.carousel",()=>this.cycle()):this.cycle())}to(q){let z=this._getItems();if(!(q>z.length-1||0>q)){if(this._isSliding)return void y.one(this._element,"slid.bs.carousel",()=>this.to(q));var I=this._getItemIndex(this._getActive());
I!==q&&this._slide(q>I?"next":"prev",z[q])}}dispose(){this._swipeHelper&&this._swipeHelper.dispose();super.dispose()}_configAfterMerge(q){return q.defaultInterval=q.interval,q}_addEventListeners(){this._config.keyboard&&y.on(this._element,"keydown.bs.carousel",q=>this._keydown(q));"hover"===this._config.pause&&(y.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),y.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle()));this._config.touch&&ea.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(let q of xa.find(".carousel-item img",
this._element))y.on(q,"dragstart.bs.carousel",z=>z.preventDefault());this._swipeHelper=new ea(this._element,{leftCallback:()=>this._slide(this._directionToOrder("left")),rightCallback:()=>this._slide(this._directionToOrder("right")),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}})}_keydown(q){if(!/input|textarea/i.test(q.target.tagName)){var z=E[q.key];
z&&(q.preventDefault(),this._slide(this._directionToOrder(z)))}}_getItemIndex(q){return this._getItems().indexOf(q)}_setActiveIndicatorElement(q){if(this._indicatorsElement){var z=xa.findOne(".active",this._indicatorsElement);z.classList.remove("active");z.removeAttribute("aria-current");(q=xa.findOne(`[data-bs-slide-to="${q}"]`,this._indicatorsElement))&&(q.classList.add("active"),q.setAttribute("aria-current","true"))}}_updateInterval(){var q=this._activeElement||this._getActive();q&&(q=Number.parseInt(q.getAttribute("data-bs-interval"),
10),this._config.interval=q||this._config.defaultInterval)}_slide(q,z=null){if(!this._isSliding){var I=this._getActive(),k="next"===q,u=z||cc(this._getItems(),I,k,this._config.wrap);if(u!==I){var w=this._getItemIndex(u),A=J=>y.trigger(this._element,J,{relatedTarget:u,direction:this._orderToDirection(q),from:this._getItemIndex(I),to:w});if(!A("slide.bs.carousel").defaultPrevented&&I&&u){z=!!this._interval;this.pause();this._isSliding=!0;this._setActiveIndicatorElement(w);this._activeElement=u;var B=
k?"carousel-item-start":"carousel-item-end",F=k?"carousel-item-next":"carousel-item-prev";u.classList.add(F);u.offsetHeight;I.classList.add(B);u.classList.add(B);this._queueCallback(()=>{u.classList.remove(B,F);u.classList.add("active");I.classList.remove("active",F,B);this._isSliding=!1;A("slid.bs.carousel")},I,this._isAnimated());z&&this.cycle()}}}}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return xa.findOne(".active.carousel-item",this._element)}_getItems(){return xa.find(".carousel-item",
this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(q){return"rtl"===document.documentElement.dir?"left"===q?"prev":"next":"left"===q?"next":"prev"}_orderToDirection(q){return"rtl"===document.documentElement.dir?"prev"===q?"left":"right":"prev"===q?"right":"left"}static jQueryInterface(q){return this.each(function(){let z=la.getOrCreateInstance(this,q);if("number"!=typeof q){if("string"==typeof q){if(void 0===z[q]||q.startsWith("_")||
"constructor"===q)throw TypeError(`No method named "${q}"`);z[q]()}}else z.to(q)})}constructor(q,z){super(q,z);this._activeElement=this._interval=null;this._isSliding=!1;this._swipeHelper=this.touchTimeout=null;this._indicatorsElement=xa.findOne(".carousel-indicators",this._element);this._addEventListeners();"carousel"===this._config.ride&&this.cycle()}}y.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(q){var z=xa.getElementFromSelector(this);if(z&&z.classList.contains("carousel"))return q.preventDefault(),
q=la.getOrCreateInstance(z),z=this.getAttribute("data-bs-slide-to"),z?q.to(z):"next"===wc.getDataAttribute(this,"slide")?q.next():q.prev(),void q._maybeEnableCycle()});y.on(window,"load.bs.carousel.data-api",()=>{for(let q of xa.find('[data-bs-ride="carousel"]'))la.getOrCreateInstance(q)});Nb(la);let za={parent:null,toggle:!0},ua={parent:"(null|element)",toggle:"boolean"};class ab extends jc{static get Default(){return za}static get DefaultType(){return ua}static get NAME(){return"collapse"}toggle(){this._isShown()?
this.hide():this.show()}show(){if(!this._isTransitioning&&!this._isShown()){var q=[];if(!(this._config.parent&&(q=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(I=>I!==this._element).map(I=>ab.getOrCreateInstance(I,{toggle:!1}))),q.length&&q[0]._isTransitioning||y.trigger(this._element,"show.bs.collapse").defaultPrevented)){for(let I of q)I.hide();var z=this._getDimension();this._element.classList.remove("collapse");this._element.classList.add("collapsing");this._element.style[z]=
0;this._addAriaAndCollapsedClass(this._triggerArray,!0);this._isTransitioning=!0;q=`scroll${z[0].toUpperCase()+z.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse","show");this._element.style[z]="";y.trigger(this._element,"shown.bs.collapse")},this._element,!0);this._element.style[z]=`${this._element[q]}px`}}}hide(){if(!this._isTransitioning&&this._isShown()&&!y.trigger(this._element,"hide.bs.collapse").defaultPrevented){var q=
this._getDimension();for(let z of(this._element.style[q]=`${this._element.getBoundingClientRect()[q]}px`,ib(this._element),this._element.classList.add("collapsing"),this._element.classList.remove("collapse","show"),this._triggerArray)){let I=xa.getElementFromSelector(z);I&&!this._isShown(I)&&this._addAriaAndCollapsedClass([z],!1)}this._isTransitioning=!0;this._element.style[q]="";this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse");
y.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}}_isShown(q=this._element){return q.classList.contains("show")}_configAfterMerge(q){return q.toggle=!!q.toggle,q.parent=Cb(q.parent),q}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(this._config.parent)for(let q of this._getFirstLevelChildren('[data-bs-toggle="collapse"]')){let z=xa.getElementFromSelector(q);z&&this._addAriaAndCollapsedClass([q],this._isShown(z))}}_getFirstLevelChildren(q){let z=
xa.find(":scope .collapse .collapse",this._config.parent);return xa.find(q,this._config.parent).filter(I=>!z.includes(I))}_addAriaAndCollapsedClass(q,z){if(q.length)for(let I of q)I.classList.toggle("collapsed",!z),I.setAttribute("aria-expanded",z)}static jQueryInterface(q){let z={};return"string"==typeof q&&/show|hide/.test(q)&&(z.toggle=!1),this.each(function(){let I=ab.getOrCreateInstance(this,z);if("string"==typeof q){if(void 0===I[q])throw TypeError(`No method named "${q}"`);I[q]()}})}constructor(q,
z){for(let I of(super(q,z),this._isTransitioning=!1,this._triggerArray=[],xa.find('[data-bs-toggle="collapse"]')))q=xa.getSelectorFromElement(I),z=xa.find(q).filter(k=>k===this._element),null!==q&&z.length&&this._triggerArray.push(I);this._initializeChildren();this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown());this._config.toggle&&this.toggle()}}y.on(document,"click.bs.collapse.data-api",'[data-bs-toggle="collapse"]',function(q){for(let z of(("A"===q.target.tagName||
q.delegateTarget&&"A"===q.delegateTarget.tagName)&&q.preventDefault(),xa.getMultipleElementsFromSelector(this)))ab.getOrCreateInstance(z,{toggle:!1}).toggle()});Nb(ab);var gb=["top","bottom","right","left"],sb=gb.reduce(function(q,z){return q.concat([z+"-start",z+"-end"])},[]),Da=[].concat(gb,["auto"]).reduce(function(q,z){return q.concat([z,z+"-start",z+"-end"])},[]),Bb="beforeRead read afterRead beforeMain main afterMain beforeWrite write afterWrite".split(" ");let kc={name:"applyStyles",enabled:!0,
phase:"write",fn:function(q){var z=q.state;Object.keys(z.elements).forEach(function(I){var k=z.styles[I]||{},u=z.attributes[I]||{},w=z.elements[I];t(w)&&h(w)&&(Object.assign(w.style,k),Object.keys(u).forEach(function(A){var B=u[A];!1===B?w.removeAttribute(A):w.setAttribute(A,!0===B?"":B)}))})},effect:function(q){var z=q.state,I={popper:{position:z.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(z.elements.popper.style,I.popper),z.styles=
I,z.elements.arrow&&Object.assign(z.elements.arrow.style,I.arrow),function(){Object.keys(z.elements).forEach(function(k){var u=z.elements[k],w=z.attributes[k]||{};k=Object.keys(z.styles.hasOwnProperty(k)?z.styles[k]:I[k]).reduce(function(A,B){return A[B]="",A},{});t(u)&&h(u)&&(Object.assign(u.style,k),Object.keys(w).forEach(function(A){u.removeAttribute(A)}))})}},requires:["computeStyles"]};var Ea=Math.max,Pa=Math.min,Ta=Math.round;let kb={name:"arrow",enabled:!0,phase:"main",fn:function(q){var z,
I=q.state,k=q.name,u=q.options,w=I.elements.arrow,A=I.modifiersData.popperOffsets,B=x(I.placement);q=Aa(B);B=0<=["left","right"].indexOf(B)?"height":"width";if(w&&A){var F;u=(F=u.padding,Ga("number"!=typeof(F="function"==typeof F?F(Object.assign({},I.rects,{placement:I.placement})):F)?F:U(F,gb)));F=K(w);var J="y"===q?"top":"left",M="y"===q?"bottom":"right",Q=I.rects.reference[B]+I.rects.reference[q]-A[q]-I.rects.popper[B];A=A[q]-I.rects.reference[q];w=(w=ka(w))?"y"===q?w.clientHeight||0:w.clientWidth||
0:0;A=w/2-F[B]/2+(Q/2-A/2);B=Ea(u[J],Pa(A,w-F[B]-u[M]));I.modifiersData[k]=((z={})[q]=B,z.centerOffset=B-A,z)}},effect:function(q){var z=q.state;q=q.options.element;q=void 0===q?"[data-popper-arrow]":q;null!=q&&("string"!=typeof q||(q=z.elements.popper.querySelector(q)))&&P(z.elements.popper,q)&&(z.elements.arrow=q)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};var ob={top:"auto",right:"auto",bottom:"auto",left:"auto"};let Zb={name:"computeStyles",enabled:!0,phase:"beforeWrite",
fn:function(q){var z=q.state,I=q.options,k=I.gpuAcceleration;q=I.adaptive;I=I.roundOffsets;I=void 0===I||I;k={placement:x(z.placement),variation:ya(z.placement),popper:z.elements.popper,popperRect:z.rects.popper,gpuAcceleration:void 0===k||k,isFixed:"fixed"===z.options.strategy};null!=z.modifiersData.popperOffsets&&(z.styles.popper=Object.assign({},z.styles.popper,pa(Object.assign({},k,{offsets:z.modifiersData.popperOffsets,position:z.options.strategy,adaptive:void 0===q||q,roundOffsets:I}))));null!=
z.modifiersData.arrow&&(z.styles.arrow=Object.assign({},z.styles.arrow,pa(Object.assign({},k,{offsets:z.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:I}))));z.attributes.popper=Object.assign({},z.attributes.popper,{"data-popper-placement":z.placement})},data:{}};var Nc={passive:!0};let ud={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(q){var z=q.state,I=q.instance;q=q.options;var k=q.scroll,u=void 0===k||k;q=q.resize;var w=void 0===q||q,A=n(z.elements.popper),
B=[].concat(z.scrollParents.reference,z.scrollParents.popper);return u&&B.forEach(function(F){F.addEventListener("scroll",I.update,Nc)}),w&&A.addEventListener("resize",I.update,Nc),function(){u&&B.forEach(function(F){F.removeEventListener("scroll",I.update,Nc)});w&&A.removeEventListener("resize",I.update,Nc)}},data:{}};var Ze={left:"right",right:"left",bottom:"top",top:"bottom"},Jd={start:"end",end:"start"};let we={name:"flip",enabled:!0,phase:"main",fn:function(q){var z=q.state,I=q.options;q=q.name;
if(!z.modifiersData[q]._skip){var k=I.mainAxis;k=void 0===k||k;var u=I.altAxis;u=void 0===u||u;var w=I.fallbackPlacements,A=I.padding,B=I.boundary,F=I.rootBoundary,J=I.altBoundary,M=I.flipVariations,Q=void 0===M||M,T=I.allowedAutoPlacements;I=z.options.placement;M=x(I);w=w||(M!==I&&Q?function(Va){if("auto"===x(Va))return[];var Sa=qb(Va);return[$a(Va),Sa,$a(Sa)]}(I):[qb(I)]);var ha=[I].concat(w).reduce(function(Va,Sa){var Oa,lb,Mb,Jc,Xb,Hb,rc,Sc,ad,yc,ac,gc;return Va.concat("auto"===x(Sa)?(lb=(Oa=
{placement:Sa,boundary:B,rootBoundary:F,padding:A,flipVariations:Q,allowedAutoPlacements:T}).placement,Mb=Oa.boundary,Jc=Oa.rootBoundary,Xb=Oa.padding,Hb=Oa.flipVariations,Sc=void 0===(rc=Oa.allowedAutoPlacements)?Da:rc,0===(ac=(yc=(ad=ya(lb))?Hb?sb:sb.filter(function(mc){return ya(mc)===ad}):gb).filter(function(mc){return 0<=Sc.indexOf(mc)})).length&&(ac=yc),Object.keys(gc=ac.reduce(function(mc,Kc){return mc[Kc]=fa(z,{placement:Kc,boundary:Mb,rootBoundary:Jc,padding:Xb})[x(Kc)],mc},{})).sort(function(mc,
Kc){return gc[mc]-gc[Kc]})):Sa)},[]);I=z.rects.reference;w=z.rects.popper;var W=new Map;M=!0;for(var oa=ha[0],ra=0;ra<ha.length;ra++){var va=ha[ra],Ua=x(va),Qa="start"===ya(va),wa=0<=["top","bottom"].indexOf(Ua),jb=wa?"width":"height",pb=fa(z,{placement:va,boundary:B,rootBoundary:F,altBoundary:J,padding:A});Qa=wa?Qa?"right":"left":Qa?"bottom":"top";I[jb]>w[jb]&&(Qa=qb(Qa));jb=qb(Qa);wa=[];if(k&&wa.push(0>=pb[Ua]),u&&wa.push(0>=pb[Qa],0>=pb[jb]),wa.every(function(Va){return Va})){oa=va;M=!1;break}W.set(va,
wa)}if(M)for(k=function(Va){var Sa=ha.find(function(Oa){if(Oa=W.get(Oa))return Oa.slice(0,Va).every(function(lb){return lb})});if(Sa)return oa=Sa,"break"},u=Q?3:1;0<u&&"break"!==k(u);u--);z.placement!==oa&&(z.modifiersData[q]._skip=!0,z.placement=oa,z.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},xe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(q){var z=q.state;q=q.name;var I=z.rects.reference,k=z.rects.popper,u=z.modifiersData.preventOverflow,w=
fa(z,{elementContext:"reference"}),A=fa(z,{altBoundary:!0});I=La(w,I);k=La(A,k,u);u=qa(I);A=qa(k);z.modifiersData[q]={referenceClippingOffsets:I,popperEscapeOffsets:k,isReferenceHidden:u,hasPopperEscaped:A};z.attributes.popper=Object.assign({},z.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":A})}},gd={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(q){var z=q.state,I=q.name;q=q.options.offset;var k=void 0===q?[0,0]:q;q=Da.reduce(function(A,B){var F,
J,M,Q,T,ha;return A[B]=(F=z.rects,M=0<=["left","top"].indexOf(J=x(B))?-1:1,T=(Q="function"==typeof k?k(Object.assign({},F,{placement:B})):k)[0],ha=Q[1],T=T||0,ha=(ha||0)*M,0<=["left","right"].indexOf(J)?{x:ha,y:T}:{x:T,y:ha}),A},{});var u=q[z.placement],w=u.x;u=u.y;null!=z.modifiersData.popperOffsets&&(z.modifiersData.popperOffsets.x+=w,z.modifiersData.popperOffsets.y+=u);z.modifiersData[I]=q}},zc={name:"popperOffsets",enabled:!0,phase:"read",fn:function(q){var z=q.state;z.modifiersData[q.name]=sa({reference:z.rects.reference,
element:z.rects.popper,strategy:"absolute",placement:z.placement})},data:{}},$e={name:"preventOverflow",enabled:!0,phase:"main",fn:function(q){var z=q.state,I=q.options;q=q.name;var k=I.mainAxis,u=I.altAxis,w=I.tether;w=void 0===w||w;var A=I.tetherOffset,B=void 0===A?0:A,F=fa(z,{boundary:I.boundary,rootBoundary:I.rootBoundary,padding:I.padding,altBoundary:I.altBoundary}),J=x(z.placement),M=ya(z.placement),Q=!M,T=Aa(J);I="x"===T?"y":"x";A=z.modifiersData.popperOffsets;var ha=z.rects.reference,W=z.rects.popper;
B="function"==typeof B?B(Object.assign({},z.rects,{placement:z.placement})):B;var oa="number"==typeof B?{mainAxis:B,altAxis:B}:Object.assign({mainAxis:0,altAxis:0},B),ra=z.modifiersData.offset?z.modifiersData.offset[z.placement]:null;B={x:0,y:0};if(A){if(void 0===k||k){var va,Ua="y"===T?"top":"left",Qa="y"===T?"bottom":"right",wa="y"===T?"height":"width";k=A[T];var jb=k+F[Ua],pb=k-F[Qa],Va=w?-W[wa]/2:0,Sa="start"===M?ha[wa]:W[wa];M="start"===M?-W[wa]:-ha[wa];var Oa=z.elements.arrow;Oa=w&&Oa?K(Oa):
{width:0,height:0};var lb=z.modifiersData["arrow#persistent"]?z.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0};Ua=lb[Ua];Qa=lb[Qa];Oa=Ea(0,Pa(ha[wa],Oa[wa]));Sa=Q?ha[wa]/2-Va-Oa-Ua-oa.mainAxis:Sa-Oa-Ua-oa.mainAxis;Q=Q?-ha[wa]/2+Va+Oa+Qa+oa.mainAxis:M+Oa+Qa+oa.mainAxis;Va=(wa=z.elements.arrow&&ka(z.elements.arrow))?"y"===T?wa.clientTop||0:wa.clientLeft||0:0;wa=null!=(va=null==ra?void 0:ra[T])?va:0;va=w?Pa(jb,k+Sa-wa-Va):jb;pb=w?Ea(pb,k+Q-wa):pb;va=Ea(va,Pa(k,pb));A[T]=va;
B[T]=va-k}if(void 0!==u&&u){var Mb,Jc;u=A[I];k="y"===I?"height":"width";va=u+F["x"===T?"top":"left"];F=u-F["x"===T?"bottom":"right"];J=-1!==["top","left"].indexOf(J);T=null!=(Jc=null==ra?void 0:ra[I])?Jc:0;Jc=J?va:u-ha[k]-W[k]-T+oa.altAxis;ha=J?u+ha[k]+W[k]-T-oa.altAxis:F;W=w&&J?(Mb=Ea(Jc,Pa(u,ha)))>ha?ha:Mb:Ea(w?Jc:va,Pa(u,w?ha:F));A[I]=W;B[I]=W-u}z.modifiersData[q]=B}},requiresIfExists:["offset"]};var ve={placement:"bottom",modifiers:[],strategy:"absolute"},Pf=Ia(),Qf=Ia({defaultModifiers:[ud,zc,
Zb,kc]}),ye=Ia({defaultModifiers:[ud,zc,Zb,kc,gd,we,$e,kb,xe]});let Yd=Object.freeze(Object.defineProperty({__proto__:null,afterMain:"afterMain",afterRead:"afterRead",afterWrite:"afterWrite",applyStyles:kc,arrow:kb,auto:"auto",basePlacements:gb,beforeMain:"beforeMain",beforeRead:"beforeRead",beforeWrite:"beforeWrite",bottom:"bottom",clippingParents:"clippingParents",computeStyles:Zb,createPopper:ye,createPopperBase:Pf,createPopperLite:Qf,detectOverflow:fa,end:"end",eventListeners:ud,flip:we,hide:xe,
left:"left",main:"main",modifierPhases:Bb,offset:gd,placements:Da,popper:"popper",popperGenerator:Ia,popperOffsets:zc,preventOverflow:$e,read:"read",reference:"reference",right:"right",start:"start",top:"top",variationPlacements:sb,viewport:"viewport",write:"write"},Symbol.toStringTag,{value:"Module"})),ze="rtl"===document.documentElement.dir?"top-end":"top-start",Zd="rtl"===document.documentElement.dir?"top-start":"top-end",af="rtl"===document.documentElement.dir?"bottom-end":"bottom-start",Rf="rtl"===
document.documentElement.dir?"bottom-start":"bottom-end",bf="rtl"===document.documentElement.dir?"left-start":"right-start",cf="rtl"===document.documentElement.dir?"right-start":"left-start",df={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Sf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Oc extends jc{static get Default(){return df}static get DefaultType(){return Sf}static get NAME(){return"dropdown"}toggle(){return this._isShown()?
this.hide():this.show()}show(){if(!yb(this._element)&&!this._isShown()){var q={relatedTarget:this._element};if(!y.trigger(this._element,"show.bs.dropdown",q).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(let z of[].concat(...document.body.children))y.on(z,"mouseover",fb);this._element.focus();this._element.setAttribute("aria-expanded",!0);this._menu.classList.add("show");this._element.classList.add("show");y.trigger(this._element,
"shown.bs.dropdown",q)}}}hide(){!yb(this._element)&&this._isShown()&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy();super.dispose()}update(){this._inNavbar=this._detectNavbar();this._popper&&this._popper.update()}_completeHide(q){if(!y.trigger(this._element,"hide.bs.dropdown",q).defaultPrevented){if("ontouchstart"in document.documentElement)for(let z of[].concat(...document.body.children))y.off(z,"mouseover",fb);this._popper&&this._popper.destroy();
this._menu.classList.remove("show");this._element.classList.remove("show");this._element.setAttribute("aria-expanded","false");wc.removeDataAttribute(this._menu,"popper");y.trigger(this._element,"hidden.bs.dropdown",q)}}_getConfig(q){if("object"==typeof(q=super._getConfig(q)).reference&&!Qb(q.reference)&&"function"!=typeof q.reference.getBoundingClientRect)throw TypeError('DROPDOWN: Option "reference" provided type "object" without a required "getBoundingClientRect" method.');return q}_createPopper(){if(void 0===
Yd)throw TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let q=this._element;"parent"===this._config.reference?q=this._parent:Qb(this._config.reference)?q=Cb(this._config.reference):"object"==typeof this._config.reference&&(q=this._config.reference);let z=this._getPopperConfig();this._popper=ye(q,this._menu,z)}_isShown(){return this._menu.classList.contains("show")}_getPlacement(){let q=this._parent;if(q.classList.contains("dropend"))return bf;if(q.classList.contains("dropstart"))return cf;
if(q.classList.contains("dropup-center"))return"top";if(q.classList.contains("dropdown-center"))return"bottom";let z="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return q.classList.contains("dropup")?z?Zd:ze:z?Rf:af}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){let {offset:q}=this._config;return"string"==typeof q?q.split(",").map(z=>Number.parseInt(z,10)):"function"==typeof q?z=>q(z,this._element):q}_getPopperConfig(){let q={placement:this._getPlacement(),
modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(wc.setDataAttribute(this._menu,"popper","static"),q.modifiers=[{name:"applyStyles",enabled:!1}]),{...q,...Ob(this._config.popperConfig,[q])}}_selectMenuItem({key:q,target:z}){let I=xa.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(k=>Kb(k));I.length&&cc(I,z,"ArrowDown"===q,
!I.includes(z)).focus()}static jQueryInterface(q){return this.each(function(){let z=Oc.getOrCreateInstance(this,q);if("string"==typeof q){if(void 0===z[q])throw TypeError(`No method named "${q}"`);z[q]()}})}static clearMenus(q){if(2!==q.button&&("keyup"!==q.type||"Tab"===q.key))for(let I of xa.find('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled).show')){let k=Oc.getInstance(I);if(!k||!1===k._config.autoClose)continue;var z=q.composedPath();let u=z.includes(k._menu);z.includes(k._element)||
"inside"===k._config.autoClose&&!u||"outside"===k._config.autoClose&&u||k._menu.contains(q.target)&&("keyup"===q.type&&"Tab"===q.key||/input|select|option|textarea|form/i.test(q.target.tagName))||(z={relatedTarget:k._element},"click"===q.type&&(z.clickEvent=q),k._completeHide(z))}}static dataApiKeydownHandler(q){var z=/input|textarea/i.test(q.target.tagName),I="Escape"===q.key;let k=["ArrowUp","ArrowDown"].includes(q.key);if((k||I)&&(!z||I)){q.preventDefault();z=this.matches('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')?
this:xa.prev(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||xa.next(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||xa.findOne('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',q.delegateTarget.parentNode);I=Oc.getOrCreateInstance(z);if(k)return q.stopPropagation(),I.show(),void I._selectMenuItem(q);I._isShown()&&(q.stopPropagation(),I.hide(),z.focus())}}constructor(q,z){super(q,z);this._popper=null;this._parent=this._element.parentNode;this._menu=
xa.next(this._element,".dropdown-menu")[0]||xa.prev(this._element,".dropdown-menu")[0]||xa.findOne(".dropdown-menu",this._parent);this._inNavbar=this._detectNavbar()}}y.on(document,"keydown.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Oc.dataApiKeydownHandler);y.on(document,"keydown.bs.dropdown.data-api",".dropdown-menu",Oc.dataApiKeydownHandler);y.on(document,"click.bs.dropdown.data-api",Oc.clearMenus);y.on(document,"keyup.bs.dropdown.data-api",Oc.clearMenus);
y.on(document,"click.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',function(q){q.preventDefault();Oc.getOrCreateInstance(this).toggle()});Nb(Oc);let ef={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},$d={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class hd extends Mc{static get Default(){return ef}static get DefaultType(){return $d}static get NAME(){return"backdrop"}show(q){if(!this._config.isVisible)return void Ob(q);
this._append();let z=this._getElement();this._config.isAnimated&&z.offsetHeight;z.classList.add("show");this._emulateAnimation(()=>{Ob(q)})}hide(q){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose();Ob(q)})):Ob(q)}dispose(){this._isAppended&&(y.off(this._element,"mousedown.bs.backdrop"),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){let q=document.createElement("div");q.className=this._config.className;this._config.isAnimated&&
q.classList.add("fade");this._element=q}return this._element}_configAfterMerge(q){return q.rootElement=Cb(q.rootElement),q}_append(){if(!this._isAppended){var q=this._getElement();this._config.rootElement.append(q);y.on(q,"mousedown.bs.backdrop",()=>{Ob(this._config.clickCallback)});this._isAppended=!0}}_emulateAnimation(q){vc(q,this._getElement(),this._config.isAnimated)}constructor(q){super();this._config=this._getConfig(q);this._isAppended=!1;this._element=null}}let ae={autofocus:!0,trapElement:null},
Tf={autofocus:"boolean",trapElement:"element"};class ff extends Mc{static get Default(){return ae}static get DefaultType(){return Tf}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),y.off(document,".bs.focustrap"),y.on(document,"focusin.bs.focustrap",q=>this._handleFocusin(q)),y.on(document,"keydown.tab.bs.focustrap",q=>this._handleKeydown(q)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,y.off(document,".bs.focustrap"))}_handleFocusin(q){let {trapElement:z}=
this._config;q.target===document||q.target===z||z.contains(q.target)||(q=xa.focusableChildren(z),0===q.length?z.focus():"backward"===this._lastTabNavDirection?q[q.length-1].focus():q[0].focus())}_handleKeydown(q){"Tab"===q.key&&(this._lastTabNavDirection=q.shiftKey?"backward":"forward")}constructor(q){super();this._config=this._getConfig(q);this._isActive=!1;this._lastTabNavDirection=null}}class id{getWidth(){return Math.abs(window.innerWidth-document.documentElement.clientWidth)}hide(){let q=this.getWidth();
this._disableOverFlow();this._setElementAttributes(this._element,"padding-right",z=>z+q);this._setElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top","padding-right",z=>z+q);this._setElementAttributes(".sticky-top","margin-right",z=>z-q)}reset(){this._resetElementAttributes(this._element,"overflow");this._resetElementAttributes(this._element,"padding-right");this._resetElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top","padding-right");this._resetElementAttributes(".sticky-top",
"margin-right")}isOverflowing(){return 0<this.getWidth()}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow");this._element.style.overflow="hidden"}_setElementAttributes(q,z,I){let k=this.getWidth();this._applyManipulationCallback(q,u=>{if(!(u!==this._element&&window.innerWidth>u.clientWidth+k)){this._saveInitialAttribute(u,z);var w=window.getComputedStyle(u).getPropertyValue(z);u.style.setProperty(z,`${I(Number.parseFloat(w))}px`)}})}_saveInitialAttribute(q,z){let I=q.style.getPropertyValue(z);
I&&wc.setDataAttribute(q,z,I)}_resetElementAttributes(q,z){this._applyManipulationCallback(q,I=>{let k=wc.getDataAttribute(I,z);null!==k?(wc.removeDataAttribute(I,z),I.style.setProperty(z,k)):I.style.removeProperty(z)})}_applyManipulationCallback(q,z){if(Qb(q))z(q);else for(let I of xa.find(q,this._element))z(I)}constructor(){this._element=document.body}}let Uf={backdrop:!0,focus:!0,keyboard:!0},Kd={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class vd extends jc{static get Default(){return Uf}static get DefaultType(){return Kd}static get NAME(){return"modal"}toggle(q){return this._isShown?
this.hide():this.show(q)}show(q){this._isShown||this._isTransitioning||y.trigger(this._element,"show.bs.modal",{relatedTarget:q}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add("modal-open"),this._adjustDialog(),this._backdrop.show(()=>this._showElement(q)))}hide(){this._isShown&&!this._isTransitioning&&(y.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),
this._element.classList.remove("show"),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){y.off(window,".bs.modal");y.off(this._dialog,".bs.modal");this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new hd({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ff({trapElement:this._element})}_showElement(q){document.body.contains(this._element)||
document.body.append(this._element);this._element.style.display="block";this._element.removeAttribute("aria-hidden");this._element.setAttribute("aria-modal",!0);this._element.setAttribute("role","dialog");this._element.scrollTop=0;let z=xa.findOne(".modal-body",this._dialog);z&&(z.scrollTop=0);this._element.offsetHeight;this._element.classList.add("show");this._queueCallback(()=>{this._config.focus&&this._focustrap.activate();this._isTransitioning=!1;y.trigger(this._element,"shown.bs.modal",{relatedTarget:q})},
this._dialog,this._isAnimated())}_addEventListeners(){y.on(this._element,"keydown.dismiss.bs.modal",q=>{"Escape"===q.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())});y.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()});y.on(this._element,"mousedown.dismiss.bs.modal",q=>{y.one(this._element,"click.dismiss.bs.modal",z=>{this._element===q.target&&this._element===z.target&&("static"!==this._config.backdrop?this._config.backdrop&&
this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none";this._element.setAttribute("aria-hidden",!0);this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._isTransitioning=!1;this._backdrop.hide(()=>{document.body.classList.remove("modal-open");this._resetAdjustments();this._scrollBar.reset();y.trigger(this._element,"hidden.bs.modal")})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(!y.trigger(this._element,
"hidePrevented.bs.modal").defaultPrevented){var q=this._element.scrollHeight>document.documentElement.clientHeight,z=this._element.style.overflowY;"hidden"===z||this._element.classList.contains("modal-static")||(q||(this._element.style.overflowY="hidden"),this._element.classList.add("modal-static"),this._queueCallback(()=>{this._element.classList.remove("modal-static");this._queueCallback(()=>{this._element.style.overflowY=z},this._dialog)},this._dialog),this._element.focus())}}_adjustDialog(){let q=
this._element.scrollHeight>document.documentElement.clientHeight,z=this._scrollBar.getWidth(),I=0<z;I&&!q&&(this._element.style["rtl"===document.documentElement.dir?"paddingLeft":"paddingRight"]=`${z}px`);!I&&q&&(this._element.style["rtl"===document.documentElement.dir?"paddingRight":"paddingLeft"]=`${z}px`)}_resetAdjustments(){this._element.style.paddingLeft="";this._element.style.paddingRight=""}static jQueryInterface(q,z){return this.each(function(){let I=vd.getOrCreateInstance(this,q);if("string"==
typeof q){if(void 0===I[q])throw TypeError(`No method named "${q}"`);I[q](z)}})}constructor(q,z){super(q,z);this._dialog=xa.findOne(".modal-dialog",this._element);this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._isTransitioning=this._isShown=!1;this._scrollBar=new id;this._addEventListeners()}}y.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(q){let z=xa.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&q.preventDefault();
y.one(z,"show.bs.modal",I=>{I.defaultPrevented||y.one(z,"hidden.bs.modal",()=>{Kb(this)&&this.focus()})});(q=xa.findOne(".modal.show"))&&vd.getInstance(q).hide();vd.getOrCreateInstance(z).toggle(this)});Vb(vd);Nb(vd);let Vf={backdrop:!0,keyboard:!0,scroll:!1},Wf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class bd extends jc{static get Default(){return Vf}static get DefaultType(){return Wf}static get NAME(){return"offcanvas"}toggle(q){return this._isShown?this.hide():this.show(q)}show(q){this._isShown||
y.trigger(this._element,"show.bs.offcanvas",{relatedTarget:q}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new id).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add("showing"),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate();this._element.classList.add("show");this._element.classList.remove("showing");y.trigger(this._element,"shown.bs.offcanvas",
{relatedTarget:q})},this._element,!0))}hide(){this._isShown&&(y.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding");this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._config.scroll||(new id).reset();y.trigger(this._element,"hidden.bs.offcanvas")},this._element,
!0)))}dispose(){this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}_initializeBackDrop(){let q=!!this._config.backdrop;return new hd({className:"offcanvas-backdrop",isVisible:q,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:q?()=>{"static"!==this._config.backdrop?this.hide():y.trigger(this._element,"hidePrevented.bs.offcanvas")}:null})}_initializeFocusTrap(){return new ff({trapElement:this._element})}_addEventListeners(){y.on(this._element,"keydown.dismiss.bs.offcanvas",
q=>{"Escape"===q.key&&(this._config.keyboard?this.hide():y.trigger(this._element,"hidePrevented.bs.offcanvas"))})}static jQueryInterface(q){return this.each(function(){let z=bd.getOrCreateInstance(this,q);if("string"==typeof q){if(void 0===z[q]||q.startsWith("_")||"constructor"===q)throw TypeError(`No method named "${q}"`);z[q](this)}})}constructor(q,z){super(q,z);this._isShown=!1;this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._addEventListeners()}}y.on(document,
"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(q){let z=xa.getElementFromSelector(this);(["A","AREA"].includes(this.tagName)&&q.preventDefault(),yb(this))||(y.one(z,"hidden.bs.offcanvas",()=>{Kb(this)&&this.focus()}),(q=xa.findOne(".offcanvas.show"))&&q!==z&&bd.getInstance(q).hide(),bd.getOrCreateInstance(z).toggle(this))});y.on(window,"load.bs.offcanvas.data-api",()=>{for(let q of xa.find(".offcanvas.show"))bd.getOrCreateInstance(q).show()});y.on(window,"resize.bs.offcanvas",
()=>{for(let q of xa.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(q).position&&bd.getOrCreateInstance(q).hide()});Vb(bd);Nb(bd);let wd={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:"src srcset alt title width height".split(" "),li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},
gf=new Set("background cite href itemtype longdesc poster src xlink:href".split(" ")),Ae=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,hf=(q,z)=>{let I=q.nodeName.toLowerCase();return z.includes(I)?!gf.has(I)||!!Ae.test(q.nodeValue):z.filter(k=>k instanceof RegExp).some(k=>k.test(I))},jf={allowList:wd,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Xf={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",
sanitizeFn:"(null|function)",template:"string"},kf={entry:"(string|element|function|null)",selector:"(string|element)"};class Yf extends Mc{static get Default(){return jf}static get DefaultType(){return Xf}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(q=>this._resolvePossibleFunction(q)).filter(Boolean)}hasContent(){return 0<this.getContent().length}changeContent(q){return this._checkContent(q),this._config.content={...this._config.content,...q},
this}toHtml(){var q=document.createElement("div");for(let [I,k]of(q.innerHTML=this._maybeSanitize(this._config.template),Object.entries(this._config.content)))this._setContent(q,k,I);q=q.children[0];let z=this._resolvePossibleFunction(this._config.extraClass);return z&&q.classList.add(...z.split(" ")),q}_typeCheckConfig(q){super._typeCheckConfig(q);this._checkContent(q.content)}_checkContent(q){for(let [z,I]of Object.entries(q))super._typeCheckConfig({selector:z,entry:I},kf)}_setContent(q,z,I){(q=
xa.findOne(I,q))&&((z=this._resolvePossibleFunction(z))?Qb(z)?this._putElementInTemplate(Cb(z),q):this._config.html?q.innerHTML=this._maybeSanitize(z):q.textContent=z:q.remove())}_maybeSanitize(q){if(this._config.sanitize){var z=this._config.allowList;var I=this._config.sanitizeFn;if(q.length)if(I&&"function"==typeof I)z=I(q);else{q=(new window.DOMParser).parseFromString(q,"text/html");for(let u of[].concat(...q.body.querySelectorAll("*"))){var k=u.nodeName.toLowerCase();if(Object.keys(z).includes(k)){I=
[].concat(...u.attributes);k=[].concat(z["*"]||[],z[k]||[]);for(let w of I)hf(w,k)||u.removeAttribute(w.nodeName)}else u.remove()}z=q.body.innerHTML}else z=q}else z=q;return z}_resolvePossibleFunction(q){return Ob(q,[this])}_putElementInTemplate(q,z){if(this._config.html)return z.innerHTML="",void z.append(q);z.textContent=q.textContent}constructor(q){super();this._config=this._getConfig(q)}}let Zf=new Set(["sanitize","allowList","sanitizeFn"]),$f={AUTO:"auto",TOP:"top",RIGHT:"rtl"===document.documentElement.dir?
"left":"right",BOTTOM:"bottom",LEFT:"rtl"===document.documentElement.dir?"right":"left"},ag={allowList:wd,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},bg={allowList:"object",
animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class xd extends jc{static get Default(){return ag}static get DefaultType(){return bg}static get NAME(){return"tooltip"}enable(){this._isEnabled=
!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout);y.off(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler);this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title"));this._disposePopper();super.dispose()}show(){if("none"===
this._element.style.display)throw Error("Please use show on visible elements");if(this._isWithContent()&&this._isEnabled){var q=y.trigger(this._element,this.constructor.eventName("show")),z=(xb(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(!q.defaultPrevented&&z){this._disposePopper();q=this._getTipElement();this._element.setAttribute("aria-describedby",q.getAttribute("id"));({container:z}=this._config);if(this._element.ownerDocument.documentElement.contains(this.tip)||
(z.append(q),y.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(q),q.classList.add("show"),"ontouchstart"in document.documentElement)for(let I of[].concat(...document.body.children))y.on(I,"mouseover",fb);this._queueCallback(()=>{y.trigger(this._element,this.constructor.eventName("shown"));!1===this._isHovered&&this._leave();this._isHovered=!1},this.tip,this._isAnimated())}}}hide(){if(this._isShown()&&!y.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove("show"),
"ontouchstart"in document.documentElement)for(let q of[].concat(...document.body.children))y.off(q,"mouseover",fb);this._activeTrigger.click=!1;this._activeTrigger.focus=!1;this._activeTrigger.hover=!1;this._isHovered=null;this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),y.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||
(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(q){q=this._getTemplateFactory(q).toHtml();if(!q)return null;q.classList.remove("fade","show");q.classList.add(`bs-${this.constructor.NAME}-auto`);var z=this.constructor.NAME;do z+=Math.floor(1E6*Math.random());while(document.getElementById(z));return q.setAttribute("id",z.toString()),this._isAnimated()&&q.classList.add("fade"),q}setContent(q){this._newContent=q;this._isShown()&&(this._disposePopper(),
this.show())}_getTemplateFactory(q){return this._templateFactory?this._templateFactory.changeContent(q):this._templateFactory=new Yf({...this._config,content:q,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(q){return this.constructor.getOrCreateInstance(q.delegateTarget,
this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains("fade")}_isShown(){return this.tip&&this.tip.classList.contains("show")}_createPopper(q){let z=$f[Ob(this._config.placement,[this,q,this._element]).toUpperCase()];return ye(this._element,q,this._getPopperConfig(z))}_getOffset(){let {offset:q}=this._config;return"string"==typeof q?q.split(",").map(z=>Number.parseInt(z,10)):"function"==typeof q?z=>q(z,this._element):q}_resolvePossibleFunction(q){return Ob(q,
[this._element])}_getPopperConfig(q){q={placement:q,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:z=>{this._getTipElement().setAttribute("data-popper-placement",z.state.placement)}}]};return{...q,...Ob(this._config.popperConfig,
[q])}}_setListeners(){for(let q of this._config.trigger.split(" "))if("click"===q)y.on(this._element,this.constructor.eventName("click"),this._config.selector,z=>{this._initializeOnDelegatedTarget(z).toggle()});else if("manual"!==q){let z="hover"===q?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),I="hover"===q?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");y.on(this._element,z,this._config.selector,k=>{let u=this._initializeOnDelegatedTarget(k);
u._activeTrigger["focusin"===k.type?"focus":"hover"]=!0;u._enter()});y.on(this._element,I,this._config.selector,k=>{let u=this._initializeOnDelegatedTarget(k);u._activeTrigger["focusout"===k.type?"focus":"hover"]=u._element.contains(k.relatedTarget);u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()};y.on(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler)}_fixTitle(){let q=this._element.getAttribute("title");q&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||
this._element.setAttribute("aria-label",q),this._element.setAttribute("data-bs-original-title",q),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(q,z){clearTimeout(this._timeout);this._timeout=setTimeout(q,
z)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(q){let z=wc.getDataAttributes(this._element);for(let I of Object.keys(z))Zf.has(I)&&delete z[I];return q={...z,...("object"==typeof q&&q?q:{})},q=this._mergeConfigObj(q),q=this._configAfterMerge(q),this._typeCheckConfig(q),q}_configAfterMerge(q){return q.container=!1===q.container?document.body:Cb(q.container),"number"==typeof q.delay&&(q.delay={show:q.delay,hide:q.delay}),"number"==typeof q.title&&(q.title=
q.title.toString()),"number"==typeof q.content&&(q.content=q.content.toString()),q}_getDelegateConfig(){let q={};for(let [z,I]of Object.entries(this._config))this.constructor.Default[z]!==I&&(q[z]=I);return q.selector=!1,q.trigger="manual",q}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null);this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(q){return this.each(function(){let z=xd.getOrCreateInstance(this,q);if("string"==typeof q){if(void 0===z[q])throw TypeError(`No method named "${q}"`);
z[q]()}})}constructor(q,z){if(void 0===Yd)throw TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(q,z);this._isEnabled=!0;this._timeout=0;this._isHovered=null;this._activeTrigger={};this.tip=this._newContent=this._templateFactory=this._popper=null;this._setListeners();this._config.selector||this._fixTitle()}}Nb(xd);let cg={...xd.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',
trigger:"click"},dg={...xd.DefaultType,content:"(null|string|element|function)"};class be extends xd{static get Default(){return cg}static get DefaultType(){return dg}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(q){return this.each(function(){let z=be.getOrCreateInstance(this,
q);if("string"==typeof q){if(void 0===z[q])throw TypeError(`No method named "${q}"`);z[q]()}})}}Nb(be);let Be={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},lf={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class yd extends jc{static get Default(){return Be}static get DefaultType(){return lf}static get NAME(){return"scrollspy"}refresh(){for(let q of(this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),
this._observer?this._observer.disconnect():this._observer=this._getNewObserver(),this._observableSections.values()))this._observer.observe(q)}dispose(){this._observer.disconnect();super.dispose()}_configAfterMerge(q){return q.target=Cb(q.target)||document.body,q.rootMargin=q.offset?`${q.offset}px 0px -30%`:q.rootMargin,"string"==typeof q.threshold&&(q.threshold=q.threshold.split(",").map(z=>Number.parseFloat(z))),q}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(y.off(this._config.target,"click.bs.scrollspy"),
y.on(this._config.target,"click.bs.scrollspy","[href]",q=>{var z=this._observableSections.get(q.target.hash);if(z){q.preventDefault();q=this._rootElement||window;z=z.offsetTop-this._element.offsetTop;if(q.scrollTo)return void q.scrollTo({top:z,behavior:"smooth"});q.scrollTop=z}}))}_getNewObserver(){return new IntersectionObserver(q=>this._observerCallback(q),{root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin})}_observerCallback(q){let z=w=>this._targetLinks.get(`#${w.target.id}`),
I=w=>{this._previousScrollData.visibleEntryTop=w.target.offsetTop;this._process(z(w))},k=(this._rootElement||document.documentElement).scrollTop,u=k>=this._previousScrollData.parentScrollTop;for(let w of(this._previousScrollData.parentScrollTop=k,q))if(w.isIntersecting)if(q=w.target.offsetTop>=this._previousScrollData.visibleEntryTop,u&&q){if(I(w),!k)break}else u||q||I(w);else this._activeTarget=null,this._clearActiveClass(z(w))}_initializeTargetsAndObservables(){for(let q of(this._targetLinks=new Map,
this._observableSections=new Map,xa.find("[href]",this._config.target))){if(!q.hash||yb(q))continue;let z=xa.findOne(decodeURI(q.hash),this._element);Kb(z)&&(this._targetLinks.set(decodeURI(q.hash),q),this._observableSections.set(q.hash,z))}}_process(q){this._activeTarget!==q&&(this._clearActiveClass(this._config.target),this._activeTarget=q,q.classList.add("active"),this._activateParents(q),y.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:q}))}_activateParents(q){if(q.classList.contains("dropdown-item"))xa.findOne(".dropdown-toggle",
q.closest(".dropdown")).classList.add("active");else for(let z of xa.parents(q,".nav, .list-group"))for(let I of xa.prev(z,".nav-link, .nav-item > .nav-link, .list-group-item"))I.classList.add("active")}_clearActiveClass(q){for(let z of(q.classList.remove("active"),xa.find("[href].active",q)))z.classList.remove("active")}static jQueryInterface(q){return this.each(function(){let z=yd.getOrCreateInstance(this,q);if("string"==typeof q){if(void 0===z[q]||q.startsWith("_")||"constructor"===q)throw TypeError(`No method named "${q}"`);
z[q]()}})}constructor(q,z){super(q,z);this._targetLinks=new Map;this._observableSections=new Map;this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element;this._observer=this._activeTarget=null;this._previousScrollData={visibleEntryTop:0,parentScrollTop:0};this.refresh()}}y.on(window,"load.bs.scrollspy.data-api",()=>{for(let q of xa.find('[data-bs-spy="scroll"]'))yd.getOrCreateInstance(q)});Nb(yd);class zd extends jc{static get NAME(){return"tab"}show(){let q=this._element;
if(!this._elemIsActive(q)){var z=this._getActiveElem(),I=z?y.trigger(z,"hide.bs.tab",{relatedTarget:q}):null;y.trigger(q,"show.bs.tab",{relatedTarget:z}).defaultPrevented||I&&I.defaultPrevented||(this._deactivate(z,q),this._activate(q,z))}}_activate(q,z){q&&(q.classList.add("active"),this._activate(xa.getElementFromSelector(q)),this._queueCallback(()=>{"tab"===q.getAttribute("role")?(q.removeAttribute("tabindex"),q.setAttribute("aria-selected",!0),this._toggleDropDown(q,!0),y.trigger(q,"shown.bs.tab",
{relatedTarget:z})):q.classList.add("show")},q,q.classList.contains("fade")))}_deactivate(q,z){q&&(q.classList.remove("active"),q.blur(),this._deactivate(xa.getElementFromSelector(q)),this._queueCallback(()=>{"tab"===q.getAttribute("role")?(q.setAttribute("aria-selected",!1),q.setAttribute("tabindex","-1"),this._toggleDropDown(q,!1),y.trigger(q,"hidden.bs.tab",{relatedTarget:z})):q.classList.remove("show")},q,q.classList.contains("fade")))}_keydown(q){if("ArrowLeft ArrowRight ArrowUp ArrowDown Home End".split(" ").includes(q.key)){q.stopPropagation();
q.preventDefault();var z=this._getChildren().filter(I=>!yb(I));if(["Home","End"].includes(q.key))q=z["Home"===q.key?0:z.length-1];else{let I=["ArrowRight","ArrowDown"].includes(q.key);q=cc(z,q.target,I,!0)}q&&(q.focus({preventScroll:!0}),zd.getOrCreateInstance(q).show())}}_getChildren(){return xa.find('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',this._parent)}_getActiveElem(){return this._getChildren().find(q=>
this._elemIsActive(q))||null}_setInitialAttributes(q,z){for(let I of(this._setAttributeIfNotExists(q,"role","tablist"),z))this._setInitialAttributesOnChild(I)}_setInitialAttributesOnChild(q){q=this._getInnerElement(q);let z=this._elemIsActive(q),I=this._getOuterElement(q);q.setAttribute("aria-selected",z);I!==q&&this._setAttributeIfNotExists(I,"role","presentation");z||q.setAttribute("tabindex","-1");this._setAttributeIfNotExists(q,"role","tab");this._setInitialAttributesOnTargetPanel(q)}_setInitialAttributesOnTargetPanel(q){let z=
xa.getElementFromSelector(q);z&&(this._setAttributeIfNotExists(z,"role","tabpanel"),q.id&&this._setAttributeIfNotExists(z,"aria-labelledby",`${q.id}`))}_toggleDropDown(q,z){q=this._getOuterElement(q);if(q.classList.contains("dropdown")){var I=xa.findOne(".dropdown-toggle",q);I&&I.classList.toggle("active",z);(I=xa.findOne(".dropdown-menu",q))&&I.classList.toggle("show",z);q.setAttribute("aria-expanded",z)}}_setAttributeIfNotExists(q,z,I){q.hasAttribute(z)||q.setAttribute(z,I)}_elemIsActive(q){return q.classList.contains("active")}_getInnerElement(q){return q.matches('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]')?
q:xa.findOne('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',q)}_getOuterElement(q){return q.closest(".nav-item, .list-group-item")||q}static jQueryInterface(q){return this.each(function(){let z=zd.getOrCreateInstance(this);if("string"==typeof q){if(void 0===z[q]||q.startsWith("_")||"constructor"===q)throw TypeError(`No method named "${q}"`);z[q]()}})}constructor(q){super(q);
(this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'))&&(this._setInitialAttributes(this._parent,this._getChildren()),y.on(this._element,"keydown.bs.tab",z=>this._keydown(z)))}}y.on(document,"click.bs.tab",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',function(q){["A","AREA"].includes(this.tagName)&&q.preventDefault();yb(this)||zd.getOrCreateInstance(this).show()});y.on(window,"load.bs.tab",()=>{for(let q of xa.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))zd.getOrCreateInstance(q)});
Nb(zd);let Ld={animation:"boolean",autohide:"boolean",delay:"number"},mf={animation:!0,autohide:!0,delay:5E3};class Ad extends jc{static get Default(){return mf}static get DefaultType(){return Ld}static get NAME(){return"toast"}show(){y.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.offsetHeight,this._element.classList.add("show","showing"),this._queueCallback(()=>
{this._element.classList.remove("showing");y.trigger(this._element,"shown.bs.toast");this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(y.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add("showing"),this._queueCallback(()=>{this._element.classList.add("hide");this._element.classList.remove("showing","show");y.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout();this.isShown()&&
this._element.classList.remove("show");super.dispose()}isShown(){return this._element.classList.contains("show")}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(q,z){switch(q.type){case "mouseover":case "mouseout":this._hasMouseInteraction=z;break;case "focusin":case "focusout":this._hasKeyboardInteraction=z}if(z)return void this._clearTimeout();q=q.relatedTarget;
this._element===q||this._element.contains(q)||this._maybeScheduleHide()}_setListeners(){y.on(this._element,"mouseover.bs.toast",q=>this._onInteraction(q,!0));y.on(this._element,"mouseout.bs.toast",q=>this._onInteraction(q,!1));y.on(this._element,"focusin.bs.toast",q=>this._onInteraction(q,!0));y.on(this._element,"focusout.bs.toast",q=>this._onInteraction(q,!1))}_clearTimeout(){clearTimeout(this._timeout);this._timeout=null}static jQueryInterface(q){return this.each(function(){let z=Ad.getOrCreateInstance(this,
q);if("string"==typeof q){if(void 0===z[q])throw TypeError(`No method named "${q}"`);z[q](this)}})}constructor(q,z){super(q,z);this._timeout=null;this._hasKeyboardInteraction=this._hasMouseInteraction=!1;this._setListeners()}}return Vb(Ad),Nb(Ad),{Alert:xc,Button:C,Carousel:la,Collapse:ab,Dropdown:Oc,Modal:vd,Offcanvas:bd,Popover:be,ScrollSpy:yd,Tab:zd,Toast:Ad,Tooltip:xd}}();var Ub={};!function(a){function c(G,N){for(var K=G.length;K--;)if(G[K]===N)return K;return-1}function d(G,N,K){var P=g(G);
void 0===K&&(K=N,N="all");for(var L=0;L<P.length;L++){var ba=[];1<(G=P[L].split("+")).length&&(ba=p(G),G=[G[G.length-1]]);(G=t(G=G[0]))in m||(m[G]=[]);m[G].push({shortcut:P[L],scope:N,method:K,key:P[L],mods:ba})}}function b(){return h||"all"}function g(G){var N;return""==(N=G.replace(/\s/g,"").split(","))[N.length-1]&&(N[N.length-2]+=","),N}function p(G){G=G.slice(0,G.length-1);for(var N=0;N<G.length;N++)G[N]=n[G[N]];return G}function f(G,N,K){G.addEventListener&&G.addEventListener(N,K,!1)}var e,
m={},l={16:!1,18:!1,17:!1,91:!1},h="all",n={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},r={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},t=function(G){G=r[G]||G.toUpperCase().charCodeAt(0);return"function"==typeof G?G():G},v=[];for(e=1;20>
e;e++)r["f"+e]=111+e;var x={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(e in n)d[e]=!1;f(document,"keydown",function(G){!function(N){var K,P,L,ba,X;if(-1==c(v,K=Kg(N.key))&&v.push(K),K in l)for(L in l[K]=!0,n)n[L]==K&&(d[L]=!0);else{for(e in l)l[e]=N[x[e]];if(d.filter.call(this,N)&&K in m){var Y=0;for(X=b();Y<m[K].length;Y++)if((P=m[K][Y]).scope==X||"all"==P.scope){for(L in ba=0<P.mods.length,l)(!l[L]&&-1<c(P.mods,+L)||l[L]&&-1==c(P.mods,+L))&&(ba=!1);(0!=P.mods.length||l[16]||l[18]||
l[17]||l[91])&&!ba||!1===P.method(N,P)&&(N.preventDefault?N.preventDefault():N.returnValue=!1,N.stopPropagation&&N.stopPropagation(),N.cancelBubble&&(N.cancelBubble=!0))}}}}(G)});f(document,"keyup",function(G){var N;G=Kg(G.key);var K=c(v,G);if(0<=K&&v.splice(K,1),G in l)for(N in l[G]=!1,n)n[N]==G&&(d[N]=!1)});f(window,"focus",function(){for(e in l)l[e]=!1;for(e in n)d[e]=!1});var D=a.key;a.key=d;a.key.setScope=function(G){h=G||"all"};a.key.getScope=b;a.key.deleteScope=function(G){var N,K;for(N in m){var P=
0;for(K=m[N];P<K.length;)K[P].scope===G?K.splice(P,1):P++}};a.key.filter=function(G){G=(G.target||G.srcElement).tagName;return"INPUT"!=G&&"SELECT"!=G&&"TEXTAREA"!=G};a.key.isPressed=function(G){return"string"==typeof G&&(G=t(G)),-1!=c(v,G)};a.key.getPressedKeyCodes=function(){return v.slice(0)};a.key.noConflict=function(){var G=a.key;return a.key=D,G};a.key.unbind=function(G,N){var K,P,L,ba,X=[];var Y=0;for(K=g(G);Y<K.length&&(1<(P=K[Y].split("+")).length&&(X=p(P)),G=t(G=P[P.length-1]),void 0===N&&
(N=b()),m[G]);Y++)for(L=0;L<m[G].length;L++){var ka;if(ka=(ba=m[G][L]).scope===N)a:if(ba=ba.mods,ba.length!=X.length)ka=!1;else{for(ka=0;ka<ba.length;ka++)if(ba[ka]!==X[ka]){ka=!1;break a}ka=!0}ka&&(m[G][L]={})}};Ub=d}(Ub||{});ed.getRef=function(){return null==ed.instance&&(ed.instance=new ed),ed.instance};window.onWacomPluginLoaded=function(){ed.getRef().pluginLoaded()};Id.prototype.clone=function(){for(var a=new Id(Array(this.points.length)),c=0;c<this.points.length;c++)a.points[c]={x:this.points[c].x,
y:this.points[c].y};return a};Id.prototype.getTransformed=function(a){for(var c=new Id(Array(this.points.length)),d=0;d<this.points.length;d++)c.points[d]=a.getTransformedPoint(this.points[d]);return c};Id.prototype.getCenter=function(){for(var a=this.points[0].x,c=this.points[0].y,d=1;d<this.points.length;d++)a+=this.points[d].x,c+=this.points[d].y;return{x:a/this.points.length,y:c/this.points.length}};Id.prototype.containsPoint=function(a){var c,d=!1;var b=0;for(c=this.points.length-1;b<this.points.length;c=
b++)this.points[b].y>a.y!=this.points[c].y>a.y&&a.x<(this.points[c].x-this.points[b].x)*(a.y-this.points[b].y)/(this.points[c].y-this.points[b].y)+this.points[b].x&&(d=!d);return d};Lb.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};Lb.prototype.normalize=function(){var a=this.getLength();return this.x/=a,this.y/=a,this};Lb.prototype.getDotProduct=function(a){return this.x*a.x+this.y*a.y};Lb.prototype.scale=function(a){return this.x*=a,this.y*=a,this};Lb.prototype.getScaled=
function(a){var c=new Lb(this.x,this.y);return c.scale(a),c};Lb.prototype.getRounded=function(){return new Lb(Math.round(this.x),Math.round(this.y))};Lb.prototype.getTruncated=function(){return new Lb(~~this.x,~~this.y)};Lb.prototype.getPerpendicular=function(){return new Lb(-this.y,this.x)};Lb.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this};Lb.prototype.subtract=function(a){return this.x-=a.x,this.y-=a.y,this};Lb.prototype.getSum=function(a){return new Lb(this.x+a.x,this.y+a.y)};Lb.subtractPoints=
function(a,c){return new Lb(a.x-c.x,a.y-c.y)};var Ba={};for(let a of(!function(c,d){"object"==typeof Ba?Ba=c.document?d(c,!0):function(b){if(!b.document)throw Error("jQuery requires a window with a document");return d(b)}:d(c)}("undefined"!=typeof window?window:Ba,function(c,d){function b(k,u,w){var A,B,F=(w=w||Wa).createElement("script");if(F.text=k,u)for(A in Rc)(B=u[A]||u.getAttribute&&u.getAttribute(A))&&F.setAttribute(A,B);w.head.appendChild(F).parentNode.removeChild(F)}function g(k){return null==
k?k+"":"object"==typeof k||"function"==typeof k?Nb[Ob.call(k)]||"object":typeof k}function p(k){var u=!!k&&"length"in k&&k.length,w=g(k);return!(db(k)||nc(k))&&("array"===w||0===u||"number"==typeof u&&0<u&&u-1 in k)}function f(k,u){return k.nodeName&&k.nodeName.toLowerCase()===u.toLowerCase()}function e(k,u){return u?"\x00"===k?"\ufffd":k.slice(0,-1)+"\\"+k.charCodeAt(k.length-1).toString(16)+" ":"\\"+k}function m(k,u,w){return db(u)?y.grep(k,function(A,B){return!!u.call(A,B,A)!==w}):u.nodeType?y.grep(k,
function(A){return A===u!==w}):"string"!=typeof u?y.grep(k,function(A){return-1<mb.call(u,A)!==w}):y.filter(u,k,w)}function l(k,u){for(;(k=k[u])&&1!==k.nodeType;);return k}function h(k){return k}function n(k){throw k;}function r(k,u,w,A){var B;try{k&&db(B=k.promise)?B.call(k).done(u).fail(w):k&&db(B=k.then)?B.call(k,u,w):u.apply(void 0,[k].slice(A))}catch(F){w.apply(void 0,[F])}}function t(){Wa.removeEventListener("DOMContentLoaded",t);c.removeEventListener("load",t);y.ready()}function v(k,u){return u.toUpperCase()}
function x(k){return k.replace(ab,"ms-").replace(gb,v)}function D(){this.expando=y.expando+D.uid++}function G(k,u,w){var A;if(void 0===w&&1===k.nodeType)if(A="data-"+u.replace(Ea,"-$&").toLowerCase(),"string"==typeof(w=k.getAttribute(A))){try{var B=w;w="true"===B||"false"!==B&&("null"===B?null:B===+B+""?+B:kc.test(B)?JSON.parse(B):B)}catch(F){}Bb.set(k,u,w)}else w=void 0;return w}function N(k,u,w,A){var B,F,J=20,M=A?function(){return A.cur()}:function(){return y.css(k,u,"")},Q=M(),T=w&&w[3]||(y.cssNumber[u]?
"":"px"),ha=k.nodeType&&(y.cssNumber[u]||"px"!==T&&+Q)&&Ta.exec(y.css(k,u));if(ha&&ha[3]!==T){Q/=2;T=T||ha[3];for(ha=+Q||1;J--;)y.style(k,u,ha+T),0>=(1-F)*(1-(F=M()/Q||.5))&&(J=0),ha/=F;ha*=2;y.style(k,u,ha+T);w=w||[]}return w&&(ha=+ha||+Q||0,B=w[1]?ha+(w[1]+1)*w[2]:+w[2],A&&(A.unit=T,A.start=ha,A.end=B)),B}function K(k,u){for(var w,A,B=[],F=0,J=k.length;F<J;F++)if((A=k[F]).style)if(w=A.style.display,u){if("none"===w&&(B[F]=Da.get(A,"display")||null,B[F]||(A.style.display="")),""===A.style.display&&
ud(A)){w=F;var M=void 0;var Q=A.ownerDocument;A=A.nodeName;var T=Ze[A];Q=(T||(M=Q.body.appendChild(Q.createElement(A)),T=y.css(M,"display"),M.parentNode.removeChild(M),"none"===T&&(T="block"),Ze[A]=T),T);B[w]=Q}}else"none"!==w&&(B[F]="none",Da.set(A,"display",w));for(F=0;F<J;F++)null!=B[F]&&(k[F].style.display=B[F]);return k}function P(k,u){var w;return(w=void 0!==k.getElementsByTagName?k.getElementsByTagName(u||"*"):void 0!==k.querySelectorAll?k.querySelectorAll(u||"*"):[],void 0===u||u&&f(k,u))?
y.merge([k],w):w}function L(k,u){for(var w=0,A=k.length;w<A;w++)Da.set(k[w],"globalEval",!u||Da.get(u[w],"globalEval"))}function ba(k,u,w,A,B){for(var F,J,M,Q,T=u.createDocumentFragment(),ha=[],W=0,oa=k.length;W<oa;W++)if((F=k[W])||0===F)if("object"===g(F))y.merge(ha,F.nodeType?[F]:F);else if($e.test(F)){J=J||T.appendChild(u.createElement("div"));M=zc[(we.exec(F)||["",""])[1].toLowerCase()]||zc._default;J.innerHTML=M[1]+y.htmlPrefilter(F)+M[2];for(M=M[0];M--;)J=J.lastChild;y.merge(ha,J.childNodes);
(J=T.firstChild).textContent=""}else ha.push(u.createTextNode(F));T.textContent="";for(W=0;F=ha[W++];)if(A&&-1<y.inArray(F,A))B&&B.push(F);else if(Q=Zb(F),J=P(T.appendChild(F),"script"),Q&&L(J),w)for(M=0;F=J[M++];)xe.test(F.type||"")&&w.push(F);return T}function X(){return!0}function Y(){return!1}function ka(k,u,w,A,B,F){var J,M;if("object"==typeof u){for(M in"string"!=typeof w&&(A=A||w,w=void 0),u)ka(k,M,w,A,u[M],F);return k}if(null==A&&null==B?(B=w,A=w=void 0):null==B&&("string"==typeof w?(B=A,
A=void 0):(B=A,A=w,w=void 0)),!1===B)B=Y;else if(!B)return k;return 1===F&&(J=B,(B=function(Q){return y().off(Q),J.apply(this,arguments)}).guid=J.guid||(J.guid=y.guid++)),k.each(function(){y.event.add(this,u,B,A,w)})}function Aa(k,u,w){w?(Da.set(k,u,!1),y.event.add(k,u,{namespace:!1,handler:function(A){var B,F=Da.get(this,u);if(1&A.isTrigger&&this[u])if(F)(y.event.special[u]||{}).delegateType&&A.stopPropagation();else{if(F=fb.call(arguments),Da.set(this,u,F),this[u](),B=Da.get(this,u),Da.set(this,
u,!1),F!==B)return A.stopImmediatePropagation(),A.preventDefault(),B}else F&&(Da.set(this,u,y.event.trigger(F[0],F.slice(1),this)),A.stopPropagation(),A.isImmediatePropagationStopped=X)}})):void 0===Da.get(k,u)&&y.event.add(k,u,X)}function Ga(k,u){return f(k,"table")&&f(11!==u.nodeType?u:u.firstChild,"tr")&&y(k).children("tbody")[0]||k}function U(k){return k.type=(null!==k.getAttribute("type"))+"/"+k.type,k}function ya(k){return"true/"===(k.type||"").slice(0,5)?k.type=k.type.slice(5):k.removeAttribute("type"),
k}function pa(k,u){var w,A,B,F,J;if(1===u.nodeType){if(Da.hasData(k)&&(J=Da.get(k).events))for(A in Da.remove(u,"handle events"),J){var M=0;for(w=J[A].length;M<w;M++)y.event.add(u,A,J[A][M])}Bb.hasData(k)&&(B=Bb.access(k),F=y.extend({},B),Bb.set(u,F))}}function qb(k,u,w,A){u=ib(u);var B,F,J,M=0,Q=k.length,T=Q-1,ha=u[0],W=db(ha);if(W||1<Q&&"string"==typeof ha&&!cb.checkClone&&Qf.test(ha))return k.each(function(ra){var va=k.eq(ra);W&&(u[0]=ha.call(this,ra,va.html()));qb(va,u,w,A)});if(Q&&(F=(B=ba(u,
k[0].ownerDocument,!1,k,A)).firstChild,1===B.childNodes.length&&(B=F),F||A)){for(J=(F=y.map(P(B,"script"),U)).length;M<Q;M++){var oa=B;M!==T&&(oa=y.clone(oa,!0,!0),J&&y.merge(F,P(oa,"script")));w.call(k[M],oa,M)}if(J)for(B=F[F.length-1].ownerDocument,y.map(F,ya),M=0;M<J;M++)oa=F[M],xe.test(oa.type||"")&&!Da.access(oa,"globalEval")&&y.contains(B,oa)&&(oa.src&&"module"!==(oa.type||"").toLowerCase()?y._evalUrl&&!oa.noModule&&y._evalUrl(oa.src,{nonce:oa.nonce||oa.getAttribute("nonce")},B):b(oa.textContent.replace(ye,
""),oa,B))}return k}function $a(k,u,w){for(var A=u?y.filter(u,k):k,B=0;null!=(u=A[B]);B++)w||1!==u.nodeType||y.cleanData(P(u)),u.parentNode&&(w&&Zb(u)&&L(P(u,"script")),u.parentNode.removeChild(u));return k}function Gb(k,u,w){var A,B,F,J,M=ze.test(u),Q=k.style;return(w=w||Zd(k))&&(J=w.getPropertyValue(u)||w[u],M&&J&&(J=J.replace(Fc,"$1")||void 0),""!==J||Zb(k)||(J=y.style(k,u)),!cb.pixelBoxStyles()&&Yd.test(J)&&Rf.test(u)&&(A=Q.width,B=Q.minWidth,F=Q.maxWidth,Q.minWidth=Q.maxWidth=Q.width=J,J=w.width,
Q.width=A,Q.minWidth=B,Q.maxWidth=F)),void 0!==J?J+"":J}function Fb(k,u){return{get:function(){if(k())delete this.get;else return(this.get=u).apply(this,arguments)}}}function Ka(k){var u;if(!(u=y.cssProps[k]||df[k])){if(!(k in cf)){a:{u=k;for(var w=u[0].toUpperCase()+u.slice(1),A=bf.length;A--;)if((u=bf[A]+w)in cf)break a;u=void 0}k=df[k]=u||k}u=k}return u}function Na(k,u,w){return(k=Ta.exec(u))?Math.max(0,k[2]-(w||0))+(k[3]||"px"):u}function ja(k,u,w,A,B,F){var J=+("width"===u),M=0,Q=0,T=0;if(w===
(A?"border":"content"))return 0;for(;4>J;J+=2)"margin"===w&&(T+=y.css(k,w+kb[J],!0,B)),A?("content"===w&&(Q-=y.css(k,"padding"+kb[J],!0,B)),"margin"!==w&&(Q-=y.css(k,"border"+kb[J]+"Width",!0,B))):(Q+=y.css(k,"padding"+kb[J],!0,B),"padding"!==w?Q+=y.css(k,"border"+kb[J]+"Width",!0,B):M+=y.css(k,"border"+kb[J]+"Width",!0,B));return!A&&0<=F&&(Q+=Math.max(0,Math.ceil(k["offset"+u[0].toUpperCase()+u.slice(1)]-F-Q-M-.5))||0),Q+T}function Fa(k,u,w){var A=Zd(k),B=(!cb.boxSizingReliable()||w)&&"border-box"===
y.css(k,"boxSizing",!1,A),F=B,J=Gb(k,u,A),M="offset"+u[0].toUpperCase()+u.slice(1);if(Yd.test(J)){if(!w)return J;J="auto"}return(!cb.boxSizingReliable()&&B||!cb.reliableTrDimensions()&&f(k,"tr")||"auto"===J||!parseFloat(J)&&"inline"===y.css(k,"display",!1,A))&&k.getClientRects().length&&(B="border-box"===y.css(k,"boxSizing",!1,A),(F=M in k)&&(J=k[M])),(J=parseFloat(J)||0)+ja(k,u,w||(B?"border":"content"),F,A,J)+"px"}function sa(k,u,w,A,B){return new sa.prototype.init(k,u,w,A,B)}function fa(){return c.setTimeout(function(){hd=
void 0}),hd=Date.now()}function La(k,u){var w,A=0,B={height:k};for(u=+!!u;4>A;A+=2-u)B["margin"+(w=kb[A])]=B["padding"+w]=k;return u&&(B.opacity=B.width=k),B}function qa(k,u,w){for(var A,B=(Ra.tweeners[u]||[]).concat(Ra.tweeners["*"]),F=0,J=B.length;F<J;F++)if(A=B[F].call(w,u,k))return A}function Ra(k,u,w){var A,B=0,F=Ra.prefilters.length,J=y.Deferred().always(function(){delete M.elem}),M=function(){if(A)return!1;var T=hd||fa();T=Math.max(0,Q.startTime+Q.duration-T);for(var ha=1-(T/Q.duration||0),
W=0,oa=Q.tweens.length;W<oa;W++)Q.tweens[W].run(ha);return(J.notifyWith(k,[Q,ha,T]),1>ha&&oa)?T:(oa||J.notifyWith(k,[Q,1,0]),J.resolveWith(k,[Q]),!1)},Q=J.promise({elem:k,props:y.extend({},u),opts:y.extend(!0,{specialEasing:{},easing:y.easing._default},w),originalProperties:u,originalOptions:w,startTime:hd||fa(),duration:w.duration,tweens:[],createTween:function(T,ha){T=y.Tween(k,Q.opts,T,ha,Q.opts.specialEasing[T]||Q.opts.easing);return Q.tweens.push(T),T},stop:function(T){var ha=0,W=T?Q.tweens.length:
0;if(A)return this;for(A=!0;ha<W;ha++)Q.tweens[ha].run(1);return T?(J.notifyWith(k,[Q,1,0]),J.resolveWith(k,[Q,T])):J.rejectWith(k,[Q,T]),this}});w=Q.props;!function(T,ha){var W,oa,ra,va,Ua;for(W in T)if(ra=ha[oa=x(W)],Array.isArray(va=T[W])&&(ra=va[1],va=T[W]=va[0]),W!==oa&&(T[oa]=va,delete T[W]),(Ua=y.cssHooks[oa])&&"expand"in Ua)for(W in va=Ua.expand(va),delete T[oa],va)W in T||(T[W]=va[W],ha[W]=ra);else ha[oa]=ra}(w,Q.opts.specialEasing);for(;B<F;B++)if(u=Ra.prefilters[B].call(Q,k,w,Q.opts))return db(u.stop)&&
(y._queueHooks(Q.elem,Q.opts.queue).stop=u.stop.bind(u)),u;return y.map(w,qa,Q),db(Q.opts.start)&&Q.opts.start.call(k,Q),Q.progress(Q.opts.progress).done(Q.opts.done,Q.opts.complete).fail(Q.opts.fail).always(Q.opts.always),y.fx.timer(y.extend(M,{elem:k,anim:Q,queue:Q.opts.queue})),Q}function Ia(k){return(k.match(Z)||[]).join(" ")}function hb(k){return k.getAttribute&&k.getAttribute("class")||""}function Yb(k){return Array.isArray(k)?k:"string"==typeof k&&k.match(Z)||[]}function ic(k){return function(u,
w){"string"!=typeof u&&(w=u,u="*");var A=0,B=u.toLowerCase().match(Z)||[];if(db(w))for(;u=B[A++];)"+"===u[0]?(k[u=u.slice(1)||"*"]=k[u]||[]).unshift(w):(k[u]=k[u]||[]).push(w)}}function Qb(k,u,w,A){function B(M){var Q;return F[M]=!0,y.each(k[M]||[],function(T,ha){T=ha(u,w,A);return"string"!=typeof T||J||F[T]?J?!(Q=T):void 0:(u.dataTypes.unshift(T),B(T),!1)}),Q}var F={},J=k===Be;return B(u.dataTypes[0])||!F["*"]&&B("*")}function Cb(k,u){var w,A,B=y.ajaxSettings.flatOptions||{};for(w in u)void 0!==
u[w]&&((B[w]?k:A||={})[w]=u[w]);return A&&y.extend(!0,k,A),k}var Kb,yb=[],xb=Object.getPrototypeOf,fb=yb.slice,ib=yb.flat?function(k){return yb.flat.call(k)}:function(k){return yb.concat.apply([],k)},dc=yb.push,mb=yb.indexOf,Nb={},Ob=Nb.toString,vc=Nb.hasOwnProperty,cc=vc.toString,Tb=cc.call(Object),cb={},db=function(k){return"function"==typeof k&&"number"!=typeof k.nodeType&&"function"!=typeof k.item},nc=function(k){return null!=k&&k===k.window},Wa=c.document,Rc={type:!0,src:!0,nonce:!0,noModule:!0},
dd=/HTML$/i,y=function(k,u){return new y.fn.init(k,u)};y.fn=y.prototype={jquery:"3.7.1",constructor:y,length:0,toArray:function(){return fb.call(this)},get:function(k){return null==k?fb.call(this):0>k?this[k+this.length]:this[k]},pushStack:function(k){k=y.merge(this.constructor(),k);return k.prevObject=this,k},each:function(k){return y.each(this,k)},map:function(k){return this.pushStack(y.map(this,function(u,w){return k.call(u,w,u)}))},slice:function(){return this.pushStack(fb.apply(this,arguments))},
first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(y.grep(this,function(k,u){return(u+1)%2}))},odd:function(){return this.pushStack(y.grep(this,function(k,u){return u%2}))},eq:function(k){var u=this.length;k=+k+(0>k?u:0);return this.pushStack(0<=k&&k<u?[this[k]]:[])},end:function(){return this.prevObject||this.constructor()},push:dc,sort:yb.sort,splice:yb.splice};y.extend=y.fn.extend=function(){var k,u,w,A,B,F=arguments[0]||{},J=1,M=arguments.length,
Q=!1;"boolean"==typeof F&&(Q=F,F=arguments[J]||{},J++);"object"==typeof F||db(F)||(F={});for(J===M&&(F=this,J--);J<M;J++)if(null!=(k=arguments[J]))for(u in k){var T=k[u];"__proto__"!==u&&F!==T&&(Q&&T&&(y.isPlainObject(T)||(A=Array.isArray(T)))?(w=F[u],B=A&&!Array.isArray(w)?[]:A||y.isPlainObject(w)?w:{},A=!1,F[u]=y.extend(Q,B,T)):void 0!==T&&(F[u]=T))}return F};y.extend({expando:"jQuery"+("3.7.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(k){throw Error(k);},noop:function(){},isPlainObject:function(k){var u,
w;return!!k&&"[object Object]"===Ob.call(k)&&(!(u=xb(k))||"function"==typeof(w=vc.call(u,"constructor")&&u.constructor)&&cc.call(w)===Tb)},isEmptyObject:function(k){for(var u in k)return!1;return!0},globalEval:function(k,u,w){b(k,{nonce:u&&u.nonce},w)},each:function(k,u){var w,A=0;if(p(k))for(w=k.length;A<w&&!1!==u.call(k[A],A,k[A]);A++);else for(A in k)if(!1===u.call(k[A],A,k[A]))break;return k},text:function(k){var u,w="",A=0,B=k.nodeType;if(!B)for(;u=k[A++];)w+=y.text(u);return 1===B||11===B?k.textContent:
9===B?k.documentElement.textContent:3===B||4===B?k.nodeValue:w},makeArray:function(k,u){u=u||[];return null!=k&&(p(Object(k))?y.merge(u,"string"==typeof k?[k]:k):dc.call(u,k)),u},inArray:function(k,u,w){return null==u?-1:mb.call(u,k,w)},isXMLDoc:function(k){var u=k&&(k.ownerDocument||k).documentElement;return!dd.test(k&&k.namespaceURI||u&&u.nodeName||"HTML")},merge:function(k,u){for(var w=+u.length,A=0,B=k.length;A<w;A++)k[B++]=u[A];return k.length=B,k},grep:function(k,u,w){var A=[],B=0,F=k.length;
for(w=!w;B<F;B++)!u(k[B],B)!==w&&A.push(k[B]);return A},map:function(k,u,w){var A,B,F=0,J=[];if(p(k))for(A=k.length;F<A;F++)null!=(B=u(k[F],F,w))&&J.push(B);else for(F in k)null!=(B=u(k[F],F,w))&&J.push(B);return ib(J)},guid:1,support:cb});"function"==typeof Symbol&&(y.fn[Symbol.iterator]=yb[Symbol.iterator]);y.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(k,u){Nb["[object "+u+"]"]=u.toLowerCase()});var wc=yb.pop,Mc=yb.sort,jc=yb.splice,Fc=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$",
"g");y.contains=function(k,u){u=u&&u.parentNode;return k===u||!!(u&&1===u.nodeType&&(k.contains?k.contains(u):k.compareDocumentPosition&&16&k.compareDocumentPosition(u)))};var xa=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;y.escapeSelector=function(k){return(k+"").replace(xa,e)};!function(){function k(S,aa,ca,ta){var Ja,eb,Za,tb,bb=aa&&aa.ownerDocument;var zb=aa?aa.nodeType:9;if(ca=ca||[],"string"!=typeof S||!S||1!==zb&&9!==zb&&11!==zb)return ca;if(!ta&&(M(aa),aa=aa||Sa,lb)){if(11!==zb&&(tb=si.exec(S)))if(Ja=
tb[1])if(9===zb){if(!(eb=aa.getElementById(Ja)))return ca;if(eb.id===Ja)return Xb.call(ca,eb),ca}else{if(bb&&(eb=bb.getElementById(Ja))&&k.contains(aa,eb)&&eb.id===Ja)return Xb.call(ca,eb),ca}else{if(tb[2])return Xb.apply(ca,aa.getElementsByTagName(S)),ca;if((Ja=tb[3])&&aa.getElementsByClassName)return Xb.apply(ca,aa.getElementsByClassName(Ja)),ca}if(!(gc[S+" "]||Mb&&Mb.test(S))){if(Ja=S,bb=aa,1===zb&&(sc.test(S)||Pb.test(S))){(bb=eg.test(S)&&J(aa.parentNode)||aa)==aa&&cb.scope||((Za=aa.getAttribute("id"))?
Za=y.escapeSelector(Za):aa.setAttribute("id",Za=Hb));for(zb=(Ja=T(S)).length;zb--;)Ja[zb]=(Za?"#"+Za:":scope")+" "+ha(Ja[zb]);Ja=Ja.join(",")}try{return Xb.apply(ca,bb.querySelectorAll(Ja)),ca}catch(vb){gc(S,!0)}finally{Za===Hb&&aa.removeAttribute("id")}}}return Ua(S.replace(Fc,"$1"),aa,ca,ta)}function u(){function S(ca,ta){return aa.push(ca+" ")>wa.cacheLength&&delete S[aa.shift()],S[ca+" "]=ta}var aa=[];return S}function w(S){return S[Hb]=!0,S}function A(S){var aa=Sa.createElement("fieldset");try{return!!S(aa)}catch(ca){return!1}finally{aa.parentNode&&
aa.parentNode.removeChild(aa)}}function B(S){return function(aa){return"form"in aa?aa.parentNode&&!1===aa.disabled?"label"in aa?"label"in aa.parentNode?aa.parentNode.disabled===S:aa.disabled===S:aa.isDisabled===S||!S!==aa.isDisabled&&ti(aa)===S:aa.disabled===S:"label"in aa&&aa.disabled===S}}function F(S){return w(function(aa){return aa*=1,w(function(ca,ta){for(var Ja,eb=S([],ca.length,aa),Za=eb.length;Za--;)ca[Ja=eb[Za]]&&(ca[Ja]=!(ta[Ja]=ca[Ja]))})})}function J(S){return S&&void 0!==S.getElementsByTagName&&
S}function M(S){var aa;S=S?S.ownerDocument||S:Wa;return S!=Sa&&9===S.nodeType&&S.documentElement&&(Oa=(Sa=S).documentElement,lb=!y.isXMLDoc(Sa),Jc=Oa.matches||Oa.webkitMatchesSelector||Oa.msMatchesSelector,Oa.msMatchesSelector&&Wa!=Sa&&(aa=Sa.defaultView)&&aa.top!==aa&&aa.addEventListener("unload",ui),cb.getById=A(function(ca){return Oa.appendChild(ca).id=y.expando,!Sa.getElementsByName||!Sa.getElementsByName(y.expando).length}),cb.disconnectedMatch=A(function(ca){return Jc.call(ca,"*")}),cb.scope=
A(function(){return Sa.querySelectorAll(":scope")}),cb.cssHas=A(function(){try{return Sa.querySelector(":has(*,:jqfake)"),!1}catch(ca){return!0}}),cb.getById?(wa.filter.ID=function(ca){var ta=ca.replace(jd,kd);return function(Ja){return Ja.getAttribute("id")===ta}},wa.find.ID=function(ca,ta){if(void 0!==ta.getElementById&&lb)return(ca=ta.getElementById(ca))?[ca]:[]}):(wa.filter.ID=function(ca){var ta=ca.replace(jd,kd);return function(Ja){return(Ja=void 0!==Ja.getAttributeNode&&Ja.getAttributeNode("id"))&&
Ja.value===ta}},wa.find.ID=function(ca,ta){if(void 0!==ta.getElementById&&lb){var Ja,eb=ta.getElementById(ca);if(eb){if((Ja=eb.getAttributeNode("id"))&&Ja.value===ca)return[eb];var Za=ta.getElementsByName(ca);for(ta=0;eb=Za[ta++];)if((Ja=eb.getAttributeNode("id"))&&Ja.value===ca)return[eb]}return[]}}),wa.find.TAG=function(ca,ta){return void 0!==ta.getElementsByTagName?ta.getElementsByTagName(ca):ta.querySelectorAll(ca)},wa.find.CLASS=function(ca,ta){if(void 0!==ta.getElementsByClassName&&lb)return ta.getElementsByClassName(ca)},
Mb=[],A(function(ca){var ta;Oa.appendChild(ca).innerHTML="<a id='"+Hb+"' href='' disabled='disabled'></a><select id='"+Hb+"-\r\\' disabled='disabled'><option selected=''></option></select>";ca.querySelectorAll("[selected]").length||Mb.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");ca.querySelectorAll("[id~="+Hb+"-]").length||Mb.push("~=");ca.querySelectorAll("a#"+Hb+"+*").length||Mb.push(".#.+[+~]");
ca.querySelectorAll(":checked").length||Mb.push(":checked");(ta=Sa.createElement("input")).setAttribute("type","hidden");ca.appendChild(ta).setAttribute("name","D");Oa.appendChild(ca).disabled=!0;2!==ca.querySelectorAll(":disabled").length&&Mb.push(":enabled",":disabled");(ta=Sa.createElement("input")).setAttribute("name","");ca.appendChild(ta);ca.querySelectorAll("[name='']").length||Mb.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")")}),cb.cssHas||Mb.push(":has"),
Mb=Mb.length&&new RegExp(Mb.join("|")),mc=function(ca,ta){if(ca===ta)return Va=!0,0;var Ja=!ca.compareDocumentPosition-!ta.compareDocumentPosition;return Ja?Ja:1&(Ja=(ca.ownerDocument||ca)==(ta.ownerDocument||ta)?ca.compareDocumentPosition(ta):1)||!cb.sortDetached&&ta.compareDocumentPosition(ca)===Ja?ca===Sa||ca.ownerDocument==Wa&&k.contains(Wa,ca)?-1:ta===Sa||ta.ownerDocument==Wa&&k.contains(Wa,ta)?1:pb?mb.call(pb,ca)-mb.call(pb,ta):0:4&Ja?-1:1}),Sa}function Q(){}function T(S,aa){var ca,ta,Ja,eb,
Za,tb;if(Za=yc[S+" "])return aa?0:Za.slice(0);Za=S;var bb=[];for(tb=wa.preFilter;Za;){for(eb in(!ca||(ta=Dc.exec(Za)))&&(ta&&(Za=Za.slice(ta[0].length)||Za),bb.push(Ja=[])),ca=!1,(ta=Pb.exec(Za))&&(ca=ta.shift(),Ja.push({value:ca,type:ta[0].replace(Fc," ")}),Za=Za.slice(ca.length)),wa.filter)(ta=Lc[eb].exec(Za))&&(!tb[eb]||(ta=tb[eb](ta)))&&(ca=ta.shift(),Ja.push({value:ca,type:eb,matches:ta}),Za=Za.slice(ca.length));if(!ca)break}return aa?Za.length:Za?k.error(S):yc(S,bb).slice(0)}function ha(S){for(var aa=
0,ca=S.length,ta="";aa<ca;aa++)ta+=S[aa].value;return ta}function W(S,aa,ca){var ta=aa.dir,Ja=aa.next,eb=Ja||ta,Za=ca&&"parentNode"===eb,tb=Sc++;return aa.first?function(bb,zb,vb){for(;bb=bb[ta];)if(1===bb.nodeType||Za)return S(bb,zb,vb);return!1}:function(bb,zb,vb){var tc,Db,Ib=[rc,tb];if(vb)for(;bb=bb[ta];){if((1===bb.nodeType||Za)&&S(bb,zb,vb))return!0}else for(;bb=bb[ta];)if(1===bb.nodeType||Za)if(Db=bb[Hb]||(bb[Hb]={}),Ja&&f(bb,Ja))bb=bb[ta]||bb;else{if((tc=Db[eb])&&tc[0]===rc&&tc[1]===tb)return Ib[2]=
tc[2];if(Db[eb]=Ib,Ib[2]=S(bb,zb,vb))return!0}return!1}}function oa(S){return 1<S.length?function(aa,ca,ta){for(var Ja=S.length;Ja--;)if(!S[Ja](aa,ca,ta))return!1;return!0}:S[0]}function ra(S,aa,ca,ta,Ja){for(var eb,Za=[],tb=0,bb=S.length,zb=null!=aa;tb<bb;tb++)(eb=S[tb])&&(!ca||ca(eb,ta,Ja))&&(Za.push(eb),zb&&aa.push(tb));return Za}function va(S,aa){var ca,ta,Ja,eb,Za=[],tb=[],bb=ac[S+" "];if(!bb){aa||=T(S);for(eb=aa.length;eb--;)(bb=function tc(vb){var Db,Ib,bc=vb.length,Pc=wa.relative[vb[0].type];
var uc=Pc||wa.relative[" "];for(var wb=+!!Pc,Uc=W(function(Tc){return Tc===Db},uc,!0),ld=W(function(Tc){return-1<mb.call(Db,Tc)},uc,!0),Cd=[function(Tc,Qc,Bd){Tc=!Pc&&(Bd||Qc!=jb)||((Db=Qc).nodeType?Uc(Tc,Qc,Bd):ld(Tc,Qc,Bd));return Db=null,Tc}];wb<bc;wb++)if(uc=wa.relative[vb[wb].type])Cd=[W(oa(Cd),uc)];else{if((uc=wa.filter[vb[wb].type].apply(null,vb[wb].matches))[Hb]){for(Ib=++wb;Ib<bc&&!wa.relative[vb[Ib].type];Ib++);return function nh(Qc,Bd,ce,Md,Vc,vi){return Md&&!Md[Hb]&&(Md=nh(Md)),Vc&&!Vc[Hb]&&
(Vc=nh(Vc,vi)),w(function(de,ee,hc,Ce){var Nd,Ac,oh=[],fg=[],ph=ee.length,Wc;if(!(Wc=de)){Wc=Bd||"*";for(var qh=hc.nodeType?[hc]:hc,rh=[],gg=0,wi=qh.length;gg<wi;gg++)k(Wc,qh[gg],rh);Wc=rh}Wc=!Qc||!de&&Bd?Wc:ra(Wc,oh,Qc,hc,Ce);if(ce?ce(Wc,Ac=Vc||(de?Qc:ph||Md)?[]:ee,hc,Ce):Ac=Wc,Md){var md=ra(Ac,fg);Md(md,[],hc,Ce);for(hc=md.length;hc--;)(Nd=md[hc])&&(Ac[fg[hc]]=!(Wc[fg[hc]]=Nd))}if(de){if(Vc||Qc){if(Vc){md=[];for(hc=Ac.length;hc--;)(Nd=Ac[hc])&&md.push(Wc[hc]=Nd);Vc(null,Ac=[],md,Ce)}for(hc=Ac.length;hc--;)(Nd=
Ac[hc])&&-1<(md=Vc?mb.call(de,Nd):oh[hc])&&(de[md]=!(ee[md]=Nd))}}else Ac=ra(Ac===ee?Ac.splice(ph,Ac.length):Ac),Vc?Vc(null,ee,Ac,Ce):Xb.apply(ee,Ac)})}(1<wb&&oa(Cd),1<wb&&ha(vb.slice(0,wb-1).concat({value:" "===vb[wb-2].type?"*":""})).replace(Fc,"$1"),uc,wb<Ib&&tc(vb.slice(wb,Ib)),Ib<bc&&tc(vb=vb.slice(Ib)),Ib<bc&&ha(vb))}Cd.push(uc)}return oa(Cd)}(aa[eb]))[Hb]?Za.push(bb):tb.push(bb);(bb=ac(S,(ca=0<Za.length,ta=0<tb.length,Ja=function(zb,vb,tc,Db,Ib){var bc,Pc,uc=0,wb="0",Uc=zb&&[],ld=[],Cd=jb,
Tc=zb||ta&&wa.find.TAG("*",Ib),Qc=rc+=null==Cd?1:Math.random()||.1,Bd=Tc.length;for(Ib&&(jb=vb==Sa||vb||Ib);wb!==Bd&&null!=(bc=Tc[wb]);wb++){if(ta&&bc){var ce=0;for(vb||bc.ownerDocument==Sa||(M(bc),tc=!lb);Pc=tb[ce++];)if(Pc(bc,vb||Sa,tc)){Xb.call(Db,bc);break}Ib&&(rc=Qc)}ca&&((bc=!Pc&&bc)&&uc--,zb&&Uc.push(bc))}if(uc+=wb,ca&&wb!==uc){for(ce=0;Pc=Za[ce++];)Pc(Uc,ld,vb,tc);if(zb){if(0<uc)for(;wb--;)Uc[wb]||ld[wb]||(ld[wb]=wc.call(Db));ld=ra(ld)}Xb.apply(Db,ld);Ib&&!zb&&0<ld.length&&1<uc+Za.length&&
y.uniqueSort(Db)}return Ib&&(rc=Qc,jb=Cd),Uc},ca?w(Ja):Ja))).selector=S}return bb}function Ua(S,aa,ca,ta){var Ja,eb,Za,tb,bb,zb="function"==typeof S&&S,vb=!ta&&T(S=zb.selector||S);if(ca=ca||[],1===vb.length){if(2<(eb=vb[0]=vb[0].slice(0)).length&&"ID"===(Za=eb[0]).type&&9===aa.nodeType&&lb&&wa.relative[eb[1].type]){if(!(aa=(wa.find.ID(Za.matches[0].replace(jd,kd),aa)||[])[0]))return ca;zb&&(aa=aa.parentNode);S=S.slice(eb.shift().value.length)}for(Ja=Lc.needsContext.test(S)?0:eb.length;Ja--&&(Za=eb[Ja],
!wa.relative[tb=Za.type]);)if((bb=wa.find[tb])&&(ta=bb(Za.matches[0].replace(jd,kd),eg.test(eb[0].type)&&J(aa.parentNode)||aa))){if(eb.splice(Ja,1),!(S=ta.length&&ha(eb)))return Xb.apply(ca,ta),ca;break}}return(zb||va(S,vb))(ta,aa,!lb,ca,!aa||eg.test(S)&&J(aa.parentNode)||aa),ca}var Qa,wa,jb,pb,Va,Sa,Oa,lb,Mb,Jc,Xb=dc,Hb=y.expando,rc=0,Sc=0,ad=u(),yc=u(),ac=u(),gc=u(),mc=function(S,aa){return S===aa&&(Va=!0),0},Kc=RegExp("[\\x20\\t\\r\\n\\f]+","g"),Dc=RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),
Pb=RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),sc=RegExp("[\\x20\\t\\r\\n\\f]|>"),Xc=RegExp(":((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
ec=RegExp("^(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+$"),Lc={ID:RegExp("^#((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)"),CLASS:RegExp("^\\.((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)"),TAG:RegExp("^((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+|[*])"),ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\]"),
PSEUDO:RegExp("^:((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},fe=/^(?:input|select|textarea|button)$/i,hg=/^h\d$/i,si=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,eg=/[+~]/,jd=RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),kd=function(S,aa){S="0x"+S.slice(1)-65536;return aa||(0>S?String.fromCharCode(S+65536):String.fromCharCode(S>>10|55296,1023&S|56320))},ui=function(){M()},ti=W(function(S){return!0===S.disabled&&f(S,"fieldset")},{dir:"parentNode",next:"legend"});try{Xb.apply(yb=fb.call(Wa.childNodes),Wa.childNodes),yb[Wa.childNodes.length].nodeType}catch(S){Xb=
{apply:function(aa,ca){dc.apply(aa,fb.call(ca))},call:function(aa){dc.apply(aa,fb.call(arguments,1))}}}for(Qa in k.matches=function(S,aa){return k(S,null,null,aa)},k.matchesSelector=function(S,aa){if(M(S),!(!lb||gc[aa+" "]||Mb&&Mb.test(aa)))try{var ca=Jc.call(S,aa);if(ca||cb.disconnectedMatch||S.document&&11!==S.document.nodeType)return ca}catch(ta){gc(aa,!0)}return 0<k(aa,Sa,null,[S]).length},k.contains=function(S,aa){return(S.ownerDocument||S)!=Sa&&M(S),y.contains(S,aa)},k.attr=function(S,aa){(S.ownerDocument||
S)!=Sa&&M(S);var ca=wa.attrHandle[aa.toLowerCase()];ca=ca&&vc.call(wa.attrHandle,aa.toLowerCase())?ca(S,aa,!lb):void 0;return void 0!==ca?ca:S.getAttribute(aa)},k.error=function(S){throw Error("Syntax error, unrecognized expression: "+S);},y.uniqueSort=function(S){var aa,ca=[],ta=0,Ja=0;if(Va=!cb.sortStable,pb=!cb.sortStable&&fb.call(S,0),Mc.call(S,mc),Va){for(;aa=S[Ja++];)aa===S[Ja]&&(ta=ca.push(Ja));for(;ta--;)jc.call(S,ca[ta],1)}return pb=null,S},y.fn.uniqueSort=function(){return this.pushStack(y.uniqueSort(fb.apply(this)))},
(wa=y.expr={cacheLength:50,createPseudo:w,match:Lc,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(S){return S[1]=S[1].replace(jd,kd),S[3]=(S[3]||S[4]||S[5]||"").replace(jd,kd),"~="===S[2]&&(S[3]=" "+S[3]+" "),S.slice(0,4)},CHILD:function(S){return S[1]=S[1].toLowerCase(),"nth"===S[1].slice(0,3)?(S[3]||k.error(S[0]),S[4]=+(S[4]?S[5]+(S[6]||1):2*("even"===S[3]||"odd"===
S[3])),S[5]=+(S[7]+S[8]||"odd"===S[3])):S[3]&&k.error(S[0]),S},PSEUDO:function(S){var aa,ca=!S[6]&&S[2];return Lc.CHILD.test(S[0])?null:(S[3]?S[2]=S[4]||S[5]||"":ca&&Xc.test(ca)&&(aa=T(ca,!0))&&(aa=ca.indexOf(")",ca.length-aa)-ca.length)&&(S[0]=S[0].slice(0,aa),S[2]=ca.slice(0,aa)),S.slice(0,3))}},filter:{TAG:function(S){var aa=S.replace(jd,kd).toLowerCase();return"*"===S?function(){return!0}:function(ca){return f(ca,aa)}},CLASS:function(S){var aa=ad[S+" "];return aa||(aa=RegExp("(^|[\\x20\\t\\r\\n\\f])"+
S+"([\\x20\\t\\r\\n\\f]|$)"),ad(S,function(ca){return aa.test("string"==typeof ca.className&&ca.className||void 0!==ca.getAttribute&&ca.getAttribute("class")||"")}))},ATTR:function(S,aa,ca){return function(ta){ta=k.attr(ta,S);return null==ta?"!="===aa:!aa||((ta+="","="===aa)?ta===ca:"!="===aa?ta!==ca:"^="===aa?ca&&0===ta.indexOf(ca):"*="===aa?ca&&-1<ta.indexOf(ca):"$="===aa?ca&&ta.slice(-ca.length)===ca:"~="===aa?-1<(" "+ta.replace(Kc," ")+" ").indexOf(ca):"|="===aa&&(ta===ca||ta.slice(0,ca.length+
1)===ca+"-"))}},CHILD:function(S,aa,ca,ta,Ja){var eb="nth"!==S.slice(0,3),Za="last"!==S.slice(-4),tb="of-type"===aa;return 1===ta&&0===Ja?function(bb){return!!bb.parentNode}:function(bb,zb,vb){var tc,Db,Ib;zb=eb!==Za?"nextSibling":"previousSibling";var bc=bb.parentNode,Pc=tb&&bb.nodeName.toLowerCase(),uc=!vb&&!tb,wb=!1;if(bc){if(eb){for(;zb;){for(Db=bb;Db=Db[zb];)if(tb?f(Db,Pc):1===Db.nodeType)return!1;var Uc=zb="only"===S&&!Uc&&"nextSibling"}return!0}if(Uc=[Za?bc.firstChild:bc.lastChild],Za&&uc)for(wb=
(Ib=(tc=(vb=bc[Hb]||(bc[Hb]={}))[S]||[])[0]===rc&&tc[1])&&tc[2],Db=Ib&&bc.childNodes[Ib];Db=++Ib&&Db&&Db[zb]||(wb=Ib=0)||Uc.pop();){if(1===Db.nodeType&&++wb&&Db===bb){vb[S]=[rc,Ib,wb];break}}else if(uc&&(wb=Ib=(tc=(bb[Hb]||(bb[Hb]={}))[S]||[])[0]===rc&&tc[1]),!1===wb)for(;(Db=++Ib&&Db&&Db[zb]||(wb=Ib=0)||Uc.pop())&&((tb?!f(Db,Pc):1!==Db.nodeType)||!++wb||(uc&&((vb=Db[Hb]||(Db[Hb]={}))[S]=[rc,wb]),Db!==bb)););return(wb-=Ja)===ta||0==wb%ta&&0<=wb/ta}}},PSEUDO:function(S,aa){var ca,ta=wa.pseudos[S]||
wa.setFilters[S.toLowerCase()]||k.error("unsupported pseudo: "+S);return ta[Hb]?ta(aa):1<ta.length?(ca=[S,S,"",aa],wa.setFilters.hasOwnProperty(S.toLowerCase())?w(function(Ja,eb){for(var Za,tb=ta(Ja,aa),bb=tb.length;bb--;)Za=mb.call(Ja,tb[bb]),Ja[Za]=!(eb[Za]=tb[bb])}):function(Ja){return ta(Ja,0,ca)}):ta}},pseudos:{not:w(function(S){var aa=[],ca=[],ta=va(S.replace(Fc,"$1"));return ta[Hb]?w(function(Ja,eb,Za,tb){var bb;Za=ta(Ja,null,tb,[]);for(tb=Ja.length;tb--;)(bb=Za[tb])&&(Ja[tb]=!(eb[tb]=bb))}):
function(Ja,eb,Za){return aa[0]=Ja,ta(aa,null,Za,ca),aa[0]=null,!ca.pop()}}),has:w(function(S){return function(aa){return 0<k(S,aa).length}}),contains:w(function(S){return S=S.replace(jd,kd),function(aa){return-1<(aa.textContent||y.text(aa)).indexOf(S)}}),lang:w(function(S){return ec.test(S||"")||k.error("unsupported lang: "+S),S=S.replace(jd,kd).toLowerCase(),function(aa){var ca;do if(ca=lb?aa.lang:aa.getAttribute("xml:lang")||aa.getAttribute("lang"))return(ca=ca.toLowerCase())===S||0===ca.indexOf(S+
"-");while((aa=aa.parentNode)&&1===aa.nodeType);return!1}}),target:function(S){var aa=c.location&&c.location.hash;return aa&&aa.slice(1)===S.id},root:function(S){return S===Oa},focus:function(S){a:{try{var aa=Sa.activeElement;break a}catch(ca){}aa=void 0}return S===aa&&Sa.hasFocus()&&!!(S.type||S.href||~S.tabIndex)},enabled:B(!1),disabled:B(!0),checked:function(S){return f(S,"input")&&!!S.checked||f(S,"option")&&!!S.selected},selected:function(S){return S.parentNode&&S.parentNode.selectedIndex,!0===
S.selected},empty:function(S){for(S=S.firstChild;S;S=S.nextSibling)if(6>S.nodeType)return!1;return!0},parent:function(S){return!wa.pseudos.empty(S)},header:function(S){return hg.test(S.nodeName)},input:function(S){return fe.test(S.nodeName)},button:function(S){return f(S,"input")&&"button"===S.type||f(S,"button")},text:function(S){var aa;return f(S,"input")&&"text"===S.type&&(null==(aa=S.getAttribute("type"))||"text"===aa.toLowerCase())},first:F(function(){return[0]}),last:F(function(S,aa){return[aa-
1]}),eq:F(function(S,aa,ca){return[0>ca?ca+aa:ca]}),even:F(function(S,aa){for(var ca=0;ca<aa;ca+=2)S.push(ca);return S}),odd:F(function(S,aa){for(var ca=1;ca<aa;ca+=2)S.push(ca);return S}),lt:F(function(S,aa,ca){for(aa=0>ca?ca+aa:ca>aa?aa:ca;0<=--aa;)S.push(aa);return S}),gt:F(function(S,aa,ca){for(ca=0>ca?ca+aa:ca;++ca<aa;)S.push(ca);return S})}}).pseudos.nth=wa.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})wa.pseudos[Qa]=function(S){return function(aa){return f(aa,"input")&&aa.type===
S}}(Qa);for(Qa in{submit:!0,reset:!0})wa.pseudos[Qa]=function(S){return function(aa){return(f(aa,"input")||f(aa,"button"))&&aa.type===S}}(Qa);Q.prototype=wa.filters=wa.pseudos;wa.setFilters=new Q;cb.sortStable=Hb.split("").sort(mc).join("")===Hb;M();cb.sortDetached=A(function(S){return 1&S.compareDocumentPosition(Sa.createElement("fieldset"))});y.find=k;y.expr[":"]=y.expr.pseudos;y.unique=y.uniqueSort;k.compile=va;k.select=Ua;k.setDocument=M;k.tokenize=T;k.escape=y.escapeSelector;k.getText=y.text;
k.isXML=y.isXMLDoc;k.selectors=y.expr;k.support=y.support;k.uniqueSort=y.uniqueSort}();var Vb=function(k,u,w){for(var A=[],B=void 0!==w;(k=k[u])&&9!==k.nodeType;)if(1===k.nodeType){if(B&&y(k).is(w))break;A.push(k)}return A},xc=function(k,u){for(var w=[];k;k=k.nextSibling)1===k.nodeType&&k!==u&&w.push(k);return w},C=y.expr.match.needsContext,R=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;y.filter=function(k,u,w){var A=u[0];return(w&&(k=":not("+k+")"),1===u.length&&1===A.nodeType)?
y.find.matchesSelector(A,k)?[A]:[]:y.find.matches(k,y.grep(u,function(B){return 1===B.nodeType}))};y.fn.extend({find:function(k){var u,w=this.length,A=this;if("string"!=typeof k)return this.pushStack(y(k).filter(function(){for(B=0;B<w;B++)if(y.contains(A[B],this))return!0}));var B=0;for(u=this.pushStack([]);B<w;B++)y.find(k,A[B],u);return 1<w?y.uniqueSort(u):u},filter:function(k){return this.pushStack(m(this,k||[],!1))},not:function(k){return this.pushStack(m(this,k||[],!0))},is:function(k){return!!m(this,
"string"==typeof k&&C.test(k)?y(k):k||[],!1).length}});var da=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(y.fn.init=function(k,u,w){var A,B;if(!k)return this;if(w=w||ea,"string"==typeof k){if((A="<"===k[0]&&">"===k[k.length-1]&&3<=k.length?[null,k,null]:da.exec(k))&&(A[1]||!u)){if(A[1]){if(u=u instanceof y?u[0]:u,y.merge(this,y.parseHTML(A[1],u&&u.nodeType?u.ownerDocument||u:Wa,!0)),R.test(A[1])&&y.isPlainObject(u))for(A in u)db(this[A])?this[A](u[A]):this.attr(A,u[A]);return this}return(B=Wa.getElementById(A[2]))&&
(this[0]=B,this.length=1),this}return!u||u.jquery?(u||w).find(k):this.constructor(u).find(k)}return k.nodeType?(this[0]=k,this.length=1,this):db(k)?void 0!==w.ready?w.ready(k):k(y):y.makeArray(k,this)}).prototype=y.fn;var ea=y(Wa);var E=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};y.fn.extend({has:function(k){var u=y(k,this),w=u.length;return this.filter(function(){for(var A=0;A<w;A++)if(y.contains(this,u[A]))return!0})},closest:function(k,u){var w,A=0,B=this.length,
F=[],J="string"!=typeof k&&y(k);if(!C.test(k))for(;A<B;A++)for(w=this[A];w&&w!==u;w=w.parentNode)if(11>w.nodeType&&(J?-1<J.index(w):1===w.nodeType&&y.find.matchesSelector(w,k))){F.push(w);break}return this.pushStack(1<F.length?y.uniqueSort(F):F)},index:function(k){return k?"string"==typeof k?mb.call(y(k),this[0]):mb.call(this,k.jquery?k[0]:k):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(k,u){return this.pushStack(y.uniqueSort(y.merge(this.get(),y(k,u))))},addBack:function(k){return this.add(null==
k?this.prevObject:this.prevObject.filter(k))}});y.each({parent:function(k){return(k=k.parentNode)&&11!==k.nodeType?k:null},parents:function(k){return Vb(k,"parentNode")},parentsUntil:function(k,u,w){return Vb(k,"parentNode",w)},next:function(k){return l(k,"nextSibling")},prev:function(k){return l(k,"previousSibling")},nextAll:function(k){return Vb(k,"nextSibling")},prevAll:function(k){return Vb(k,"previousSibling")},nextUntil:function(k,u,w){return Vb(k,"nextSibling",w)},prevUntil:function(k,u,w){return Vb(k,
"previousSibling",w)},siblings:function(k){return xc((k.parentNode||{}).firstChild,k)},children:function(k){return xc(k.firstChild)},contents:function(k){return null!=k.contentDocument&&xb(k.contentDocument)?k.contentDocument:(f(k,"template")&&(k=k.content||k),y.merge([],k.childNodes))}},function(k,u){y.fn[k]=function(w,A){var B=y.map(this,u,w);return"Until"!==k.slice(-5)&&(A=w),A&&"string"==typeof A&&(B=y.filter(A,B)),1<this.length&&(O[k]||y.uniqueSort(B),E.test(k)&&B.reverse()),this.pushStack(B)}});
var Z=/[^\x20\t\r\n\f]+/g;y.Callbacks=function(k){k="string"==typeof k?(u=k,w={},y.each(u.match(Z)||[],function(oa,ra){w[ra]=!0}),w):y.extend({},k);var u,w,A,B,F,J,M=[],Q=[],T=-1,ha=function(){J=J||k.once;for(F=A=!0;Q.length;T=-1)for(B=Q.shift();++T<M.length;)!1===M[T].apply(B[0],B[1])&&k.stopOnFalse&&(T=M.length,B=!1);k.memory||(B=!1);A=!1;J&&(M=B?[]:"")},W={add:function(){return M&&(B&&!A&&(T=M.length-1,Q.push(B)),!function va(ra){y.each(ra,function(Ua,Qa){db(Qa)?k.unique&&W.has(Qa)||M.push(Qa):
Qa&&Qa.length&&"string"!==g(Qa)&&va(Qa)})}(arguments),B&&!A&&ha()),this},remove:function(){return y.each(arguments,function(oa,ra){for(var va;-1<(va=y.inArray(ra,M,va));)M.splice(va,1),va<=T&&T--}),this},has:function(oa){return oa?-1<y.inArray(oa,M):0<M.length},empty:function(){return M&&=[],this},disable:function(){return J=Q=[],M=B="",this},disabled:function(){return!M},lock:function(){return J=Q=[],B||A||(M=B=""),this},locked:function(){return!!J},fireWith:function(oa,ra){return!J&&(ra=[oa,(ra=
ra||[]).slice?ra.slice():ra],Q.push(ra),A||ha()),this},fire:function(){return W.fireWith(this,arguments),this},fired:function(){return!!F}};return W};y.extend({Deferred:function(k){var u=[["notify","progress",y.Callbacks("memory"),y.Callbacks("memory"),2],["resolve","done",y.Callbacks("once memory"),y.Callbacks("once memory"),0,"resolved"],["reject","fail",y.Callbacks("once memory"),y.Callbacks("once memory"),1,"rejected"]],w="pending",A={state:function(){return w},always:function(){return B.done(arguments).fail(arguments),
this},catch:function(F){return A.then(null,F)},pipe:function(){var F=arguments;return y.Deferred(function(J){y.each(u,function(M,Q){var T=db(F[Q[4]])&&F[Q[4]];B[Q[1]](function(){var ha=T&&T.apply(this,arguments);ha&&db(ha.promise)?ha.promise().progress(J.notify).done(J.resolve).fail(J.reject):J[Q[0]+"With"](this,T?[ha]:arguments)})});F=null}).promise()},then:function(F,J,M){function Q(ha,W,oa,ra){return function(){var va=this,Ua=arguments,Qa=function(){var jb,pb;if(!(ha<T)){if((jb=oa.apply(va,Ua))===
W.promise())throw TypeError("Thenable self-resolution");db(pb=jb&&("object"==typeof jb||"function"==typeof jb)&&jb.then)?ra?pb.call(jb,Q(T,W,h,ra),Q(T,W,n,ra)):(T++,pb.call(jb,Q(T,W,h,ra),Q(T,W,n,ra),Q(T,W,h,W.notifyWith))):(oa!==h&&(va=void 0,Ua=[jb]),(ra||W.resolveWith)(va,Ua))}},wa=ra?Qa:function(){try{Qa()}catch(jb){y.Deferred.exceptionHook&&y.Deferred.exceptionHook(jb,wa.error),ha+1>=T&&(oa!==n&&(va=void 0,Ua=[jb]),W.rejectWith(va,Ua))}};ha?wa():(y.Deferred.getErrorHook?wa.error=y.Deferred.getErrorHook():
y.Deferred.getStackHook&&(wa.error=y.Deferred.getStackHook()),c.setTimeout(wa))}}var T=0;return y.Deferred(function(ha){u[0][3].add(Q(0,ha,db(M)?M:h,ha.notifyWith));u[1][3].add(Q(0,ha,db(F)?F:h));u[2][3].add(Q(0,ha,db(J)?J:n))}).promise()},promise:function(F){return null!=F?y.extend(F,A):A}},B={};return y.each(u,function(F,J){var M=J[2],Q=J[5];A[J[1]]=M.add;Q&&M.add(function(){w=Q},u[3-F][2].disable,u[3-F][3].disable,u[0][2].lock,u[0][3].lock);M.add(J[3].fire);B[J[0]]=function(){return B[J[0]+"With"](this===
B?void 0:this,arguments),this};B[J[0]+"With"]=M.fireWith}),A.promise(B),k&&k.call(B,B),B},when:function(k){var u=arguments.length,w=u,A=Array(w),B=fb.call(arguments),F=y.Deferred(),J=function(M){return function(Q){A[M]=this;B[M]=1<arguments.length?fb.call(arguments):Q;--u||F.resolveWith(A,B)}};if(1>=u&&(r(k,F.done(J(w)).resolve,F.reject,!u),"pending"===F.state()||db(B[w]&&B[w].then)))return F.then();for(;w--;)r(B[w],J(w),F.reject);return F.promise()}});var la=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;
y.Deferred.exceptionHook=function(k,u){c.console&&c.console.warn&&k&&la.test(k.name)&&c.console.warn("jQuery.Deferred exception: "+k.message,k.stack,u)};y.readyException=function(k){c.setTimeout(function(){throw k;})};var za=y.Deferred();y.fn.ready=function(k){return za.then(k).catch(function(u){y.readyException(u)}),this};y.extend({isReady:!1,readyWait:1,ready:function(k){(!0===k?!--y.readyWait:!y.isReady)&&(y.isReady=!0,!0!==k&&0<--y.readyWait||za.resolveWith(Wa,[y]))}});y.ready.then=za.then;"complete"===
Wa.readyState||"loading"!==Wa.readyState&&!Wa.documentElement.doScroll?c.setTimeout(y.ready):(Wa.addEventListener("DOMContentLoaded",t),c.addEventListener("load",t));var ua=function(k,u,w,A,B,F,J){var M=0,Q=k.length,T=null==w;if("object"===g(w))for(M in B=!0,w)ua(k,u,M,w[M],!0,F,J);else if(void 0!==A&&(B=!0,db(A)||(J=!0),T&&(J?(u.call(k,A),u=null):(T=u,u=function(ha,W,oa){return T.call(y(ha),oa)})),u))for(;M<Q;M++)u(k[M],w,J?A:A.call(k[M],M,u(k[M],w)));return B?k:T?u.call(k):Q?u(k[0],w):F},ab=/^-ms-/,
gb=/-([a-z])/g,sb=function(k){return 1===k.nodeType||9===k.nodeType||!+k.nodeType};D.uid=1;D.prototype={cache:function(k){var u=k[this.expando];return!u&&(u={},sb(k)&&(k.nodeType?k[this.expando]=u:Object.defineProperty(k,this.expando,{value:u,configurable:!0}))),u},set:function(k,u,w){var A;k=this.cache(k);if("string"==typeof u)k[x(u)]=w;else for(A in u)k[x(A)]=u[A];return k},get:function(k,u){return void 0===u?this.cache(k):k[this.expando]&&k[this.expando][x(u)]},access:function(k,u,w){return void 0===
u||u&&"string"==typeof u&&void 0===w?this.get(k,u):(this.set(k,u,w),void 0!==w?w:u)},remove:function(k,u){var w=k[this.expando];if(void 0!==w){if(void 0!==u){var A=(u=Array.isArray(u)?u.map(x):(u=x(u))in w?[u]:u.match(Z)||[]).length;for(;A--;)delete w[u[A]]}(void 0===u||y.isEmptyObject(w))&&(k.nodeType?k[this.expando]=void 0:delete k[this.expando])}},hasData:function(k){k=k[this.expando];return void 0!==k&&!y.isEmptyObject(k)}};var Da=new D,Bb=new D,kc=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ea=/[A-Z]/g;
y.extend({hasData:function(k){return Bb.hasData(k)||Da.hasData(k)},data:function(k,u,w){return Bb.access(k,u,w)},removeData:function(k,u){Bb.remove(k,u)},_data:function(k,u,w){return Da.access(k,u,w)},_removeData:function(k,u){Da.remove(k,u)}});y.fn.extend({data:function(k,u){var w,A,B,F=this[0],J=F&&F.attributes;if(void 0===k){if(this.length&&(B=Bb.get(F),1===F.nodeType&&!Da.get(F,"hasDataAttrs"))){for(w=J.length;w--;)J[w]&&0===(A=J[w].name).indexOf("data-")&&G(F,A=x(A.slice(5)),B[A]);Da.set(F,"hasDataAttrs",
!0)}return B}return"object"==typeof k?this.each(function(){Bb.set(this,k)}):ua(this,function(M){var Q;if(F&&void 0===M)return void 0!==(Q=Bb.get(F,k))||void 0!==(Q=G(F,k))?Q:void 0;this.each(function(){Bb.set(this,k,M)})},null,u,1<arguments.length,null,!0)},removeData:function(k){return this.each(function(){Bb.remove(this,k)})}});y.extend({queue:function(k,u,w){var A;if(k)return u=(u||"fx")+"queue",A=Da.get(k,u),w&&(!A||Array.isArray(w)?A=Da.access(k,u,y.makeArray(w)):A.push(w)),A||[]},dequeue:function(k,
u){u=u||"fx";var w=y.queue(k,u),A=w.length,B=w.shift(),F=y._queueHooks(k,u);"inprogress"===B&&(B=w.shift(),A--);B&&("fx"===u&&w.unshift("inprogress"),delete F.stop,B.call(k,function(){y.dequeue(k,u)},F));!A&&F&&F.empty.fire()},_queueHooks:function(k,u){var w=u+"queueHooks";return Da.get(k,w)||Da.access(k,w,{empty:y.Callbacks("once memory").add(function(){Da.remove(k,[u+"queue",w])})})}});y.fn.extend({queue:function(k,u){var w=2;return("string"!=typeof k&&(u=k,k="fx",w--),arguments.length<w)?y.queue(this[0],
k):void 0===u?this:this.each(function(){var A=y.queue(this,k,u);y._queueHooks(this,k);"fx"===k&&"inprogress"!==A[0]&&y.dequeue(this,k)})},dequeue:function(k){return this.each(function(){y.dequeue(this,k)})},clearQueue:function(k){return this.queue(k||"fx",[])},promise:function(k,u){var w,A=1,B=y.Deferred(),F=this,J=this.length,M=function(){--A||B.resolveWith(F,[F])};"string"!=typeof k&&(u=k,k=void 0);for(k=k||"fx";J--;)(w=Da.get(F[J],k+"queueHooks"))&&w.empty&&(A++,w.empty.add(M));return M(),B.promise(u)}});
var Pa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ta=RegExp("^(?:([+-])=|)("+Pa+")([a-z%]*)$","i"),kb=["Top","Right","Bottom","Left"],ob=Wa.documentElement,Zb=function(k){return y.contains(k.ownerDocument,k)},Nc={composed:!0};ob.getRootNode&&(Zb=function(k){return y.contains(k.ownerDocument,k)||k.getRootNode(Nc)===k.ownerDocument});var ud=function(k,u){return"none"===(k=u||k).style.display||""===k.style.display&&Zb(k)&&"none"===y.css(k,"display")},Ze={};y.fn.extend({show:function(){return K(this,
!0)},hide:function(){return K(this)},toggle:function(k){return"boolean"==typeof k?k?this.show():this.hide():this.each(function(){ud(this)?y(this).show():y(this).hide()})}});var Jd=/^(?:checkbox|radio)$/i,we=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,xe=/^$|^module$|\/(?:java|ecma)script/i;var gd=Wa.createDocumentFragment().appendChild(Wa.createElement("div"));($d=Wa.createElement("input")).setAttribute("type","radio");$d.setAttribute("checked","checked");$d.setAttribute("name","t");gd.appendChild($d);cb.checkClone=
gd.cloneNode(!0).cloneNode(!0).lastChild.checked;gd.innerHTML="<textarea>x</textarea>";cb.noCloneChecked=!!gd.cloneNode(!0).lastChild.defaultValue;gd.innerHTML="<option></option>";cb.option=!!gd.lastChild;var zc={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};zc.tbody=zc.tfoot=zc.colgroup=zc.caption=zc.thead;zc.th=zc.td;cb.option||(zc.optgroup=zc.option=
[1,"<select multiple='multiple'>","</select>"]);var $e=/<|&#?\w+;/,ve=/^([^.]*)(?:\.(.+)|)/;y.event={global:{},add:function(k,u,w,A,B){var F,J,M,Q,T,ha,W,oa;var ra=Da.get(k);if(sb(k))for(w.handler&&(w=(F=w).handler,B=F.selector),B&&y.find.matchesSelector(ob,B),w.guid||(w.guid=y.guid++),(Q=ra.events)||(Q=ra.events=Object.create(null)),(J=ra.handle)||(J=ra.handle=function(Ua){return y.event.triggered!==Ua.type?y.event.dispatch.apply(k,arguments):void 0}),ra=(u=(u||"").match(Z)||[""]).length;ra--;){var va=
oa=(M=ve.exec(u[ra])||[])[1];M=(M[2]||"").split(".").sort();va&&(ha=y.event.special[va]||{},va=(B?ha.delegateType:ha.bindType)||va,ha=y.event.special[va]||{},T=y.extend({type:va,origType:oa,data:A,handler:w,guid:w.guid,selector:B,needsContext:B&&y.expr.match.needsContext.test(B),namespace:M.join(".")},F),(W=Q[va])||((W=Q[va]=[]).delegateCount=0,(!ha.setup||!1===ha.setup.call(k,A,M,J))&&k.addEventListener&&k.addEventListener(va,J)),ha.add&&(ha.add.call(k,T),T.handler.guid||(T.handler.guid=w.guid)),
B?W.splice(W.delegateCount++,0,T):W.push(T),y.event.global[va]=!0)}},remove:function(k,u,w,A,B){var F,J,M,Q,T,ha,W,oa,ra=Da.hasData(k)&&Da.get(k);if(ra&&(Q=ra.events)){for(T=(u=(u||"").match(Z)||[""]).length;T--;)if(ha=oa=(M=ve.exec(u[T])||[])[1],W=(M[2]||"").split(".").sort(),ha){var va=y.event.special[ha]||{};var Ua=Q[ha=(A?va.delegateType:va.bindType)||ha]||[];M=M[2]&&RegExp("(^|\\.)"+W.join("\\.(?:.*\\.|)")+"(\\.|$)");for(J=F=Ua.length;F--;){var Qa=Ua[F];!B&&oa!==Qa.origType||w&&w.guid!==Qa.guid||
M&&!M.test(Qa.namespace)||A&&A!==Qa.selector&&("**"!==A||!Qa.selector)||(Ua.splice(F,1),Qa.selector&&Ua.delegateCount--,!va.remove||va.remove.call(k,Qa))}J&&!Ua.length&&(va.teardown&&!1!==va.teardown.call(k,W,ra.handle)||y.removeEvent(k,ha,ra.handle),delete Q[ha])}else for(ha in Q)y.event.remove(k,ha+u[T],w,A,!0);y.isEmptyObject(Q)&&Da.remove(k,"handle events")}},dispatch:function(k){var u,w,A,B=Array(arguments.length),F=y.event.fix(k);var J=(Da.get(this,"events")||Object.create(null))[F.type]||[];
var M=y.event.special[F.type]||{};var Q=1;for(B[0]=F;Q<arguments.length;Q++)B[Q]=arguments[Q];if(F.delegateTarget=this,!M.preDispatch||!1!==M.preDispatch.call(this,F)){var T=y.event.handlers.call(this,F,J);for(Q=0;(w=T[Q++])&&!F.isPropagationStopped();)for(F.currentTarget=w.elem,J=0;(A=w.handlers[J++])&&!F.isImmediatePropagationStopped();)F.rnamespace&&!1!==A.namespace&&!F.rnamespace.test(A.namespace)||(F.handleObj=A,F.data=A.data,void 0===(u=((y.event.special[A.origType]||{}).handle||A.handler).apply(w.elem,
B))||!1!==(F.result=u)||(F.preventDefault(),F.stopPropagation()));return M.postDispatch&&M.postDispatch.call(this,F),F.result}},handlers:function(k,u){var w,A,B,F=[],J=u.delegateCount,M=k.target;if(J&&M.nodeType&&!("click"===k.type&&1<=k.button))for(;M!==this;M=M.parentNode||this)if(1===M.nodeType&&("click"!==k.type||!0!==M.disabled)){var Q=0;var T=[];for(B={};Q<J;Q++)void 0===B[A=(w=u[Q]).selector+" "]&&(B[A]=w.needsContext?-1<y(A,this).index(M):y.find(A,this,null,[M]).length),B[A]&&T.push(w);T.length&&
F.push({elem:M,handlers:T})}return M=this,J<u.length&&F.push({elem:M,handlers:u.slice(J)}),F},addProp:function(k,u){Object.defineProperty(y.Event.prototype,k,{enumerable:!0,configurable:!0,get:db(u)?function(){if(this.originalEvent)return u(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[k]},set:function(w){Object.defineProperty(this,k,{enumerable:!0,configurable:!0,writable:!0,value:w})}})},fix:function(k){return k[y.expando]?k:new y.Event(k)},special:{load:{noBubble:!0},
click:{setup:function(k){k=this||k;return Jd.test(k.type)&&k.click&&f(k,"input")&&Aa(k,"click",!0),!1},trigger:function(k){k=this||k;return Jd.test(k.type)&&k.click&&f(k,"input")&&Aa(k,"click"),!0},_default:function(k){k=k.target;return Jd.test(k.type)&&k.click&&f(k,"input")&&Da.get(k,"click")||f(k,"a")}},beforeunload:{postDispatch:function(k){void 0!==k.result&&k.originalEvent&&(k.originalEvent.returnValue=k.result)}}}};y.removeEvent=function(k,u,w){k.removeEventListener&&k.removeEventListener(u,
w)};y.Event=function(k,u){if(!(this instanceof y.Event))return new y.Event(k,u);k&&k.type?(this.originalEvent=k,this.type=k.type,this.isDefaultPrevented=k.defaultPrevented||void 0===k.defaultPrevented&&!1===k.returnValue?X:Y,this.target=k.target&&3===k.target.nodeType?k.target.parentNode:k.target,this.currentTarget=k.currentTarget,this.relatedTarget=k.relatedTarget):this.type=k;u&&y.extend(this,u);this.timeStamp=k&&k.timeStamp||Date.now();this[y.expando]=!0};y.Event.prototype={constructor:y.Event,
isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,isSimulated:!1,preventDefault:function(){var k=this.originalEvent;this.isDefaultPrevented=X;k&&!this.isSimulated&&k.preventDefault()},stopPropagation:function(){var k=this.originalEvent;this.isPropagationStopped=X;k&&!this.isSimulated&&k.stopPropagation()},stopImmediatePropagation:function(){var k=this.originalEvent;this.isImmediatePropagationStopped=X;k&&!this.isSimulated&&k.stopImmediatePropagation();this.stopPropagation()}};
y.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},y.event.addProp);y.each({focus:"focusin",blur:"focusout"},function(k,u){function w(A){if(Wa.documentMode){var B=Da.get(this,"handle"),F=y.event.fix(A);
F.type="focusin"===A.type?"focus":"blur";F.isSimulated=!0;B(A);F.target===F.currentTarget&&B(F)}else y.event.simulate(u,A.target,y.event.fix(A))}y.event.special[k]={setup:function(){var A;if(Aa(this,k,!0),!Wa.documentMode)return!1;(A=Da.get(this,u))||this.addEventListener(u,w);Da.set(this,u,(A||0)+1)},trigger:function(){return Aa(this,k),!0},teardown:function(){var A;if(!Wa.documentMode)return!1;(A=Da.get(this,u)-1)?Da.set(this,u,A):(this.removeEventListener(u,w),Da.remove(this,u))},_default:function(A){return Da.get(A.target,
k)},delegateType:u};y.event.special[u]={setup:function(){var A=this.ownerDocument||this.document||this,B=Wa.documentMode?this:A,F=Da.get(B,u);F||(Wa.documentMode?this.addEventListener(u,w):A.addEventListener(k,w,!0));Da.set(B,u,(F||0)+1)},teardown:function(){var A=this.ownerDocument||this.document||this,B=Wa.documentMode?this:A,F=Da.get(B,u)-1;F?Da.set(B,u,F):(Wa.documentMode?this.removeEventListener(u,w):A.removeEventListener(k,w,!0),Da.remove(B,u))}}});y.each({mouseenter:"mouseover",mouseleave:"mouseout",
pointerenter:"pointerover",pointerleave:"pointerout"},function(k,u){y.event.special[k]={delegateType:u,bindType:u,handle:function(w){var A,B=w.relatedTarget,F=w.handleObj;return B&&(B===this||y.contains(this,B))||(w.type=F.origType,A=F.handler.apply(this,arguments),w.type=u),A}}});y.fn.extend({on:function(k,u,w,A){return ka(this,k,u,w,A)},one:function(k,u,w,A){return ka(this,k,u,w,A,1)},off:function(k,u,w){var A,B;if(k&&k.preventDefault&&k.handleObj)return A=k.handleObj,y(k.delegateTarget).off(A.namespace?
A.origType+"."+A.namespace:A.origType,A.selector,A.handler),this;if("object"==typeof k){for(B in k)this.off(B,u,k[B]);return this}return(!1===u||"function"==typeof u)&&(w=u,u=void 0),!1===w&&(w=Y),this.each(function(){y.event.remove(this,k,w,u)})}});var Pf=/<script|<style|<link/i,Qf=/checked\s*(?:[^=]|=\s*.checked.)/i,ye=/^\s*<!\[CDATA\[|\]\]>\s*$/g;y.extend({htmlPrefilter:function(k){return k},clone:function(k,u,w){var A,B,F=k.cloneNode(!0),J=Zb(k);if(!(cb.noCloneChecked||1!==k.nodeType&&11!==k.nodeType||
y.isXMLDoc(k))){var M=0;var Q=P(F);for(A=(B=P(k)).length;M<A;M++){var T=B[M],ha=Q[M],W=ha.nodeName.toLowerCase();"input"===W&&Jd.test(T.type)?ha.checked=T.checked:("input"===W||"textarea"===W)&&(ha.defaultValue=T.defaultValue);!0}}if(u)if(w)for(M=0,B=B||P(k),Q=Q||P(F),A=B.length;M<A;M++)pa(B[M],Q[M]);else pa(k,F);return 0<(Q=P(F,"script")).length&&L(Q,!J&&P(k,"script")),F},cleanData:function(k){for(var u,w,A,B=y.event.special,F=0;void 0!==(w=k[F]);F++)if(sb(w)){if(u=w[Da.expando]){if(u.events)for(A in u.events)B[A]?
y.event.remove(w,A):y.removeEvent(w,A,u.handle);w[Da.expando]=void 0}w[Bb.expando]&&(w[Bb.expando]=void 0)}}});y.fn.extend({detach:function(k){return $a(this,k,!0)},remove:function(k){return $a(this,k)},text:function(k){return ua(this,function(u){return void 0===u?y.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=u)})},null,k,arguments.length)},append:function(){return qb(this,arguments,function(k){1!==this.nodeType&&11!==this.nodeType&&
9!==this.nodeType||Ga(this,k).appendChild(k)})},prepend:function(){return qb(this,arguments,function(k){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var u=Ga(this,k);u.insertBefore(k,u.firstChild)}})},before:function(){return qb(this,arguments,function(k){this.parentNode&&this.parentNode.insertBefore(k,this)})},after:function(){return qb(this,arguments,function(k){this.parentNode&&this.parentNode.insertBefore(k,this.nextSibling)})},empty:function(){for(var k,u=0;null!=(k=this[u]);u++)1===
k.nodeType&&(y.cleanData(P(k,!1)),k.textContent="");return this},clone:function(k,u){return k=null!=k&&k,u=null==u?k:u,this.map(function(){return y.clone(this,k,u)})},html:function(k){return ua(this,function(u){var w=this[0]||{},A=0,B=this.length;if(void 0===u&&1===w.nodeType)return w.innerHTML;if("string"==typeof u&&!Pf.test(u)&&!zc[(we.exec(u)||["",""])[1].toLowerCase()]){u=y.htmlPrefilter(u);try{for(;A<B;A++)w=this[A]||{},1===w.nodeType&&(y.cleanData(P(w,!1)),w.innerHTML=u);w=0}catch(F){}}w&&this.empty().append(u)},
null,k,arguments.length)},replaceWith:function(){var k=[];return qb(this,arguments,function(u){var w=this.parentNode;0>y.inArray(this,k)&&(y.cleanData(P(this)),w&&w.replaceChild(u,this))},k)}});y.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(k,u){y.fn[k]=function(w){for(var A=[],B=y(w),F=B.length-1,J=0;J<=F;J++)w=J===F?this:this.clone(!0),y(B[J])[u](w),dc.apply(A,w.get());return this.pushStack(A)}});var Yd=RegExp("^("+Pa+")(?!px)[a-z%]+$",
"i"),ze=/^--/,Zd=function(k){var u=k.ownerDocument.defaultView;return u&&u.opener||(u=c),u.getComputedStyle(k)},af=function(k,u,w){var A,B={};for(A in u)B[A]=k.style[A],k.style[A]=u[A];for(A in w=w.call(k),u)k.style[A]=B[A];return w},Rf=RegExp(kb.join("|"),"i");!function(){function k(){if(Q){M.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0";Q.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%";
ob.appendChild(M).appendChild(Q);var T=c.getComputedStyle(Q);u="1%"!==T.top;J=12===Math.round(parseFloat(T.marginLeft));Q.style.right="60%";B=36===Math.round(parseFloat(T.right));w=36===Math.round(parseFloat(T.width));Q.style.position="absolute";A=12===Math.round(parseFloat(Q.offsetWidth/3));ob.removeChild(M);Q=null}}var u,w,A,B,F,J,M=Wa.createElement("div"),Q=Wa.createElement("div");Q.style&&(Q.style.backgroundClip="content-box",Q.cloneNode(!0).style.backgroundClip="",cb.clearCloneStyle="content-box"===
Q.style.backgroundClip,y.extend(cb,{boxSizingReliable:function(){return k(),w},pixelBoxStyles:function(){return k(),B},pixelPosition:function(){return k(),u},reliableMarginLeft:function(){return k(),J},scrollboxSize:function(){return k(),A},reliableTrDimensions:function(){var T,ha,W,oa;return null==F&&(T=Wa.createElement("table"),ha=Wa.createElement("tr"),W=Wa.createElement("div"),T.style.cssText="position:absolute;left:-11111px;border-collapse:separate",ha.style.cssText="box-sizing:content-box;border:1px solid",
ha.style.height="1px",W.style.height="9px",W.style.display="block",ob.appendChild(T).appendChild(ha).appendChild(W),F=parseInt((oa=c.getComputedStyle(ha)).height,10)+parseInt(oa.borderTopWidth,10)+parseInt(oa.borderBottomWidth,10)===ha.offsetHeight,ob.removeChild(T)),F}}))}();var bf=["Webkit","Moz","ms"],cf=Wa.createElement("div").style,df={},Sf=/^(none|table(?!-c[ea]).+)/,Oc={position:"absolute",visibility:"hidden",display:"block"},ef={letterSpacing:"0",fontWeight:"400"};y.extend({cssHooks:{opacity:{get:function(k,
u){if(u)return k=Gb(k,"opacity"),""===k?"1":k}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(k,u,w,A){if(k&&3!==k.nodeType&&
8!==k.nodeType&&k.style){var B,F,J,M=x(u),Q=ze.test(u),T=k.style;if(Q||(u=Ka(M)),J=y.cssHooks[u]||y.cssHooks[M],void 0===w)return J&&"get"in J&&void 0!==(B=J.get(k,!1,A))?B:T[u];if("string"==(F=typeof w)&&(B=Ta.exec(w))&&B[1]&&(w=N(k,u,B),F="number"),null!=w&&w==w)"number"!==F||Q||(w+=B&&B[3]||(y.cssNumber[M]?"":"px")),cb.clearCloneStyle||""!==w||0!==u.indexOf("background")||(T[u]="inherit"),J&&"set"in J&&void 0===(w=J.set(k,w,A))||(Q?T.setProperty(u,w):T[u]=w)}},css:function(k,u,w,A){var B,F,J,M=
x(u);return(ze.test(u)||(u=Ka(M)),(J=y.cssHooks[u]||y.cssHooks[M])&&"get"in J&&(B=J.get(k,!0,w)),void 0===B&&(B=Gb(k,u,A)),"normal"===B&&u in ef&&(B=ef[u]),""===w||w)?(F=parseFloat(B),!0===w||isFinite(F)?F||0:B):B}});y.each(["height","width"],function(k,u){y.cssHooks[u]={get:function(w,A,B){if(A)return!Sf.test(y.css(w,"display"))||w.getClientRects().length&&w.getBoundingClientRect().width?Fa(w,u,B):af(w,Oc,function(){return Fa(w,u,B)})},set:function(w,A,B){var F,J=Zd(w),M=!cb.scrollboxSize()&&"absolute"===
J.position,Q=(M||B)&&"border-box"===y.css(w,"boxSizing",!1,J);B=B?ja(w,u,B,Q,J):0;return Q&&M&&(B-=Math.ceil(w["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(J[u])-ja(w,u,"border",!1,J)-.5)),B&&(F=Ta.exec(A))&&"px"!==(F[3]||"px")&&(w.style[u]=A,A=y.css(w,u)),Na(w,A,B)}}});y.cssHooks.marginLeft=Fb(cb.reliableMarginLeft,function(k,u){if(u)return(parseFloat(Gb(k,"marginLeft"))||k.getBoundingClientRect().left-af(k,{marginLeft:0},function(){return k.getBoundingClientRect().left}))+"px"});y.each({margin:"",
padding:"",border:"Width"},function(k,u){y.cssHooks[k+u]={expand:function(w){var A=0,B={};for(w="string"==typeof w?w.split(" "):[w];4>A;A++)B[k+kb[A]+u]=w[A]||w[A-2]||w[0];return B}};"margin"!==k&&(y.cssHooks[k+u].set=Na)});y.fn.extend({css:function(k,u){return ua(this,function(w,A,B){var F,J={},M=0;if(Array.isArray(A)){B=Zd(w);for(F=A.length;M<F;M++)J[A[M]]=y.css(w,A[M],!1,B);return J}return void 0!==B?y.style(w,A,B):y.css(w,A)},k,u,1<arguments.length)}});y.Tween=sa;sa.prototype={constructor:sa,
init:function(k,u,w,A,B,F){this.elem=k;this.prop=w;this.easing=B||y.easing._default;this.options=u;this.start=this.now=this.cur();this.end=A;this.unit=F||(y.cssNumber[w]?"":"px")},cur:function(){var k=sa.propHooks[this.prop];return k&&k.get?k.get(this):sa.propHooks._default.get(this)},run:function(k){var u,w=sa.propHooks[this.prop];return this.options.duration?this.pos=u=y.easing[this.easing](k,this.options.duration*k,0,1,this.options.duration):this.pos=u=k,this.now=(this.end-this.start)*u+this.start,
this.options.step&&this.options.step.call(this.elem,this.now,this),w&&w.set?w.set(this):sa.propHooks._default.set(this),this}};sa.prototype.init.prototype=sa.prototype;sa.propHooks={_default:{get:function(k){var u;return 1!==k.elem.nodeType||null!=k.elem[k.prop]&&null==k.elem.style[k.prop]?k.elem[k.prop]:(u=y.css(k.elem,k.prop,""))&&"auto"!==u?u:0},set:function(k){y.fx.step[k.prop]?y.fx.step[k.prop](k):1!==k.elem.nodeType||!y.cssHooks[k.prop]&&null==k.elem.style[Ka(k.prop)]?k.elem[k.prop]=k.now:y.style(k.elem,
k.prop,k.now+k.unit)}}};sa.propHooks.scrollTop=sa.propHooks.scrollLeft={set:function(k){k.elem.nodeType&&k.elem.parentNode&&(k.elem[k.prop]=k.now)}};y.easing={linear:function(k){return k},swing:function(k){return.5-Math.cos(k*Math.PI)/2},_default:"swing"};y.fx=sa.prototype.init;y.fx.step={};var $d,hd,ae,Tf=/^(?:toggle|show|hide)$/,ff=/queueHooks$/;y.Animation=y.extend(Ra,{tweeners:{"*":[function(k,u){var w=this.createTween(k,u);return N(w.elem,k,Ta.exec(u),w),w}]},tweener:function(k,u){db(k)?(u=k,
k=["*"]):k=k.match(Z);for(var w,A=0,B=k.length;A<B;A++)w=k[A],Ra.tweeners[w]=Ra.tweeners[w]||[],Ra.tweeners[w].unshift(u)},prefilters:[function(k,u,w){var A,B,F,J,M,Q,T,ha="width"in u||"height"in u,W=this,oa={},ra=k.style,va=k.nodeType&&ud(k),Ua=Da.get(k,"fxshow");for(A in w.queue||(null==(J=y._queueHooks(k,"fx")).unqueued&&(J.unqueued=0,M=J.empty.fire,J.empty.fire=function(){J.unqueued||M()}),J.unqueued++,W.always(function(){W.always(function(){J.unqueued--;y.queue(k,"fx").length||J.empty.fire()})})),
u)if(B=u[A],Tf.test(B)){if(delete u[A],F=F||"toggle"===B,B===(va?"hide":"show"))if("show"===B&&Ua&&void 0!==Ua[A])va=!0;else continue;oa[A]=Ua&&Ua[A]||y.style(k,A)}if((u=!y.isEmptyObject(u))||!y.isEmptyObject(oa))for(A in ha&&1===k.nodeType&&(w.overflow=[ra.overflow,ra.overflowX,ra.overflowY],null==(Q=Ua&&Ua.display)&&(Q=Da.get(k,"display")),"none"===(T=y.css(k,"display"))&&(Q?T=Q:(K([k],!0),Q=k.style.display||Q,T=y.css(k,"display"),K([k]))),("inline"===T||"inline-block"===T&&null!=Q)&&"none"===y.css(k,
"float")&&(u||(W.done(function(){ra.display=Q}),null==Q&&(Q="none"===(T=ra.display)?"":T)),ra.display="inline-block")),w.overflow&&(ra.overflow="hidden",W.always(function(){ra.overflow=w.overflow[0];ra.overflowX=w.overflow[1];ra.overflowY=w.overflow[2]})),u=!1,oa)u||(Ua?"hidden"in Ua&&(va=Ua.hidden):Ua=Da.access(k,"fxshow",{display:Q}),F&&(Ua.hidden=!va),va&&K([k],!0),W.done(function(){for(A in va||K([k]),Da.remove(k,"fxshow"),oa)y.style(k,A,oa[A])})),u=qa(va?Ua[A]:0,A,W),A in Ua||(Ua[A]=u.start,
va&&(u.end=u.start,u.start=0))}],prefilter:function(k,u){u?Ra.prefilters.unshift(k):Ra.prefilters.push(k)}});y.speed=function(k,u,w){var A=k&&"object"==typeof k?y.extend({},k):{complete:w||!w&&u||db(k)&&k,duration:k,easing:w&&u||u&&!db(u)&&u};return y.fx.off?A.duration=0:"number"!=typeof A.duration&&(A.duration in y.fx.speeds?A.duration=y.fx.speeds[A.duration]:A.duration=y.fx.speeds._default),(null==A.queue||!0===A.queue)&&(A.queue="fx"),A.old=A.complete,A.complete=function(){db(A.old)&&A.old.call(this);
A.queue&&y.dequeue(this,A.queue)},A};y.fn.extend({fadeTo:function(k,u,w,A){return this.filter(ud).css("opacity",0).show().end().animate({opacity:u},k,w,A)},animate:function(k,u,w,A){var B=y.isEmptyObject(k),F=y.speed(u,w,A);u=function(){var J=Ra(this,y.extend({},k),F);(B||Da.get(this,"finish"))&&J.stop(!0)};return u.finish=u,B||!1===F.queue?this.each(u):this.queue(F.queue,u)},stop:function(k,u,w){var A=function(B){var F=B.stop;delete B.stop;F(w)};return"string"!=typeof k&&(w=u,u=k,k=void 0),u&&this.queue(k||
"fx",[]),this.each(function(){var B=!0,F=null!=k&&k+"queueHooks",J=y.timers,M=Da.get(this);if(F)M[F]&&M[F].stop&&A(M[F]);else for(F in M)M[F]&&M[F].stop&&ff.test(F)&&A(M[F]);for(F=J.length;F--;)J[F].elem!==this||null!=k&&J[F].queue!==k||(J[F].anim.stop(w),B=!1,J.splice(F,1));!B&&w||y.dequeue(this,k)})},finish:function(k){return!1!==k&&(k=k||"fx"),this.each(function(){var u=Da.get(this),w=u[k+"queue"];var A=u[k+"queueHooks"];var B=y.timers,F=w?w.length:0;u.finish=!0;y.queue(this,k,[]);A&&A.stop&&A.stop.call(this,
!0);for(A=B.length;A--;)B[A].elem===this&&B[A].queue===k&&(B[A].anim.stop(!0),B.splice(A,1));for(A=0;A<F;A++)w[A]&&w[A].finish&&w[A].finish.call(this);delete u.finish})}});y.each(["toggle","show","hide"],function(k,u){var w=y.fn[u];y.fn[u]=function(A,B,F){return null==A||"boolean"==typeof A?w.apply(this,arguments):this.animate(La(u,!0),A,B,F)}});y.each({slideDown:La("show"),slideUp:La("hide"),slideToggle:La("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},
function(k,u){y.fn[k]=function(w,A,B){return this.animate(u,w,A,B)}});y.timers=[];y.fx.tick=function(){var k,u=0,w=y.timers;for(hd=Date.now();u<w.length;u++)(k=w[u])()||w[u]!==k||w.splice(u--,1);w.length||y.fx.stop();hd=void 0};y.fx.timer=function(k){y.timers.push(k);y.fx.start()};y.fx.interval=13;y.fx.start=function(){ae||(ae=!0,function u(){ae&&(!1===Wa.hidden&&c.requestAnimationFrame?c.requestAnimationFrame(u):c.setTimeout(u,y.fx.interval),y.fx.tick())}())};y.fx.stop=function(){ae=null};y.fx.speeds=
{slow:600,fast:200,_default:400};y.fn.delay=function(k,u){return k=y.fx&&y.fx.speeds[k]||k,u=u||"fx",this.queue(u,function(w,A){var B=c.setTimeout(w,k);A.stop=function(){c.clearTimeout(B)}})};var id=Wa.createElement("input");var Uf=Wa.createElement("select").appendChild(Wa.createElement("option"));id.type="checkbox";cb.checkOn=""!==id.value;cb.optSelected=Uf.selected;(id=Wa.createElement("input")).value="t";id.type="radio";cb.radioValue="t"===id.value;var Kd=y.expr.attrHandle;y.fn.extend({attr:function(k,
u){return ua(this,y.attr,k,u,1<arguments.length)},removeAttr:function(k){return this.each(function(){y.removeAttr(this,k)})}});y.extend({attr:function(k,u,w){var A,B,F=k.nodeType;if(3!==F&&8!==F&&2!==F){if(void 0===k.getAttribute)return y.prop(k,u,w);if(1===F&&y.isXMLDoc(k)||(B=y.attrHooks[u.toLowerCase()]||(y.expr.match.bool.test(u)?vd:void 0)),void 0!==w){if(null===w){y.removeAttr(k,u);return}return B&&"set"in B&&void 0!==(A=B.set(k,w,u))?A:(k.setAttribute(u,w+""),w)}return B&&"get"in B&&null!==
(A=B.get(k,u))?A:null==(A=y.find.attr(k,u))?void 0:A}},attrHooks:{type:{set:function(k,u){if(!cb.radioValue&&"radio"===u&&f(k,"input")){var w=k.value;return k.setAttribute("type",u),w&&(k.value=w),u}}}},removeAttr:function(k,u){var w=0,A=u&&u.match(Z);if(A&&1===k.nodeType)for(;u=A[w++];)k.removeAttribute(u)}});var vd={set:function(k,u,w){return!1===u?y.removeAttr(k,w):k.setAttribute(w,w),w}};y.each(y.expr.match.bool.source.match(/\w+/g),function(k,u){var w=Kd[u]||y.find.attr;Kd[u]=function(A,B,F){var J,
M,Q=B.toLowerCase();return F||(M=Kd[Q],Kd[Q]=J,J=null!=w(A,B,F)?Q:null,Kd[Q]=M),J}});var Vf=/^(?:input|select|textarea|button)$/i,Wf=/^(?:a|area)$/i;y.fn.extend({prop:function(k,u){return ua(this,y.prop,k,u,1<arguments.length)},removeProp:function(k){return this.each(function(){delete this[y.propFix[k]||k]})}});y.extend({prop:function(k,u,w){var A,B,F=k.nodeType;if(3!==F&&8!==F&&2!==F)return(1===F&&y.isXMLDoc(k)||(u=y.propFix[u]||u,B=y.propHooks[u]),void 0!==w)?B&&"set"in B&&void 0!==(A=B.set(k,w,
u))?A:k[u]=w:B&&"get"in B&&null!==(A=B.get(k,u))?A:k[u]},propHooks:{tabIndex:{get:function(k){var u=y.find.attr(k,"tabindex");return u?parseInt(u,10):Vf.test(k.nodeName)||Wf.test(k.nodeName)&&k.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}});cb.optSelected||(y.propHooks.selected={get:function(k){k=k.parentNode;return k&&k.parentNode&&k.parentNode.selectedIndex,null},set:function(k){k=k.parentNode;k&&(k.selectedIndex,k.parentNode&&k.parentNode.selectedIndex)}});y.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){y.propFix[this.toLowerCase()]=this});y.fn.extend({addClass:function(k){var u,w,A,B,F,J;return db(k)?this.each(function(M){y(this).addClass(k.call(this,M,hb(this)))}):(u=Yb(k)).length?this.each(function(){if(A=hb(this),w=1===this.nodeType&&" "+Ia(A)+" "){for(F=0;F<u.length;F++)B=u[F],0>w.indexOf(" "+B+" ")&&(w+=B+" ");A!==(J=Ia(w))&&this.setAttribute("class",J)}}):this},removeClass:function(k){var u,w,A,B,F,J;return db(k)?this.each(function(M){y(this).removeClass(k.call(this,M,hb(this)))}):
arguments.length?(u=Yb(k)).length?this.each(function(){if(A=hb(this),w=1===this.nodeType&&" "+Ia(A)+" "){for(F=0;F<u.length;F++)for(B=u[F];-1<w.indexOf(" "+B+" ");)w=w.replace(" "+B+" "," ");A!==(J=Ia(w))&&this.setAttribute("class",J)}}):this:this.attr("class","")},toggleClass:function(k,u){var w,A,B,F,J=typeof k,M="string"===J||Array.isArray(k);return db(k)?this.each(function(Q){y(this).toggleClass(k.call(this,Q,hb(this),u),u)}):"boolean"==typeof u&&M?u?this.addClass(k):this.removeClass(k):(w=Yb(k),
this.each(function(){if(M)for(B=0,F=y(this);B<w.length;B++)A=w[B],F.hasClass(A)?F.removeClass(A):F.addClass(A);else(void 0===k||"boolean"===J)&&((A=hb(this))&&Da.set(this,"__className__",A),this.setAttribute&&this.setAttribute("class",A||!1===k?"":Da.get(this,"__className__")||""))}))},hasClass:function(k){var u,w=0;for(k=" "+k+" ";u=this[w++];)if(1===u.nodeType&&-1<(" "+Ia(hb(u))+" ").indexOf(k))return!0;return!1}});var bd=/\r/g;y.fn.extend({val:function(k){var u,w,A,B=this[0];return arguments.length?
(A=db(k),this.each(function(F){var J;1===this.nodeType&&(null==(J=A?k.call(this,F,y(this).val()):k)?J="":"number"==typeof J?J+="":Array.isArray(J)&&(J=y.map(J,function(M){return null==M?"":M+""})),(u=y.valHooks[this.type]||y.valHooks[this.nodeName.toLowerCase()])&&"set"in u&&void 0!==u.set(this,J,"value")||(this.value=J))})):B?(u=y.valHooks[B.type]||y.valHooks[B.nodeName.toLowerCase()])&&"get"in u&&void 0!==(w=u.get(B,"value"))?w:"string"==typeof(w=B.value)?w.replace(bd,""):null==w?"":w:void 0}});
y.extend({valHooks:{option:{get:function(k){var u=y.find.attr(k,"value");return null!=u?u:Ia(y.text(k))}},select:{get:function(k){var u,w,A=k.options,B=k.selectedIndex,F="select-one"===k.type,J=F?null:[],M=F?B+1:A.length;for(w=0>B?M:F?B:0;w<M;w++)if(!(!(u=A[w]).selected&&w!==B||u.disabled||u.parentNode.disabled&&f(u.parentNode,"optgroup"))){if(k=y(u).val(),F)return k;J.push(k)}return J},set:function(k,u){var w,A,B=k.options;u=y.makeArray(u);for(var F=B.length;F--;)((A=B[F]).selected=-1<y.inArray(y.valHooks.option.get(A),
u))&&(w=!0);return w||(k.selectedIndex=-1),u}}}});y.each(["radio","checkbox"],function(){y.valHooks[this]={set:function(k,u){if(Array.isArray(u))return k.checked=-1<y.inArray(y(k).val(),u)}};cb.checkOn||(y.valHooks[this].get=function(k){return null===k.getAttribute("value")?"on":k.value})});var wd=c.location,gf=Date.now(),Ae=/\?/;y.parseXML=function(k){var u;if(!k||"string"!=typeof k)return null;try{var w=(new c.DOMParser).parseFromString(k,"text/xml")}catch(A){}return u=w&&w.getElementsByTagName("parsererror")[0],
(!w||u)&&y.error("Invalid XML: "+(u?y.map(u.childNodes,function(A){return A.textContent}).join("\n"):k)),w};var hf=/^(?:focusinfocus|focusoutblur)$/,jf=function(k){k.stopPropagation()};y.extend(y.event,{trigger:function(k,u,w,A){var B,F,J,M,Q,T,ha=[w||Wa],W=vc.call(k,"type")?k.type:k;var oa=vc.call(k,"namespace")?k.namespace.split("."):[];if(B=T=F=w=w||Wa,3!==w.nodeType&&8!==w.nodeType&&!hf.test(W+y.event.triggered)&&(-1<W.indexOf(".")&&(W=(oa=W.split(".")).shift(),oa.sort()),J=0>W.indexOf(":")&&
"on"+W,(k=k[y.expando]?k:new y.Event(W,"object"==typeof k&&k)).isTrigger=A?2:3,k.namespace=oa.join("."),k.rnamespace=k.namespace?RegExp("(^|\\.)"+oa.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,k.result=void 0,k.target||(k.target=w),u=null==u?[k]:y.makeArray(u,[k]),Q=y.event.special[W]||{},A||!Q.trigger||!1!==Q.trigger.apply(w,u))){if(!A&&!Q.noBubble&&!nc(w)){var ra=Q.delegateType||W;for(hf.test(ra+W)||(B=B.parentNode);B;B=B.parentNode)ha.push(B),F=B;F===(w.ownerDocument||Wa)&&ha.push(F.defaultView||F.parentWindow||
c)}for(oa=0;(B=ha[oa++])&&!k.isPropagationStopped();)T=B,k.type=1<oa?ra:Q.bindType||W,(M=(Da.get(B,"events")||Object.create(null))[k.type]&&Da.get(B,"handle"))&&M.apply(B,u),(M=J&&B[J])&&M.apply&&sb(B)&&(k.result=M.apply(B,u),!1===k.result&&k.preventDefault());return k.type=W,!A&&!k.isDefaultPrevented()&&(!Q._default||!1===Q._default.apply(ha.pop(),u))&&sb(w)&&J&&db(w[W])&&!nc(w)&&((F=w[J])&&(w[J]=null),y.event.triggered=W,k.isPropagationStopped()&&T.addEventListener(W,jf),w[W](),k.isPropagationStopped()&&
T.removeEventListener(W,jf),y.event.triggered=void 0,F&&(w[J]=F)),k.result}},simulate:function(k,u,w){k=y.extend(new y.Event,w,{type:k,isSimulated:!0});y.event.trigger(k,null,u)}});y.fn.extend({trigger:function(k,u){return this.each(function(){y.event.trigger(k,u,this)})},triggerHandler:function(k,u){var w=this[0];if(w)return y.event.trigger(k,u,w,!0)}});var Xf=/\[\]$/,kf=/\r?\n/g,Yf=/^(?:submit|button|image|reset|file)$/i,Zf=/^(?:input|select|textarea|keygen)/i;y.param=function(k,u){var w,A=[],B=
function(F,J){J=db(J)?J():J;A[A.length]=encodeURIComponent(F)+"="+encodeURIComponent(null==J?"":J)};if(null==k)return"";if(Array.isArray(k)||k.jquery&&!y.isPlainObject(k))y.each(k,function(){B(this.name,this.value)});else for(w in k)!function ha(J,M,Q,T){var W;if(Array.isArray(M))y.each(M,function(oa,ra){Q||Xf.test(J)?T(J,ra):ha(J+"["+("object"==typeof ra&&null!=ra?oa:"")+"]",ra,Q,T)});else if(Q||"object"!==g(M))T(J,M);else for(W in M)ha(J+"["+W+"]",M[W],Q,T)}(w,k[w],u,B);return A.join("&")};y.fn.extend({serialize:function(){return y.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var k=y.prop(this,"elements");return k?y.makeArray(k):this}).filter(function(){var k=this.type;return this.name&&!y(this).is(":disabled")&&Zf.test(this.nodeName)&&!Yf.test(k)&&(this.checked||!Jd.test(k))}).map(function(k,u){k=y(this).val();return null==k?null:Array.isArray(k)?y.map(k,function(w){return{name:u.name,value:w.replace(kf,"\r\n")}}):{name:u.name,value:k.replace(kf,"\r\n")}}).get()}});var $f=/%20/g,ag=/#.*$/,bg=/([?&])_=[^&]*/,xd=/^(.*?):[ \t]*([^\r\n]*)$/mg,
cg=/^(?:GET|HEAD)$/,dg=/^\/\//,be={},Be={},lf="*/".concat("*"),yd=Wa.createElement("a");yd.href=wd.href;y.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:wd.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(wd.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":lf,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,
html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":y.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(k,u){return u?Cb(Cb(k,y.ajaxSettings),u):Cb(y.ajaxSettings,k)},ajaxPrefilter:ic(be),ajaxTransport:ic(Be),ajax:function(k,u){function w(Oa,lb,Mb,Jc){var Xb,Hb,rc,Sc,ad,yc=lb;!Sa&&(Sa=!0,M&&c.clearTimeout(M),A=void 0,F=Jc||"",Va.readyState=4*(0<Oa),Xb=200<=
Oa&&300>Oa||304===Oa,Mb&&(Sc=function(ac,gc,mc){for(var Kc,Dc,Pb,sc,Xc=ac.contents,ec=ac.dataTypes;"*"===ec[0];)ec.shift(),void 0===Kc&&(Kc=ac.mimeType||gc.getResponseHeader("Content-Type"));if(Kc)for(Dc in Xc)if(Xc[Dc]&&Xc[Dc].test(Kc)){ec.unshift(Dc);break}if(ec[0]in mc)Pb=ec[0];else{for(Dc in mc){if(!ec[0]||ac.converters[Dc+" "+ec[0]]){Pb=Dc;break}sc||=Dc}Pb=Pb||sc}if(Pb)return Pb!==ec[0]&&ec.unshift(Pb),mc[Pb]}(W,Va,Mb)),!Xb&&-1<y.inArray("script",W.dataTypes)&&0>y.inArray("json",W.dataTypes)&&
(W.converters["text script"]=function(){}),Sc=function(ac,gc,mc,Kc){var Dc,Pb,sc,Xc,ec,Lc={},fe=ac.dataTypes.slice();if(fe[1])for(sc in ac.converters)Lc[sc.toLowerCase()]=ac.converters[sc];for(Pb=fe.shift();Pb;)if(ac.responseFields[Pb]&&(mc[ac.responseFields[Pb]]=gc),!ec&&Kc&&ac.dataFilter&&(gc=ac.dataFilter(gc,ac.dataType)),ec=Pb,Pb=fe.shift())if("*"===Pb)Pb=ec;else if("*"!==ec&&ec!==Pb){if(!(sc=Lc[ec+" "+Pb]||Lc["* "+Pb]))for(Dc in Lc)if((Xc=Dc.split(" "))[1]===Pb&&(sc=Lc[ec+" "+Xc[0]]||Lc["* "+
Xc[0]])){!0===sc?sc=Lc[Dc]:!0!==Lc[Dc]&&(Pb=Xc[0],fe.unshift(Xc[1]));break}if(!0!==sc)if(sc&&ac.throws)gc=sc(gc);else try{gc=sc(gc)}catch(hg){return{state:"parsererror",error:sc?hg:"No conversion from "+ec+" to "+Pb}}}return{state:"success",data:gc}}(W,Sc,Va,Xb),Xb?(W.ifModified&&((ad=Va.getResponseHeader("Last-Modified"))&&(y.lastModified[B]=ad),(ad=Va.getResponseHeader("etag"))&&(y.etag[B]=ad)),204===Oa||"HEAD"===W.type?yc="nocontent":304===Oa?yc="notmodified":(yc=Sc.state,Hb=Sc.data,Xb=!(rc=Sc.error))):
(rc=yc,(Oa||!yc)&&(yc="error",0>Oa&&(Oa=0))),Va.status=Oa,Va.statusText=(lb||yc)+"",Xb?va.resolveWith(oa,[Hb,yc,Va]):va.rejectWith(oa,[Va,yc,rc]),Va.statusCode(Qa),Qa=void 0,Q&&ra.trigger(Xb?"ajaxSuccess":"ajaxError",[Va,W,Xb?Hb:rc]),Ua.fireWith(oa,[Va,yc]),Q&&(ra.trigger("ajaxComplete",[Va,W]),--y.active||y.event.trigger("ajaxStop")))}"object"==typeof k&&(u=k,k=void 0);u=u||{};var A,B,F,J,M,Q,T,ha,W=y.ajaxSetup({},u),oa=W.context||W,ra=W.context&&(oa.nodeType||oa.jquery)?y(oa):y.event,va=y.Deferred(),
Ua=y.Callbacks("once memory"),Qa=W.statusCode||{},wa={},jb={},pb="canceled",Va={readyState:0,getResponseHeader:function(Oa){var lb;if(Sa){if(!J)for(J={};lb=xd.exec(F);)J[lb[1].toLowerCase()+" "]=(J[lb[1].toLowerCase()+" "]||[]).concat(lb[2]);lb=J[Oa.toLowerCase()+" "]}return null==lb?null:lb.join(", ")},getAllResponseHeaders:function(){return Sa?F:null},setRequestHeader:function(Oa,lb){return null==Sa&&(wa[Oa=jb[Oa.toLowerCase()]=jb[Oa.toLowerCase()]||Oa]=lb),this},overrideMimeType:function(Oa){return null==
Sa&&(W.mimeType=Oa),this},statusCode:function(Oa){var lb;if(Oa)if(Sa)Va.always(Oa[Va.status]);else for(lb in Oa)Qa[lb]=[Qa[lb],Oa[lb]];return this},abort:function(Oa){Oa=Oa||pb;return A&&A.abort(Oa),w(0,Oa),this}};if(va.promise(Va),W.url=((k||W.url||wd.href)+"").replace(dg,wd.protocol+"//"),W.type=u.method||u.type||W.method||W.type,W.dataTypes=(W.dataType||"*").toLowerCase().match(Z)||[""],null==W.crossDomain){k=Wa.createElement("a");try{k.href=W.url,k.href=k.href,W.crossDomain=yd.protocol+"//"+yd.host!=
k.protocol+"//"+k.host}catch(Oa){W.crossDomain=!0}}if(W.data&&W.processData&&"string"!=typeof W.data&&(W.data=y.param(W.data,W.traditional)),Qb(be,W,u,Va),Sa)return Va;for(T in(Q=y.event&&W.global)&&0==y.active++&&y.event.trigger("ajaxStart"),W.type=W.type.toUpperCase(),W.hasContent=!cg.test(W.type),B=W.url.replace(ag,""),W.hasContent?W.data&&W.processData&&0===(W.contentType||"").indexOf("application/x-www-form-urlencoded")&&(W.data=W.data.replace($f,"+")):(ha=W.url.slice(B.length),W.data&&(W.processData||
"string"==typeof W.data)&&(B+=(Ae.test(B)?"&":"?")+W.data,delete W.data),!1===W.cache&&(B=B.replace(bg,"$1"),ha=(Ae.test(B)?"&":"?")+"_="+gf++ +ha),W.url=B+ha),W.ifModified&&(y.lastModified[B]&&Va.setRequestHeader("If-Modified-Since",y.lastModified[B]),y.etag[B]&&Va.setRequestHeader("If-None-Match",y.etag[B])),(W.data&&W.hasContent&&!1!==W.contentType||u.contentType)&&Va.setRequestHeader("Content-Type",W.contentType),Va.setRequestHeader("Accept",W.dataTypes[0]&&W.accepts[W.dataTypes[0]]?W.accepts[W.dataTypes[0]]+
("*"!==W.dataTypes[0]?", "+lf+"; q=0.01":""):W.accepts["*"]),W.headers)Va.setRequestHeader(T,W.headers[T]);if(W.beforeSend&&(!1===W.beforeSend.call(oa,Va,W)||Sa))return Va.abort();if(pb="abort",Ua.add(W.complete),Va.done(W.success),Va.fail(W.error),A=Qb(Be,W,u,Va)){if(Va.readyState=1,Q&&ra.trigger("ajaxSend",[Va,W]),Sa)return Va;W.async&&0<W.timeout&&(M=c.setTimeout(function(){Va.abort("timeout")},W.timeout));try{var Sa=!1;A.send(wa,w)}catch(Oa){if(Sa)throw Oa;w(-1,Oa)}}else w(-1,"No Transport");
return Va},getJSON:function(k,u,w){return y.get(k,u,w,"json")},getScript:function(k,u){return y.get(k,void 0,u,"script")}});y.each(["get","post"],function(k,u){y[u]=function(w,A,B,F){return db(A)&&(F=F||B,B=A,A=void 0),y.ajax(y.extend({url:w,type:u,dataType:F,data:A,success:B},y.isPlainObject(w)&&w))}});y.ajaxPrefilter(function(k){for(var u in k.headers)"content-type"===u.toLowerCase()&&(k.contentType=k.headers[u]||"")});y._evalUrl=function(k,u,w){return y.ajax({url:k,type:"GET",dataType:"script",
cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(A){y.globalEval(A,u,w)}})};y.fn.extend({wrapAll:function(k){var u;return this[0]&&(db(k)&&(k=k.call(this[0])),u=y(k,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&u.insertBefore(this[0]),u.map(function(){for(var w=this;w.firstElementChild;)w=w.firstElementChild;return w}).append(this)),this},wrapInner:function(k){return db(k)?this.each(function(u){y(this).wrapInner(k.call(this,u))}):this.each(function(){var u=
y(this),w=u.contents();w.length?w.wrapAll(k):u.append(k)})},wrap:function(k){var u=db(k);return this.each(function(w){y(this).wrapAll(u?k.call(this,w):k)})},unwrap:function(k){return this.parent(k).not("body").each(function(){y(this).replaceWith(this.childNodes)}),this}});y.expr.pseudos.hidden=function(k){return!y.expr.pseudos.visible(k)};y.expr.pseudos.visible=function(k){return!!(k.offsetWidth||k.offsetHeight||k.getClientRects().length)};y.ajaxSettings.xhr=function(){try{return new c.XMLHttpRequest}catch(k){}};
var zd={0:200,1223:204},Ld=y.ajaxSettings.xhr();cb.cors=!!Ld&&"withCredentials"in Ld;cb.ajax=Ld=!!Ld;y.ajaxTransport(function(k){var u,w;if(cb.cors||Ld&&!k.crossDomain)return{send:function(A,B){var F,J=k.xhr();if(J.open(k.type,k.url,k.async,k.username,k.password),k.xhrFields)for(F in k.xhrFields)J[F]=k.xhrFields[F];for(F in k.mimeType&&J.overrideMimeType&&J.overrideMimeType(k.mimeType),k.crossDomain||A["X-Requested-With"]||(A["X-Requested-With"]="XMLHttpRequest"),A)J.setRequestHeader(F,A[F]);u=function(M){return function(){u&&
(u=w=J.onload=J.onerror=J.onabort=J.ontimeout=J.onreadystatechange=null,"abort"===M?J.abort():"error"===M?"number"!=typeof J.status?B(0,"error"):B(J.status,J.statusText):B(zd[J.status]||J.status,J.statusText,"text"!==(J.responseType||"text")||"string"!=typeof J.responseText?{binary:J.response}:{text:J.responseText},J.getAllResponseHeaders()))}};J.onload=u();w=J.onerror=J.ontimeout=u("error");void 0!==J.onabort?J.onabort=w:J.onreadystatechange=function(){4===J.readyState&&c.setTimeout(function(){u&&
w()})};u=u("abort");try{J.send(k.hasContent&&k.data||null)}catch(M){if(u)throw M;}},abort:function(){u&&u()}}});y.ajaxPrefilter(function(k){k.crossDomain&&(k.contents.script=!1)});y.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(k){return y.globalEval(k),k}}});y.ajaxPrefilter("script",function(k){void 0===k.cache&&(k.cache=!1);k.crossDomain&&(k.type=
"GET")});y.ajaxTransport("script",function(k){if(k.crossDomain||k.scriptAttrs){var u,w;return{send:function(A,B){u=y("<script>").attr(k.scriptAttrs||{}).prop({charset:k.scriptCharset,src:k.url}).on("load error",w=function(F){u.remove();w=null;F&&B("error"===F.type?404:200,F.type)});Wa.head.appendChild(u[0])},abort:function(){w&&w()}}}});var mf=[],Ad=/(=)\?(?=&|$)|\?\?/;y.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var k=mf.pop()||y.expando+"_"+gf++;return this[k]=!0,k}});y.ajaxPrefilter("json jsonp",
function(k,u,w){var A,B,F,J=!1!==k.jsonp&&(Ad.test(k.url)?"url":"string"==typeof k.data&&0===(k.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ad.test(k.data)&&"data");if(J||"jsonp"===k.dataTypes[0])return A=k.jsonpCallback=db(k.jsonpCallback)?k.jsonpCallback():k.jsonpCallback,J?k[J]=k[J].replace(Ad,"$1"+A):!1!==k.jsonp&&(k.url+=(Ae.test(k.url)?"&":"?")+k.jsonp+"="+A),k.converters["script json"]=function(){return F||y.error(A+" was not called"),F[0]},k.dataTypes[0]="json",B=c[A],c[A]=
function(){F=arguments},w.always(function(){void 0===B?y(c).removeProp(A):c[A]=B;k[A]&&(k.jsonpCallback=u.jsonpCallback,mf.push(A));F&&db(B)&&B(F[0]);F=B=void 0}),"script"});(Kb=Wa.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>";cb.createHTMLDocument=2===Kb.childNodes.length;y.parseHTML=function(k,u,w){var A,B,F;return"string"!=typeof k?[]:("boolean"==typeof u&&(w=u,u=!1),u||(cb.createHTMLDocument?((A=(u=Wa.implementation.createHTMLDocument("")).createElement("base")).href=
Wa.location.href,u.head.appendChild(A)):u=Wa),B=R.exec(k),F=!w&&[],B)?[u.createElement(B[1])]:(B=ba([k],u,F),F&&F.length&&y(F).remove(),y.merge([],B.childNodes))};y.fn.load=function(k,u,w){var A,B,F,J=this,M=k.indexOf(" ");return-1<M&&(A=Ia(k.slice(M)),k=k.slice(0,M)),db(u)?(w=u,u=void 0):u&&"object"==typeof u&&(B="POST"),0<J.length&&y.ajax({url:k,type:B||"GET",dataType:"html",data:u}).done(function(Q){F=arguments;J.html(A?y("<div>").append(y.parseHTML(Q)).find(A):Q)}).always(w&&function(Q,T){J.each(function(){w.apply(this,
F||[Q.responseText,T,Q])})}),this};y.expr.pseudos.animated=function(k){return y.grep(y.timers,function(u){return k===u.elem}).length};y.offset={setOffset:function(k,u,w){var A,B,F,J=y.css(k,"position"),M=y(k),Q={};"static"===J&&(k.style.position="relative");var T=M.offset();var ha=y.css(k,"top");var W=y.css(k,"left");("absolute"===J||"fixed"===J)&&-1<(ha+W).indexOf("auto")?(F=(A=M.position()).top,B=A.left):(F=parseFloat(ha)||0,B=parseFloat(W)||0);db(u)&&(u=u.call(k,w,y.extend({},T)));null!=u.top&&
(Q.top=u.top-T.top+F);null!=u.left&&(Q.left=u.left-T.left+B);"using"in u?u.using.call(k,Q):M.css(Q)}};y.fn.extend({offset:function(k){if(arguments.length)return void 0===k?this:this.each(function(B){y.offset.setOffset(this,k,B)});var u,w,A=this[0];if(A)return A.getClientRects().length?(u=A.getBoundingClientRect(),w=A.ownerDocument.defaultView,{top:u.top+w.pageYOffset,left:u.left+w.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var k,u=this[0],w={top:0,left:0};if("fixed"===y.css(u,"position"))var A=
u.getBoundingClientRect();else{A=this.offset();var B=u.ownerDocument;for(k=u.offsetParent||B.documentElement;k&&(k===B.body||k===B.documentElement)&&"static"===y.css(k,"position");)k=k.parentNode;k&&k!==u&&1===k.nodeType&&(w=y(k).offset(),w.top+=y.css(k,"borderTopWidth",!0),w.left+=y.css(k,"borderLeftWidth",!0))}return{top:A.top-w.top-y.css(u,"marginTop",!0),left:A.left-w.left-y.css(u,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var k=this.offsetParent;k&&"static"===
y.css(k,"position");)k=k.offsetParent;return k||ob})}});y.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(k,u){var w="pageYOffset"===u;y.fn[k]=function(A){return ua(this,function(B,F,J){var M;if(nc(B)?M=B:9===B.nodeType&&(M=B.defaultView),void 0===J)return M?M[u]:B[F];M?M.scrollTo(w?M.pageXOffset:J,w?J:M.pageYOffset):B[F]=J},k,A,arguments.length)}});y.each(["top","left"],function(k,u){y.cssHooks[u]=Fb(cb.pixelPosition,function(w,A){if(A)return A=Gb(w,u),Yd.test(A)?y(w).position()[u]+
"px":A})});y.each({Height:"height",Width:"width"},function(k,u){y.each({padding:"inner"+k,content:u,"":"outer"+k},function(w,A){y.fn[A]=function(B,F){var J=arguments.length&&(w||"boolean"!=typeof B),M=w||(!0===B||!0===F?"margin":"border");return ua(this,function(Q,T,ha){var W;return nc(Q)?0===A.indexOf("outer")?Q["inner"+k]:Q.document.documentElement["client"+k]:9===Q.nodeType?(W=Q.documentElement,Math.max(Q.body["scroll"+k],W["scroll"+k],Q.body["offset"+k],W["offset"+k],W["client"+k])):void 0===
ha?y.css(Q,T,M):y.style(Q,T,ha,M)},u,J?B:void 0,J)}})});y.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(k,u){y.fn[u]=function(w){return this.on(u,w)}});y.fn.extend({bind:function(k,u,w){return this.on(k,null,u,w)},unbind:function(k,u){return this.off(k,null,u)},delegate:function(k,u,w,A){return this.on(u,k,w,A)},undelegate:function(k,u,w){return 1==arguments.length?this.off(k,"**"):this.off(u,k||"**",w)},hover:function(k,u){return this.on("mouseenter",k).on("mouseleave",
u||k)}});y.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(k,u){y.fn[u]=function(w,A){return 0<arguments.length?this.on(u,null,w,A):this.trigger(u)}});var q=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;y.proxy=function(k,u){var w,A,B;if("string"==typeof u&&(w=k[u],u=k,k=w),db(k))return A=fb.call(arguments,2),(B=function(){return k.apply(u||
this,A.concat(fb.call(arguments)))}).guid=k.guid=k.guid||y.guid++,B};y.holdReady=function(k){k?y.readyWait++:y.ready(!0)};y.isArray=Array.isArray;y.parseJSON=JSON.parse;y.nodeName=f;y.isFunction=db;y.isWindow=nc;y.camelCase=x;y.type=g;y.now=Date.now;y.isNumeric=function(k){var u=y.type(k);return("number"===u||"string"===u)&&!isNaN(k-parseFloat(k))};y.trim=function(k){return null==k?"":(k+"").replace(q,"$1")};"function"==typeof define&&define.amd&&define("jquery",[],function(){return y});var z=c.jQuery,
I=c.$;return y.noConflict=function(k){return c.$===y&&(c.$=I),k&&c.jQuery===y&&(c.jQuery=z),y},void 0===d&&(c.jQuery=c.$=y),y}),pe.prototype=Object.create(ma($b).prototype),pe.prototype.constructor=pe,pc.MODE_INDEX_DEFAULT=0,pc.MODE_INDEX_USER=1,pc.prototype.setMode=function(c,d){var b=this.modes[c];b!=d&&(b&&b.leave(),this.modes[c]=d,d.enter())},pc.prototype.setDefaultMode=function(c){c.transient=!1;c.capture=!1;this.setMode(pc.MODE_INDEX_DEFAULT,c)},pc.prototype.setUserMode=function(c){for(var d=
this.modes.length-1;d>pc.MODE_INDEX_USER;d--)this.modes[d].leave(),this.modes.splice(d,1);c.transient=!1;c.capture=!1;this.setMode(pc.MODE_INDEX_USER,c)},pc.prototype.deliverEvent=function(c,d){for(var b=this.modes.length-1;0<=b;b--){var g=this.modes[b];if(g[c].apply(g,d)||g.capture&&"paint"!=c)return!0}return!1},["mouseDown","mouseUp"]))pc.prototype[a]=function(c,d,b){this.deliverEvent(a,[c,d,b])};for(let a of["mouseDrag","mouseMove"])pc.prototype[a]=function(c,d){this.deliverEvent(a,[c,d])};for(let a of["keyDown",
"keyUp"])pc.prototype[a]=function(c){this.deliverEvent(a,[c])&&c.preventDefault()};pc.prototype.paint=function(a){this.deliverEvent("paint",[a])};pc.prototype.push=function(a,c){var d=this.peek();d&&d.suspend();a.transient=c;a.capture=!1;a.enter();this.modes.push(a)};pc.prototype.peek=function(){return 0<this.modes.length?this.modes[this.modes.length-1]:null};pc.prototype.pop=function(){var a=this.modes.pop(),c=this.peek();return a&&a.leave(),c&&c.resume(),c};Me.prototype=Object.create(ma($b).prototype);
Me.prototype.constructor=Me;lc.prototype=Object.create(ma($b).prototype);lc.prototype.constructor=ma($b);Ne.prototype=Object.create(lc.prototype);Ne.prototype.constructor=Ne;Oe.prototype=Object.create(lc.prototype);Oe.prototype.constructor=Oe;Pe.prototype=Object.create(lc.prototype);Pe.prototype.constructor=Pe;let nf=window.devicePixelRatio||1,Od=Math.round(128*nf),Pd=Math.round(128*nf);class Og{_makeBitmap(){if(this._bitmapInvalid){var a=0,c=this._imageData.data;if(this._greyscale)for(var d=0;d<
Pd;d++){var b=255-Math.round(d/(Pd-1)*255);for(var g=0;g<Od;g++)c[a+H.RED_BYTE_OFFSET]=b,c[a+H.GREEN_BYTE_OFFSET]=b,c[a+H.BLUE_BYTE_OFFSET]=b,c[a+H.ALPHA_BYTE_OFFSET]=255,a+=H.BYTES_PER_PIXEL}else for(d=this.color.clone(),b=0;b<Pd;b++)for(d.setValue(255-~~(b/(Pd-1)*255)),g=0;g<Od;g++)d.setSaturation(Math.round(g/(Od-1)*255)),c[a+H.RED_BYTE_OFFSET]=d.rgb>>16&255,c[a+H.GREEN_BYTE_OFFSET]=d.rgb>>8&255,c[a+H.BLUE_BYTE_OFFSET]=255&d.rgb,c[a+H.ALPHA_BYTE_OFFSET]=255,a+=H.BYTES_PER_PIXEL;this._bitmapInvalid=
!1}}paint(){this._makeBitmap();this._canvasContext.putImageData(this._imageData,0,0);let a=this.color.getSaturation()/255*(Od-1),c=(255-this.color.getValue())/255*(Pd-1);Le(this._canvasContext,"stroke");this._canvasContext.lineWidth=1.5*nf;this._canvasContext.beginPath();this._greyscale?(this._canvasContext.moveTo(0,c),this._canvasContext.lineTo(Od,c)):this._canvasContext.arc(a,c,5*nf,0,2*Math.PI);this._canvasContext.stroke();this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(a){let c=
this._canvas.getBoundingClientRect();var d=a.pageX-window.scrollX-c.left;a=Math.max(Math.min(255-~~(255*(a.pageY-window.scrollY-c.top)/127),255),0);this._greyscale?this.color.setGreyscale(a):(d=Math.max(Math.min(~~(255*d/127),255),0),this.color.setHsv(this.color.getHue(),d,a));this.paint();this._controller.setCurColor(this.color)}_endDrag(a){this._canvas.releasePointerCapture(a.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",this._handleEndDrag);this._canvas.removeEventListener("pointermove",
this._handleMousePickColor)}_startDrag(a){this._capturedMouse||(this._capturedMouse=!0,this._canvas.setPointerCapture(a.pointerId),this._canvas.addEventListener("pointerup",this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(a)}setHue(a){this.color.getHue()!=a&&(this.color.setHue(a),this._controller.setCurColor(this.color))}getElement(){return this._canvas}constructor(a,c){Cc(this,"_controller",void 0);Cc(this,"_canvas",void 0);
Cc(this,"_canvasContext",void 0);Cc(this,"_imageData",void 0);Cc(this,"_bitmapInvalid",!0);Cc(this,"_capturedMouse",!1);Cc(this,"_greyscale",!1);Cc(this,"color",new Ab(0));this._controller=a;let d=document.createElement("canvas");this._canvas=d;d.className="chickenpaint-colorpicker-select";d.setAttribute("touch-action","none");d.width=Od;d.height=Pd;d.style.width="128px";d.style.height="128px";this._canvasContext=d.getContext("2d");this._imageData=this._canvasContext.createImageData(Od,Pd);this._canvasContext.getImageData(0,
0,1,1);this._handleEndDrag=this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);d.addEventListener("pointerdown",b=>this._startDrag(b));c&&this.color.copyFrom(c);a.on("colorChange",b=>{this.color.copyFrom(b);this._bitmapInvalid=!0;this.paint()});a.on("colorModeChange",b=>{this._greyscale="greyscale"==b;this._bitmapInvalid=!0;this.paint()});this.paint()}}class Pg{paint(){this._canvasContext.putImageData(this._imageData,0,0);let a=128*this.hue/360;Le(this._canvasContext,
"stroke");this._canvasContext.lineWidth=1.5;this._canvasContext.beginPath();this._canvasContext.moveTo(0,a);this._canvasContext.lineTo(24,a);this._canvasContext.stroke();this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(a){let c=this._canvas.getBoundingClientRect();this.hue=Math.max(0,Math.min(359,~~(360*(a.pageY-c.top)/128)));this.paint();this.selecter&&this.selecter.setHue(this.hue)}_endDrag(a){this._canvas.releasePointerCapture(a.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",
this._handleEndDrag);this._canvas.removeEventListener("pointermove",this._handleMousePickColor)}_startDrag(a){this._capturedMouse||(this._capturedMouse=!0,this._canvas.setPointerCapture(a.pointerId),this._canvas.addEventListener("pointerup",this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(a)}getElement(){return this._canvas}setHue(a){this.hue=a;this.paint()}constructor(a,c,d){Cc(this,"hue",void 0);Cc(this,"selecter",void 0);Cc(this,
"_canvas",void 0);Cc(this,"_canvasContext",void 0);Cc(this,"_imageData",void 0);Cc(this,"_capturedMouse",!1);this.selecter=c;this.hue=d||0;let b=document.createElement("canvas");this._canvas=b;a.on("colorChange",g=>{this.setHue(g.getHue())});a.on("colorModeChange",g=>{b.style.display="greyscale"==g?"none":"block"});b.setAttribute("touch-action","none");b.addEventListener("pointerdown",g=>this._startDrag(g));b.width=24;b.height=128;b.className="chickenpaint-colorpicker-slider";this._canvasContext=
b.getContext("2d");this._imageData=this._canvasContext.createImageData(24,128);this._canvasContext.getImageData(0,0,1,1);this._handleEndDrag=this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);(function(g){let p=new Ab(65535),f=0,e=g.data;for(let m=0;m<g.height;m++){p.setHue(359*m/g.height);for(let l=0;l<g.width;l++)e[f+H.RED_BYTE_OFFSET]=p.rgb>>16&255,e[f+H.GREEN_BYTE_OFFSET]=p.rgb>>8&255,e[f+H.BLUE_BYTE_OFFSET]=255&p.rgb,e[f+H.ALPHA_BYTE_OFFSET]=255,f+=H.BYTES_PER_PIXEL}})(this._imageData);
this.paint()}}Qe.prototype=Object.create(lc.prototype);Qe.prototype.constructor=Qe;Vd.prototype=Object.create(ma($b).prototype);Vd.prototype.constructor=Vd;Hc.prototype=Object.create(ma($b).prototype);Hc.prototype.constructor=Hc;qe.prototype=Object.create(ma($b).prototype);qe.prototype.constructor=qe;Wd.prototype=Object.create(lc.prototype);Wd.prototype.constructor=Wd;Wd.CPBrushPreview=function(a){function c(){f.clearRect(0,0,p.width,p.height);f.beginPath();f.arc(p.width/2,p.height/2,g/2*window.devicePixelRatio,
0,2*Math.PI);f.stroke()}function d(m){let l=p.getBoundingClientRect();var h=m.clientX-l.left-p.clientWidth/2;m=m.clientY-l.top-p.clientHeight/2;h=Math.max(1,Math.min(200,Math.round(2*Math.sqrt(h*h+m*m))));c();a.setBrushSize(h)}function b(m){e&&(e=!1,document.removeEventListener("pointerup",b,{passive:!0,capture:!1}),document.removeEventListener("pointermove",d,{passive:!0,capture:!1}))}let g=16,p=document.createElement("canvas"),f=p.getContext("2d"),e=!1;p.addEventListener("pointerdown",function(m){e||
(e=!0,document.addEventListener("pointerup",b,{passive:!0,capture:!1}),document.addEventListener("pointermove",d,{passive:!0,capture:!1}),d(m))});this.getElement=function(){return p};a.on("toolChange",function(m,l){l.size!=g&&(g=l.size,c())});p.width=64;p.height=64;1<window.devicePixelRatio&&(p.style.width=p.width+"px",p.style.height=p.height+"px",p.width*=window.devicePixelRatio,p.height*=window.devicePixelRatio);p.className="chickenpaint-brush-preview";f.strokeStyle="black";f.lineWidth=+window.devicePixelRatio;
c()};Re.prototype=Object.create(lc.prototype);Re.prototype.constructor=Re;Se.prototype=Object.create(lc.prototype);Se.prototype.constructor=Se;Te.prototype=Object.create(lc.prototype);Te.prototype.constructor=Te;Ue.prototype=Object.create(ma($b).prototype);Ue.prototype.constructor=Ue;let Tg=[{name:"File",mnemonic:"F",children:[{name:"Save to my computer",action:"CPSave",mnemonic:"S",shortcut:"ctrl+s"},{name:"Save Oekaki",action:"CPSend",mnemonic:"S",shortcut:"ctrl+s"}]},{name:"Edit",mnemonic:"E",
children:[{name:"Undo",action:"CPUndo",mnemonic:"U",shortcut:"ctrl+z"},{name:"Redo",action:"CPRedo",mnemonic:"R",shortcut:"ctrl+y"},{name:"Clear history",action:"CPClearHistory",mnemonic:"H",title:ia("Removes all undo/redo information to regain memory")},{name:"-"},{name:"Cut",action:"CPCut",mnemonic:"T",shortcut:"ctrl+x"},{name:"Copy",action:"CPCopy",mnemonic:"C",shortcut:"ctrl+c"},{name:"Copy merged",action:"CPCopyMerged",mnemonic:"Y",shortcut:"shift+ctrl+c"},{name:"Paste",action:"CPPaste",mnemonic:"P",
shortcut:"ctrl+v"},{name:"-"},{name:"Select all",action:"CPSelectAll",mnemonic:"A",shortcut:"ctrl+a"},{name:"Deselect",action:"CPDeselectAll",mnemonic:"D",shortcut:"ctrl+d"},{name:"-"},{name:"Transform",action:"CPTransform",mnemonic:"T",shortcut:"ctrl+h"}]},{name:"Layers",mnemonic:"L",children:[{name:"Duplicate",action:"CPLayerDuplicate",mnemonic:"D",shortcut:"shift+ctrl+d"},{name:"-"},{name:"Merge down",action:"CPLayerMergeDown",mnemonic:"E",shortcut:"ctrl+e"},{name:"Merge group",action:"CPGroupMerge",
mnemonic:"G",shortcut:"shift+ctrl+g"},{name:"Merge all layers",action:"CPLayerMergeAll",shortcut:"shift+ctrl+e",mnemonic:"A"},{name:"-"},{hideIfNotAvailable:!0,name:"Add layer mask",action:"CPAddLayerMask"},{hideIfNotAvailable:!0,name:"Delete layer mask",action:"CPRemoveLayerMask",shortcut:"shift+m"},{hideIfNotAvailable:!0,name:"Apply layer mask",action:"CPApplyLayerMask",shortcut:"ctrl+m"},{name:"-"},{hideIfNotAvailable:!0,name:"Clip to the layer below",action:"CPCreateClippingMask"},{hideIfNotAvailable:!0,
name:"Unclip from the layer below",action:"CPReleaseClippingMask"}]},{name:"Effects",mnemonic:"E",children:[{name:"Clear",action:"CPClear",mnemonic:"D",shortcut:"del,backspace"},{name:"Fill",action:"CPFill",mnemonic:"F",shortcut:"ctrl+f"},{name:"Flip horizontal",action:"CPHFlip",mnemonic:"H",shortcut:"h"},{name:"Flip vertical",action:"CPVFlip",mnemonic:"V"},{name:"Invert",action:"CPFXInvert",mnemonic:"I",shortcut:"ctrl+i",title:ia("Invert the image colors")},{name:"-"},{name:"Convert brightness to opacity",
action:"CPBrightnessToOpacity",mnemonic:"B",title:ia("Convert brightness to opacity")},{name:"-"},{name:"Box blur...",action:"CPFXBoxBlur",mnemonic:"B"},{name:"-"},{name:"Monochromatic noise",action:"CPMNoise",mnemonic:"M",title:ia("Fills the selection with noise")},{name:"Color noise",action:"CPCNoise",mnemonic:"C",title:ia("Fills the selection with colored noise")}]},{name:"View",mnemonic:"V",children:[{name:"Full-screen mode",action:"CPFullScreen",mnemonic:"F",checkbox:!0,checked:!1},{name:"-"},
{name:"Zoom in",action:"CPZoomIn",mnemonic:"I",shortcut:"="},{name:"Zoom out",action:"CPZoomOut",mnemonic:"O",shortcut:"-"},{name:"Zoom 100%",action:"CPZoom100",mnemonic:"1",shortcut:"ctrl+0"},{action:"CPLinearInterpolation",name:"-"},{name:"Smooth-out zoomed canvas",action:"CPLinearInterpolation",mnemonic:"L",title:ia("Linear interpolation is used to give a smoothed looked to the picture when zoomed in"),checkbox:!0,checked:!0},{name:"-"},{name:"Show grid",action:"CPToggleGrid",mnemonic:"G",shortcut:"ctrl+g",
checkbox:!0,checked:!1},{name:"Grid options...",action:"CPGridOptions",mnemonic:"D"}]},{name:"Palettes",mnemonic:"P",children:[{name:"Rearrange",action:"CPArrangePalettes",title:ia("Rearrange the palette windows")},{name:"Toggle palettes",action:"CPTogglePalettes",mnemonic:"P",shortcut:"tab",title:ia("Hides or shows all palettes")},{name:"-"},{name:"Show tools",action:"CPPalTool",mnemonic:"T",checkbox:!0,checked:!0},{name:"Show color",action:"CPPalColor",mnemonic:"C",checkbox:!0,checked:!0},{name:"Show stroke",
action:"CPPalStroke",mnemonic:"S",checkbox:!0,checked:!0},{name:"Show misc",action:"CPPalMisc",mnemonic:"M",checkbox:!0,checked:!0},{name:"Show swatches",action:"CPPalSwatches",mnemonic:"W",checkbox:!0,checked:!0},{name:"Show textures",action:"CPPalTextures",mnemonic:"X",checkbox:!0,checked:!0},{name:"Show tool options",action:"CPPalBrush",mnemonic:"B",checkbox:!0,checked:!0},{name:"Show layers",action:"CPPalLayers",mnemonic:"L",checkbox:!0,checked:!0}]},{name:"Help",mnemonic:"H",children:[{name:"Tablet support",
mnemonic:"T",action:"CPTabletSupport"},{name:"Shortcuts",mnemonic:"S",action:"CPShortcuts"},{name:"-"},{name:"About",mnemonic:"A",action:"CPAbout"}]}];Ve.prototype=Object.create(ma($b).prototype);Ve.prototype.constructor=Ve;We.prototype=Object.create(ma($b).prototype);We.prototype.constructor=We;let Ug=navigator.userAgent.toLowerCase().includes("mac os")?"\u2318":"Ctrl";Xe.prototype=Object.create(ma($b).prototype);Xe.prototype.constructor=Xe;let nd={toolbarStyle:"new"};class Yh extends ma($b){setDefaults(){for(let a in nd)nd.hasOwnProperty(a)&&
this.set(a,nd[a])}load(){let a={};try{a=JSON.parse(localStorage.getItem("chickenpaint-prefs"))}catch(c){console.error(c)}for(let c in a&&"object"==typeof a||(a={}),nd)if(nd.hasOwnProperty(c))try{this.set(c,a.hasOwnProperty(c)?a[c]:nd[c])}catch(d){console.error(d)}}save(){try{let a=!1;for(let c in nd)if(nd.hasOwnProperty(c)&&this[c]!=nd[c]){a=!0;break}a?localStorage.setItem("chickenpaint-prefs",JSON.stringify({toolbarStyle:this.toolbarStyle})):localStorage.removeItem("chickenpaint-prefs")}catch(a){console.error(a)}}set(a,
c){this[a]=c;this.emitEvent(a,[c])}get(a){return this[a]}constructor(){super();Cc(this,"toolbarStyle",void 0);this.setDefaults()}}window.PointerEvent&&(window.hasNativePointerEvents=!0);na.prototype=Object.create(ma($b).prototype);na.prototype.constructor=na;na.UnsupportedBrowserException=function(a){this.message=a};na.UnsupportedBrowserException.prototype.toString=function(){let a="Sorry, your web browser does not support ChickenPaint.";return this.message?a+=" "+this.message:a+=" Please try a modern browser like Chrome, Safari, Firefox, or Edge.",
a};na.M_DRAW=0;na.M_FLOODFILL=1;na.M_RECT_SELECTION=2;na.M_MOVE_TOOL=3;na.M_ROTATE_CANVAS=4;na.M_COLOR_PICKER=5;na.M_GRADIENTFILL=6;na.M_TRANSFORM=7;na.M_PAN_CANVAS=8;na.T_PENCIL=0;na.T_ERASER=1;na.T_PEN=2;na.T_SOFTERASER=3;na.T_AIRBRUSH=4;na.T_DODGE=5;na.T_BURN=6;na.T_WATER=7;na.T_BLUR=8;na.T_SMUDGE=9;na.T_BLENDER=10;na.T_MAX=11;na.COLOR_MODE_RGB=0;na.COLOR_MODE_GREYSCALE=1;window.ChickenPaint=na}();
